---
title: SECCON 2018
category: writeup
date: 2018-10-28 16:05:30
---

# Forensics

## Unzip

å‹ç¼©å‘½ä»¤ä¸º

```bash
echo 'SECCON{'`cat key`'}' > flag.txt
zip -e --password=`perl -e "print time()"` flag.zip flag.txt
```

update:

###

æ¯”è¾ƒæ£’çš„æ€è·¯æ˜¯flag.zipç”Ÿæˆæ—¶åˆ»çš„æ—¶é—´æˆ³å°±æ˜¯ä»–çš„å¯†ç ã€‚é‚£ä¹ˆ

```bash
$stat -c %Y flag.zip
1540566641
```

###

çˆ†ç ´å¯†ç ï¼š

![1540714389474](1540714389474.png)

![1540714399554](1540714399554.png)

![1540714953343](1540714953343.png)

## History

```bash
$ binwalk J

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
3912330       0x3BB28A        ARJ archive data, header size: 22472, version 1, minimum version to extract: 1, compression method: stored, file type: binary, original name: "1", original file date: 1970-01-01 00:00:00, compressed file size: 538968064, uncompressed file size: 1441792, os: MS-DOS
# MS-DOS ä»¥å°ç«¯åºå­˜å‚¨æ•°æ®

$ strings -el J | grep SEC
...foo...
<SEC{.txt
...bar...

$ strings -el J | grep CON
...foo...
<CON{.txt
...bar...

$ strings -el J | grep .txt | uniq
...foo...
<SEC.txt
<CON{.txt
<F0r.txt
<tktksec.txt
<F0r.txt
<ensic.txt
<s.txt
<_usnjrnl.txt
<2018}.txt
<logfile.txt.0

$ strings -el J | grep .txt | uniq | tail -n 10 | sed -E 's/<(.*).txt.*/\1/g' | tr  -d '\n' | grep -o 'SECCON{.*}'
SECCON{F0rtktksecF0rensics_usnjrnl2018}
```

# Reversing

## Runme

miscå¼çš„æ°´é¢˜ã€‚å°±æ˜¯ä¸æ–­è·Ÿè¿›å‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œæ‹¼å‡‘èµ·æ¥å°±å¯ä»¥äº†ã€‚ä¼šå¾—åˆ° `"C:\Temp\SECCON2018Online.exe" SECCON{Runn1n6_P47h} ` ã€‚

update:

###

æ¯”è¾ƒéªšçš„åšæ³•æ˜¯ç›´æ¥strings

```bash
$ strings runme
!This program cannot be run in DOS mode.
...foo...
BRjS
BRjE
BRjC
BRjC
BRjO
BRjN
BRj{
BRjR
BRju
...bar...
$ strings runme | sed -E 's/BRj(.)/\1/g' | tr -d '\n' | grep -o 'SECCON{.*}'
SECCON{Runn1n6_P47h}
```

###

# Media

## Needle in a haystack

æä¾›ä¸€ä¸ªYouTubeçš„è§†é¢‘é“¾æ¥ï¼ˆ<https://www.youtube.com/watch?v=sTKP2btHSBQ> ï¼‰ï¼Œé•¿è¾¾ä¹ä¸ªå¤šå°æ—¶ã€‚

ä» https://y2mate.com/youtube/sTKP2btHSBQ ä¸‹è½½360pçš„ï¼Œå·®ä¸å¤š1.9Gã€‚å¿«è¿›æŸ¥çœ‹ä¼šå‘ç°å³ä¸‹è§’æœ‰ä¸€ä¸ªæˆ¿é—´çš„ç¯äº®ç­å¾ˆæœ‰è§„å¾‹ï¼ŒåŸºæœ¬æ¯åˆ†é’Ÿéƒ½ä¼šæœ‰å˜åŒ–ã€‚

![1540715588584](1540715588584.png)

æˆ‘ä»¬æŠŠäº®è®°ä¸º1ï¼Œæš—è®°ä¸º0çš„è¯ï¼Œæ•´ä¸ªè§†é¢‘æ—¶é•¿545åˆ†é’Ÿï¼Œå¯ä»¥å¾—åˆ°çº¦545æ¯”ç‰¹çš„ä¿¡æ¯ã€‚å¤§æ¦‚æ˜¯è¿™æ ·ï¼š

```
010101000100011101011101000111010111010001110111011100011101000111010111011101000101010001110111011100011101110001000111000101000111011100010001010100011101010101011100010111000111010101010111000101010001000111010111010001011101000100011100011101010101011100011101110001000101010001010100010111000111011101000100011101010101011100011101010100010111010001110111011100010111000111010100011101011101000101110001010100011100001010111000101010101000111000101010111000100010001110100010101110001010111010001010111000101000100011100010100010001010001111
```

å…¶ä¸­æœ‰å››ç§æ•°æ®ï¼Œ`0`ï¼Œ`1` ï¼Œ`000` ï¼Œ`111` ï¼Œåˆ†åˆ«å¯¹åº”äº®ã€æš—ã€é•¿äº®ã€é•¿æš—å››ç§çŠ¶æ€ï¼Œå¯¹åº”åˆ°æ‘©æ–¯ç”µç åˆ™æ˜¯`.` ï¼Œ`çŸ­é—´éš”`ï¼Œ`-` ï¼Œ`é•¿é—´éš”` ã€‚

```python
# -*- coding: utf-8 -*-
# __author__ = findneo

def do(s):
    res=''
    i=0
    while i<len(s):
        if s[i:i+3] == '000':
            res+=' '
            i+=3
        elif s[i:i+3] == '111':
            res+='-'
            i+=3
        elif s[i] == '1':
            res+='.'
            i+=1
        elif s[i] == '0':
            i+=1
    return res
raw='01010100010001110101110100011101011101000111011101110001110100011101011101110100010101000111011101110001110111000100011100010100011101110001000101010001110101010101110001011100011101010101011100010101000100011101011101000101110100010001110001110101010101110001110111000100010101000101010001011100011101110100010001110101010101110001110101010001011101000111011101110001011100011101010001110101110100010111000101010001110??01010111000101010101000111000101010111000100010001110100010101110001010111010001010111000101000100011100010100010001010001111'
may='010101000100011101011101000111010111010001110111011100011101000111010111011101000101010001110111011100011101110001000111000101000111011100010001010100011101010101011100010111000111010101010111000101010001000111010111010001011101000100011100011101010101011100011101110001000101010001010100010111000111011101000100011101010101011100011101010100010111010001110111011100010111000111010100011101011101000101110001010100011100001010111000101010101000111000101010111000100010001110100010101110001010111010001010111000101000100011100010100010001010001111'
print(do(may))
# ... . -.-. -.-. --- -. -.--. ... --- -- . - .. -- . ... -....- .- -....- ... . -.-. .-. . - -....- -- . ... ... .- --. . -....- -... .-. --- .- -.. -.-. .- ... - ..- ..... - ...- . . -. ..- ..-. ..- .. . - .. . .. -.
# http://rumkin.com/tools/cipher/morse.php
# SECCON(SOMETIMES-A-SECRET-MESSAGE-BROADCASTU5TVEENUFUIETIEIN
```

å¤©äº®åçœ‹å¾—å¾ˆä¸æ¸…æ™°äº†ï¼Œè€Œä¸”è²Œä¼¼ 6h58min ä¹‹åçª—æˆ·éƒ½ä¼šé—´æ­‡æ€§åœ°è¢«å…³ä¸Šï¼Œæ‰€ä»¥flagçš„ååŠæ®µæœ‰ç‚¹é—®é¢˜ã€‚

![1540716372243](1540716372243.png)



update:

###

å®é™…ä¸Šå¤©äº®ä»¥åç”¨çª—æˆ·çš„å¼€å…³æ¥è¡¨ç¤ºï¼Œçª—æˆ·æ‰“å¼€ä¸º1ï¼Œçª—æˆ·å…³é—­ä¸º0ï¼ˆæ­£å¥½å’ŒåŸæ¥çš„å¤„ç†æ–¹å¼01ç›¸åï¼Œæ‰€ä»¥å¾—ä¸åˆ°flagï¼‰ï¼Œæ€ç»´å¤ªåƒµç¡¬å•ŠğŸ˜‚

é‚£ä¹ˆå°±å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š

```
010101000100011101011101000111010111010001110111011100011101000111010111011101000101010001110111011100011101110001000111000101000111011100010001010100011101010101011100010111000111010101010111000101010001000111010111010001011101000100011100011101010101011100011101110001000101010001010100010111000111011101000100011101010101011100011101010100010111010001110111011100010111000111010100011101011101000101110001010100011100010101000111010101010111000111010101000111011101110001011101010001110101000101110101000111010111011100011101011101110101110000
... . -.-. -.-. --- -. -.--. ... --- -- . - .. -- . ... -....- .- -....- ... . -.-. .-. . - -....- -- . ... ... .- --. . -....- -... .-. --- .- -.. -.-. .- ... - ... -....- -... --- .-.. -.. .-.. -.-- -.--.-
SECCON(SOMETIMES-A-SECRET-MESSAGE-BROADCASTS-BOLDLY)
```

è¿™ä¸ªå›¾ç‰‡è§£é‡Šå¾—å¾ˆåˆ°ä½äº†ï¼Œä¸è¿‡æˆ‘è§‰å¾—å¾’æ‰‹å¼€å…³ä¸¤ä¸ªå¤šå°æ—¶çš„çª—æˆ·å¤ªä¸é»‘å®¢äº†å§ï¼Œä»–ä»¬ä¸€å®šç”¨äº†æŸç§æ–¹å¼è‡ªåŠ¨åŒ–ã€‚

![1540778376203](1540778376203.png)

###

update2:

###

æœ‰å¤§ä½¬åšäº†è‡ªåŠ¨åŒ–ï¼Œæ•ˆæœè›®å¥½çš„ã€‚

ï¼ˆhttps://ctf-writeups.ru/2k18/seccon-2018-online-ctf/needle_in_a_haystack/ ï¼‰

###